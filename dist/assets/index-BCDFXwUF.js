function KC(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const s in n)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(n,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>n[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(s){if(s.ep)return;s.ep=!0;const a=r(s);fetch(s.href,a)}})();var An=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zy(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function XC(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var s=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,s.get?s:{enumerable:!0,get:function(){return e[n]}})}),r}var e_={exports:{}},Ud={},t_={exports:{}},Xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tu=Symbol.for("react.element"),YC=Symbol.for("react.portal"),JC=Symbol.for("react.fragment"),QC=Symbol.for("react.strict_mode"),ZC=Symbol.for("react.profiler"),e4=Symbol.for("react.provider"),t4=Symbol.for("react.context"),r4=Symbol.for("react.forward_ref"),n4=Symbol.for("react.suspense"),s4=Symbol.for("react.memo"),a4=Symbol.for("react.lazy"),pv=Symbol.iterator;function i4(e){return e===null||typeof e!="object"?null:(e=pv&&e[pv]||e["@@iterator"],typeof e=="function"?e:null)}var r_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},n_=Object.assign,s_={};function nl(e,t,r){this.props=e,this.context=t,this.refs=s_,this.updater=r||r_}nl.prototype.isReactComponent={};nl.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};nl.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function a_(){}a_.prototype=nl.prototype;function Gm(e,t,r){this.props=e,this.context=t,this.refs=s_,this.updater=r||r_}var qm=Gm.prototype=new a_;qm.constructor=Gm;n_(qm,nl.prototype);qm.isPureReactComponent=!0;var mv=Array.isArray,i_=Object.prototype.hasOwnProperty,Km={current:null},o_={key:!0,ref:!0,__self:!0,__source:!0};function l_(e,t,r){var n,s={},a=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)i_.call(t,n)&&!o_.hasOwnProperty(n)&&(s[n]=t[n]);var o=arguments.length-2;if(o===1)s.children=r;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)s[n]===void 0&&(s[n]=o[n]);return{$$typeof:tu,type:e,key:a,ref:i,props:s,_owner:Km.current}}function o4(e,t){return{$$typeof:tu,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Xm(e){return typeof e=="object"&&e!==null&&e.$$typeof===tu}function l4(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var xv=/\/+/g;function W0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?l4(""+e.key):t.toString(36)}function _f(e,t,r,n,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case tu:case YC:i=!0}}if(i)return i=e,s=s(i),e=n===""?"."+W0(i,0):n,mv(s)?(r="",e!=null&&(r=e.replace(xv,"$&/")+"/"),_f(s,t,r,"",function(u){return u})):s!=null&&(Xm(s)&&(s=o4(s,r+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(xv,"$&/")+"/")+e)),t.push(s)),1;if(i=0,n=n===""?".":n+":",mv(e))for(var o=0;o<e.length;o++){a=e[o];var c=n+W0(a,o);i+=_f(a,t,r,c,s)}else if(c=i4(e),typeof c=="function")for(e=c.call(e),o=0;!(a=e.next()).done;)a=a.value,c=n+W0(a,o++),i+=_f(a,t,r,c,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function Ru(e,t,r){if(e==null)return e;var n=[],s=0;return _f(e,n,"","",function(a){return t.call(r,a,s++)}),n}function c4(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Or={current:null},bf={transition:null},u4={ReactCurrentDispatcher:Or,ReactCurrentBatchConfig:bf,ReactCurrentOwner:Km};function c_(){throw Error("act(...) is not supported in production builds of React.")}Xe.Children={map:Ru,forEach:function(e,t,r){Ru(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Ru(e,function(){t++}),t},toArray:function(e){return Ru(e,function(t){return t})||[]},only:function(e){if(!Xm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Xe.Component=nl;Xe.Fragment=JC;Xe.Profiler=ZC;Xe.PureComponent=Gm;Xe.StrictMode=QC;Xe.Suspense=n4;Xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=u4;Xe.act=c_;Xe.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=n_({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=Km.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)i_.call(t,c)&&!o_.hasOwnProperty(c)&&(n[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)n.children=r;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:tu,type:e.type,key:s,ref:a,props:n,_owner:i}};Xe.createContext=function(e){return e={$$typeof:t4,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:e4,_context:e},e.Consumer=e};Xe.createElement=l_;Xe.createFactory=function(e){var t=l_.bind(null,e);return t.type=e,t};Xe.createRef=function(){return{current:null}};Xe.forwardRef=function(e){return{$$typeof:r4,render:e}};Xe.isValidElement=Xm;Xe.lazy=function(e){return{$$typeof:a4,_payload:{_status:-1,_result:e},_init:c4}};Xe.memo=function(e,t){return{$$typeof:s4,type:e,compare:t===void 0?null:t}};Xe.startTransition=function(e){var t=bf.transition;bf.transition={};try{e()}finally{bf.transition=t}};Xe.unstable_act=c_;Xe.useCallback=function(e,t){return Or.current.useCallback(e,t)};Xe.useContext=function(e){return Or.current.useContext(e)};Xe.useDebugValue=function(){};Xe.useDeferredValue=function(e){return Or.current.useDeferredValue(e)};Xe.useEffect=function(e,t){return Or.current.useEffect(e,t)};Xe.useId=function(){return Or.current.useId()};Xe.useImperativeHandle=function(e,t,r){return Or.current.useImperativeHandle(e,t,r)};Xe.useInsertionEffect=function(e,t){return Or.current.useInsertionEffect(e,t)};Xe.useLayoutEffect=function(e,t){return Or.current.useLayoutEffect(e,t)};Xe.useMemo=function(e,t){return Or.current.useMemo(e,t)};Xe.useReducer=function(e,t,r){return Or.current.useReducer(e,t,r)};Xe.useRef=function(e){return Or.current.useRef(e)};Xe.useState=function(e){return Or.current.useState(e)};Xe.useSyncExternalStore=function(e,t,r){return Or.current.useSyncExternalStore(e,t,r)};Xe.useTransition=function(){return Or.current.useTransition()};Xe.version="18.3.1";t_.exports=Xe;var _=t_.exports;const oa=Zy(_),Ym=KC({__proto__:null,default:oa},[_]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f4=_,d4=Symbol.for("react.element"),h4=Symbol.for("react.fragment"),p4=Object.prototype.hasOwnProperty,m4=f4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,x4={key:!0,ref:!0,__self:!0,__source:!0};function u_(e,t,r){var n,s={},a=null,i=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)p4.call(t,n)&&!x4.hasOwnProperty(n)&&(s[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)s[n]===void 0&&(s[n]=t[n]);return{$$typeof:d4,type:e,key:a,ref:i,props:s,_owner:m4.current}}Ud.Fragment=h4;Ud.jsx=u_;Ud.jsxs=u_;e_.exports=Ud;var l=e_.exports,f_={exports:{}},hn={},d_={exports:{}},h_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(K,F){var ne=K.length;K.push(F);e:for(;0<ne;){var Y=ne-1>>>1,j=K[Y];if(0<s(j,F))K[Y]=F,K[ne]=j,ne=Y;else break e}}function r(K){return K.length===0?null:K[0]}function n(K){if(K.length===0)return null;var F=K[0],ne=K.pop();if(ne!==F){K[0]=ne;e:for(var Y=0,j=K.length,H=j>>>1;Y<H;){var U=2*(Y+1)-1,W=K[U],J=U+1,te=K[J];if(0>s(W,ne))J<j&&0>s(te,W)?(K[Y]=te,K[J]=ne,Y=J):(K[Y]=W,K[U]=ne,Y=U);else if(J<j&&0>s(te,ne))K[Y]=te,K[J]=ne,Y=J;else break e}}return F}function s(K,F){var ne=K.sortIndex-F.sortIndex;return ne!==0?ne:K.id-F.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],u=[],f=1,d=null,h=3,p=!1,g=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(K){for(var F=r(u);F!==null;){if(F.callback===null)n(u);else if(F.startTime<=K)n(u),F.sortIndex=F.expirationTime,t(c,F);else break;F=r(u)}}function S(K){if(m=!1,v(K),!g)if(r(c)!==null)g=!0,z(E);else{var F=r(u);F!==null&&q(S,F.startTime-K)}}function E(K,F){g=!1,m&&(m=!1,y(N),N=-1),p=!0;var ne=h;try{for(v(F),d=r(c);d!==null&&(!(d.expirationTime>F)||K&&!V());){var Y=d.callback;if(typeof Y=="function"){d.callback=null,h=d.priorityLevel;var j=Y(d.expirationTime<=F);F=e.unstable_now(),typeof j=="function"?d.callback=j:d===r(c)&&n(c),v(F)}else n(c);d=r(c)}if(d!==null)var H=!0;else{var U=r(u);U!==null&&q(S,U.startTime-F),H=!1}return H}finally{d=null,h=ne,p=!1}}var k=!1,b=null,N=-1,A=5,O=-1;function V(){return!(e.unstable_now()-O<A)}function C(){if(b!==null){var K=e.unstable_now();O=K;var F=!0;try{F=b(!0,K)}finally{F?B():(k=!1,b=null)}}else k=!1}var B;if(typeof w=="function")B=function(){w(C)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,X=G.port2;G.port1.onmessage=C,B=function(){X.postMessage(null)}}else B=function(){x(C,0)};function z(K){b=K,k||(k=!0,B())}function q(K,F){N=x(function(){K(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(K){K.callback=null},e.unstable_continueExecution=function(){g||p||(g=!0,z(E))},e.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<K?Math.floor(1e3/K):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(c)},e.unstable_next=function(K){switch(h){case 1:case 2:case 3:var F=3;break;default:F=h}var ne=h;h=F;try{return K()}finally{h=ne}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(K,F){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var ne=h;h=K;try{return F()}finally{h=ne}},e.unstable_scheduleCallback=function(K,F,ne){var Y=e.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?Y+ne:Y):ne=Y,K){case 1:var j=-1;break;case 2:j=250;break;case 5:j=1073741823;break;case 4:j=1e4;break;default:j=5e3}return j=ne+j,K={id:f++,callback:F,priorityLevel:K,startTime:ne,expirationTime:j,sortIndex:-1},ne>Y?(K.sortIndex=ne,t(u,K),r(c)===null&&K===r(u)&&(m?(y(N),N=-1):m=!0,q(S,ne-Y))):(K.sortIndex=j,t(c,K),g||p||(g=!0,z(E))),K},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(K){var F=h;return function(){var ne=h;h=F;try{return K.apply(this,arguments)}finally{h=ne}}}})(h_);d_.exports=h_;var g4=d_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v4=_,fn=g4;function pe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p_=new Set,hc={};function Mi(e,t){Wo(e,t),Wo(e+"Capture",t)}function Wo(e,t){for(hc[e]=t,e=0;e<t.length;e++)p_.add(t[e])}var Ws=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),np=Object.prototype.hasOwnProperty,w4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,gv={},vv={};function y4(e){return np.call(vv,e)?!0:np.call(gv,e)?!1:w4.test(e)?vv[e]=!0:(gv[e]=!0,!1)}function _4(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function b4(e,t,r,n){if(t===null||typeof t>"u"||_4(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ir(e,t,r,n,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=s,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var fr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){fr[e]=new Ir(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];fr[t]=new Ir(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){fr[e]=new Ir(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){fr[e]=new Ir(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){fr[e]=new Ir(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){fr[e]=new Ir(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){fr[e]=new Ir(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){fr[e]=new Ir(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){fr[e]=new Ir(e,5,!1,e.toLowerCase(),null,!1,!1)});var Jm=/[\-:]([a-z])/g;function Qm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Jm,Qm);fr[t]=new Ir(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Jm,Qm);fr[t]=new Ir(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Jm,Qm);fr[t]=new Ir(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){fr[e]=new Ir(e,1,!1,e.toLowerCase(),null,!1,!1)});fr.xlinkHref=new Ir("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){fr[e]=new Ir(e,1,!1,e.toLowerCase(),null,!0,!0)});function Zm(e,t,r,n){var s=fr.hasOwnProperty(t)?fr[t]:null;(s!==null?s.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(b4(t,r,s,n)&&(r=null),n||s===null?y4(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):s.mustUseProperty?e[s.propertyName]=r===null?s.type===3?!1:"":r:(t=s.attributeName,n=s.attributeNamespace,r===null?e.removeAttribute(t):(s=s.type,r=s===3||s===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var Ys=v4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fu=Symbol.for("react.element"),mo=Symbol.for("react.portal"),xo=Symbol.for("react.fragment"),ex=Symbol.for("react.strict_mode"),sp=Symbol.for("react.profiler"),m_=Symbol.for("react.provider"),x_=Symbol.for("react.context"),tx=Symbol.for("react.forward_ref"),ap=Symbol.for("react.suspense"),ip=Symbol.for("react.suspense_list"),rx=Symbol.for("react.memo"),ua=Symbol.for("react.lazy"),g_=Symbol.for("react.offscreen"),wv=Symbol.iterator;function Sl(e){return e===null||typeof e!="object"?null:(e=wv&&e[wv]||e["@@iterator"],typeof e=="function"?e:null)}var Et=Object.assign,V0;function Dl(e){if(V0===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);V0=t&&t[1]||""}return`
`+V0+e}var H0=!1;function G0(e,t){if(!e||H0)return"";H0=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=n.stack.split(`
`),i=s.length-1,o=a.length-1;1<=i&&0<=o&&s[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(s[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||s[i]!==a[o]){var c=`
`+s[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{H0=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Dl(e):""}function S4(e){switch(e.tag){case 5:return Dl(e.type);case 16:return Dl("Lazy");case 13:return Dl("Suspense");case 19:return Dl("SuspenseList");case 0:case 2:case 15:return e=G0(e.type,!1),e;case 11:return e=G0(e.type.render,!1),e;case 1:return e=G0(e.type,!0),e;default:return""}}function op(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case xo:return"Fragment";case mo:return"Portal";case sp:return"Profiler";case ex:return"StrictMode";case ap:return"Suspense";case ip:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case x_:return(e.displayName||"Context")+".Consumer";case m_:return(e._context.displayName||"Context")+".Provider";case tx:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case rx:return t=e.displayName||null,t!==null?t:op(e.type)||"Memo";case ua:t=e._payload,e=e._init;try{return op(e(t))}catch{}}return null}function k4(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return op(t);case 8:return t===ex?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Pa(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function v_(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function E4(e){var t=v_(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var s=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){n=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ou(e){e._valueTracker||(e._valueTracker=E4(e))}function w_(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=v_(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function Uf(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function lp(e,t){var r=t.checked;return Et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function yv(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=Pa(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function y_(e,t){t=t.checked,t!=null&&Zm(e,"checked",t,!1)}function cp(e,t){y_(e,t);var r=Pa(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?up(e,t.type,r):t.hasOwnProperty("defaultValue")&&up(e,t.type,Pa(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function _v(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function up(e,t,r){(t!=="number"||Uf(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ll=Array.isArray;function Co(e,t,r,n){if(e=e.options,t){t={};for(var s=0;s<r.length;s++)t["$"+r[s]]=!0;for(r=0;r<e.length;r++)s=t.hasOwnProperty("$"+e[r].value),e[r].selected!==s&&(e[r].selected=s),s&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Pa(r),t=null,s=0;s<e.length;s++){if(e[s].value===r){e[s].selected=!0,n&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function fp(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(pe(91));return Et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function bv(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(pe(92));if(Ll(r)){if(1<r.length)throw Error(pe(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:Pa(r)}}function __(e,t){var r=Pa(t.value),n=Pa(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Sv(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function b_(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?b_(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Iu,S_=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,s){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Iu=Iu||document.createElement("div"),Iu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Iu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function pc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Gl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},T4=["Webkit","ms","Moz","O"];Object.keys(Gl).forEach(function(e){T4.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Gl[t]=Gl[e]})});function k_(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Gl.hasOwnProperty(e)&&Gl[e]?(""+t).trim():t+"px"}function E_(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,s=k_(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,s):e[r]=s}}var N4=Et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hp(e,t){if(t){if(N4[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(pe(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(pe(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(pe(61))}if(t.style!=null&&typeof t.style!="object")throw Error(pe(62))}}function pp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var mp=null;function nx(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var xp=null,Ao=null,jo=null;function kv(e){if(e=su(e)){if(typeof xp!="function")throw Error(pe(280));var t=e.stateNode;t&&(t=Hd(t),xp(e.stateNode,e.type,t))}}function T_(e){Ao?jo?jo.push(e):jo=[e]:Ao=e}function N_(){if(Ao){var e=Ao,t=jo;if(jo=Ao=null,kv(e),t)for(e=0;e<t.length;e++)kv(t[e])}}function C_(e,t){return e(t)}function A_(){}var q0=!1;function j_(e,t,r){if(q0)return e(t,r);q0=!0;try{return C_(e,t,r)}finally{q0=!1,(Ao!==null||jo!==null)&&(A_(),N_())}}function mc(e,t){var r=e.stateNode;if(r===null)return null;var n=Hd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(pe(231,t,typeof r));return r}var gp=!1;if(Ws)try{var kl={};Object.defineProperty(kl,"passive",{get:function(){gp=!0}}),window.addEventListener("test",kl,kl),window.removeEventListener("test",kl,kl)}catch{gp=!1}function C4(e,t,r,n,s,a,i,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var ql=!1,$f=null,zf=!1,vp=null,A4={onError:function(e){ql=!0,$f=e}};function j4(e,t,r,n,s,a,i,o,c){ql=!1,$f=null,C4.apply(A4,arguments)}function P4(e,t,r,n,s,a,i,o,c){if(j4.apply(this,arguments),ql){if(ql){var u=$f;ql=!1,$f=null}else throw Error(pe(198));zf||(zf=!0,vp=u)}}function Bi(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function P_(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Ev(e){if(Bi(e)!==e)throw Error(pe(188))}function R4(e){var t=e.alternate;if(!t){if(t=Bi(e),t===null)throw Error(pe(188));return t!==e?null:e}for(var r=e,n=t;;){var s=r.return;if(s===null)break;var a=s.alternate;if(a===null){if(n=s.return,n!==null){r=n;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===r)return Ev(s),e;if(a===n)return Ev(s),t;a=a.sibling}throw Error(pe(188))}if(r.return!==n.return)r=s,n=a;else{for(var i=!1,o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i)throw Error(pe(189))}}if(r.alternate!==n)throw Error(pe(190))}if(r.tag!==3)throw Error(pe(188));return r.stateNode.current===r?e:t}function R_(e){return e=R4(e),e!==null?F_(e):null}function F_(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=F_(e);if(t!==null)return t;e=e.sibling}return null}var O_=fn.unstable_scheduleCallback,Tv=fn.unstable_cancelCallback,F4=fn.unstable_shouldYield,O4=fn.unstable_requestPaint,It=fn.unstable_now,I4=fn.unstable_getCurrentPriorityLevel,sx=fn.unstable_ImmediatePriority,I_=fn.unstable_UserBlockingPriority,Wf=fn.unstable_NormalPriority,D4=fn.unstable_LowPriority,D_=fn.unstable_IdlePriority,$d=null,ws=null;function L4(e){if(ws&&typeof ws.onCommitFiberRoot=="function")try{ws.onCommitFiberRoot($d,e,void 0,(e.current.flags&128)===128)}catch{}}var Xn=Math.clz32?Math.clz32:U4,M4=Math.log,B4=Math.LN2;function U4(e){return e>>>=0,e===0?32:31-(M4(e)/B4|0)|0}var Du=64,Lu=4194304;function Ml(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Vf(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,s=e.suspendedLanes,a=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~s;o!==0?n=Ml(o):(a&=i,a!==0&&(n=Ml(a)))}else i=r&~s,i!==0?n=Ml(i):a!==0&&(n=Ml(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&s)&&(s=n&-n,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Xn(t),s=1<<r,n|=e[r],t&=~s;return n}function $4(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function z4(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-Xn(a),o=1<<i,c=s[i];c===-1?(!(o&r)||o&n)&&(s[i]=$4(o,t)):c<=t&&(e.expiredLanes|=o),a&=~o}}function wp(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function L_(){var e=Du;return Du<<=1,!(Du&4194240)&&(Du=64),e}function K0(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function ru(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Xn(t),e[t]=r}function W4(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var s=31-Xn(r),a=1<<s;t[s]=0,n[s]=-1,e[s]=-1,r&=~a}}function ax(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Xn(r),s=1<<n;s&t|e[n]&t&&(e[n]|=t),r&=~s}}var at=0;function M_(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var B_,ix,U_,$_,z_,yp=!1,Mu=[],_a=null,ba=null,Sa=null,xc=new Map,gc=new Map,da=[],V4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nv(e,t){switch(e){case"focusin":case"focusout":_a=null;break;case"dragenter":case"dragleave":ba=null;break;case"mouseover":case"mouseout":Sa=null;break;case"pointerover":case"pointerout":xc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":gc.delete(t.pointerId)}}function El(e,t,r,n,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[s]},t!==null&&(t=su(t),t!==null&&ix(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function H4(e,t,r,n,s){switch(t){case"focusin":return _a=El(_a,e,t,r,n,s),!0;case"dragenter":return ba=El(ba,e,t,r,n,s),!0;case"mouseover":return Sa=El(Sa,e,t,r,n,s),!0;case"pointerover":var a=s.pointerId;return xc.set(a,El(xc.get(a)||null,e,t,r,n,s)),!0;case"gotpointercapture":return a=s.pointerId,gc.set(a,El(gc.get(a)||null,e,t,r,n,s)),!0}return!1}function W_(e){var t=ui(e.target);if(t!==null){var r=Bi(t);if(r!==null){if(t=r.tag,t===13){if(t=P_(r),t!==null){e.blockedOn=t,z_(e.priority,function(){U_(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Sf(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=_p(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);mp=n,r.target.dispatchEvent(n),mp=null}else return t=su(r),t!==null&&ix(t),e.blockedOn=r,!1;t.shift()}return!0}function Cv(e,t,r){Sf(e)&&r.delete(t)}function G4(){yp=!1,_a!==null&&Sf(_a)&&(_a=null),ba!==null&&Sf(ba)&&(ba=null),Sa!==null&&Sf(Sa)&&(Sa=null),xc.forEach(Cv),gc.forEach(Cv)}function Tl(e,t){e.blockedOn===t&&(e.blockedOn=null,yp||(yp=!0,fn.unstable_scheduleCallback(fn.unstable_NormalPriority,G4)))}function vc(e){function t(s){return Tl(s,e)}if(0<Mu.length){Tl(Mu[0],e);for(var r=1;r<Mu.length;r++){var n=Mu[r];n.blockedOn===e&&(n.blockedOn=null)}}for(_a!==null&&Tl(_a,e),ba!==null&&Tl(ba,e),Sa!==null&&Tl(Sa,e),xc.forEach(t),gc.forEach(t),r=0;r<da.length;r++)n=da[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<da.length&&(r=da[0],r.blockedOn===null);)W_(r),r.blockedOn===null&&da.shift()}var Po=Ys.ReactCurrentBatchConfig,Hf=!0;function q4(e,t,r,n){var s=at,a=Po.transition;Po.transition=null;try{at=1,ox(e,t,r,n)}finally{at=s,Po.transition=a}}function K4(e,t,r,n){var s=at,a=Po.transition;Po.transition=null;try{at=4,ox(e,t,r,n)}finally{at=s,Po.transition=a}}function ox(e,t,r,n){if(Hf){var s=_p(e,t,r,n);if(s===null)sh(e,t,n,Gf,r),Nv(e,n);else if(H4(s,e,t,r,n))n.stopPropagation();else if(Nv(e,n),t&4&&-1<V4.indexOf(e)){for(;s!==null;){var a=su(s);if(a!==null&&B_(a),a=_p(e,t,r,n),a===null&&sh(e,t,n,Gf,r),a===s)break;s=a}s!==null&&n.stopPropagation()}else sh(e,t,n,null,r)}}var Gf=null;function _p(e,t,r,n){if(Gf=null,e=nx(n),e=ui(e),e!==null)if(t=Bi(e),t===null)e=null;else if(r=t.tag,r===13){if(e=P_(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gf=e,null}function V_(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(I4()){case sx:return 1;case I_:return 4;case Wf:case D4:return 16;case D_:return 536870912;default:return 16}default:return 16}}var xa=null,lx=null,kf=null;function H_(){if(kf)return kf;var e,t=lx,r=t.length,n,s="value"in xa?xa.value:xa.textContent,a=s.length;for(e=0;e<r&&t[e]===s[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===s[a-n];n++);return kf=s.slice(e,1<n?1-n:void 0)}function Ef(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Bu(){return!0}function Av(){return!1}function pn(e){function t(r,n,s,a,i){this._reactName=r,this._targetInst=s,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Bu:Av,this.isPropagationStopped=Av,this}return Et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Bu)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Bu)},persist:function(){},isPersistent:Bu}),t}var sl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cx=pn(sl),nu=Et({},sl,{view:0,detail:0}),X4=pn(nu),X0,Y0,Nl,zd=Et({},nu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ux,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Nl&&(Nl&&e.type==="mousemove"?(X0=e.screenX-Nl.screenX,Y0=e.screenY-Nl.screenY):Y0=X0=0,Nl=e),X0)},movementY:function(e){return"movementY"in e?e.movementY:Y0}}),jv=pn(zd),Y4=Et({},zd,{dataTransfer:0}),J4=pn(Y4),Q4=Et({},nu,{relatedTarget:0}),J0=pn(Q4),Z4=Et({},sl,{animationName:0,elapsedTime:0,pseudoElement:0}),eA=pn(Z4),tA=Et({},sl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),rA=pn(tA),nA=Et({},sl,{data:0}),Pv=pn(nA),sA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},aA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},iA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function oA(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=iA[e])?!!t[e]:!1}function ux(){return oA}var lA=Et({},nu,{key:function(e){if(e.key){var t=sA[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ef(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?aA[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ux,charCode:function(e){return e.type==="keypress"?Ef(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ef(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),cA=pn(lA),uA=Et({},zd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rv=pn(uA),fA=Et({},nu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ux}),dA=pn(fA),hA=Et({},sl,{propertyName:0,elapsedTime:0,pseudoElement:0}),pA=pn(hA),mA=Et({},zd,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xA=pn(mA),gA=[9,13,27,32],fx=Ws&&"CompositionEvent"in window,Kl=null;Ws&&"documentMode"in document&&(Kl=document.documentMode);var vA=Ws&&"TextEvent"in window&&!Kl,G_=Ws&&(!fx||Kl&&8<Kl&&11>=Kl),Fv=" ",Ov=!1;function q_(e,t){switch(e){case"keyup":return gA.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function K_(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var go=!1;function wA(e,t){switch(e){case"compositionend":return K_(t);case"keypress":return t.which!==32?null:(Ov=!0,Fv);case"textInput":return e=t.data,e===Fv&&Ov?null:e;default:return null}}function yA(e,t){if(go)return e==="compositionend"||!fx&&q_(e,t)?(e=H_(),kf=lx=xa=null,go=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return G_&&t.locale!=="ko"?null:t.data;default:return null}}var _A={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Iv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!_A[e.type]:t==="textarea"}function X_(e,t,r,n){T_(n),t=qf(t,"onChange"),0<t.length&&(r=new cx("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Xl=null,wc=null;function bA(e){i2(e,0)}function Wd(e){var t=yo(e);if(w_(t))return e}function SA(e,t){if(e==="change")return t}var Y_=!1;if(Ws){var Q0;if(Ws){var Z0="oninput"in document;if(!Z0){var Dv=document.createElement("div");Dv.setAttribute("oninput","return;"),Z0=typeof Dv.oninput=="function"}Q0=Z0}else Q0=!1;Y_=Q0&&(!document.documentMode||9<document.documentMode)}function Lv(){Xl&&(Xl.detachEvent("onpropertychange",J_),wc=Xl=null)}function J_(e){if(e.propertyName==="value"&&Wd(wc)){var t=[];X_(t,wc,e,nx(e)),j_(bA,t)}}function kA(e,t,r){e==="focusin"?(Lv(),Xl=t,wc=r,Xl.attachEvent("onpropertychange",J_)):e==="focusout"&&Lv()}function EA(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Wd(wc)}function TA(e,t){if(e==="click")return Wd(t)}function NA(e,t){if(e==="input"||e==="change")return Wd(t)}function CA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var es=typeof Object.is=="function"?Object.is:CA;function yc(e,t){if(es(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var s=r[n];if(!np.call(t,s)||!es(e[s],t[s]))return!1}return!0}function Mv(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Bv(e,t){var r=Mv(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Mv(r)}}function Q_(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Q_(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Z_(){for(var e=window,t=Uf();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=Uf(e.document)}return t}function dx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function AA(e){var t=Z_(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Q_(r.ownerDocument.documentElement,r)){if(n!==null&&dx(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=r.textContent.length,a=Math.min(n.start,s);n=n.end===void 0?a:Math.min(n.end,s),!e.extend&&a>n&&(s=n,n=a,a=s),s=Bv(r,a);var i=Bv(r,n);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var jA=Ws&&"documentMode"in document&&11>=document.documentMode,vo=null,bp=null,Yl=null,Sp=!1;function Uv(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Sp||vo==null||vo!==Uf(n)||(n=vo,"selectionStart"in n&&dx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Yl&&yc(Yl,n)||(Yl=n,n=qf(bp,"onSelect"),0<n.length&&(t=new cx("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=vo)))}function Uu(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var wo={animationend:Uu("Animation","AnimationEnd"),animationiteration:Uu("Animation","AnimationIteration"),animationstart:Uu("Animation","AnimationStart"),transitionend:Uu("Transition","TransitionEnd")},eh={},e2={};Ws&&(e2=document.createElement("div").style,"AnimationEvent"in window||(delete wo.animationend.animation,delete wo.animationiteration.animation,delete wo.animationstart.animation),"TransitionEvent"in window||delete wo.transitionend.transition);function Vd(e){if(eh[e])return eh[e];if(!wo[e])return e;var t=wo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in e2)return eh[e]=t[r];return e}var t2=Vd("animationend"),r2=Vd("animationiteration"),n2=Vd("animationstart"),s2=Vd("transitionend"),a2=new Map,$v="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ua(e,t){a2.set(e,t),Mi(t,[e])}for(var th=0;th<$v.length;th++){var rh=$v[th],PA=rh.toLowerCase(),RA=rh[0].toUpperCase()+rh.slice(1);Ua(PA,"on"+RA)}Ua(t2,"onAnimationEnd");Ua(r2,"onAnimationIteration");Ua(n2,"onAnimationStart");Ua("dblclick","onDoubleClick");Ua("focusin","onFocus");Ua("focusout","onBlur");Ua(s2,"onTransitionEnd");Wo("onMouseEnter",["mouseout","mouseover"]);Wo("onMouseLeave",["mouseout","mouseover"]);Wo("onPointerEnter",["pointerout","pointerover"]);Wo("onPointerLeave",["pointerout","pointerover"]);Mi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Mi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Mi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Mi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Mi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Mi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FA=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bl));function zv(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,P4(n,t,void 0,e),e.currentTarget=null}function i2(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],s=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==a&&s.isPropagationStopped())break e;zv(s,o,u),a=c}else for(i=0;i<n.length;i++){if(o=n[i],c=o.instance,u=o.currentTarget,o=o.listener,c!==a&&s.isPropagationStopped())break e;zv(s,o,u),a=c}}}if(zf)throw e=vp,zf=!1,vp=null,e}function dt(e,t){var r=t[Cp];r===void 0&&(r=t[Cp]=new Set);var n=e+"__bubble";r.has(n)||(o2(t,e,2,!1),r.add(n))}function nh(e,t,r){var n=0;t&&(n|=4),o2(r,e,n,t)}var $u="_reactListening"+Math.random().toString(36).slice(2);function _c(e){if(!e[$u]){e[$u]=!0,p_.forEach(function(r){r!=="selectionchange"&&(FA.has(r)||nh(r,!1,e),nh(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[$u]||(t[$u]=!0,nh("selectionchange",!1,t))}}function o2(e,t,r,n){switch(V_(t)){case 1:var s=q4;break;case 4:s=K4;break;default:s=ox}r=s.bind(null,t,r,e),s=void 0,!gp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),n?s!==void 0?e.addEventListener(t,r,{capture:!0,passive:s}):e.addEventListener(t,r,!0):s!==void 0?e.addEventListener(t,r,{passive:s}):e.addEventListener(t,r,!1)}function sh(e,t,r,n,s){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(i===4)for(i=n.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;o!==null;){if(i=ui(o),i===null)return;if(c=i.tag,c===5||c===6){n=a=i;continue e}o=o.parentNode}}n=n.return}j_(function(){var u=a,f=nx(r),d=[];e:{var h=a2.get(e);if(h!==void 0){var p=cx,g=e;switch(e){case"keypress":if(Ef(r)===0)break e;case"keydown":case"keyup":p=cA;break;case"focusin":g="focus",p=J0;break;case"focusout":g="blur",p=J0;break;case"beforeblur":case"afterblur":p=J0;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=jv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=J4;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=dA;break;case t2:case r2:case n2:p=eA;break;case s2:p=pA;break;case"scroll":p=X4;break;case"wheel":p=xA;break;case"copy":case"cut":case"paste":p=rA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Rv}var m=(t&4)!==0,x=!m&&e==="scroll",y=m?h!==null?h+"Capture":null:h;m=[];for(var w=u,v;w!==null;){v=w;var S=v.stateNode;if(v.tag===5&&S!==null&&(v=S,y!==null&&(S=mc(w,y),S!=null&&m.push(bc(w,S,v)))),x)break;w=w.return}0<m.length&&(h=new p(h,g,null,r,f),d.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==mp&&(g=r.relatedTarget||r.fromElement)&&(ui(g)||g[Vs]))break e;if((p||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,p?(g=r.relatedTarget||r.toElement,p=u,g=g?ui(g):null,g!==null&&(x=Bi(g),g!==x||g.tag!==5&&g.tag!==6)&&(g=null)):(p=null,g=u),p!==g)){if(m=jv,S="onMouseLeave",y="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(m=Rv,S="onPointerLeave",y="onPointerEnter",w="pointer"),x=p==null?h:yo(p),v=g==null?h:yo(g),h=new m(S,w+"leave",p,r,f),h.target=x,h.relatedTarget=v,S=null,ui(f)===u&&(m=new m(y,w+"enter",g,r,f),m.target=v,m.relatedTarget=x,S=m),x=S,p&&g)t:{for(m=p,y=g,w=0,v=m;v;v=Qi(v))w++;for(v=0,S=y;S;S=Qi(S))v++;for(;0<w-v;)m=Qi(m),w--;for(;0<v-w;)y=Qi(y),v--;for(;w--;){if(m===y||y!==null&&m===y.alternate)break t;m=Qi(m),y=Qi(y)}m=null}else m=null;p!==null&&Wv(d,h,p,m,!1),g!==null&&x!==null&&Wv(d,x,g,m,!0)}}e:{if(h=u?yo(u):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var E=SA;else if(Iv(h))if(Y_)E=NA;else{E=EA;var k=kA}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(E=TA);if(E&&(E=E(e,u))){X_(d,E,r,f);break e}k&&k(e,h,u),e==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&up(h,"number",h.value)}switch(k=u?yo(u):window,e){case"focusin":(Iv(k)||k.contentEditable==="true")&&(vo=k,bp=u,Yl=null);break;case"focusout":Yl=bp=vo=null;break;case"mousedown":Sp=!0;break;case"contextmenu":case"mouseup":case"dragend":Sp=!1,Uv(d,r,f);break;case"selectionchange":if(jA)break;case"keydown":case"keyup":Uv(d,r,f)}var b;if(fx)e:{switch(e){case"compositionstart":var N="onCompositionStart";break e;case"compositionend":N="onCompositionEnd";break e;case"compositionupdate":N="onCompositionUpdate";break e}N=void 0}else go?q_(e,r)&&(N="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(N="onCompositionStart");N&&(G_&&r.locale!=="ko"&&(go||N!=="onCompositionStart"?N==="onCompositionEnd"&&go&&(b=H_()):(xa=f,lx="value"in xa?xa.value:xa.textContent,go=!0)),k=qf(u,N),0<k.length&&(N=new Pv(N,e,null,r,f),d.push({event:N,listeners:k}),b?N.data=b:(b=K_(r),b!==null&&(N.data=b)))),(b=vA?wA(e,r):yA(e,r))&&(u=qf(u,"onBeforeInput"),0<u.length&&(f=new Pv("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:u}),f.data=b))}i2(d,t)})}function bc(e,t,r){return{instance:e,listener:t,currentTarget:r}}function qf(e,t){for(var r=t+"Capture",n=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=mc(e,r),a!=null&&n.unshift(bc(e,a,s)),a=mc(e,t),a!=null&&n.push(bc(e,a,s))),e=e.return}return n}function Qi(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Wv(e,t,r,n,s){for(var a=t._reactName,i=[];r!==null&&r!==n;){var o=r,c=o.alternate,u=o.stateNode;if(c!==null&&c===n)break;o.tag===5&&u!==null&&(o=u,s?(c=mc(r,a),c!=null&&i.unshift(bc(r,c,o))):s||(c=mc(r,a),c!=null&&i.push(bc(r,c,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var OA=/\r\n?/g,IA=/\u0000|\uFFFD/g;function Vv(e){return(typeof e=="string"?e:""+e).replace(OA,`
`).replace(IA,"")}function zu(e,t,r){if(t=Vv(t),Vv(e)!==t&&r)throw Error(pe(425))}function Kf(){}var kp=null,Ep=null;function Tp(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Np=typeof setTimeout=="function"?setTimeout:void 0,DA=typeof clearTimeout=="function"?clearTimeout:void 0,Hv=typeof Promise=="function"?Promise:void 0,LA=typeof queueMicrotask=="function"?queueMicrotask:typeof Hv<"u"?function(e){return Hv.resolve(null).then(e).catch(MA)}:Np;function MA(e){setTimeout(function(){throw e})}function ah(e,t){var r=t,n=0;do{var s=r.nextSibling;if(e.removeChild(r),s&&s.nodeType===8)if(r=s.data,r==="/$"){if(n===0){e.removeChild(s),vc(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=s}while(r);vc(t)}function ka(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Gv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var al=Math.random().toString(36).slice(2),hs="__reactFiber$"+al,Sc="__reactProps$"+al,Vs="__reactContainer$"+al,Cp="__reactEvents$"+al,BA="__reactListeners$"+al,UA="__reactHandles$"+al;function ui(e){var t=e[hs];if(t)return t;for(var r=e.parentNode;r;){if(t=r[Vs]||r[hs]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=Gv(e);e!==null;){if(r=e[hs])return r;e=Gv(e)}return t}e=r,r=e.parentNode}return null}function su(e){return e=e[hs]||e[Vs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function yo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(pe(33))}function Hd(e){return e[Sc]||null}var Ap=[],_o=-1;function $a(e){return{current:e}}function pt(e){0>_o||(e.current=Ap[_o],Ap[_o]=null,_o--)}function ut(e,t){_o++,Ap[_o]=e.current,e.current=t}var Ra={},kr=$a(Ra),Wr=$a(!1),_i=Ra;function Vo(e,t){var r=e.type.contextTypes;if(!r)return Ra;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in r)s[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Vr(e){return e=e.childContextTypes,e!=null}function Xf(){pt(Wr),pt(kr)}function qv(e,t,r){if(kr.current!==Ra)throw Error(pe(168));ut(kr,t),ut(Wr,r)}function l2(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var s in n)if(!(s in t))throw Error(pe(108,k4(e)||"Unknown",s));return Et({},r,n)}function Yf(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ra,_i=kr.current,ut(kr,e),ut(Wr,Wr.current),!0}function Kv(e,t,r){var n=e.stateNode;if(!n)throw Error(pe(169));r?(e=l2(e,t,_i),n.__reactInternalMemoizedMergedChildContext=e,pt(Wr),pt(kr),ut(kr,e)):pt(Wr),ut(Wr,r)}var Os=null,Gd=!1,ih=!1;function c2(e){Os===null?Os=[e]:Os.push(e)}function $A(e){Gd=!0,c2(e)}function za(){if(!ih&&Os!==null){ih=!0;var e=0,t=at;try{var r=Os;for(at=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}Os=null,Gd=!1}catch(s){throw Os!==null&&(Os=Os.slice(e+1)),O_(sx,za),s}finally{at=t,ih=!1}}return null}var bo=[],So=0,Jf=null,Qf=0,Sn=[],kn=0,bi=null,Is=1,Ds="";function ni(e,t){bo[So++]=Qf,bo[So++]=Jf,Jf=e,Qf=t}function u2(e,t,r){Sn[kn++]=Is,Sn[kn++]=Ds,Sn[kn++]=bi,bi=e;var n=Is;e=Ds;var s=32-Xn(n)-1;n&=~(1<<s),r+=1;var a=32-Xn(t)+s;if(30<a){var i=s-s%5;a=(n&(1<<i)-1).toString(32),n>>=i,s-=i,Is=1<<32-Xn(t)+s|r<<s|n,Ds=a+e}else Is=1<<a|r<<s|n,Ds=e}function hx(e){e.return!==null&&(ni(e,1),u2(e,1,0))}function px(e){for(;e===Jf;)Jf=bo[--So],bo[So]=null,Qf=bo[--So],bo[So]=null;for(;e===bi;)bi=Sn[--kn],Sn[kn]=null,Ds=Sn[--kn],Sn[kn]=null,Is=Sn[--kn],Sn[kn]=null}var cn=null,on=null,gt=!1,Vn=null;function f2(e,t){var r=En(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function Xv(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,cn=e,on=ka(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,cn=e,on=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=bi!==null?{id:Is,overflow:Ds}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=En(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,cn=e,on=null,!0):!1;default:return!1}}function jp(e){return(e.mode&1)!==0&&(e.flags&128)===0}function Pp(e){if(gt){var t=on;if(t){var r=t;if(!Xv(e,t)){if(jp(e))throw Error(pe(418));t=ka(r.nextSibling);var n=cn;t&&Xv(e,t)?f2(n,r):(e.flags=e.flags&-4097|2,gt=!1,cn=e)}}else{if(jp(e))throw Error(pe(418));e.flags=e.flags&-4097|2,gt=!1,cn=e}}}function Yv(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;cn=e}function Wu(e){if(e!==cn)return!1;if(!gt)return Yv(e),gt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Tp(e.type,e.memoizedProps)),t&&(t=on)){if(jp(e))throw d2(),Error(pe(418));for(;t;)f2(e,t),t=ka(t.nextSibling)}if(Yv(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(pe(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){on=ka(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}on=null}}else on=cn?ka(e.stateNode.nextSibling):null;return!0}function d2(){for(var e=on;e;)e=ka(e.nextSibling)}function Ho(){on=cn=null,gt=!1}function mx(e){Vn===null?Vn=[e]:Vn.push(e)}var zA=Ys.ReactCurrentBatchConfig;function Cl(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(pe(309));var n=r.stateNode}if(!n)throw Error(pe(147,e));var s=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=s.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(pe(284));if(!r._owner)throw Error(pe(290,e))}return e}function Vu(e,t){throw e=Object.prototype.toString.call(t),Error(pe(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Jv(e){var t=e._init;return t(e._payload)}function h2(e){function t(y,w){if(e){var v=y.deletions;v===null?(y.deletions=[w],y.flags|=16):v.push(w)}}function r(y,w){if(!e)return null;for(;w!==null;)t(y,w),w=w.sibling;return null}function n(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function s(y,w){return y=Ca(y,w),y.index=0,y.sibling=null,y}function a(y,w,v){return y.index=v,e?(v=y.alternate,v!==null?(v=v.index,v<w?(y.flags|=2,w):v):(y.flags|=2,w)):(y.flags|=1048576,w)}function i(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,w,v,S){return w===null||w.tag!==6?(w=hh(v,y.mode,S),w.return=y,w):(w=s(w,v),w.return=y,w)}function c(y,w,v,S){var E=v.type;return E===xo?f(y,w,v.props.children,S,v.key):w!==null&&(w.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===ua&&Jv(E)===w.type)?(S=s(w,v.props),S.ref=Cl(y,w,v),S.return=y,S):(S=Rf(v.type,v.key,v.props,null,y.mode,S),S.ref=Cl(y,w,v),S.return=y,S)}function u(y,w,v,S){return w===null||w.tag!==4||w.stateNode.containerInfo!==v.containerInfo||w.stateNode.implementation!==v.implementation?(w=ph(v,y.mode,S),w.return=y,w):(w=s(w,v.children||[]),w.return=y,w)}function f(y,w,v,S,E){return w===null||w.tag!==7?(w=xi(v,y.mode,S,E),w.return=y,w):(w=s(w,v),w.return=y,w)}function d(y,w,v){if(typeof w=="string"&&w!==""||typeof w=="number")return w=hh(""+w,y.mode,v),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Fu:return v=Rf(w.type,w.key,w.props,null,y.mode,v),v.ref=Cl(y,null,w),v.return=y,v;case mo:return w=ph(w,y.mode,v),w.return=y,w;case ua:var S=w._init;return d(y,S(w._payload),v)}if(Ll(w)||Sl(w))return w=xi(w,y.mode,v,null),w.return=y,w;Vu(y,w)}return null}function h(y,w,v,S){var E=w!==null?w.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return E!==null?null:o(y,w,""+v,S);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Fu:return v.key===E?c(y,w,v,S):null;case mo:return v.key===E?u(y,w,v,S):null;case ua:return E=v._init,h(y,w,E(v._payload),S)}if(Ll(v)||Sl(v))return E!==null?null:f(y,w,v,S,null);Vu(y,v)}return null}function p(y,w,v,S,E){if(typeof S=="string"&&S!==""||typeof S=="number")return y=y.get(v)||null,o(w,y,""+S,E);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case Fu:return y=y.get(S.key===null?v:S.key)||null,c(w,y,S,E);case mo:return y=y.get(S.key===null?v:S.key)||null,u(w,y,S,E);case ua:var k=S._init;return p(y,w,v,k(S._payload),E)}if(Ll(S)||Sl(S))return y=y.get(v)||null,f(w,y,S,E,null);Vu(w,S)}return null}function g(y,w,v,S){for(var E=null,k=null,b=w,N=w=0,A=null;b!==null&&N<v.length;N++){b.index>N?(A=b,b=null):A=b.sibling;var O=h(y,b,v[N],S);if(O===null){b===null&&(b=A);break}e&&b&&O.alternate===null&&t(y,b),w=a(O,w,N),k===null?E=O:k.sibling=O,k=O,b=A}if(N===v.length)return r(y,b),gt&&ni(y,N),E;if(b===null){for(;N<v.length;N++)b=d(y,v[N],S),b!==null&&(w=a(b,w,N),k===null?E=b:k.sibling=b,k=b);return gt&&ni(y,N),E}for(b=n(y,b);N<v.length;N++)A=p(b,y,N,v[N],S),A!==null&&(e&&A.alternate!==null&&b.delete(A.key===null?N:A.key),w=a(A,w,N),k===null?E=A:k.sibling=A,k=A);return e&&b.forEach(function(V){return t(y,V)}),gt&&ni(y,N),E}function m(y,w,v,S){var E=Sl(v);if(typeof E!="function")throw Error(pe(150));if(v=E.call(v),v==null)throw Error(pe(151));for(var k=E=null,b=w,N=w=0,A=null,O=v.next();b!==null&&!O.done;N++,O=v.next()){b.index>N?(A=b,b=null):A=b.sibling;var V=h(y,b,O.value,S);if(V===null){b===null&&(b=A);break}e&&b&&V.alternate===null&&t(y,b),w=a(V,w,N),k===null?E=V:k.sibling=V,k=V,b=A}if(O.done)return r(y,b),gt&&ni(y,N),E;if(b===null){for(;!O.done;N++,O=v.next())O=d(y,O.value,S),O!==null&&(w=a(O,w,N),k===null?E=O:k.sibling=O,k=O);return gt&&ni(y,N),E}for(b=n(y,b);!O.done;N++,O=v.next())O=p(b,y,N,O.value,S),O!==null&&(e&&O.alternate!==null&&b.delete(O.key===null?N:O.key),w=a(O,w,N),k===null?E=O:k.sibling=O,k=O);return e&&b.forEach(function(C){return t(y,C)}),gt&&ni(y,N),E}function x(y,w,v,S){if(typeof v=="object"&&v!==null&&v.type===xo&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Fu:e:{for(var E=v.key,k=w;k!==null;){if(k.key===E){if(E=v.type,E===xo){if(k.tag===7){r(y,k.sibling),w=s(k,v.props.children),w.return=y,y=w;break e}}else if(k.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===ua&&Jv(E)===k.type){r(y,k.sibling),w=s(k,v.props),w.ref=Cl(y,k,v),w.return=y,y=w;break e}r(y,k);break}else t(y,k);k=k.sibling}v.type===xo?(w=xi(v.props.children,y.mode,S,v.key),w.return=y,y=w):(S=Rf(v.type,v.key,v.props,null,y.mode,S),S.ref=Cl(y,w,v),S.return=y,y=S)}return i(y);case mo:e:{for(k=v.key;w!==null;){if(w.key===k)if(w.tag===4&&w.stateNode.containerInfo===v.containerInfo&&w.stateNode.implementation===v.implementation){r(y,w.sibling),w=s(w,v.children||[]),w.return=y,y=w;break e}else{r(y,w);break}else t(y,w);w=w.sibling}w=ph(v,y.mode,S),w.return=y,y=w}return i(y);case ua:return k=v._init,x(y,w,k(v._payload),S)}if(Ll(v))return g(y,w,v,S);if(Sl(v))return m(y,w,v,S);Vu(y,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,w!==null&&w.tag===6?(r(y,w.sibling),w=s(w,v),w.return=y,y=w):(r(y,w),w=hh(v,y.mode,S),w.return=y,y=w),i(y)):r(y,w)}return x}var Go=h2(!0),p2=h2(!1),Zf=$a(null),ed=null,ko=null,xx=null;function gx(){xx=ko=ed=null}function vx(e){var t=Zf.current;pt(Zf),e._currentValue=t}function Rp(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Ro(e,t){ed=e,xx=ko=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(zr=!0),e.firstContext=null)}function jn(e){var t=e._currentValue;if(xx!==e)if(e={context:e,memoizedValue:t,next:null},ko===null){if(ed===null)throw Error(pe(308));ko=e,ed.dependencies={lanes:0,firstContext:e}}else ko=ko.next=e;return t}var fi=null;function wx(e){fi===null?fi=[e]:fi.push(e)}function m2(e,t,r,n){var s=t.interleaved;return s===null?(r.next=r,wx(t)):(r.next=s.next,s.next=r),t.interleaved=r,Hs(e,n)}function Hs(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var fa=!1;function yx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function x2(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ms(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Ea(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Je&2){var s=n.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),n.pending=t,Hs(e,r)}return s=n.interleaved,s===null?(t.next=t,wx(n)):(t.next=s.next,s.next=t),n.interleaved=t,Hs(e,r)}function Tf(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ax(e,r)}}function Qv(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var s=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?s=a=i:a=a.next=i,r=r.next}while(r!==null);a===null?s=a=t:a=a.next=t}else s=a=t;r={baseState:n.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function td(e,t,r,n){var s=e.updateQueue;fa=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var c=o,u=c.next;c.next=null,i===null?a=u:i.next=u,i=c;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=c))}if(a!==null){var d=s.baseState;i=0,f=u=c=null,o=a;do{var h=o.lane,p=o.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var g=e,m=o;switch(h=t,p=r,m.tag){case 1:if(g=m.payload,typeof g=="function"){d=g.call(p,d,h);break e}d=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=m.payload,h=typeof g=="function"?g.call(p,d,h):g,h==null)break e;d=Et({},d,h);break e;case 2:fa=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=s.effects,h===null?s.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=p,c=d):f=f.next=p,i|=h;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;h=o,o=h.next,h.next=null,s.lastBaseUpdate=h,s.shared.pending=null}}while(!0);if(f===null&&(c=d),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=f,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);ki|=i,e.lanes=i,e.memoizedState=d}}function Zv(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],s=n.callback;if(s!==null){if(n.callback=null,n=r,typeof s!="function")throw Error(pe(191,s));s.call(n)}}}var au={},ys=$a(au),kc=$a(au),Ec=$a(au);function di(e){if(e===au)throw Error(pe(174));return e}function _x(e,t){switch(ut(Ec,t),ut(kc,e),ut(ys,au),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:dp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=dp(t,e)}pt(ys),ut(ys,t)}function qo(){pt(ys),pt(kc),pt(Ec)}function g2(e){di(Ec.current);var t=di(ys.current),r=dp(t,e.type);t!==r&&(ut(kc,e),ut(ys,r))}function bx(e){kc.current===e&&(pt(ys),pt(kc))}var _t=$a(0);function rd(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var oh=[];function Sx(){for(var e=0;e<oh.length;e++)oh[e]._workInProgressVersionPrimary=null;oh.length=0}var Nf=Ys.ReactCurrentDispatcher,lh=Ys.ReactCurrentBatchConfig,Si=0,kt=null,qt=null,Zt=null,nd=!1,Jl=!1,Tc=0,WA=0;function mr(){throw Error(pe(321))}function kx(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!es(e[r],t[r]))return!1;return!0}function Ex(e,t,r,n,s,a){if(Si=a,kt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Nf.current=e===null||e.memoizedState===null?qA:KA,e=r(n,s),Jl){a=0;do{if(Jl=!1,Tc=0,25<=a)throw Error(pe(301));a+=1,Zt=qt=null,t.updateQueue=null,Nf.current=XA,e=r(n,s)}while(Jl)}if(Nf.current=sd,t=qt!==null&&qt.next!==null,Si=0,Zt=qt=kt=null,nd=!1,t)throw Error(pe(300));return e}function Tx(){var e=Tc!==0;return Tc=0,e}function fs(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Zt===null?kt.memoizedState=Zt=e:Zt=Zt.next=e,Zt}function Pn(){if(qt===null){var e=kt.alternate;e=e!==null?e.memoizedState:null}else e=qt.next;var t=Zt===null?kt.memoizedState:Zt.next;if(t!==null)Zt=t,qt=e;else{if(e===null)throw Error(pe(310));qt=e,e={memoizedState:qt.memoizedState,baseState:qt.baseState,baseQueue:qt.baseQueue,queue:qt.queue,next:null},Zt===null?kt.memoizedState=Zt=e:Zt=Zt.next=e}return Zt}function Nc(e,t){return typeof t=="function"?t(e):t}function ch(e){var t=Pn(),r=t.queue;if(r===null)throw Error(pe(311));r.lastRenderedReducer=e;var n=qt,s=n.baseQueue,a=r.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}n.baseQueue=s=a,r.pending=null}if(s!==null){a=s.next,n=n.baseState;var o=i=null,c=null,u=a;do{var f=u.lane;if((Si&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=d,i=n):c=c.next=d,kt.lanes|=f,ki|=f}u=u.next}while(u!==null&&u!==a);c===null?i=n:c.next=o,es(n,t.memoizedState)||(zr=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=c,r.lastRenderedState=n}if(e=r.interleaved,e!==null){s=e;do a=s.lane,kt.lanes|=a,ki|=a,s=s.next;while(s!==e)}else s===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function uh(e){var t=Pn(),r=t.queue;if(r===null)throw Error(pe(311));r.lastRenderedReducer=e;var n=r.dispatch,s=r.pending,a=t.memoizedState;if(s!==null){r.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);es(a,t.memoizedState)||(zr=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function v2(){}function w2(e,t){var r=kt,n=Pn(),s=t(),a=!es(n.memoizedState,s);if(a&&(n.memoizedState=s,zr=!0),n=n.queue,Nx(b2.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||Zt!==null&&Zt.memoizedState.tag&1){if(r.flags|=2048,Cc(9,_2.bind(null,r,n,s,t),void 0,null),rr===null)throw Error(pe(349));Si&30||y2(r,t,s)}return s}function y2(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=kt.updateQueue,t===null?(t={lastEffect:null,stores:null},kt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function _2(e,t,r,n){t.value=r,t.getSnapshot=n,S2(t)&&k2(e)}function b2(e,t,r){return r(function(){S2(t)&&k2(e)})}function S2(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!es(e,r)}catch{return!0}}function k2(e){var t=Hs(e,1);t!==null&&Yn(t,e,1,-1)}function e1(e){var t=fs();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nc,lastRenderedState:e},t.queue=e,e=e.dispatch=GA.bind(null,kt,e),[t.memoizedState,e]}function Cc(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=kt.updateQueue,t===null?(t={lastEffect:null,stores:null},kt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function E2(){return Pn().memoizedState}function Cf(e,t,r,n){var s=fs();kt.flags|=e,s.memoizedState=Cc(1|t,r,void 0,n===void 0?null:n)}function qd(e,t,r,n){var s=Pn();n=n===void 0?null:n;var a=void 0;if(qt!==null){var i=qt.memoizedState;if(a=i.destroy,n!==null&&kx(n,i.deps)){s.memoizedState=Cc(t,r,a,n);return}}kt.flags|=e,s.memoizedState=Cc(1|t,r,a,n)}function t1(e,t){return Cf(8390656,8,e,t)}function Nx(e,t){return qd(2048,8,e,t)}function T2(e,t){return qd(4,2,e,t)}function N2(e,t){return qd(4,4,e,t)}function C2(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function A2(e,t,r){return r=r!=null?r.concat([e]):null,qd(4,4,C2.bind(null,t,e),r)}function Cx(){}function j2(e,t){var r=Pn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kx(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function P2(e,t){var r=Pn();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&kx(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function R2(e,t,r){return Si&21?(es(r,t)||(r=L_(),kt.lanes|=r,ki|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,zr=!0),e.memoizedState=r)}function VA(e,t){var r=at;at=r!==0&&4>r?r:4,e(!0);var n=lh.transition;lh.transition={};try{e(!1),t()}finally{at=r,lh.transition=n}}function F2(){return Pn().memoizedState}function HA(e,t,r){var n=Na(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},O2(e))I2(t,r);else if(r=m2(e,t,r,n),r!==null){var s=Rr();Yn(r,e,n,s),D2(r,t,n)}}function GA(e,t,r){var n=Na(e),s={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(O2(e))I2(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,r);if(s.hasEagerState=!0,s.eagerState=o,es(o,i)){var c=t.interleaved;c===null?(s.next=s,wx(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}r=m2(e,t,s,n),r!==null&&(s=Rr(),Yn(r,e,n,s),D2(r,t,n))}}function O2(e){var t=e.alternate;return e===kt||t!==null&&t===kt}function I2(e,t){Jl=nd=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function D2(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,ax(e,r)}}var sd={readContext:jn,useCallback:mr,useContext:mr,useEffect:mr,useImperativeHandle:mr,useInsertionEffect:mr,useLayoutEffect:mr,useMemo:mr,useReducer:mr,useRef:mr,useState:mr,useDebugValue:mr,useDeferredValue:mr,useTransition:mr,useMutableSource:mr,useSyncExternalStore:mr,useId:mr,unstable_isNewReconciler:!1},qA={readContext:jn,useCallback:function(e,t){return fs().memoizedState=[e,t===void 0?null:t],e},useContext:jn,useEffect:t1,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Cf(4194308,4,C2.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Cf(4194308,4,e,t)},useInsertionEffect:function(e,t){return Cf(4,2,e,t)},useMemo:function(e,t){var r=fs();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=fs();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=HA.bind(null,kt,e),[n.memoizedState,e]},useRef:function(e){var t=fs();return e={current:e},t.memoizedState=e},useState:e1,useDebugValue:Cx,useDeferredValue:function(e){return fs().memoizedState=e},useTransition:function(){var e=e1(!1),t=e[0];return e=VA.bind(null,e[1]),fs().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=kt,s=fs();if(gt){if(r===void 0)throw Error(pe(407));r=r()}else{if(r=t(),rr===null)throw Error(pe(349));Si&30||y2(n,t,r)}s.memoizedState=r;var a={value:r,getSnapshot:t};return s.queue=a,t1(b2.bind(null,n,a,e),[e]),n.flags|=2048,Cc(9,_2.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=fs(),t=rr.identifierPrefix;if(gt){var r=Ds,n=Is;r=(n&~(1<<32-Xn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=Tc++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=WA++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},KA={readContext:jn,useCallback:j2,useContext:jn,useEffect:Nx,useImperativeHandle:A2,useInsertionEffect:T2,useLayoutEffect:N2,useMemo:P2,useReducer:ch,useRef:E2,useState:function(){return ch(Nc)},useDebugValue:Cx,useDeferredValue:function(e){var t=Pn();return R2(t,qt.memoizedState,e)},useTransition:function(){var e=ch(Nc)[0],t=Pn().memoizedState;return[e,t]},useMutableSource:v2,useSyncExternalStore:w2,useId:F2,unstable_isNewReconciler:!1},XA={readContext:jn,useCallback:j2,useContext:jn,useEffect:Nx,useImperativeHandle:A2,useInsertionEffect:T2,useLayoutEffect:N2,useMemo:P2,useReducer:uh,useRef:E2,useState:function(){return uh(Nc)},useDebugValue:Cx,useDeferredValue:function(e){var t=Pn();return qt===null?t.memoizedState=e:R2(t,qt.memoizedState,e)},useTransition:function(){var e=uh(Nc)[0],t=Pn().memoizedState;return[e,t]},useMutableSource:v2,useSyncExternalStore:w2,useId:F2,unstable_isNewReconciler:!1};function $n(e,t){if(e&&e.defaultProps){t=Et({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function Fp(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Et({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Kd={isMounted:function(e){return(e=e._reactInternals)?Bi(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=Rr(),s=Na(e),a=Ms(n,s);a.payload=t,r!=null&&(a.callback=r),t=Ea(e,a,s),t!==null&&(Yn(t,e,s,n),Tf(t,e,s))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=Rr(),s=Na(e),a=Ms(n,s);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Ea(e,a,s),t!==null&&(Yn(t,e,s,n),Tf(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=Rr(),n=Na(e),s=Ms(r,n);s.tag=2,t!=null&&(s.callback=t),t=Ea(e,s,n),t!==null&&(Yn(t,e,n,r),Tf(t,e,n))}};function r1(e,t,r,n,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,i):t.prototype&&t.prototype.isPureReactComponent?!yc(r,n)||!yc(s,a):!0}function L2(e,t,r){var n=!1,s=Ra,a=t.contextType;return typeof a=="object"&&a!==null?a=jn(a):(s=Vr(t)?_i:kr.current,n=t.contextTypes,a=(n=n!=null)?Vo(e,s):Ra),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Kd,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function n1(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Kd.enqueueReplaceState(t,t.state,null)}function Op(e,t,r,n){var s=e.stateNode;s.props=r,s.state=e.memoizedState,s.refs={},yx(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=jn(a):(a=Vr(t)?_i:kr.current,s.context=Vo(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(Fp(e,t,a,r),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Kd.enqueueReplaceState(s,s.state,null),td(e,r,s,n),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Ko(e,t){try{var r="",n=t;do r+=S4(n),n=n.return;while(n);var s=r}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function fh(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function Ip(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var YA=typeof WeakMap=="function"?WeakMap:Map;function M2(e,t,r){r=Ms(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){id||(id=!0,Hp=n),Ip(e,t)},r}function B2(e,t,r){r=Ms(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var s=t.value;r.payload=function(){return n(s)},r.callback=function(){Ip(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){Ip(e,t),typeof n!="function"&&(Ta===null?Ta=new Set([this]):Ta.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function s1(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new YA;var s=new Set;n.set(t,s)}else s=n.get(t),s===void 0&&(s=new Set,n.set(t,s));s.has(r)||(s.add(r),e=uj.bind(null,e,t,r),t.then(e,e))}function a1(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function i1(e,t,r,n,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Ms(-1,1),t.tag=2,Ea(r,t,1))),r.lanes|=1),e)}var JA=Ys.ReactCurrentOwner,zr=!1;function Ar(e,t,r,n){t.child=e===null?p2(t,null,r,n):Go(t,e.child,r,n)}function o1(e,t,r,n,s){r=r.render;var a=t.ref;return Ro(t,s),n=Ex(e,t,r,n,a,s),r=Tx(),e!==null&&!zr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Gs(e,t,s)):(gt&&r&&hx(t),t.flags|=1,Ar(e,t,n,s),t.child)}function l1(e,t,r,n,s){if(e===null){var a=r.type;return typeof a=="function"&&!Dx(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,U2(e,t,a,n,s)):(e=Rf(r.type,null,n,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(r=r.compare,r=r!==null?r:yc,r(i,n)&&e.ref===t.ref)return Gs(e,t,s)}return t.flags|=1,e=Ca(a,n),e.ref=t.ref,e.return=t,t.child=e}function U2(e,t,r,n,s){if(e!==null){var a=e.memoizedProps;if(yc(a,n)&&e.ref===t.ref)if(zr=!1,t.pendingProps=n=a,(e.lanes&s)!==0)e.flags&131072&&(zr=!0);else return t.lanes=e.lanes,Gs(e,t,s)}return Dp(e,t,r,n,s)}function $2(e,t,r){var n=t.pendingProps,s=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ut(To,Qr),Qr|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ut(To,Qr),Qr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,ut(To,Qr),Qr|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,ut(To,Qr),Qr|=n;return Ar(e,t,s,r),t.child}function z2(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Dp(e,t,r,n,s){var a=Vr(r)?_i:kr.current;return a=Vo(t,a),Ro(t,s),r=Ex(e,t,r,n,a,s),n=Tx(),e!==null&&!zr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Gs(e,t,s)):(gt&&n&&hx(t),t.flags|=1,Ar(e,t,r,s),t.child)}function c1(e,t,r,n,s){if(Vr(r)){var a=!0;Yf(t)}else a=!1;if(Ro(t,s),t.stateNode===null)Af(e,t),L2(t,r,n),Op(t,r,n,s),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var c=i.context,u=r.contextType;typeof u=="object"&&u!==null?u=jn(u):(u=Vr(r)?_i:kr.current,u=Vo(t,u));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||c!==u)&&n1(t,i,n,u),fa=!1;var h=t.memoizedState;i.state=h,td(t,n,i,s),c=t.memoizedState,o!==n||h!==c||Wr.current||fa?(typeof f=="function"&&(Fp(t,r,f,n),c=t.memoizedState),(o=fa||r1(t,r,o,n,h,c,u))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=c),i.props=n,i.state=c,i.context=u,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,x2(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:$n(t.type,o),i.props=u,d=t.pendingProps,h=i.context,c=r.contextType,typeof c=="object"&&c!==null?c=jn(c):(c=Vr(r)?_i:kr.current,c=Vo(t,c));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||h!==c)&&n1(t,i,n,c),fa=!1,h=t.memoizedState,i.state=h,td(t,n,i,s);var g=t.memoizedState;o!==d||h!==g||Wr.current||fa?(typeof p=="function"&&(Fp(t,r,p,n),g=t.memoizedState),(u=fa||r1(t,r,u,n,h,g,c)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,g,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,g,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=g),i.props=n,i.state=g,i.context=c,n=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Lp(e,t,r,n,a,s)}function Lp(e,t,r,n,s,a){z2(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return s&&Kv(t,r,!1),Gs(e,t,a);n=t.stateNode,JA.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=Go(t,e.child,null,a),t.child=Go(t,null,o,a)):Ar(e,t,o,a),t.memoizedState=n.state,s&&Kv(t,r,!0),t.child}function W2(e){var t=e.stateNode;t.pendingContext?qv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&qv(e,t.context,!1),_x(e,t.containerInfo)}function u1(e,t,r,n,s){return Ho(),mx(s),t.flags|=256,Ar(e,t,r,n),t.child}var Mp={dehydrated:null,treeContext:null,retryLane:0};function Bp(e){return{baseLanes:e,cachePool:null,transitions:null}}function V2(e,t,r){var n=t.pendingProps,s=_t.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(s&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ut(_t,s&1),e===null)return Pp(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,a?(n=t.mode,a=t.child,i={mode:"hidden",children:i},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Jd(i,n,0,null),e=xi(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Bp(r),t.memoizedState=Mp,e):Ax(t,i));if(s=e.memoizedState,s!==null&&(o=s.dehydrated,o!==null))return QA(e,t,i,n,o,s,r);if(a){a=n.fallback,i=t.mode,s=e.child,o=s.sibling;var c={mode:"hidden",children:n.children};return!(i&1)&&t.child!==s?(n=t.child,n.childLanes=0,n.pendingProps=c,t.deletions=null):(n=Ca(s,c),n.subtreeFlags=s.subtreeFlags&14680064),o!==null?a=Ca(o,a):(a=xi(a,i,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,i=e.child.memoizedState,i=i===null?Bp(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~r,t.memoizedState=Mp,n}return a=e.child,e=a.sibling,n=Ca(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Ax(e,t){return t=Jd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Hu(e,t,r,n){return n!==null&&mx(n),Go(t,e.child,null,r),e=Ax(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function QA(e,t,r,n,s,a,i){if(r)return t.flags&256?(t.flags&=-257,n=fh(Error(pe(422))),Hu(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,s=t.mode,n=Jd({mode:"visible",children:n.children},s,0,null),a=xi(a,s,i,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&Go(t,e.child,null,i),t.child.memoizedState=Bp(i),t.memoizedState=Mp,a);if(!(t.mode&1))return Hu(e,t,i,null);if(s.data==="$!"){if(n=s.nextSibling&&s.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(pe(419)),n=fh(a,n,void 0),Hu(e,t,i,n)}if(o=(i&e.childLanes)!==0,zr||o){if(n=rr,n!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(n.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,Hs(e,s),Yn(n,e,s,-1))}return Ix(),n=fh(Error(pe(421))),Hu(e,t,i,n)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=fj.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,on=ka(s.nextSibling),cn=t,gt=!0,Vn=null,e!==null&&(Sn[kn++]=Is,Sn[kn++]=Ds,Sn[kn++]=bi,Is=e.id,Ds=e.overflow,bi=t),t=Ax(t,n.children),t.flags|=4096,t)}function f1(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),Rp(e.return,t,r)}function dh(e,t,r,n,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=s)}function H2(e,t,r){var n=t.pendingProps,s=n.revealOrder,a=n.tail;if(Ar(e,t,n.children,r),n=_t.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&f1(e,r,t);else if(e.tag===19)f1(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ut(_t,n),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(r=t.child,s=null;r!==null;)e=r.alternate,e!==null&&rd(e)===null&&(s=r),r=r.sibling;r=s,r===null?(s=t.child,t.child=null):(s=r.sibling,r.sibling=null),dh(t,!1,s,r,a);break;case"backwards":for(r=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&rd(e)===null){t.child=s;break}e=s.sibling,s.sibling=r,r=s,s=e}dh(t,!0,r,null,a);break;case"together":dh(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Af(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),ki|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(pe(153));if(t.child!==null){for(e=t.child,r=Ca(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Ca(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function ZA(e,t,r){switch(t.tag){case 3:W2(t),Ho();break;case 5:g2(t);break;case 1:Vr(t.type)&&Yf(t);break;case 4:_x(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,s=t.memoizedProps.value;ut(Zf,n._currentValue),n._currentValue=s;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(ut(_t,_t.current&1),t.flags|=128,null):r&t.child.childLanes?V2(e,t,r):(ut(_t,_t.current&1),e=Gs(e,t,r),e!==null?e.sibling:null);ut(_t,_t.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return H2(e,t,r);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ut(_t,_t.current),n)break;return null;case 22:case 23:return t.lanes=0,$2(e,t,r)}return Gs(e,t,r)}var G2,Up,q2,K2;G2=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};Up=function(){};q2=function(e,t,r,n){var s=e.memoizedProps;if(s!==n){e=t.stateNode,di(ys.current);var a=null;switch(r){case"input":s=lp(e,s),n=lp(e,n),a=[];break;case"select":s=Et({},s,{value:void 0}),n=Et({},n,{value:void 0}),a=[];break;case"textarea":s=fp(e,s),n=fp(e,n),a=[];break;default:typeof s.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=Kf)}hp(r,n);var i;r=null;for(u in s)if(!n.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var o=s[u];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(hc.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var c=n[u];if(o=s!=null?s[u]:void 0,n.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(r||(r={}),r[i]=c[i])}else r||(a||(a=[]),a.push(u,r)),r=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(hc.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&dt("scroll",e),a||o===c||(a=[])):(a=a||[]).push(u,c))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};K2=function(e,t,r,n){r!==n&&(t.flags|=4)};function Al(e,t){if(!gt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function xr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags&14680064,n|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)r|=s.lanes|s.childLanes,n|=s.subtreeFlags,n|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function ej(e,t,r){var n=t.pendingProps;switch(px(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return xr(t),null;case 1:return Vr(t.type)&&Xf(),xr(t),null;case 3:return n=t.stateNode,qo(),pt(Wr),pt(kr),Sx(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Wu(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Vn!==null&&(Kp(Vn),Vn=null))),Up(e,t),xr(t),null;case 5:bx(t);var s=di(Ec.current);if(r=t.type,e!==null&&t.stateNode!=null)q2(e,t,r,n,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(pe(166));return xr(t),null}if(e=di(ys.current),Wu(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[hs]=t,n[Sc]=a,e=(t.mode&1)!==0,r){case"dialog":dt("cancel",n),dt("close",n);break;case"iframe":case"object":case"embed":dt("load",n);break;case"video":case"audio":for(s=0;s<Bl.length;s++)dt(Bl[s],n);break;case"source":dt("error",n);break;case"img":case"image":case"link":dt("error",n),dt("load",n);break;case"details":dt("toggle",n);break;case"input":yv(n,a),dt("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},dt("invalid",n);break;case"textarea":bv(n,a),dt("invalid",n)}hp(r,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&zu(n.textContent,o,e),s=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&zu(n.textContent,o,e),s=["children",""+o]):hc.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&dt("scroll",n)}switch(r){case"input":Ou(n),_v(n,a,!0);break;case"textarea":Ou(n),Sv(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=Kf)}n=s,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=b_(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[hs]=t,e[Sc]=n,G2(e,t,!1,!1),t.stateNode=e;e:{switch(i=pp(r,n),r){case"dialog":dt("cancel",e),dt("close",e),s=n;break;case"iframe":case"object":case"embed":dt("load",e),s=n;break;case"video":case"audio":for(s=0;s<Bl.length;s++)dt(Bl[s],e);s=n;break;case"source":dt("error",e),s=n;break;case"img":case"image":case"link":dt("error",e),dt("load",e),s=n;break;case"details":dt("toggle",e),s=n;break;case"input":yv(e,n),s=lp(e,n),dt("invalid",e);break;case"option":s=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},s=Et({},n,{value:void 0}),dt("invalid",e);break;case"textarea":bv(e,n),s=fp(e,n),dt("invalid",e);break;default:s=n}hp(r,s),o=s;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?E_(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&S_(e,c)):a==="children"?typeof c=="string"?(r!=="textarea"||c!=="")&&pc(e,c):typeof c=="number"&&pc(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(hc.hasOwnProperty(a)?c!=null&&a==="onScroll"&&dt("scroll",e):c!=null&&Zm(e,a,c,i))}switch(r){case"input":Ou(e),_v(e,n,!1);break;case"textarea":Ou(e),Sv(e);break;case"option":n.value!=null&&e.setAttribute("value",""+Pa(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?Co(e,!!n.multiple,a,!1):n.defaultValue!=null&&Co(e,!!n.multiple,n.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=Kf)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return xr(t),null;case 6:if(e&&t.stateNode!=null)K2(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(pe(166));if(r=di(Ec.current),di(ys.current),Wu(t)){if(n=t.stateNode,r=t.memoizedProps,n[hs]=t,(a=n.nodeValue!==r)&&(e=cn,e!==null))switch(e.tag){case 3:zu(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&zu(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[hs]=t,t.stateNode=n}return xr(t),null;case 13:if(pt(_t),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(gt&&on!==null&&t.mode&1&&!(t.flags&128))d2(),Ho(),t.flags|=98560,a=!1;else if(a=Wu(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(pe(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(pe(317));a[hs]=t}else Ho(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;xr(t),a=!1}else Vn!==null&&(Kp(Vn),Vn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||_t.current&1?Xt===0&&(Xt=3):Ix())),t.updateQueue!==null&&(t.flags|=4),xr(t),null);case 4:return qo(),Up(e,t),e===null&&_c(t.stateNode.containerInfo),xr(t),null;case 10:return vx(t.type._context),xr(t),null;case 17:return Vr(t.type)&&Xf(),xr(t),null;case 19:if(pt(_t),a=t.memoizedState,a===null)return xr(t),null;if(n=(t.flags&128)!==0,i=a.rendering,i===null)if(n)Al(a,!1);else{if(Xt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=rd(e),i!==null){for(t.flags|=128,Al(a,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return ut(_t,_t.current&1|2),t.child}e=e.sibling}a.tail!==null&&It()>Xo&&(t.flags|=128,n=!0,Al(a,!1),t.lanes=4194304)}else{if(!n)if(e=rd(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),Al(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!gt)return xr(t),null}else 2*It()-a.renderingStartTime>Xo&&r!==1073741824&&(t.flags|=128,n=!0,Al(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(r=a.last,r!==null?r.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=It(),t.sibling=null,r=_t.current,ut(_t,n?r&1|2:r&1),t):(xr(t),null);case 22:case 23:return Ox(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Qr&1073741824&&(xr(t),t.subtreeFlags&6&&(t.flags|=8192)):xr(t),null;case 24:return null;case 25:return null}throw Error(pe(156,t.tag))}function tj(e,t){switch(px(t),t.tag){case 1:return Vr(t.type)&&Xf(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return qo(),pt(Wr),pt(kr),Sx(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return bx(t),null;case 13:if(pt(_t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(pe(340));Ho()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return pt(_t),null;case 4:return qo(),null;case 10:return vx(t.type._context),null;case 22:case 23:return Ox(),null;case 24:return null;default:return null}}var Gu=!1,yr=!1,rj=typeof WeakSet=="function"?WeakSet:Set,Se=null;function Eo(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){Nt(e,t,n)}else r.current=null}function $p(e,t,r){try{r()}catch(n){Nt(e,t,n)}}var d1=!1;function nj(e,t){if(kp=Hf,e=Z_(),dx(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var s=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var i=0,o=-1,c=-1,u=0,f=0,d=e,h=null;t:for(;;){for(var p;d!==r||s!==0&&d.nodeType!==3||(o=i+s),d!==a||n!==0&&d.nodeType!==3||(c=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===e)break t;if(h===r&&++u===s&&(o=i),h===a&&++f===n&&(c=i),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}r=o===-1||c===-1?null:{start:o,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(Ep={focusedElem:e,selectionRange:r},Hf=!1,Se=t;Se!==null;)if(t=Se,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Se=e;else for(;Se!==null;){t=Se;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var m=g.memoizedProps,x=g.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:$n(t.type,m),x);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(pe(163))}}catch(S){Nt(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,Se=e;break}Se=t.return}return g=d1,d1=!1,g}function Ql(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var s=n=n.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&$p(t,r,a)}s=s.next}while(s!==n)}}function Xd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function zp(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function X2(e){var t=e.alternate;t!==null&&(e.alternate=null,X2(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[hs],delete t[Sc],delete t[Cp],delete t[BA],delete t[UA])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Y2(e){return e.tag===5||e.tag===3||e.tag===4}function h1(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Y2(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Wp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=Kf));else if(n!==4&&(e=e.child,e!==null))for(Wp(e,t,r),e=e.sibling;e!==null;)Wp(e,t,r),e=e.sibling}function Vp(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Vp(e,t,r),e=e.sibling;e!==null;)Vp(e,t,r),e=e.sibling}var ir=null,zn=!1;function ra(e,t,r){for(r=r.child;r!==null;)J2(e,t,r),r=r.sibling}function J2(e,t,r){if(ws&&typeof ws.onCommitFiberUnmount=="function")try{ws.onCommitFiberUnmount($d,r)}catch{}switch(r.tag){case 5:yr||Eo(r,t);case 6:var n=ir,s=zn;ir=null,ra(e,t,r),ir=n,zn=s,ir!==null&&(zn?(e=ir,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):ir.removeChild(r.stateNode));break;case 18:ir!==null&&(zn?(e=ir,r=r.stateNode,e.nodeType===8?ah(e.parentNode,r):e.nodeType===1&&ah(e,r),vc(e)):ah(ir,r.stateNode));break;case 4:n=ir,s=zn,ir=r.stateNode.containerInfo,zn=!0,ra(e,t,r),ir=n,zn=s;break;case 0:case 11:case 14:case 15:if(!yr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){s=n=n.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&$p(r,t,i),s=s.next}while(s!==n)}ra(e,t,r);break;case 1:if(!yr&&(Eo(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Nt(r,t,o)}ra(e,t,r);break;case 21:ra(e,t,r);break;case 22:r.mode&1?(yr=(n=yr)||r.memoizedState!==null,ra(e,t,r),yr=n):ra(e,t,r);break;default:ra(e,t,r)}}function p1(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new rj),t.forEach(function(n){var s=dj.bind(null,e,n);r.has(n)||(r.add(n),n.then(s,s))})}}function Ln(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var s=r[n];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:ir=o.stateNode,zn=!1;break e;case 3:ir=o.stateNode.containerInfo,zn=!0;break e;case 4:ir=o.stateNode.containerInfo,zn=!0;break e}o=o.return}if(ir===null)throw Error(pe(160));J2(a,i,s),ir=null,zn=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Nt(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Q2(t,e),t=t.sibling}function Q2(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ln(t,e),os(e),n&4){try{Ql(3,e,e.return),Xd(3,e)}catch(m){Nt(e,e.return,m)}try{Ql(5,e,e.return)}catch(m){Nt(e,e.return,m)}}break;case 1:Ln(t,e),os(e),n&512&&r!==null&&Eo(r,r.return);break;case 5:if(Ln(t,e),os(e),n&512&&r!==null&&Eo(r,r.return),e.flags&32){var s=e.stateNode;try{pc(s,"")}catch(m){Nt(e,e.return,m)}}if(n&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=r!==null?r.memoizedProps:a,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&y_(s,a),pp(o,i);var u=pp(o,a);for(i=0;i<c.length;i+=2){var f=c[i],d=c[i+1];f==="style"?E_(s,d):f==="dangerouslySetInnerHTML"?S_(s,d):f==="children"?pc(s,d):Zm(s,f,d,u)}switch(o){case"input":cp(s,a);break;case"textarea":__(s,a);break;case"select":var h=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var p=a.value;p!=null?Co(s,!!a.multiple,p,!1):h!==!!a.multiple&&(a.defaultValue!=null?Co(s,!!a.multiple,a.defaultValue,!0):Co(s,!!a.multiple,a.multiple?[]:"",!1))}s[Sc]=a}catch(m){Nt(e,e.return,m)}}break;case 6:if(Ln(t,e),os(e),n&4){if(e.stateNode===null)throw Error(pe(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(m){Nt(e,e.return,m)}}break;case 3:if(Ln(t,e),os(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{vc(t.containerInfo)}catch(m){Nt(e,e.return,m)}break;case 4:Ln(t,e),os(e);break;case 13:Ln(t,e),os(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Rx=It())),n&4&&p1(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(yr=(u=yr)||f,Ln(t,e),yr=u):Ln(t,e),os(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(Se=e,f=e.child;f!==null;){for(d=Se=f;Se!==null;){switch(h=Se,p=h.child,h.tag){case 0:case 11:case 14:case 15:Ql(4,h,h.return);break;case 1:Eo(h,h.return);var g=h.stateNode;if(typeof g.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(m){Nt(n,r,m)}}break;case 5:Eo(h,h.return);break;case 22:if(h.memoizedState!==null){x1(d);continue}}p!==null?(p.return=h,Se=p):x1(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{s=d.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=d.stateNode,c=d.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=k_("display",i))}catch(m){Nt(e,e.return,m)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){Nt(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Ln(t,e),os(e),n&4&&p1(e);break;case 21:break;default:Ln(t,e),os(e)}}function os(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Y2(r)){var n=r;break e}r=r.return}throw Error(pe(160))}switch(n.tag){case 5:var s=n.stateNode;n.flags&32&&(pc(s,""),n.flags&=-33);var a=h1(e);Vp(e,a,s);break;case 3:case 4:var i=n.stateNode.containerInfo,o=h1(e);Wp(e,o,i);break;default:throw Error(pe(161))}}catch(c){Nt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function sj(e,t,r){Se=e,Z2(e)}function Z2(e,t,r){for(var n=(e.mode&1)!==0;Se!==null;){var s=Se,a=s.child;if(s.tag===22&&n){var i=s.memoizedState!==null||Gu;if(!i){var o=s.alternate,c=o!==null&&o.memoizedState!==null||yr;o=Gu;var u=yr;if(Gu=i,(yr=c)&&!u)for(Se=s;Se!==null;)i=Se,c=i.child,i.tag===22&&i.memoizedState!==null?g1(s):c!==null?(c.return=i,Se=c):g1(s);for(;a!==null;)Se=a,Z2(a),a=a.sibling;Se=s,Gu=o,yr=u}m1(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,Se=a):m1(e)}}function m1(e){for(;Se!==null;){var t=Se;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:yr||Xd(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!yr)if(r===null)n.componentDidMount();else{var s=t.elementType===t.type?r.memoizedProps:$n(t.type,r.memoizedProps);n.componentDidUpdate(s,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Zv(t,a,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Zv(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&vc(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(pe(163))}yr||t.flags&512&&zp(t)}catch(h){Nt(t,t.return,h)}}if(t===e){Se=null;break}if(r=t.sibling,r!==null){r.return=t.return,Se=r;break}Se=t.return}}function x1(e){for(;Se!==null;){var t=Se;if(t===e){Se=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Se=r;break}Se=t.return}}function g1(e){for(;Se!==null;){var t=Se;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{Xd(4,t)}catch(c){Nt(t,r,c)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var s=t.return;try{n.componentDidMount()}catch(c){Nt(t,s,c)}}var a=t.return;try{zp(t)}catch(c){Nt(t,a,c)}break;case 5:var i=t.return;try{zp(t)}catch(c){Nt(t,i,c)}}}catch(c){Nt(t,t.return,c)}if(t===e){Se=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Se=o;break}Se=t.return}}var aj=Math.ceil,ad=Ys.ReactCurrentDispatcher,jx=Ys.ReactCurrentOwner,Tn=Ys.ReactCurrentBatchConfig,Je=0,rr=null,Vt=null,ur=0,Qr=0,To=$a(0),Xt=0,Ac=null,ki=0,Yd=0,Px=0,Zl=null,Ur=null,Rx=0,Xo=1/0,Rs=null,id=!1,Hp=null,Ta=null,qu=!1,ga=null,od=0,ec=0,Gp=null,jf=-1,Pf=0;function Rr(){return Je&6?It():jf!==-1?jf:jf=It()}function Na(e){return e.mode&1?Je&2&&ur!==0?ur&-ur:zA.transition!==null?(Pf===0&&(Pf=L_()),Pf):(e=at,e!==0||(e=window.event,e=e===void 0?16:V_(e.type)),e):1}function Yn(e,t,r,n){if(50<ec)throw ec=0,Gp=null,Error(pe(185));ru(e,r,n),(!(Je&2)||e!==rr)&&(e===rr&&(!(Je&2)&&(Yd|=r),Xt===4&&ha(e,ur)),Hr(e,n),r===1&&Je===0&&!(t.mode&1)&&(Xo=It()+500,Gd&&za()))}function Hr(e,t){var r=e.callbackNode;z4(e,t);var n=Vf(e,e===rr?ur:0);if(n===0)r!==null&&Tv(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Tv(r),t===1)e.tag===0?$A(v1.bind(null,e)):c2(v1.bind(null,e)),LA(function(){!(Je&6)&&za()}),r=null;else{switch(M_(n)){case 1:r=sx;break;case 4:r=I_;break;case 16:r=Wf;break;case 536870912:r=D_;break;default:r=Wf}r=ob(r,eb.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function eb(e,t){if(jf=-1,Pf=0,Je&6)throw Error(pe(327));var r=e.callbackNode;if(Fo()&&e.callbackNode!==r)return null;var n=Vf(e,e===rr?ur:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=ld(e,n);else{t=n;var s=Je;Je|=2;var a=rb();(rr!==e||ur!==t)&&(Rs=null,Xo=It()+500,mi(e,t));do try{lj();break}catch(o){tb(e,o)}while(!0);gx(),ad.current=a,Je=s,Vt!==null?t=0:(rr=null,ur=0,t=Xt)}if(t!==0){if(t===2&&(s=wp(e),s!==0&&(n=s,t=qp(e,s))),t===1)throw r=Ac,mi(e,0),ha(e,n),Hr(e,It()),r;if(t===6)ha(e,n);else{if(s=e.current.alternate,!(n&30)&&!ij(s)&&(t=ld(e,n),t===2&&(a=wp(e),a!==0&&(n=a,t=qp(e,a))),t===1))throw r=Ac,mi(e,0),ha(e,n),Hr(e,It()),r;switch(e.finishedWork=s,e.finishedLanes=n,t){case 0:case 1:throw Error(pe(345));case 2:si(e,Ur,Rs);break;case 3:if(ha(e,n),(n&130023424)===n&&(t=Rx+500-It(),10<t)){if(Vf(e,0)!==0)break;if(s=e.suspendedLanes,(s&n)!==n){Rr(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=Np(si.bind(null,e,Ur,Rs),t);break}si(e,Ur,Rs);break;case 4:if(ha(e,n),(n&4194240)===n)break;for(t=e.eventTimes,s=-1;0<n;){var i=31-Xn(n);a=1<<i,i=t[i],i>s&&(s=i),n&=~a}if(n=s,n=It()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*aj(n/1960))-n,10<n){e.timeoutHandle=Np(si.bind(null,e,Ur,Rs),n);break}si(e,Ur,Rs);break;case 5:si(e,Ur,Rs);break;default:throw Error(pe(329))}}}return Hr(e,It()),e.callbackNode===r?eb.bind(null,e):null}function qp(e,t){var r=Zl;return e.current.memoizedState.isDehydrated&&(mi(e,t).flags|=256),e=ld(e,t),e!==2&&(t=Ur,Ur=r,t!==null&&Kp(t)),e}function Kp(e){Ur===null?Ur=e:Ur.push.apply(Ur,e)}function ij(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var s=r[n],a=s.getSnapshot;s=s.value;try{if(!es(a(),s))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ha(e,t){for(t&=~Px,t&=~Yd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Xn(t),n=1<<r;e[r]=-1,t&=~n}}function v1(e){if(Je&6)throw Error(pe(327));Fo();var t=Vf(e,0);if(!(t&1))return Hr(e,It()),null;var r=ld(e,t);if(e.tag!==0&&r===2){var n=wp(e);n!==0&&(t=n,r=qp(e,n))}if(r===1)throw r=Ac,mi(e,0),ha(e,t),Hr(e,It()),r;if(r===6)throw Error(pe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,si(e,Ur,Rs),Hr(e,It()),null}function Fx(e,t){var r=Je;Je|=1;try{return e(t)}finally{Je=r,Je===0&&(Xo=It()+500,Gd&&za())}}function Ei(e){ga!==null&&ga.tag===0&&!(Je&6)&&Fo();var t=Je;Je|=1;var r=Tn.transition,n=at;try{if(Tn.transition=null,at=1,e)return e()}finally{at=n,Tn.transition=r,Je=t,!(Je&6)&&za()}}function Ox(){Qr=To.current,pt(To)}function mi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,DA(r)),Vt!==null)for(r=Vt.return;r!==null;){var n=r;switch(px(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&Xf();break;case 3:qo(),pt(Wr),pt(kr),Sx();break;case 5:bx(n);break;case 4:qo();break;case 13:pt(_t);break;case 19:pt(_t);break;case 10:vx(n.type._context);break;case 22:case 23:Ox()}r=r.return}if(rr=e,Vt=e=Ca(e.current,null),ur=Qr=t,Xt=0,Ac=null,Px=Yd=ki=0,Ur=Zl=null,fi!==null){for(t=0;t<fi.length;t++)if(r=fi[t],n=r.interleaved,n!==null){r.interleaved=null;var s=n.next,a=r.pending;if(a!==null){var i=a.next;a.next=s,n.next=i}r.pending=n}fi=null}return e}function tb(e,t){do{var r=Vt;try{if(gx(),Nf.current=sd,nd){for(var n=kt.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}nd=!1}if(Si=0,Zt=qt=kt=null,Jl=!1,Tc=0,jx.current=null,r===null||r.return===null){Xt=1,Ac=t,Vt=null;break}e:{var a=e,i=r.return,o=r,c=t;if(t=ur,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=a1(i);if(p!==null){p.flags&=-257,i1(p,i,o,a,t),p.mode&1&&s1(a,u,t),t=p,c=u;var g=t.updateQueue;if(g===null){var m=new Set;m.add(c),t.updateQueue=m}else g.add(c);break e}else{if(!(t&1)){s1(a,u,t),Ix();break e}c=Error(pe(426))}}else if(gt&&o.mode&1){var x=a1(i);if(x!==null){!(x.flags&65536)&&(x.flags|=256),i1(x,i,o,a,t),mx(Ko(c,o));break e}}a=c=Ko(c,o),Xt!==4&&(Xt=2),Zl===null?Zl=[a]:Zl.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var y=M2(a,c,t);Qv(a,y);break e;case 1:o=c;var w=a.type,v=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Ta===null||!Ta.has(v)))){a.flags|=65536,t&=-t,a.lanes|=t;var S=B2(a,o,t);Qv(a,S);break e}}a=a.return}while(a!==null)}sb(r)}catch(E){t=E,Vt===r&&r!==null&&(Vt=r=r.return);continue}break}while(!0)}function rb(){var e=ad.current;return ad.current=sd,e===null?sd:e}function Ix(){(Xt===0||Xt===3||Xt===2)&&(Xt=4),rr===null||!(ki&268435455)&&!(Yd&268435455)||ha(rr,ur)}function ld(e,t){var r=Je;Je|=2;var n=rb();(rr!==e||ur!==t)&&(Rs=null,mi(e,t));do try{oj();break}catch(s){tb(e,s)}while(!0);if(gx(),Je=r,ad.current=n,Vt!==null)throw Error(pe(261));return rr=null,ur=0,Xt}function oj(){for(;Vt!==null;)nb(Vt)}function lj(){for(;Vt!==null&&!F4();)nb(Vt)}function nb(e){var t=ib(e.alternate,e,Qr);e.memoizedProps=e.pendingProps,t===null?sb(e):Vt=t,jx.current=null}function sb(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=tj(r,t),r!==null){r.flags&=32767,Vt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Xt=6,Vt=null;return}}else if(r=ej(r,t,Qr),r!==null){Vt=r;return}if(t=t.sibling,t!==null){Vt=t;return}Vt=t=e}while(t!==null);Xt===0&&(Xt=5)}function si(e,t,r){var n=at,s=Tn.transition;try{Tn.transition=null,at=1,cj(e,t,r,n)}finally{Tn.transition=s,at=n}return null}function cj(e,t,r,n){do Fo();while(ga!==null);if(Je&6)throw Error(pe(327));r=e.finishedWork;var s=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(pe(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(W4(e,a),e===rr&&(Vt=rr=null,ur=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||qu||(qu=!0,ob(Wf,function(){return Fo(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Tn.transition,Tn.transition=null;var i=at;at=1;var o=Je;Je|=4,jx.current=null,nj(e,r),Q2(r,e),AA(Ep),Hf=!!kp,Ep=kp=null,e.current=r,sj(r),O4(),Je=o,at=i,Tn.transition=a}else e.current=r;if(qu&&(qu=!1,ga=e,od=s),a=e.pendingLanes,a===0&&(Ta=null),L4(r.stateNode),Hr(e,It()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)s=t[r],n(s.value,{componentStack:s.stack,digest:s.digest});if(id)throw id=!1,e=Hp,Hp=null,e;return od&1&&e.tag!==0&&Fo(),a=e.pendingLanes,a&1?e===Gp?ec++:(ec=0,Gp=e):ec=0,za(),null}function Fo(){if(ga!==null){var e=M_(od),t=Tn.transition,r=at;try{if(Tn.transition=null,at=16>e?16:e,ga===null)var n=!1;else{if(e=ga,ga=null,od=0,Je&6)throw Error(pe(331));var s=Je;for(Je|=4,Se=e.current;Se!==null;){var a=Se,i=a.child;if(Se.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(Se=u;Se!==null;){var f=Se;switch(f.tag){case 0:case 11:case 15:Ql(8,f,a)}var d=f.child;if(d!==null)d.return=f,Se=d;else for(;Se!==null;){f=Se;var h=f.sibling,p=f.return;if(X2(f),f===u){Se=null;break}if(h!==null){h.return=p,Se=h;break}Se=p}}}var g=a.alternate;if(g!==null){var m=g.child;if(m!==null){g.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(m!==null)}}Se=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,Se=i;else e:for(;Se!==null;){if(a=Se,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Ql(9,a,a.return)}var y=a.sibling;if(y!==null){y.return=a.return,Se=y;break e}Se=a.return}}var w=e.current;for(Se=w;Se!==null;){i=Se;var v=i.child;if(i.subtreeFlags&2064&&v!==null)v.return=i,Se=v;else e:for(i=w;Se!==null;){if(o=Se,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Xd(9,o)}}catch(E){Nt(o,o.return,E)}if(o===i){Se=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,Se=S;break e}Se=o.return}}if(Je=s,za(),ws&&typeof ws.onPostCommitFiberRoot=="function")try{ws.onPostCommitFiberRoot($d,e)}catch{}n=!0}return n}finally{at=r,Tn.transition=t}}return!1}function w1(e,t,r){t=Ko(r,t),t=M2(e,t,1),e=Ea(e,t,1),t=Rr(),e!==null&&(ru(e,1,t),Hr(e,t))}function Nt(e,t,r){if(e.tag===3)w1(e,e,r);else for(;t!==null;){if(t.tag===3){w1(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ta===null||!Ta.has(n))){e=Ko(r,e),e=B2(t,e,1),t=Ea(t,e,1),e=Rr(),t!==null&&(ru(t,1,e),Hr(t,e));break}}t=t.return}}function uj(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=Rr(),e.pingedLanes|=e.suspendedLanes&r,rr===e&&(ur&r)===r&&(Xt===4||Xt===3&&(ur&130023424)===ur&&500>It()-Rx?mi(e,0):Px|=r),Hr(e,t)}function ab(e,t){t===0&&(e.mode&1?(t=Lu,Lu<<=1,!(Lu&130023424)&&(Lu=4194304)):t=1);var r=Rr();e=Hs(e,t),e!==null&&(ru(e,t,r),Hr(e,r))}function fj(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),ab(e,r)}function dj(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,s=e.memoizedState;s!==null&&(r=s.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(pe(314))}n!==null&&n.delete(t),ab(e,r)}var ib;ib=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wr.current)zr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return zr=!1,ZA(e,t,r);zr=!!(e.flags&131072)}else zr=!1,gt&&t.flags&1048576&&u2(t,Qf,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Af(e,t),e=t.pendingProps;var s=Vo(t,kr.current);Ro(t,r),s=Ex(null,t,n,e,s,r);var a=Tx();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Vr(n)?(a=!0,Yf(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,yx(t),s.updater=Kd,t.stateNode=s,s._reactInternals=t,Op(t,n,e,r),t=Lp(null,t,n,!0,a,r)):(t.tag=0,gt&&a&&hx(t),Ar(null,t,s,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Af(e,t),e=t.pendingProps,s=n._init,n=s(n._payload),t.type=n,s=t.tag=pj(n),e=$n(n,e),s){case 0:t=Dp(null,t,n,e,r);break e;case 1:t=c1(null,t,n,e,r);break e;case 11:t=o1(null,t,n,e,r);break e;case 14:t=l1(null,t,n,$n(n.type,e),r);break e}throw Error(pe(306,n,""))}return t;case 0:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:$n(n,s),Dp(e,t,n,s,r);case 1:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:$n(n,s),c1(e,t,n,s,r);case 3:e:{if(W2(t),e===null)throw Error(pe(387));n=t.pendingProps,a=t.memoizedState,s=a.element,x2(e,t),td(t,n,null,r);var i=t.memoizedState;if(n=i.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=Ko(Error(pe(423)),t),t=u1(e,t,n,r,s);break e}else if(n!==s){s=Ko(Error(pe(424)),t),t=u1(e,t,n,r,s);break e}else for(on=ka(t.stateNode.containerInfo.firstChild),cn=t,gt=!0,Vn=null,r=p2(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Ho(),n===s){t=Gs(e,t,r);break e}Ar(e,t,n,r)}t=t.child}return t;case 5:return g2(t),e===null&&Pp(t),n=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,Tp(n,s)?i=null:a!==null&&Tp(n,a)&&(t.flags|=32),z2(e,t),Ar(e,t,i,r),t.child;case 6:return e===null&&Pp(t),null;case 13:return V2(e,t,r);case 4:return _x(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=Go(t,null,n,r):Ar(e,t,n,r),t.child;case 11:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:$n(n,s),o1(e,t,n,s,r);case 7:return Ar(e,t,t.pendingProps,r),t.child;case 8:return Ar(e,t,t.pendingProps.children,r),t.child;case 12:return Ar(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,ut(Zf,n._currentValue),n._currentValue=i,a!==null)if(es(a.value,i)){if(a.children===s.children&&!Wr.current){t=Gs(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var c=o.firstContext;c!==null;){if(c.context===n){if(a.tag===1){c=Ms(-1,r&-r),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}a.lanes|=r,c=a.alternate,c!==null&&(c.lanes|=r),Rp(a.return,r,t),o.lanes|=r;break}c=c.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(pe(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),Rp(i,r,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Ar(e,t,s.children,r),t=t.child}return t;case 9:return s=t.type,n=t.pendingProps.children,Ro(t,r),s=jn(s),n=n(s),t.flags|=1,Ar(e,t,n,r),t.child;case 14:return n=t.type,s=$n(n,t.pendingProps),s=$n(n.type,s),l1(e,t,n,s,r);case 15:return U2(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,s=t.pendingProps,s=t.elementType===n?s:$n(n,s),Af(e,t),t.tag=1,Vr(n)?(e=!0,Yf(t)):e=!1,Ro(t,r),L2(t,n,s),Op(t,n,s,r),Lp(null,t,n,!0,e,r);case 19:return H2(e,t,r);case 22:return $2(e,t,r)}throw Error(pe(156,t.tag))};function ob(e,t){return O_(e,t)}function hj(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function En(e,t,r,n){return new hj(e,t,r,n)}function Dx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function pj(e){if(typeof e=="function")return Dx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===tx)return 11;if(e===rx)return 14}return 2}function Ca(e,t){var r=e.alternate;return r===null?(r=En(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Rf(e,t,r,n,s,a){var i=2;if(n=e,typeof e=="function")Dx(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case xo:return xi(r.children,s,a,t);case ex:i=8,s|=8;break;case sp:return e=En(12,r,t,s|2),e.elementType=sp,e.lanes=a,e;case ap:return e=En(13,r,t,s),e.elementType=ap,e.lanes=a,e;case ip:return e=En(19,r,t,s),e.elementType=ip,e.lanes=a,e;case g_:return Jd(r,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case m_:i=10;break e;case x_:i=9;break e;case tx:i=11;break e;case rx:i=14;break e;case ua:i=16,n=null;break e}throw Error(pe(130,e==null?e:typeof e,""))}return t=En(i,r,t,s),t.elementType=e,t.type=n,t.lanes=a,t}function xi(e,t,r,n){return e=En(7,e,n,t),e.lanes=r,e}function Jd(e,t,r,n){return e=En(22,e,n,t),e.elementType=g_,e.lanes=r,e.stateNode={isHidden:!1},e}function hh(e,t,r){return e=En(6,e,null,t),e.lanes=r,e}function ph(e,t,r){return t=En(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function mj(e,t,r,n,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=K0(0),this.expirationTimes=K0(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=K0(0),this.identifierPrefix=n,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Lx(e,t,r,n,s,a,i,o,c){return e=new mj(e,t,r,o,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=En(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},yx(a),e}function xj(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:mo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function lb(e){if(!e)return Ra;e=e._reactInternals;e:{if(Bi(e)!==e||e.tag!==1)throw Error(pe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Vr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(pe(171))}if(e.tag===1){var r=e.type;if(Vr(r))return l2(e,r,t)}return t}function cb(e,t,r,n,s,a,i,o,c){return e=Lx(r,n,!0,e,s,a,i,o,c),e.context=lb(null),r=e.current,n=Rr(),s=Na(r),a=Ms(n,s),a.callback=t??null,Ea(r,a,s),e.current.lanes=s,ru(e,s,n),Hr(e,n),e}function Qd(e,t,r,n){var s=t.current,a=Rr(),i=Na(s);return r=lb(r),t.context===null?t.context=r:t.pendingContext=r,t=Ms(a,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Ea(s,t,i),e!==null&&(Yn(e,s,i,a),Tf(e,s,i)),i}function cd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function y1(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Mx(e,t){y1(e,t),(e=e.alternate)&&y1(e,t)}function gj(){return null}var ub=typeof reportError=="function"?reportError:function(e){console.error(e)};function Bx(e){this._internalRoot=e}Zd.prototype.render=Bx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(pe(409));Qd(e,t,null,null)};Zd.prototype.unmount=Bx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Ei(function(){Qd(null,e,null,null)}),t[Vs]=null}};function Zd(e){this._internalRoot=e}Zd.prototype.unstable_scheduleHydration=function(e){if(e){var t=$_();e={blockedOn:null,target:e,priority:t};for(var r=0;r<da.length&&t!==0&&t<da[r].priority;r++);da.splice(r,0,e),r===0&&W_(e)}};function Ux(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function e0(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function _1(){}function vj(e,t,r,n,s){if(s){if(typeof n=="function"){var a=n;n=function(){var u=cd(i);a.call(u)}}var i=cb(t,n,e,0,null,!1,!1,"",_1);return e._reactRootContainer=i,e[Vs]=i.current,_c(e.nodeType===8?e.parentNode:e),Ei(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof n=="function"){var o=n;n=function(){var u=cd(c);o.call(u)}}var c=Lx(e,0,!1,null,null,!1,!1,"",_1);return e._reactRootContainer=c,e[Vs]=c.current,_c(e.nodeType===8?e.parentNode:e),Ei(function(){Qd(t,c,r,n)}),c}function t0(e,t,r,n,s){var a=r._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var o=s;s=function(){var c=cd(i);o.call(c)}}Qd(t,i,e,s)}else i=vj(r,t,e,s,n);return cd(i)}B_=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ml(t.pendingLanes);r!==0&&(ax(t,r|1),Hr(t,It()),!(Je&6)&&(Xo=It()+500,za()))}break;case 13:Ei(function(){var n=Hs(e,1);if(n!==null){var s=Rr();Yn(n,e,1,s)}}),Mx(e,1)}};ix=function(e){if(e.tag===13){var t=Hs(e,134217728);if(t!==null){var r=Rr();Yn(t,e,134217728,r)}Mx(e,134217728)}};U_=function(e){if(e.tag===13){var t=Na(e),r=Hs(e,t);if(r!==null){var n=Rr();Yn(r,e,t,n)}Mx(e,t)}};$_=function(){return at};z_=function(e,t){var r=at;try{return at=e,t()}finally{at=r}};xp=function(e,t,r){switch(t){case"input":if(cp(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var s=Hd(n);if(!s)throw Error(pe(90));w_(n),cp(n,s)}}}break;case"textarea":__(e,r);break;case"select":t=r.value,t!=null&&Co(e,!!r.multiple,t,!1)}};C_=Fx;A_=Ei;var wj={usingClientEntryPoint:!1,Events:[su,yo,Hd,T_,N_,Fx]},jl={findFiberByHostInstance:ui,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},yj={bundleType:jl.bundleType,version:jl.version,rendererPackageName:jl.rendererPackageName,rendererConfig:jl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ys.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=R_(e),e===null?null:e.stateNode},findFiberByHostInstance:jl.findFiberByHostInstance||gj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ku=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ku.isDisabled&&Ku.supportsFiber)try{$d=Ku.inject(yj),ws=Ku}catch{}}hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=wj;hn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ux(t))throw Error(pe(200));return xj(e,t,null,r)};hn.createRoot=function(e,t){if(!Ux(e))throw Error(pe(299));var r=!1,n="",s=ub;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Lx(e,1,!1,null,null,r,!1,n,s),e[Vs]=t.current,_c(e.nodeType===8?e.parentNode:e),new Bx(t)};hn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(pe(188)):(e=Object.keys(e).join(","),Error(pe(268,e)));return e=R_(t),e=e===null?null:e.stateNode,e};hn.flushSync=function(e){return Ei(e)};hn.hydrate=function(e,t,r){if(!e0(t))throw Error(pe(200));return t0(null,e,t,!0,r)};hn.hydrateRoot=function(e,t,r){if(!Ux(e))throw Error(pe(405));var n=r!=null&&r.hydratedSources||null,s=!1,a="",i=ub;if(r!=null&&(r.unstable_strictMode===!0&&(s=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=cb(t,null,e,1,r??null,s,!1,a,i),e[Vs]=t.current,_c(e),n)for(e=0;e<n.length;e++)r=n[e],s=r._getVersion,s=s(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,s]:t.mutableSourceEagerHydrationData.push(r,s);return new Zd(t)};hn.render=function(e,t,r){if(!e0(t))throw Error(pe(200));return t0(null,e,t,!1,r)};hn.unmountComponentAtNode=function(e){if(!e0(e))throw Error(pe(40));return e._reactRootContainer?(Ei(function(){t0(null,null,e,!1,function(){e._reactRootContainer=null,e[Vs]=null})}),!0):!1};hn.unstable_batchedUpdates=Fx;hn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!e0(r))throw Error(pe(200));if(e==null||e._reactInternals===void 0)throw Error(pe(38));return t0(e,t,r,!1,n)};hn.version="18.3.1-next-f1338f8080-20240426";function fb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(fb)}catch(e){console.error(e)}}fb(),f_.exports=hn;var Ui=f_.exports;const _j=Zy(Ui);var db,b1=Ui;db=b1.createRoot,b1.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function jc(){return jc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jc.apply(this,arguments)}var va;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(va||(va={}));const S1="popstate";function bj(e){e===void 0&&(e={});function t(n,s){let{pathname:a,search:i,hash:o}=n.location;return Xp("",{pathname:a,search:i,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function r(n,s){return typeof s=="string"?s:ud(s)}return kj(t,r,null,e)}function Ht(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function hb(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Sj(){return Math.random().toString(36).substr(2,8)}function k1(e,t){return{usr:e.state,key:e.key,idx:t}}function Xp(e,t,r,n){return r===void 0&&(r=null),jc({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?il(t):t,{state:r,key:t&&t.key||n||Sj()})}function ud(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function il(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function kj(e,t,r,n){n===void 0&&(n={});let{window:s=document.defaultView,v5Compat:a=!1}=n,i=s.history,o=va.Pop,c=null,u=f();u==null&&(u=0,i.replaceState(jc({},i.state,{idx:u}),""));function f(){return(i.state||{idx:null}).idx}function d(){o=va.Pop;let x=f(),y=x==null?null:x-u;u=x,c&&c({action:o,location:m.location,delta:y})}function h(x,y){o=va.Push;let w=Xp(m.location,x,y);u=f()+1;let v=k1(w,u),S=m.createHref(w);try{i.pushState(v,"",S)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;s.location.assign(S)}a&&c&&c({action:o,location:m.location,delta:1})}function p(x,y){o=va.Replace;let w=Xp(m.location,x,y);u=f();let v=k1(w,u),S=m.createHref(w);i.replaceState(v,"",S),a&&c&&c({action:o,location:m.location,delta:0})}function g(x){let y=s.location.origin!=="null"?s.location.origin:s.location.href,w=typeof x=="string"?x:ud(x);return w=w.replace(/ $/,"%20"),Ht(y,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,y)}let m={get action(){return o},get location(){return e(s,i)},listen(x){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(S1,d),c=x,()=>{s.removeEventListener(S1,d),c=null}},createHref(x){return t(s,x)},createURL:g,encodeLocation(x){let y=g(x);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:h,replace:p,go(x){return i.go(x)}};return m}var E1;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(E1||(E1={}));function Ej(e,t,r){return r===void 0&&(r="/"),Tj(e,t,r,!1)}function Tj(e,t,r,n){let s=typeof t=="string"?il(t):t,a=$x(s.pathname||"/",r);if(a==null)return null;let i=pb(e);Nj(i);let o=null;for(let c=0;o==null&&c<i.length;++c){let u=Mj(a);o=Dj(i[c],u,n)}return o}function pb(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let s=(a,i,o)=>{let c={relativePath:o===void 0?a.path||"":o,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(Ht(c.relativePath.startsWith(n),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(n.length));let u=Aa([n,c.relativePath]),f=r.concat(c);a.children&&a.children.length>0&&(Ht(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),pb(a.children,t,f,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:Oj(u,a.index),routesMeta:f})};return e.forEach((a,i)=>{var o;if(a.path===""||!((o=a.path)!=null&&o.includes("?")))s(a,i);else for(let c of mb(a.path))s(a,i,c)}),t}function mb(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,s=r.endsWith("?"),a=r.replace(/\?$/,"");if(n.length===0)return s?[a,""]:[a];let i=mb(n.join("/")),o=[];return o.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&o.push(...i),o.map(c=>e.startsWith("/")&&c===""?"/":c)}function Nj(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:Ij(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Cj=/^:[\w-]+$/,Aj=3,jj=2,Pj=1,Rj=10,Fj=-2,T1=e=>e==="*";function Oj(e,t){let r=e.split("/"),n=r.length;return r.some(T1)&&(n+=Fj),t&&(n+=jj),r.filter(s=>!T1(s)).reduce((s,a)=>s+(Cj.test(a)?Aj:a===""?Pj:Rj),n)}function Ij(e,t){return e.length===t.length&&e.slice(0,-1).every((n,s)=>n===t[s])?e[e.length-1]-t[t.length-1]:0}function Dj(e,t,r){let{routesMeta:n}=e,s={},a="/",i=[];for(let o=0;o<n.length;++o){let c=n[o],u=o===n.length-1,f=a==="/"?t:t.slice(a.length)||"/",d=N1({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},f),h=c.route;if(!d&&u&&r&&!n[n.length-1].route.index&&(d=N1({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},f)),!d)return null;Object.assign(s,d.params),i.push({params:s,pathname:Aa([a,d.pathname]),pathnameBase:zj(Aa([a,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(a=Aa([a,d.pathnameBase]))}return i}function N1(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=Lj(e.path,e.caseSensitive,e.end),s=t.match(r);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:n.reduce((u,f,d)=>{let{paramName:h,isOptional:p}=f;if(h==="*"){let m=o[d]||"";i=a.slice(0,a.length-m.length).replace(/(.)\/+$/,"$1")}const g=o[d];return p&&!g?u[h]=void 0:u[h]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:e}}function Lj(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),hb(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,c)=>(n.push({paramName:o,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),n]}function Mj(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return hb(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function $x(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function Bj(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:s=""}=typeof e=="string"?il(e):e;return{pathname:r?r.startsWith("/")?r:Uj(r,t):t,search:Wj(n),hash:Vj(s)}}function Uj(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?r.length>1&&r.pop():s!=="."&&r.push(s)}),r.length>1?r.join("/"):"/"}function mh(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function $j(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function xb(e,t){let r=$j(e);return t?r.map((n,s)=>s===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function gb(e,t,r,n){n===void 0&&(n=!1);let s;typeof e=="string"?s=il(e):(s=jc({},e),Ht(!s.pathname||!s.pathname.includes("?"),mh("?","pathname","search",s)),Ht(!s.pathname||!s.pathname.includes("#"),mh("#","pathname","hash",s)),Ht(!s.search||!s.search.includes("#"),mh("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;s.pathname=h.join("/")}o=d>=0?t[d]:"/"}let c=Bj(s,o),u=i&&i!=="/"&&i.endsWith("/"),f=(a||i===".")&&r.endsWith("/");return!c.pathname.endsWith("/")&&(u||f)&&(c.pathname+="/"),c}const Aa=e=>e.join("/").replace(/\/\/+/g,"/"),zj=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Wj=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Vj=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Hj(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const vb=["post","put","patch","delete"];new Set(vb);const Gj=["get",...vb];new Set(Gj);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pc(){return Pc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pc.apply(this,arguments)}const zx=_.createContext(null),qj=_.createContext(null),$i=_.createContext(null),r0=_.createContext(null),Wa=_.createContext({outlet:null,matches:[],isDataRoute:!1}),wb=_.createContext(null);function Kj(e,t){let{relative:r}=t===void 0?{}:t;iu()||Ht(!1);let{basename:n,navigator:s}=_.useContext($i),{hash:a,pathname:i,search:o}=_b(e,{relative:r}),c=i;return n!=="/"&&(c=i==="/"?n:Aa([n,i])),s.createHref({pathname:c,search:o,hash:a})}function iu(){return _.useContext(r0)!=null}function ol(){return iu()||Ht(!1),_.useContext(r0).location}function yb(e){_.useContext($i).static||_.useLayoutEffect(e)}function dr(){let{isDataRoute:e}=_.useContext(Wa);return e?l3():Xj()}function Xj(){iu()||Ht(!1);let e=_.useContext(zx),{basename:t,future:r,navigator:n}=_.useContext($i),{matches:s}=_.useContext(Wa),{pathname:a}=ol(),i=JSON.stringify(xb(s,r.v7_relativeSplatPath)),o=_.useRef(!1);return yb(()=>{o.current=!0}),_.useCallback(function(u,f){if(f===void 0&&(f={}),!o.current)return;if(typeof u=="number"){n.go(u);return}let d=gb(u,JSON.parse(i),a,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Aa([t,d.pathname])),(f.replace?n.replace:n.push)(d,f.state,f)},[t,n,i,a,e])}function Yj(){let{matches:e}=_.useContext(Wa),t=e[e.length-1];return t?t.params:{}}function _b(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=_.useContext($i),{matches:s}=_.useContext(Wa),{pathname:a}=ol(),i=JSON.stringify(xb(s,n.v7_relativeSplatPath));return _.useMemo(()=>gb(e,JSON.parse(i),a,r==="path"),[e,i,a,r])}function Jj(e,t){return Qj(e,t)}function Qj(e,t,r,n){iu()||Ht(!1);let{navigator:s}=_.useContext($i),{matches:a}=_.useContext(Wa),i=a[a.length-1],o=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let u=ol(),f;if(t){var d;let x=typeof t=="string"?il(t):t;c==="/"||(d=x.pathname)!=null&&d.startsWith(c)||Ht(!1),f=x}else f=u;let h=f.pathname||"/",p=h;if(c!=="/"){let x=c.replace(/^\//,"").split("/");p="/"+h.replace(/^\//,"").split("/").slice(x.length).join("/")}let g=Ej(e,{pathname:p}),m=n3(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:Aa([c,s.encodeLocation?s.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?c:Aa([c,s.encodeLocation?s.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),a,r,n);return t&&m?_.createElement(r0.Provider,{value:{location:Pc({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:va.Pop}},m):m}function Zj(){let e=o3(),t=Hj(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return _.createElement(_.Fragment,null,_.createElement("h2",null,"Unexpected Application Error!"),_.createElement("h3",{style:{fontStyle:"italic"}},t),r?_.createElement("pre",{style:s},r):null,null)}const e3=_.createElement(Zj,null);class t3 extends _.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?_.createElement(Wa.Provider,{value:this.props.routeContext},_.createElement(wb.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function r3(e){let{routeContext:t,match:r,children:n}=e,s=_.useContext(zx);return s&&s.static&&s.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=r.route.id),_.createElement(Wa.Provider,{value:t},n)}function n3(e,t,r,n){var s;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var a;if(!r)return null;if(r.errors)e=r.matches;else if((a=n)!=null&&a.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(s=r)==null?void 0:s.errors;if(o!=null){let f=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);f>=0||Ht(!1),i=i.slice(0,Math.min(i.length,f+1))}let c=!1,u=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let d=i[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(u=f),d.route.id){let{loaderData:h,errors:p}=r,g=d.route.loader&&h[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||g){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((f,d,h)=>{let p,g=!1,m=null,x=null;r&&(p=o&&d.route.id?o[d.route.id]:void 0,m=d.route.errorElement||e3,c&&(u<0&&h===0?(g=!0,x=null):u===h&&(g=!0,x=d.route.hydrateFallbackElement||null)));let y=t.concat(i.slice(0,h+1)),w=()=>{let v;return p?v=m:g?v=x:d.route.Component?v=_.createElement(d.route.Component,null):d.route.element?v=d.route.element:v=f,_.createElement(r3,{match:d,routeContext:{outlet:f,matches:y,isDataRoute:r!=null},children:v})};return r&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?_.createElement(t3,{location:r.location,revalidation:r.revalidation,component:m,error:p,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):w()},null)}var bb=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(bb||{}),fd=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(fd||{});function s3(e){let t=_.useContext(zx);return t||Ht(!1),t}function a3(e){let t=_.useContext(qj);return t||Ht(!1),t}function i3(e){let t=_.useContext(Wa);return t||Ht(!1),t}function Sb(e){let t=i3(),r=t.matches[t.matches.length-1];return r.route.id||Ht(!1),r.route.id}function o3(){var e;let t=_.useContext(wb),r=a3(fd.UseRouteError),n=Sb(fd.UseRouteError);return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function l3(){let{router:e}=s3(bb.UseNavigateStable),t=Sb(fd.UseNavigateStable),r=_.useRef(!1);return yb(()=>{r.current=!0}),_.useCallback(function(s,a){a===void 0&&(a={}),r.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Pc({fromRouteId:t},a)))},[e,t])}function c3(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Jt(e){Ht(!1)}function u3(e){let{basename:t="/",children:r=null,location:n,navigationType:s=va.Pop,navigator:a,static:i=!1,future:o}=e;iu()&&Ht(!1);let c=t.replace(/^\/*/,"/"),u=_.useMemo(()=>({basename:c,navigator:a,static:i,future:Pc({v7_relativeSplatPath:!1},o)}),[c,o,a,i]);typeof n=="string"&&(n=il(n));let{pathname:f="/",search:d="",hash:h="",state:p=null,key:g="default"}=n,m=_.useMemo(()=>{let x=$x(f,c);return x==null?null:{location:{pathname:x,search:d,hash:h,state:p,key:g},navigationType:s}},[c,f,d,h,p,g,s]);return m==null?null:_.createElement($i.Provider,{value:u},_.createElement(r0.Provider,{children:r,value:m}))}function f3(e){let{children:t,location:r}=e;return Jj(Yp(t),r)}new Promise(()=>{});function Yp(e,t){t===void 0&&(t=[]);let r=[];return _.Children.forEach(e,(n,s)=>{if(!_.isValidElement(n))return;let a=[...t,s];if(n.type===_.Fragment){r.push.apply(r,Yp(n.props.children,a));return}n.type!==Jt&&Ht(!1),!n.props.index||!n.props.children||Ht(!1);let i={id:n.props.id||a.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Yp(n.props.children,a)),r.push(i)}),r}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Jp(){return Jp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jp.apply(this,arguments)}function d3(e,t){if(e==null)return{};var r={},n=Object.keys(e),s,a;for(a=0;a<n.length;a++)s=n[a],!(t.indexOf(s)>=0)&&(r[s]=e[s]);return r}function h3(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function p3(e,t){return e.button===0&&(!t||t==="_self")&&!h3(e)}function Qp(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,r)=>{let n=e[r];return t.concat(Array.isArray(n)?n.map(s=>[r,s]):[[r,n]])},[]))}function m3(e,t){let r=Qp(e);return t&&t.forEach((n,s)=>{r.has(s)||t.getAll(s).forEach(a=>{r.append(s,a)})}),r}const x3=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],g3="6";try{window.__reactRouterVersion=g3}catch{}const v3="startTransition",C1=Ym[v3];function w3(e){let{basename:t,children:r,future:n,window:s}=e,a=_.useRef();a.current==null&&(a.current=bj({window:s,v5Compat:!0}));let i=a.current,[o,c]=_.useState({action:i.action,location:i.location}),{v7_startTransition:u}=n||{},f=_.useCallback(d=>{u&&C1?C1(()=>c(d)):c(d)},[c,u]);return _.useLayoutEffect(()=>i.listen(f),[i,f]),_.useEffect(()=>c3(n),[n]),_.createElement(u3,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}const y3=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",_3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Zp=_.forwardRef(function(t,r){let{onClick:n,relative:s,reloadDocument:a,replace:i,state:o,target:c,to:u,preventScrollReset:f,viewTransition:d}=t,h=d3(t,x3),{basename:p}=_.useContext($i),g,m=!1;if(typeof u=="string"&&_3.test(u)&&(g=u,y3))try{let v=new URL(window.location.href),S=u.startsWith("//")?new URL(v.protocol+u):new URL(u),E=$x(S.pathname,p);S.origin===v.origin&&E!=null?u=E+S.search+S.hash:m=!0}catch{}let x=Kj(u,{relative:s}),y=b3(u,{replace:i,state:o,target:c,preventScrollReset:f,relative:s,viewTransition:d});function w(v){n&&n(v),v.defaultPrevented||y(v)}return _.createElement("a",Jp({},h,{href:g||x,onClick:m||a?n:w,ref:r,target:c}))});var A1;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(A1||(A1={}));var j1;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(j1||(j1={}));function b3(e,t){let{target:r,replace:n,state:s,preventScrollReset:a,relative:i,viewTransition:o}=t===void 0?{}:t,c=dr(),u=ol(),f=_b(e,{relative:i});return _.useCallback(d=>{if(p3(d,r)){d.preventDefault();let h=n!==void 0?n:ud(u)===ud(f);c(e,{replace:h,state:s,preventScrollReset:a,relative:i,viewTransition:o})}},[u,c,f,n,s,r,e,a,i,o])}function S3(e){let t=_.useRef(Qp(e)),r=_.useRef(!1),n=ol(),s=_.useMemo(()=>m3(n.search,r.current?null:t.current),[n.search]),a=dr(),i=_.useCallback((o,c)=>{const u=Qp(typeof o=="function"?o(s):o);r.current=!0,a("?"+u,c)},[a,s]);return[s,i]}function kb(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(r=kb(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Eb(){for(var e,t,r=0,n="",s=arguments.length;r<s;r++)(e=arguments[r])&&(t=kb(e))&&(n&&(n+=" "),n+=t);return n}const Wx="-",k3=e=>{const t=T3(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:i=>{const o=i.split(Wx);return o[0]===""&&o.length!==1&&o.shift(),Tb(o,t)||E3(i)},getConflictingClassGroupIds:(i,o)=>{const c=r[i]||[];return o&&n[i]?[...c,...n[i]]:c}}},Tb=(e,t)=>{var i;if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),s=n?Tb(e.slice(1),n):void 0;if(s)return s;if(t.validators.length===0)return;const a=e.join(Wx);return(i=t.validators.find(({validator:o})=>o(a)))==null?void 0:i.classGroupId},P1=/^\[(.+)\]$/,E3=e=>{if(P1.test(e)){const t=P1.exec(e)[1],r=t==null?void 0:t.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},T3=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return C3(Object.entries(e.classGroups),r).forEach(([a,i])=>{em(i,n,a,t)}),n},em=(e,t,r,n)=>{e.forEach(s=>{if(typeof s=="string"){const a=s===""?t:R1(t,s);a.classGroupId=r;return}if(typeof s=="function"){if(N3(s)){em(s(n),t,r,n);return}t.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([a,i])=>{em(i,R1(t,a),r,n)})})},R1=(e,t)=>{let r=e;return t.split(Wx).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},N3=e=>e.isThemeGetter,C3=(e,t)=>t?e.map(([r,n])=>{const s=n.map(a=>typeof a=="string"?t+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([i,o])=>[t+i,o])):a);return[r,s]}):e,A3=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const s=(a,i)=>{r.set(a,i),t++,t>e&&(t=0,n=r,r=new Map)};return{get(a){let i=r.get(a);if(i!==void 0)return i;if((i=n.get(a))!==void 0)return s(a,i),i},set(a,i){r.has(a)?r.set(a,i):s(a,i)}}},Nb="!",j3=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,s=t[0],a=t.length,i=o=>{const c=[];let u=0,f=0,d;for(let x=0;x<o.length;x++){let y=o[x];if(u===0){if(y===s&&(n||o.slice(x,x+a)===t)){c.push(o.slice(f,x)),f=x+a;continue}if(y==="/"){d=x;continue}}y==="["?u++:y==="]"&&u--}const h=c.length===0?o:o.substring(f),p=h.startsWith(Nb),g=p?h.substring(1):h,m=d&&d>f?d-f:void 0;return{modifiers:c,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:m}};return r?o=>r({className:o,parseClassName:i}):i},P3=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},R3=e=>({cache:A3(e.cacheSize),parseClassName:j3(e),...k3(e)}),F3=/\s+/,O3=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=t,a=[],i=e.trim().split(F3);let o="";for(let c=i.length-1;c>=0;c-=1){const u=i[c],{modifiers:f,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:p}=r(u);let g=!!p,m=n(g?h.substring(0,p):h);if(!m){if(!g){o=u+(o.length>0?" "+o:o);continue}if(m=n(h),!m){o=u+(o.length>0?" "+o:o);continue}g=!1}const x=P3(f).join(":"),y=d?x+Nb:x,w=y+m;if(a.includes(w))continue;a.push(w);const v=s(m,g);for(let S=0;S<v.length;++S){const E=v[S];a.push(y+E)}o=u+(o.length>0?" "+o:o)}return o};function I3(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=Cb(t))&&(n&&(n+=" "),n+=r);return n}const Cb=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=Cb(e[n]))&&(r&&(r+=" "),r+=t);return r};function D3(e,...t){let r,n,s,a=i;function i(c){const u=t.reduce((f,d)=>d(f),e());return r=R3(u),n=r.cache.get,s=r.cache.set,a=o,o(c)}function o(c){const u=n(c);if(u)return u;const f=O3(c,r);return s(c,f),f}return function(){return a(I3.apply(null,arguments))}}const ft=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},Ab=/^\[(?:([a-z-]+):)?(.+)\]$/i,L3=/^\d+\/\d+$/,M3=new Set(["px","full","screen"]),B3=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,U3=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,$3=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,z3=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,W3=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,js=e=>Oo(e)||M3.has(e)||L3.test(e),na=e=>ll(e,"length",J3),Oo=e=>!!e&&!Number.isNaN(Number(e)),xh=e=>ll(e,"number",Oo),Pl=e=>!!e&&Number.isInteger(Number(e)),V3=e=>e.endsWith("%")&&Oo(e.slice(0,-1)),ze=e=>Ab.test(e),sa=e=>B3.test(e),H3=new Set(["length","size","percentage"]),G3=e=>ll(e,H3,jb),q3=e=>ll(e,"position",jb),K3=new Set(["image","url"]),X3=e=>ll(e,K3,Z3),Y3=e=>ll(e,"",Q3),Rl=()=>!0,ll=(e,t,r)=>{const n=Ab.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},J3=e=>U3.test(e)&&!$3.test(e),jb=()=>!1,Q3=e=>z3.test(e),Z3=e=>W3.test(e),eP=()=>{const e=ft("colors"),t=ft("spacing"),r=ft("blur"),n=ft("brightness"),s=ft("borderColor"),a=ft("borderRadius"),i=ft("borderSpacing"),o=ft("borderWidth"),c=ft("contrast"),u=ft("grayscale"),f=ft("hueRotate"),d=ft("invert"),h=ft("gap"),p=ft("gradientColorStops"),g=ft("gradientColorStopPositions"),m=ft("inset"),x=ft("margin"),y=ft("opacity"),w=ft("padding"),v=ft("saturate"),S=ft("scale"),E=ft("sepia"),k=ft("skew"),b=ft("space"),N=ft("translate"),A=()=>["auto","contain","none"],O=()=>["auto","hidden","clip","visible","scroll"],V=()=>["auto",ze,t],C=()=>[ze,t],B=()=>["",js,na],G=()=>["auto",Oo,ze],X=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],z=()=>["solid","dashed","dotted","double","none"],q=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],K=()=>["start","end","center","between","around","evenly","stretch"],F=()=>["","0",ze],ne=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Y=()=>[Oo,ze];return{cacheSize:500,separator:":",theme:{colors:[Rl],spacing:[js,na],blur:["none","",sa,ze],brightness:Y(),borderColor:[e],borderRadius:["none","","full",sa,ze],borderSpacing:C(),borderWidth:B(),contrast:Y(),grayscale:F(),hueRotate:Y(),invert:F(),gap:C(),gradientColorStops:[e],gradientColorStopPositions:[V3,na],inset:V(),margin:V(),opacity:Y(),padding:C(),saturate:Y(),scale:Y(),sepia:F(),skew:Y(),space:C(),translate:C()},classGroups:{aspect:[{aspect:["auto","square","video",ze]}],container:["container"],columns:[{columns:[sa]}],"break-after":[{"break-after":ne()}],"break-before":[{"break-before":ne()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...X(),ze]}],overflow:[{overflow:O()}],"overflow-x":[{"overflow-x":O()}],"overflow-y":[{"overflow-y":O()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[m]}],"inset-x":[{"inset-x":[m]}],"inset-y":[{"inset-y":[m]}],start:[{start:[m]}],end:[{end:[m]}],top:[{top:[m]}],right:[{right:[m]}],bottom:[{bottom:[m]}],left:[{left:[m]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Pl,ze]}],basis:[{basis:V()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",ze]}],grow:[{grow:F()}],shrink:[{shrink:F()}],order:[{order:["first","last","none",Pl,ze]}],"grid-cols":[{"grid-cols":[Rl]}],"col-start-end":[{col:["auto",{span:["full",Pl,ze]},ze]}],"col-start":[{"col-start":G()}],"col-end":[{"col-end":G()}],"grid-rows":[{"grid-rows":[Rl]}],"row-start-end":[{row:["auto",{span:[Pl,ze]},ze]}],"row-start":[{"row-start":G()}],"row-end":[{"row-end":G()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",ze]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",ze]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...K()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...K(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...K(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[x]}],mx:[{mx:[x]}],my:[{my:[x]}],ms:[{ms:[x]}],me:[{me:[x]}],mt:[{mt:[x]}],mr:[{mr:[x]}],mb:[{mb:[x]}],ml:[{ml:[x]}],"space-x":[{"space-x":[b]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[b]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",ze,t]}],"min-w":[{"min-w":[ze,t,"min","max","fit"]}],"max-w":[{"max-w":[ze,t,"none","full","min","max","fit","prose",{screen:[sa]},sa]}],h:[{h:[ze,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[ze,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[ze,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[ze,t,"auto","min","max","fit"]}],"font-size":[{text:["base",sa,na]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",xh]}],"font-family":[{font:[Rl]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",ze]}],"line-clamp":[{"line-clamp":["none",Oo,xh]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",js,ze]}],"list-image":[{"list-image":["none",ze]}],"list-style-type":[{list:["none","disc","decimal",ze]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",js,na]}],"underline-offset":[{"underline-offset":["auto",js,ze]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",ze]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",ze]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...X(),q3]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",G3]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},X3]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...z(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:z()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...z()]}],"outline-offset":[{"outline-offset":[js,ze]}],"outline-w":[{outline:[js,na]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:B()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[js,na]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",sa,Y3]}],"shadow-color":[{shadow:[Rl]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...q(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":q()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",sa,ze]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[d]}],saturate:[{saturate:[v]}],sepia:[{sepia:[E]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[E]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",ze]}],duration:[{duration:Y()}],ease:[{ease:["linear","in","out","in-out",ze]}],delay:[{delay:Y()}],animate:[{animate:["none","spin","ping","pulse","bounce",ze]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[Pl,ze]}],"translate-x":[{"translate-x":[N]}],"translate-y":[{"translate-y":[N]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",ze]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",ze]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",ze]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[js,na,xh]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},tP=D3(eP);function Ke(...e){return tP(Eb(e))}const Pe=_.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ke("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Pe.displayName="Card";const _s=_.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ke("flex flex-col space-y-1.5 p-6",e),...t}));_s.displayName="CardHeader";const bs=_.forwardRef(({className:e,...t},r)=>l.jsx("h3",{ref:r,className:Ke("text-2xl font-semibold leading-none tracking-tight",e),...t}));bs.displayName="CardTitle";const rP=_.forwardRef(({className:e,...t},r)=>l.jsx("p",{ref:r,className:Ke("text-sm text-muted-foreground",e),...t}));rP.displayName="CardDescription";const ln=_.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ke("p-6 pt-0",e),...t}));ln.displayName="CardContent";const nP=_.forwardRef(({className:e,...t},r)=>l.jsx("div",{ref:r,className:Ke("flex items-center p-6 pt-0",e),...t}));nP.displayName="CardFooter";const Ie=({color:e,size:t,top:r,left:n,delay:s=0,rotation:a=!1})=>{const i={purple:"bg-battle-purple shadow-glow",pink:"bg-battle-pink shadow-glow-pink",yellow:"bg-battle-accent shadow-glow-accent"};return l.jsx("div",{className:`absolute ${i[e]} rounded-lg ${a?"animate-rotate":"animate-float"} opacity-20`,style:{width:`${t}px`,height:`${t}px`,top:r,left:n,animationDelay:`${s}s`}})},sP=({lines:e,className:t=""})=>l.jsx("div",{className:`font-mono text-sm md:text-base bg-card/50 backdrop-blur-sm p-4 md:p-6 rounded-lg border border-primary/30 ${t}`,children:e.map((r,n)=>l.jsxs("div",{className:"flex gap-4",children:[l.jsx("span",{className:"text-muted-foreground select-none",children:(n+1).toString().padStart(2,"0")}),l.jsx("span",{className:"text-foreground/80",children:r})]},n))});function F1(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function n0(...e){return t=>{let r=!1;const n=e.map(s=>{const a=F1(s,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let s=0;s<n.length;s++){const a=n[s];typeof a=="function"?a():F1(e[s],null)}}}}function Ye(...e){return _.useCallback(n0(...e),e)}function Ti(e){const t=iP(e),r=_.forwardRef((n,s)=>{const{children:a,...i}=n,o=_.Children.toArray(a),c=o.find(lP);if(c){const u=c.props.children,f=o.map(d=>d===c?_.Children.count(u)>1?_.Children.only(null):_.isValidElement(u)?u.props.children:null:d);return l.jsx(t,{...i,ref:s,children:_.isValidElement(u)?_.cloneElement(u,void 0,f):null})}return l.jsx(t,{...i,ref:s,children:a})});return r.displayName=`${e}.Slot`,r}var aP=Ti("Slot");function iP(e){const t=_.forwardRef((r,n)=>{const{children:s,...a}=r;if(_.isValidElement(s)){const i=uP(s),o=cP(a,s.props);return s.type!==_.Fragment&&(o.ref=n?n0(n,i):i),_.cloneElement(s,o)}return _.Children.count(s)>1?_.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var oP=Symbol("radix.slottable");function lP(e){return _.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===oP}function cP(e,t){const r={...t};for(const n in t){const s=e[n],a=t[n];/^on[A-Z]/.test(n)?s&&a?r[n]=(...o)=>{const c=a(...o);return s(...o),c}:s&&(r[n]=s):n==="style"?r[n]={...s,...a}:n==="className"&&(r[n]=[s,a].filter(Boolean).join(" "))}return{...e,...r}}function uP(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}const O1=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,I1=Eb,s0=(e,t)=>r=>{var n;if((t==null?void 0:t.variants)==null)return I1(e,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:s,defaultVariants:a}=t,i=Object.keys(s).map(u=>{const f=r==null?void 0:r[u],d=a==null?void 0:a[u];if(f===null)return null;const h=O1(f)||O1(d);return s[u][h]}),o=r&&Object.entries(r).reduce((u,f)=>{let[d,h]=f;return h===void 0||(u[d]=h),u},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((u,f)=>{let{class:d,className:h,...p}=f;return Object.entries(p).every(g=>{let[m,x]=g;return Array.isArray(x)?x.includes({...a,...o}[m]):{...a,...o}[m]===x})?[...u,d,h]:u},[]);return I1(e,i,c,r==null?void 0:r.class,r==null?void 0:r.className)},fP=s0("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary  hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),fe=_.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...s},a)=>{const i=n?aP:"button";return l.jsx(i,{className:Ke(fP({variant:t,size:r,className:e})),ref:a,...s})});fe.displayName="Button";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dP=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Pb=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var hP={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pP=_.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:s="",children:a,iconNode:i,...o},c)=>_.createElement("svg",{ref:c,...hP,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Pb("lucide",s),...o},[...i.map(([u,f])=>_.createElement(u,f)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=(e,t)=>{const r=_.forwardRef(({className:n,...s},a)=>_.createElement(pP,{ref:a,iconNode:t,className:Pb(`lucide-${dP(e)}`,n),...s}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=Te("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vx=Te("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rb=Te("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=Te("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hx=Te("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mP=Te("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xP=Te("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dd=Te("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rc=Te("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gP=Te("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vP=Te("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wP=Te("CloudSun",[["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}],["path",{d:"M15.947 12.65a4 4 0 0 0-5.925-4.128",key:"dpwdj0"}],["path",{d:"M13 22H7a5 5 0 1 1 4.9-6H13a3 3 0 0 1 0 6Z",key:"s09mg5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yP=Te("CodeXml",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fc=Te("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _P=Te("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bP=Te("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=Te("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SP=Te("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fl=Te("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D1=Te("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L1=Te("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=Te("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=Te("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ni=Te("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gx=Te("Medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kP=Te("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hd=Te("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gh=Te("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EP=Te("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TP=Te("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rm=Te("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ob=Te("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NP=Te("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qx=Te("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Io=Te("Reply",[["polyline",{points:"9 17 4 12 9 7",key:"hvgpf2"}],["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CP=Te("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AP=Te("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jP=Te("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ib=Te("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pd=Te("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PP=Te("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RP=Te("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vh=Te("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FP=Te("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M1=Te("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OP=Te("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B1=Te("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=Te("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=Te("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nm=Te("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=Te("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cl=Te("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=Te("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IP=Te("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),DP="modulepreload",LP=function(e){return"/"+e},U1={},ou=function(t,r,n){let s=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));s=Promise.allSettled(r.map(c=>{if(c=LP(c),c in U1)return;U1[c]=!0;const u=c.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${f}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":DP,u||(d.as="script"),d.crossOrigin="",d.href=c,o&&d.setAttribute("nonce",o),document.head.appendChild(d),u)return new Promise((h,p)=>{d.addEventListener("load",h),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${c}`)))})}))}function a(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return s.then(i=>{for(const o of i||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})},MP=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ou(async()=>{const{default:n}=await Promise.resolve().then(()=>ul);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Kx extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class $1 extends Kx{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class z1 extends Kx{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class W1 extends Kx{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var sm;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(sm||(sm={}));var BP=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class UP{constructor(t,{headers:r={},customFetch:n,region:s=sm.Any}={}){this.url=t,this.headers=r,this.region=s,this.fetch=MP(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return BP(this,arguments,void 0,function*(r,n={}){var s;try{const{headers:a,method:i,body:o,signal:c}=n;let u={},{region:f}=n;f||(f=this.region);const d=new URL(`${this.url}/${r}`);f&&f!=="any"&&(u["x-region"]=f,d.searchParams.set("forceFunctionRegion",f));let h;o&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",h=o):typeof o=="string"?(u["Content-Type"]="text/plain",h=o):typeof FormData<"u"&&o instanceof FormData?h=o:(u["Content-Type"]="application/json",h=JSON.stringify(o)));const p=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),a),body:h,signal:c}).catch(y=>{throw y.name==="AbortError"?y:new $1(y)}),g=p.headers.get("x-relay-error");if(g&&g==="true")throw new z1(p);if(!p.ok)throw new W1(p);let m=((s=p.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),x;return m==="application/json"?x=yield p.json():m==="application/octet-stream"?x=yield p.blob():m==="text/event-stream"?x=p:m==="multipart/form-data"?x=yield p.formData():x=yield p.text(),{data:x,error:null,response:p}}catch(a){return a instanceof Error&&a.name==="AbortError"?{data:null,error:new $1(a)}:{data:null,error:a,response:a instanceof W1||a instanceof z1?a.context:void 0}}})}}var $r={},Xx={},i0={},lu={},o0={},l0={},$P=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Jo=$P();const zP=Jo.fetch,Db=Jo.fetch.bind(Jo),Lb=Jo.Headers,WP=Jo.Request,VP=Jo.Response,ul=Object.freeze(Object.defineProperty({__proto__:null,Headers:Lb,Request:WP,Response:VP,default:Db,fetch:zP},Symbol.toStringTag,{value:"Module"})),HP=XC(ul);var c0={};Object.defineProperty(c0,"__esModule",{value:!0});let GP=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};c0.default=GP;var Mb=An&&An.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(l0,"__esModule",{value:!0});const qP=Mb(HP),KP=Mb(c0);let XP=class{constructor(t){var r,n;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(r=t.shouldThrowOnError)!==null&&r!==void 0?r:!1,this.signal=t.signal,this.isMaybeSingle=(n=t.isMaybeSingle)!==null&&n!==void 0?n:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=qP.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=new Headers(this.headers),this.headers.set(t,r),this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let s=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{var i,o,c,u;let f=null,d=null,h=null,p=a.status,g=a.statusText;if(a.ok){if(this.method!=="HEAD"){const w=await a.text();w===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((i=this.headers.get("Accept"))===null||i===void 0)&&i.includes("application/vnd.pgrst.plan+text"))?d=w:d=JSON.parse(w))}const x=(o=this.headers.get("Prefer"))===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),y=(c=a.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");x&&y&&y.length>1&&(h=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(f={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,p=406,g="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const x=await a.text();try{f=JSON.parse(x),Array.isArray(f)&&a.status===404&&(d=[],f=null,p=200,g="OK")}catch{a.status===404&&x===""?(p=204,g="No Content"):f={message:x}}if(f&&this.isMaybeSingle&&(!((u=f==null?void 0:f.details)===null||u===void 0)&&u.includes("0 rows"))&&(f=null,p=200,g="OK"),f&&this.shouldThrowOnError)throw new KP.default(f)}return{error:f,data:d,count:h,status:p,statusText:g}});return this.shouldThrowOnError||(s=s.catch(a=>{var i,o,c;return{error:{message:`${(i=a==null?void 0:a.name)!==null&&i!==void 0?i:"FetchError"}: ${a==null?void 0:a.message}`,details:`${(o=a==null?void 0:a.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(c=a==null?void 0:a.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,r)}returns(){return this}overrideTypes(){return this}};l0.default=XP;var YP=An&&An.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(o0,"__esModule",{value:!0});const JP=YP(l0);let QP=class extends JP.default{select(t){let r=!1;const n=(t??"*").split("").map(s=>/\s/.test(s)&&!r?"":(s==='"'&&(r=!r),s)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:s,referencedTable:a=s}={}){const i=a?`${a}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:s=n}={}){const a=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:s=!1,wal:a=!1,format:i="text"}={}){var o;const c=[t?"analyze":null,r?"verbose":null,n?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),u=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${u}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};o0.default=QP;var ZP=An&&An.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(lu,"__esModule",{value:!0});const eR=ZP(o0);let tR=class extends eR.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:s}={}){let a="";s==="plain"?a="pl":s==="phrase"?a="ph":s==="websearch"&&(a="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${a}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const s=n?`${n}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};lu.default=tR;var rR=An&&An.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(i0,"__esModule",{value:!0});const Ol=rR(lu);let nR=class{constructor(t,{headers:r={},schema:n,fetch:s}){this.url=t,this.headers=new Headers(r),this.schema=n,this.fetch=s}select(t,r){const{head:n=!1,count:s}=r??{},a=n?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(c=>/\s/.test(c)&&!i?"":(c==='"'&&(i=!i),c)).join("");return this.url.searchParams.set("select",o),s&&this.headers.append("Prefer",`count=${s}`),new Ol.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:r,defaultToNull:n=!0}={}){var s;const a="POST";if(r&&this.headers.append("Prefer",`count=${r}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const i=t.reduce((o,c)=>o.concat(Object.keys(c)),[]);if(i.length>0){const o=[...new Set(i)].map(c=>`"${c}"`);this.url.searchParams.set("columns",o.join(","))}}return new Ol.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:s,defaultToNull:a=!0}={}){var i;const o="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),r!==void 0&&this.url.searchParams.set("on_conflict",r),s&&this.headers.append("Prefer",`count=${s}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(t)){const c=t.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(c.length>0){const u=[...new Set(c)].map(f=>`"${f}"`);this.url.searchParams.set("columns",u.join(","))}}return new Ol.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(t,{count:r}={}){var n;const s="PATCH";return r&&this.headers.append("Prefer",`count=${r}`),new Ol.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:t}={}){var r;const n="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Ol.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}};i0.default=nR;var Bb=An&&An.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Xx,"__esModule",{value:!0});const sR=Bb(i0),aR=Bb(lu);let iR=class Ub{constructor(t,{headers:r={},schema:n,fetch:s}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=s}from(t){const r=new URL(`${this.url}/${t}`);return new sR.default(r,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Ub(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:s=!1,count:a}={}){var i;let o;const c=new URL(`${this.url}/rpc/${t}`);let u;n||s?(o=n?"HEAD":"GET",Object.entries(r).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{c.searchParams.append(d,h)})):(o="POST",u=r);const f=new Headers(this.headers);return a&&f.set("Prefer",`count=${a}`),new aR.default({method:o,url:c,headers:f,schema:this.schemaName,body:u,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};Xx.default=iR;var fl=An&&An.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty($r,"__esModule",{value:!0});$r.PostgrestError=$r.PostgrestBuilder=$r.PostgrestTransformBuilder=$r.PostgrestFilterBuilder=$r.PostgrestQueryBuilder=$r.PostgrestClient=void 0;const $b=fl(Xx);$r.PostgrestClient=$b.default;const zb=fl(i0);$r.PostgrestQueryBuilder=zb.default;const Wb=fl(lu);$r.PostgrestFilterBuilder=Wb.default;const Vb=fl(o0);$r.PostgrestTransformBuilder=Vb.default;const Hb=fl(l0);$r.PostgrestBuilder=Hb.default;const Gb=fl(c0);$r.PostgrestError=Gb.default;var oR=$r.default={PostgrestClient:$b.default,PostgrestQueryBuilder:zb.default,PostgrestFilterBuilder:Wb.default,PostgrestTransformBuilder:Vb.default,PostgrestBuilder:Hb.default,PostgrestError:Gb.default};const{PostgrestClient:lR,PostgrestQueryBuilder:Zq,PostgrestFilterBuilder:eK,PostgrestTransformBuilder:tK,PostgrestBuilder:rK,PostgrestError:nK}=oR;class cR{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const r=process.versions;if(r&&r.node){const n=r.node,s=parseInt(n.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const uR="2.75.1",fR=`realtime-js/${uR}`,dR="1.0.0",am=1e4,hR=1e3,pR=100;var tc;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(tc||(tc={}));var Gt;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Gt||(Gt={}));var Wn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Wn||(Wn={}));var im;(function(e){e.websocket="websocket"})(im||(im={}));var oi;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(oi||(oi={}));class mR{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const s=r.getUint8(1),a=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+s));i=i+s;const c=n.decode(t.slice(i,i+a));i=i+a;const u=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:c,payload:u}}}class qb{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var ct;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(ct||(ct={}));const V1=(e,t,r={})=>{var n;const s=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((a,i)=>(a[i]=xR(i,e,t,s),a),{}):{}},xR=(e,t,r,n)=>{const s=t.find(o=>o.name===e),a=s==null?void 0:s.type,i=r[e];return a&&!n.includes(a)?Kb(a,i):om(i)},Kb=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return yR(t,r)}switch(e){case ct.bool:return gR(t);case ct.float4:case ct.float8:case ct.int2:case ct.int4:case ct.int8:case ct.numeric:case ct.oid:return vR(t);case ct.json:case ct.jsonb:return wR(t);case ct.timestamp:return _R(t);case ct.abstime:case ct.date:case ct.daterange:case ct.int4range:case ct.int8range:case ct.money:case ct.reltime:case ct.text:case ct.time:case ct.timestamptz:case ct.timetz:case ct.tsrange:case ct.tstzrange:return om(t);default:return om(t)}},om=e=>e,gR=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},vR=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},wR=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},yR=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const i=e.slice(1,r);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(o=>Kb(t,o))}return e},_R=e=>typeof e=="string"?e.replace(" ","T"):e,Xb=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class wh{constructor(t,r,n={},s=am){this.channel=t,this.event=r,this.payload=n,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var H1;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(H1||(H1={}));class rc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},s=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=rc.syncState(this.state,s,a,i),this.pendingDiffs.forEach(c=>{this.state=rc.syncDiff(this.state,c,a,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},s=>{const{onJoin:a,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=rc.syncDiff(this.state,s,a,i),o())}),this.onJoin((s,a,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:i})}),this.onLeave((s,a,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,s){const a=this.cloneDeep(t),i=this.transformState(r),o={},c={};return this.map(a,(u,f)=>{i[u]||(c[u]=f)}),this.map(i,(u,f)=>{const d=a[u];if(d){const h=f.map(x=>x.presence_ref),p=d.map(x=>x.presence_ref),g=f.filter(x=>p.indexOf(x.presence_ref)<0),m=d.filter(x=>h.indexOf(x.presence_ref)<0);g.length>0&&(o[u]=g),m.length>0&&(c[u]=m)}else o[u]=f}),this.syncDiff(a,{joins:o,leaves:c},n,s)}static syncDiff(t,r,n,s){const{joins:a,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),s||(s=()=>{}),this.map(a,(o,c)=>{var u;const f=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(c),f.length>0){const d=t[o].map(p=>p.presence_ref),h=f.filter(p=>d.indexOf(p.presence_ref)<0);t[o].unshift(...h)}n(o,f,c)}),this.map(i,(o,c)=>{let u=t[o];if(!u)return;const f=c.map(d=>d.presence_ref);u=u.filter(d=>f.indexOf(d.presence_ref)<0),t[o]=u,s(o,u,c),u.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const s=t[n];return"metas"in s?r[n]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=s,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var G1;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(G1||(G1={}));var nc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(nc||(nc={}));var Fs;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Fs||(Fs={}));class Yx{constructor(t,r={config:{}},n){var s,a;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Gt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new wh(this,Wn.join,this.params,this.timeout),this.rejoinTimer=new qb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Gt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Gt.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Gt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Gt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=Gt.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Wn.reply,{},(i,o)=>{this._trigger(this._replyEventName(o),i)}),this.presence=new rc(this),this.broadcastEndpointURL=Xb(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Gt.closed){const{config:{broadcast:i,presence:o,private:c}}=this.params,u=(s=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(p=>p.filter))!==null&&s!==void 0?s:[],f=!!this.bindings[nc.PRESENCE]&&this.bindings[nc.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,d={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:f}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(p=>t==null?void 0:t(Fs.CHANNEL_ERROR,p)),this._onClose(()=>t==null?void 0:t(Fs.CLOSED)),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:p})=>{var g;if(this.socket.setAuth(),p===void 0){t==null||t(Fs.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,x=(g=m==null?void 0:m.length)!==null&&g!==void 0?g:0,y=[];for(let w=0;w<x;w++){const v=m[w],{filter:{event:S,schema:E,table:k,filter:b}}=v,N=p&&p[w];if(N&&N.event===S&&N.schema===E&&N.table===k&&N.filter===b)y.push(Object.assign(Object.assign({},v),{id:N.id}));else{this.unsubscribe(),this.state=Gt.errored,t==null||t(Fs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(Fs.SUBSCRIBED);return}}).receive("error",p=>{this.state=Gt.errored,t==null||t(Fs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(p).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Fs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Gt.joined&&t===nc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,r,n)}async send(t,r={}){var n,s;if(!this._canPush()&&t.type==="broadcast"){const{event:a,payload:i}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,o,c;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Gt.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Wn.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(s=>{n=new wh(this,Wn.leave,{},t),n.receive("ok",()=>{r(),s("ok")}).receive("timeout",()=>{r(),s("timed out")}).receive("error",()=>{s("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Gt.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const s=new AbortController,a=setTimeout(()=>s.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:s.signal}));return clearTimeout(a),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new wh(this,t,r,n);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>pR){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var s,a;const i=t.toLocaleLowerCase(),{close:o,error:c,leave:u,join:f}=Wn;if(n&&[o,c,u,f].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(p=>{var g,m,x;return((g=p.filter)===null||g===void 0?void 0:g.event)==="*"||((x=(m=p.filter)===null||m===void 0?void 0:m.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===i}).map(p=>p.callback(h,n)):(a=this.bindings[i])===null||a===void 0||a.filter(p=>{var g,m,x,y,w,v;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const S=p.id,E=(g=p.filter)===null||g===void 0?void 0:g.event;return S&&((m=r.ids)===null||m===void 0?void 0:m.includes(S))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((x=r.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{const S=(w=(y=p==null?void 0:p.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return S==="*"||S===((v=r==null?void 0:r.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:m,table:x,commit_timestamp:y,type:w,errors:v}=g;h=Object.assign(Object.assign({},{schema:m,table:x,commit_timestamp:y,eventType:w,new:{},old:{},errors:v}),this._getPayloadRecords(g))}p.callback(h,n)})}_isClosed(){return this.state===Gt.closed}_isJoined(){return this.state===Gt.joined}_isJoining(){return this.state===Gt.joining}_isLeaving(){return this.state===Gt.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const s=t.toLocaleLowerCase(),a={type:s,filter:r,callback:n};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&Yx.isEqual(s.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Wn.close,{},t)}_onError(t){this._on(Wn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Gt.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=V1(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=V1(t.columns,t.old_record)),r}}const yh=()=>{},Yu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},bR=[1e3,2e3,5e3,1e4],SR=1e4,kR=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class ER{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=am,this.transport=null,this.heartbeatIntervalMs=Yu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=yh,this.ref=0,this.reconnectTimer=null,this.logger=yh,this.conn=null,this.sendBuffer=[],this.serializer=new mR,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let a;return s?a=s:typeof fetch>"u"?a=(...i)=>ou(async()=>{const{default:o}=await Promise.resolve().then(()=>ul);return{default:o}},void 0).then(({default:o})=>o(...i)).catch(o=>{throw new Error(`Failed to load @supabase/node-fetch: ${o.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):a=fetch,(...i)=>a(...i)},!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${im.websocket}`,this.httpEndpoint=Xb(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=cR.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:dR}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},t?this.conn.close(t,r??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case tc.connecting:return oi.Connecting;case tc.open:return oi.Open;case tc.closing:return oi.Closing;default:return oi.Closed}}isConnected(){return this.connectionState()===oi.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,s=this.getChannels().find(a=>a.topic===n);if(s)return s;{const a=new Yx(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:s,ref:a}=t,i=()=>{this.encode(t,o=>{var c;(c=this.conn)===null||c===void 0||c.send(o)})};this.log("push",`${r} ${n} (${a})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(hR,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Yu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply")try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}r.ref&&r.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:s,payload:a,ref:i}=r,o=i?`(${i})`:"",c=a.status||"";this.log("receive",`${c} ${n} ${s} ${o}`.trim(),a),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(s,a,i)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Wn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",s=new URLSearchParams(r);return`${t}${n}${s}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([kR],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r;t?r=t:this.accessToken?r=await this.accessToken():r=this.accessTokenValue,this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(n=>{const s={access_token:r,version:fR};r&&n.updateJoinPayload(s),n.joinedOnce&&n._isJoined()&&n._push(Wn.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(r=>{this.log("error",`error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new qb(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Yu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,s,a,i,o,c,u,f;if(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:am,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:Yu.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:yh,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t==null?void 0:t.reconnectAfterMs)!==null&&c!==void 0?c:d=>bR[d-1]||SR,this.encode=(u=t==null?void 0:t.encode)!==null&&u!==void 0?u:(d,h)=>h(JSON.stringify(d)),this.decode=(f=t==null?void 0:t.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class Jx extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Wt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class TR extends Jx{constructor(t,r,n){super(t),this.name="StorageApiError",this.status=r,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class lm extends Jx{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var NR=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const Yb=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ou(async()=>{const{default:n}=await Promise.resolve().then(()=>ul);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},CR=()=>NR(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ou(()=>Promise.resolve().then(()=>ul),void 0)).Response:Response}),cm=e=>{if(Array.isArray(e))return e.map(r=>cm(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const s=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[s]=cm(n)}),t},AR=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var zi=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const _h=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),jR=(e,t,r)=>zi(void 0,void 0,void 0,function*(){const n=yield CR();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(s=>{const a=e.status||500,i=(s==null?void 0:s.statusCode)||a+"";t(new TR(_h(s),a,i))}).catch(s=>{t(new lm(_h(s),s))}):t(new lm(_h(e),e))}),PR=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?s:(AR(n)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(n)):s.body=n,t!=null&&t.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),r))};function cu(e,t,r,n,s,a){return zi(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,PR(t,n,s,a)).then(c=>{if(!c.ok)throw c;return n!=null&&n.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>jR(c,o,n))})})}function md(e,t,r,n){return zi(this,void 0,void 0,function*(){return cu(e,"GET",t,r,n)})}function ds(e,t,r,n,s){return zi(this,void 0,void 0,function*(){return cu(e,"POST",t,n,s,r)})}function um(e,t,r,n,s){return zi(this,void 0,void 0,function*(){return cu(e,"PUT",t,n,s,r)})}function RR(e,t,r,n){return zi(this,void 0,void 0,function*(){return cu(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function Jb(e,t,r,n,s){return zi(this,void 0,void 0,function*(){return cu(e,"DELETE",t,n,s,r)})}var FR=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class OR{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r}then(t,r){return this.execute().then(t,r)}execute(){return FR(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}}var IR=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})},Qb;class DR{constructor(t,r){this.downloadFn=t,this.shouldThrowOnError=r,this[Qb]="BlobDownloadBuilder",this.promise=null}asStream(){return new OR(this.downloadFn,this.shouldThrowOnError)}then(t,r){return this.getPromise().then(t,r)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return IR(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}}Qb=Symbol.toStringTag;var Mr=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const LR={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},q1={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class MR{constructor(t,r={},n,s){this.shouldThrowOnError=!1,this.url=t,this.headers=r,this.bucketId=n,this.fetch=Yb(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,r,n,s){return Mr(this,void 0,void 0,function*(){try{let a;const i=Object.assign(Object.assign({},q1),s);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",this.encodeMetadata(c))):(a=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,c&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(o=Object.assign(Object.assign({},o),s.headers));const u=this._removeEmptyFolders(r),f=this._getFinalPath(u),d=yield(t=="PUT"?um:ds)(this.fetch,`${this.url}/object/${f}`,a,Object.assign({headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:d.Id,fullPath:d.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Wt(a))return{data:null,error:a};throw a}})}upload(t,r,n){return Mr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,s){return Mr(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(t),i=this._getFinalPath(a),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let c;const u=Object.assign({upsert:q1.upsert},s),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,f["cache-control"]=`max-age=${u.cacheControl}`,f["content-type"]=u.contentType);const d=yield um(this.fetch,o.toString(),c,{headers:f});return{data:{path:a,fullPath:d.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Wt(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,r){return Mr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const s=Object.assign({},this.headers);r!=null&&r.upsert&&(s["x-upsert"]="true");const a=yield ds(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:s}),i=new URL(this.url+a.url),o=i.searchParams.get("token");if(!o)throw new Jx("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Wt(n))return{data:null,error:n};throw n}})}update(t,r,n){return Mr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Mr(this,void 0,void 0,function*(){try{return{data:yield ds(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}copy(t,r,n){return Mr(this,void 0,void 0,function*(){try{return{data:{path:(yield ds(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}createSignedUrl(t,r,n){return Mr(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),a=yield ds(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}createSignedUrls(t,r,n){return Mr(this,void 0,void 0,function*(){try{const s=yield ds(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${a}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}download(t,r){const s=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=a?`?${a}`:"",o=this._getFinalPath(t),c=()=>md(this.fetch,`${this.url}/${s}/${o}${i}`,{headers:this.headers,noResolveJson:!0});return new DR(c,this.shouldThrowOnError)}info(t){return Mr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield md(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:cm(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Wt(n))return{data:null,error:n};throw n}})}exists(t){return Mr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield RR(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Wt(n)&&n instanceof lm){const s=n.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),s=[],a=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";a!==""&&s.push(a);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${u}`)}}}remove(t){return Mr(this,void 0,void 0,function*(){try{return{data:yield Jb(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}})}list(t,r,n){return Mr(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},LR),r),{prefix:t||""});return{data:yield ds(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},n),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}listV2(t,r){return Mr(this,void 0,void 0,function*(){try{const n=Object.assign({},t);return{data:yield ds(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Wt(n))return{data:null,error:n};throw n}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const BR="2.75.1",UR={"X-Client-Info":`storage-js/${BR}`};var Zi=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class $R{constructor(t,r={},n,s){this.shouldThrowOnError=!1;const a=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},UR),r),this.fetch=Yb(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return Zi(this,void 0,void 0,function*(){try{return{data:yield md(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Wt(t))return{data:null,error:t};throw t}})}getBucket(t){return Zi(this,void 0,void 0,function*(){try{return{data:yield md(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}})}createBucket(t){return Zi(this,arguments,void 0,function*(r,n={public:!1}){try{return{data:yield ds(this.fetch,`${this.url}/bucket`,{id:r,name:r,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Wt(s))return{data:null,error:s};throw s}})}updateBucket(t,r){return Zi(this,void 0,void 0,function*(){try{return{data:yield um(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(Wt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return Zi(this,void 0,void 0,function*(){try{return{data:yield ds(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return Zi(this,void 0,void 0,function*(){try{return{data:yield Jb(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Wt(r))return{data:null,error:r};throw r}})}}class zR extends $R{constructor(t,r={},n,s){super(t,r,n,s)}from(t){return new MR(this.url,this.headers,t,this.fetch)}}const WR="2.75.1";let Ul="";typeof Deno<"u"?Ul="deno":typeof document<"u"?Ul="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ul="react-native":Ul="node";const VR={"X-Client-Info":`supabase-js-${Ul}/${WR}`},HR={headers:VR},GR={schema:"public"},qR={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},KR={};var XR=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};const YR=e=>{let t;return e?t=e:typeof fetch>"u"?t=Db:t=fetch,(...r)=>t(...r)},JR=()=>typeof Headers>"u"?Lb:Headers,QR=(e,t,r)=>{const n=YR(r),s=JR();return(a,i)=>XR(void 0,void 0,void 0,function*(){var o;const c=(o=yield t())!==null&&o!==void 0?o:e;let u=new s(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),n(a,Object.assign(Object.assign({},i),{headers:u}))})};var ZR=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};function eF(e){return e.endsWith("/")?e:e+"/"}function tF(e,t){var r,n;const{db:s,auth:a,realtime:i,global:o}=e,{db:c,auth:u,realtime:f,global:d}=t,h={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),a),realtime:Object.assign(Object.assign({},f),i),storage:{},global:Object.assign(Object.assign(Object.assign({},d),o),{headers:Object.assign(Object.assign({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>ZR(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}function rF(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(eF(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const Zb="2.75.1",fo=30*1e3,fm=3,bh=fm*fo,nF="http://localhost:9999",sF="supabase.auth.token",aF={"X-Client-Info":`gotrue-js/${Zb}`},dm="X-Supabase-Api-Version",eS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},iF=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,oF=10*60*1e3;class Ic extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Ne(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class lF extends Ic{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function cF(e){return Ne(e)&&e.name==="AuthApiError"}class li extends Ic{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class Va extends Ic{constructor(t,r,n,s){super(t,n,s),this.name=r,this.status=n}}class la extends Va{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function uF(e){return Ne(e)&&e.name==="AuthSessionMissingError"}class eo extends Va{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Ju extends Va{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Qu extends Va{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function fF(e){return Ne(e)&&e.name==="AuthImplicitGrantRedirectError"}class K1 extends Va{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class hm extends Va{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Sh(e){return Ne(e)&&e.name==="AuthRetryableFetchError"}class X1 extends Va{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class pm extends Va{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const xd="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Y1=` 	
\r=`.split(""),dF=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<Y1.length;t+=1)e[Y1[t].charCodeAt(0)]=-2;for(let t=0;t<xd.length;t+=1)e[xd[t].charCodeAt(0)]=t;return e})();function J1(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(xd[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(xd[n]),t.queuedBits-=6}}function tS(e,t,r){const n=dF[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function Q1(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=i=>{mF(i,n,r)};for(let i=0;i<e.length;i+=1)tS(e.charCodeAt(i),s,a);return t.join("")}function hF(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function pF(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const s=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|s)+65536,r+=1}hF(n,t)}}function mF(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function Do(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)tS(e.charCodeAt(s),r,n);return new Uint8Array(t)}function xF(e){const t=[];return pF(e,r=>t.push(r)),new Uint8Array(t)}function hi(e){const t=[],r={queue:0,queuedBits:0},n=s=>{t.push(s)};return e.forEach(s=>J1(s,r,n)),J1(null,r,n),t.join("")}function gF(e){return Math.round(Date.now()/1e3)+e}function vF(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const Jr=()=>typeof window<"u"&&typeof document<"u",ti={tested:!1,writable:!1},rS=()=>{if(!Jr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(ti.tested)return ti.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ti.tested=!0,ti.writable=!0}catch{ti.tested=!0,ti.writable=!1}return ti.writable};function wF(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((s,a)=>{t[a]=s})}catch{}return r.searchParams.forEach((n,s)=>{t[s]=n}),t}const nS=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>ou(async()=>{const{default:n}=await Promise.resolve().then(()=>ul);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},yF=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",ho=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ri=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},aa=async(e,t)=>{await e.removeItem(t)};class u0{constructor(){this.promise=new u0.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}u0.promiseConstructor=Promise;function kh(e){const t=e.split(".");if(t.length!==3)throw new pm("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!iF.test(t[n]))throw new pm("JWT not in base64url format");return{header:JSON.parse(Q1(t[0])),payload:JSON.parse(Q1(t[1])),signature:Do(t[2]),raw:{header:t[0],payload:t[1]}}}async function _F(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function bF(e,t){return new Promise((n,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await e(a);if(!t(a,null,i)){n(i);return}}catch(i){if(!t(a,i)){s(i);return}}})()})}function SF(e){return("0"+e.toString(16)).substr(-2)}function kF(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let s="";for(let a=0;a<56;a++)s+=r.charAt(Math.floor(Math.random()*n));return s}return crypto.getRandomValues(t),Array.from(t,SF).join("")}async function EF(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),s=new Uint8Array(n);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function TF(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await EF(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function to(e,t,r=!1){const n=kF();let s=n;r&&(s+="/PASSWORD_RECOVERY"),await ho(e,`${t}-code-verifier`,s);const a=await TF(n);return[a,n===a?"plain":"s256"]}const NF=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function CF(e){const t=e.headers.get(dm);if(!t||!t.match(NF))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function AF(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function jF(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const PF=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ro(e){if(!PF.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Eh(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Z1(e){return JSON.parse(JSON.stringify(e))}var RF=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};const ai=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),FF=[502,503,504];async function ew(e){var t;if(!yF(e))throw new hm(ai(e),0);if(FF.includes(e.status))throw new hm(ai(e),e.status);let r;try{r=await e.json()}catch(a){throw new li(ai(a),a)}let n;const s=CF(e);if(s&&s.getTime()>=eS["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new X1(ai(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new la}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new X1(ai(r),e.status,r.weak_password.reasons);throw new lF(ai(r),e.status||500,n)}const OF=(e,t,r,n)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(n),Object.assign(Object.assign({},s),r))};async function Me(e,t,r,n){var s;const a=Object.assign({},n==null?void 0:n.headers);a[dm]||(a[dm]=eS["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const i=(s=n==null?void 0:n.query)!==null&&s!==void 0?s:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await IF(e,t,r+o,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(c):{data:Object.assign({},c),error:null}}async function IF(e,t,r,n,s,a){const i=OF(t,n,s,a);let o;try{o=await e(r,Object.assign({},i))}catch(c){throw console.error(c),new hm(ai(c),0)}if(o.ok||await ew(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(c){await ew(c)}}function Bn(e){var t;let r=null;MF(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=gF(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function tw(e){const t=Bn(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function pa(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function DF(e){return{data:e,error:null}}function LF(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a}=e,i=RF(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:s,verification_type:a},c=Object.assign({},i);return{data:{properties:o,user:c},error:null}}function rw(e){return e}function MF(e){return e.access_token&&e.refresh_token&&e.expires_in}const Th=["global","local","others"];var BF=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class UF{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=nS(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=Th[0]){if(Th.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Th.join(", ")}`);try{return await Me(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Ne(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Me(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:pa})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=BF(t,["options"]),s=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(s.new_email=n==null?void 0:n.newEmail,delete s.newEmail),await Me(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:LF,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Ne(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Me(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:pa})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,s,a,i,o,c;try{const u={nextPage:null,lastPage:0,total:0},f=await Me(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:rw});if(f.error)throw f.error;const d=await f.json(),h=(i=f.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(c=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);u[`${x}Page`]=m}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(Ne(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){ro(t);try{return await Me(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:pa})}catch(r){if(Ne(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){ro(t);try{return await Me(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:pa})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){ro(t);try{return await Me(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:pa})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){ro(t.userId);try{const{data:r,error:n}=await Me(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:r,error:n}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _deleteFactor(t){ro(t.userId),ro(t.id);try{return{data:await Me(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,s,a,i,o,c;try{const u={nextPage:null,lastPage:0,total:0},f=await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:rw});if(f.error)throw f.error;const d=await f.json(),h=(i=f.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(c=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&c!==void 0?c:[];return p.length>0&&(p.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(g.split(";")[1].split("=")[1]);u[`${x}Page`]=m}),u.total=parseInt(h)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(Ne(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Me(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await Me(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Me(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}}function nw(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const no={debug:!!(globalThis&&rS()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class sS extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class $F extends sS{}async function zF(e,t,r){no.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),no.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async s=>{if(s){no.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{no.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw no.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new $F(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(no.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function WF(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function aS(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function VF(e){return parseInt(e,16)}function HF(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function GF(e){var t;const{chainId:r,domain:n,expirationTime:s,issuedAt:a=new Date,nonce:i,notBefore:o,requestId:c,resources:u,scheme:f,uri:d,version:h}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(h!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const p=aS(e.address),g=f?`${f}://${n}`:n,m=e.statement?`${e.statement}
`:"",x=`${g} wants you to sign in with your Ethereum account:
${p}

${m}`;let y=`URI: ${d}
Version: ${h}
Chain ID: ${r}${i?`
Nonce: ${i}`:""}
Issued At: ${a.toISOString()}`;if(s&&(y+=`
Expiration Time: ${s.toISOString()}`),o&&(y+=`
Not Before: ${o.toISOString()}`),c&&(y+=`
Request ID: ${c}`),u){let w=`
Resources:`;for(const v of u){if(!v||typeof v!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${v}`);w+=`
- ${v}`}y+=w}return`${x}
${y}`}class zt extends Error{constructor({message:t,code:r,cause:n,name:s}){var a;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=s??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class gd extends zt{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function qF({error:e,options:t}){var r,n,s;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new zt({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new zt({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new zt({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new zt({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new zt({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new zt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new zt({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new zt({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(oS(i)){if(a.rp.id!==i)return new zt({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new zt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new zt({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new zt({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new zt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function KF({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new zt({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new zt({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(oS(n)){if(r.rpId!==n)return new zt({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new zt({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new zt({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new zt({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}var iS=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r};class XF{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const YF=new XF;function JF(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,s=iS(e,["challenge","user","excludeCredentials"]),a=Do(t).buffer,i=Object.assign(Object.assign({},r),{id:Do(r.id).buffer}),o=Object.assign(Object.assign({},s),{challenge:a,user:i});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let c=0;c<n.length;c++){const u=n[c];o.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:Do(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function QF(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=iS(e,["challenge","allowCredentials"]),s=Do(t).buffer,a=Object.assign(Object.assign({},n),{challenge:s});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let i=0;i<r.length;i++){const o=r[i];a.allowCredentials[i]=Object.assign(Object.assign({},o),{id:Do(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return a}function ZF(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:hi(new Uint8Array(e.response.attestationObject)),clientDataJSON:hi(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function eO(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:hi(new Uint8Array(s.authenticatorData)),clientDataJSON:hi(new Uint8Array(s.clientDataJSON)),signature:hi(new Uint8Array(s.signature)),userHandle:s.userHandle?hi(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function oS(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function sw(){var e,t;return!!(Jr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function tO(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new gd("Browser returned unexpected credential type",t)}:{data:null,error:new gd("Empty credential response",t)}}catch(t){return{data:null,error:qF({error:t,options:e})}}}async function rO(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new gd("Browser returned unexpected credential type",t)}:{data:null,error:new gd("Empty credential response",t)}}catch(t){return{data:null,error:KF({error:t,options:e})}}}const nO={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},sO={userVerification:"preferred",hints:["security-key"]};function vd(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),r=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),n={};for(const s of e)if(s)for(const a in s){const i=s[a];if(i!==void 0)if(Array.isArray(i))n[a]=i;else if(r(i))n[a]=i;else if(t(i)){const o=n[a];t(o)?n[a]=vd(o,i):n[a]=vd(i)}else n[a]=i}return n}function aO(e,t){return vd(nO,e,t||{})}function iO(e,t){return vd(sO,e,t||{})}class oO{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:s},a){try{const{data:i,error:o}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!i)return{data:null,error:o};const c=s??YF.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:u}=i.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${n}`),u.displayName||(u.displayName=u.name)}switch(i.webauthn.type){case"create":{const u=aO(i.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:f,error:d}=await tO({publicKey:u,signal:c});return f?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:f}},error:null}:{data:null,error:d}}case"request":{const u=iO(i.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:f,error:d}=await rO(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:u,signal:c}));return f?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:f}},error:null}:{data:null,error:d}}}}catch(i){return Ne(i)?{data:null,error:i}:{data:null,error:new li("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s}},a){if(!r)return{data:null,error:new Ic("rpId is required for WebAuthn authentication")};try{if(!sw())return{data:null,error:new li("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:s},{request:a});if(!i)return{data:null,error:o};const{webauthn:c}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:c.type,rpId:r,rpOrigins:n,credential_response:c.credential_response}})}catch(i){return Ne(i)?{data:null,error:i}:{data:null,error:new li("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:s},a){if(!r)return{data:null,error:new Ic("rpId is required for WebAuthn registration")};try{if(!sw())return{data:null,error:new li("Browser does not support WebAuthn",null)};const{data:i,error:o}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(f=>{var d;return(d=f.data)===null||d===void 0?void 0:d.all.find(h=>h.factor_type==="webauthn"&&h.friendly_name===t&&h.status!=="unverified")}).then(f=>f?this.client.mfa.unenroll({factorId:f==null?void 0:f.id}):void 0),{data:null,error:o};const{data:c,error:u}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:s},{create:a});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:r,rpOrigins:n,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(i){return Ne(i)?{data:null,error:i}:{data:null,error:new li("Unexpected error in register",i)}}}}WF();const lO={url:nF,storageKey:sF,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:aF,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function aw(e,t,r){return await r()}const so={};class Dc{get jwks(){var t,r;return(r=(t=so[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){so[this.storageKey]=Object.assign(Object.assign({},so[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=so[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){so[this.storageKey]=Object.assign(Object.assign({},so[this.storageKey]),{cachedAt:t})}constructor(t){var r,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Dc.nextInstanceID,Dc.nextInstanceID+=1,this.instanceID>0&&Jr()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},lO),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new UF({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=nS(s.fetch),this.lock=s.lock||aw,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:Jr()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=zF:this.lock=aw,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new oO(this)},this.persistSession?(s.storage?this.storage=s.storage:rS()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=nw(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=nw(this.memoryStorage)),Jr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async a=>{this._debug("received broadcast notification from other tab or client",a),await this._notifyAllSubscribers(a.data.event,a.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Zb}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=wF(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),Jr()&&this.detectSessionInUrl&&n!=="none"){const{data:s,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),fF(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Ne(r)?{error:r}:{error:new li("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,s;try{const a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Bn}),{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(Ne(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(t){var r,n,s;try{let a;if("email"in t){const{email:f,password:d,options:h}=t;let p=null,g=null;this.flowType==="pkce"&&([p,g]=await to(this.storage,this.storageKey)),a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:f,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:g},xform:Bn})}else if("phone"in t){const{phone:f,password:d,options:h}=t;a=await Me(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Bn})}else throw new Ju("You must provide either an email or phone number and a password");const{data:i,error:o}=a;if(o||!i)return{data:{user:null,session:null},error:o};const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(a){if(Ne(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:i,options:o}=t;r=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:tw})}else if("phone"in t){const{phone:a,password:i,options:o}=t;r=await Me(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:tw})}else throw new Ju("You must provide either an email or phone number and a password");const{data:n,error:s}=r;return s?{data:{user:null,session:null},error:s}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new eo}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:s})}catch(r){if(Ne(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,s,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,s,a,i,o,c,u,f,d,h;let p,g;if("message"in t)p=t.message,g=t.signature;else{const{chain:m,wallet:x,statement:y,options:w}=t;let v;if(Jr())if(typeof x=="object")v=x;else{const A=window;if("ethereum"in A&&typeof A.ethereum=="object"&&"request"in A.ethereum&&typeof A.ethereum.request=="function")v=A.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");v=x}const S=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href),E=await v.request({method:"eth_requestAccounts"}).then(A=>A).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!E||E.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const k=aS(E[0]);let b=(n=w==null?void 0:w.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!b){const A=await v.request({method:"eth_chainId"});b=VF(A)}const N={domain:S.host,address:k,statement:y,uri:S.href,version:"1",chainId:b,nonce:(s=w==null?void 0:w.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(i=(a=w==null?void 0:w.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(o=w==null?void 0:w.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(c=w==null?void 0:w.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=w==null?void 0:w.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(f=w==null?void 0:w.signInWithEthereum)===null||f===void 0?void 0:f.resources};p=GF(N),g=await v.request({method:"personal_sign",params:[HF(p),k]})}try{const{data:m,error:x}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:g},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:Bn});if(x)throw x;return!m||!m.session||!m.user?{data:{user:null,session:null},error:new eo}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),{data:Object.assign({},m),error:x})}catch(m){if(Ne(m))return{data:{user:null,session:null},error:m};throw m}}async signInWithSolana(t){var r,n,s,a,i,o,c,u,f,d,h,p;let g,m;if("message"in t)g=t.message,m=t.signature;else{const{chain:x,wallet:y,statement:w,options:v}=t;let S;if(Jr())if(typeof y=="object")S=y;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))S=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(v!=null&&v.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=y}const E=new URL((r=v==null?void 0:v.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in S&&S.signIn){const k=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},v==null?void 0:v.signInWithSolana),{version:"1",domain:E.host,uri:E.href}),w?{statement:w}:null));let b;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")b=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)b=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in b&&"signature"in b&&(typeof b.signedMessage=="string"||b.signedMessage instanceof Uint8Array)&&b.signature instanceof Uint8Array)g=typeof b.signedMessage=="string"?b.signedMessage:new TextDecoder().decode(b.signedMessage),m=b.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${E.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${E.href}`,`Issued At: ${(s=(n=v==null?void 0:v.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=v==null?void 0:v.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${v.signInWithSolana.notBefore}`]:[],...!((i=v==null?void 0:v.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${v.signInWithSolana.expirationTime}`]:[],...!((o=v==null?void 0:v.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${v.signInWithSolana.chainId}`]:[],...!((c=v==null?void 0:v.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${v.signInWithSolana.nonce}`]:[],...!((u=v==null?void 0:v.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${v.signInWithSolana.requestId}`]:[],...!((d=(f=v==null?void 0:v.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||d===void 0)&&d.length?["Resources",...v.signInWithSolana.resources.map(b=>`- ${b}`)]:[]].join(`
`);const k=await S.signMessage(new TextEncoder().encode(g),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=k}}try{const{data:x,error:y}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:hi(m)},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Bn});if(y)throw y;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new eo}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:y})}catch(x){if(Ne(x))return{data:{user:null,session:null},error:x};throw x}}async _exchangeCodeForSession(t){const r=await ri(this.storage,`${this.storageKey}-code-verifier`),[n,s]=(r??"").split("/");try{const{data:a,error:i}=await Me(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Bn});if(await aa(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!a||!a.session||!a.user?{data:{user:null,session:null,redirectType:null},error:new eo}:(a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:i})}catch(a){if(Ne(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:s,access_token:a,nonce:i}=t,o=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:s,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Bn}),{data:c,error:u}=o;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new eo}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(r){if(Ne(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,s,a,i;try{if("email"in t){const{email:o,options:c}=t;let u=null,f=null;this.flowType==="pkce"&&([u,f]=await to(this.storage,this.storageKey));const{error:d}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(n=c==null?void 0:c.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:f},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in t){const{phone:o,options:c}=t,{data:u,error:f}=await Me(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:f}}throw new Ju("You must provide either an email or phone number.")}catch(o){if(Ne(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let s,a;"options"in t&&(s=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await Me(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:Bn});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(Ne(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var r,n,s;try{let a=null,i=null;return this.flowType==="pkce"&&([a,i]=await to(this.storage,this.storageKey)),await Me(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:DF})}catch(a){if(Ne(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new la;const{error:s}=await Me(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Ne(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:s,options:a}=t,{error:i}=await Me(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:s,options:a}=t,{data:i,error:o}=await Me(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new Ju("You must provide either an email or phone number and a type")}catch(r){if(Ne(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ri(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<bh:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const i=await ri(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=Eh()}if(this.storage.isServer&&t.user){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,f)=>(!i&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,f))})}return{data:{session:t},error:null}}const{data:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:pa}):await this._useSession(async r=>{var n,s,a;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new la}:await Me(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:pa})})}catch(r){if(Ne(r))return uF(r)&&(await this._removeSession(),await aa(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:s,error:a}=n;if(a)throw a;if(!s.session)throw new la;const i=s.session;let o=null,c=null;this.flowType==="pkce"&&t.email!=null&&([o,c]=await to(this.storage,this.storageKey));const{data:u,error:f}=await Me(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:c}),jwt:i.access_token,xform:pa});if(f)throw f;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Ne(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new la;const r=Date.now()/1e3;let n=r,s=!0,a=null;const{payload:i}=kh(t.access_token);if(i.exp&&(n=i.exp,s=n<=r),s){const{data:o,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(r){if(Ne(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new la;const{data:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?{data:{user:null,session:null},error:a}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Ne(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!Jr())throw new Qu("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Qu(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new K1("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Qu("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new K1("No code detected.");const{data:w,error:v}=await this._exchangeCodeForSession(t.code);if(v)throw v;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:s,access_token:a,refresh_token:i,expires_in:o,expires_at:c,token_type:u}=t;if(!a||!o||!i||!u)throw new Qu("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(o);let h=f+d;c&&(h=parseInt(c));const p=h-f;p*1e3<=fo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const g=h-d;f-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,f):f-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,f);const{data:m,error:x}=await this._getUser(a);if(x)throw x;const y={provider_token:n,provider_refresh_token:s,access_token:a,expires_in:d,expires_at:h,refresh_token:i,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:y,redirectType:t.type},error:null}}catch(n){if(Ne(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ri(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{error:a};const i=(n=s.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(cF(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await aa(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=vF(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,s;try{const{data:{session:a},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,s=null;this.flowType==="pkce"&&([n,s]=await to(this.storage,this.storageKey,!0));try{return await Me(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:s,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(Ne(a))return{data:null,error:a};throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:s}=await this._useSession(async a=>{var i,o,c,u,f;const{data:d,error:h}=a;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Me(this.fetch,"GET",p,{headers:this.headers,jwt:(f=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&f!==void 0?f:void 0})});if(s)throw s;return Jr()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Ne(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:s,data:{session:a}}=r;if(s)throw s;const{options:i,provider:o,token:c,access_token:u,nonce:f}=t,d=await Me(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a==null?void 0:a.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:c,access_token:u,nonce:f,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Bn}),{data:h,error:p}=d;return p?{data:{user:null,session:null},error:p}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new eo}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("USER_UPDATED",h.session)),{data:h,error:p})}catch(s){if(Ne(s))return{data:{user:null,session:null},error:s};throw s}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:i}=r;if(i)throw i;return await Me(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&s!==void 0?s:void 0})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await bF(async s=>(s>0&&await _F(200*Math.pow(2,s-1)),this._debug(r,"refreshing attempt",s),await Me(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Bn})),(s,a)=>{const i=200*Math.pow(2,s);return a&&Sh(a)&&Date.now()+i-n<fo})}catch(n){if(this._debug(r,"error",n),Ne(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),Jr()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const s=await ri(this.storage,this.storageKey);if(s&&this.userStorage){let i=await ri(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:s.user},await ho(this.userStorage,this.storageKey+"-user",i)),s.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:Eh()}else if(s&&!s.user&&!s.user){const i=await ri(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(s.user=i.user,await aa(this.storage,this.storageKey+"-user"),await ho(this.storage,this.storageKey,s)):s.user=Eh()}if(this._debug(n,"session from storage",s),!this._isValidSession(s)){this._debug(n,"session is not valid"),s!==null&&await this._removeSession();return}const a=((r=s.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<bh;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${bh}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),Sh(i)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:o}=await this._getUser(s.access_token);!o&&(i!=null&&i.user)?(s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(n,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(n,"error",s),console.error(s);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new la;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new u0;const{data:a,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!a.session)throw new la;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={data:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(s,"error",a),Ne(a)){const i={data:null,error:a};return Sh(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,r,n=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(c){a.push(c)}});if(await Promise.all(i),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await ho(this.userStorage,this.storageKey+"-user",{user:r.user});const s=Object.assign({},r);delete s.user;const a=Z1(s);await ho(this.storage,this.storageKey,a)}else{const s=Z1(r);await ho(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await aa(this.storage,this.storageKey),await aa(this.storage,this.storageKey+"-code-verifier"),await aa(this.storage,this.storageKey+"-user"),this.userStorage&&await aa(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&Jr()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),fo);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((n.expires_at*1e3-t)/fo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${fo}ms, refresh threshold is ${fm} ticks`),s<=fm&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof sS)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Jr()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const s=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&s.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&s.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,i]=await to(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(o.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);s.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&s.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;return a?{data:null,error:a}:await Me(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,s;const{data:a,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await Me(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&c.type==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{data:null,error:a};const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?ZF(t.webauthn.credential_response):eO(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:c}=await Me(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:c})})}catch(r){if(Ne(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:s,error:a}=r;if(a)return{data:null,error:a};const i=await Me(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});if(i.error)return i;const{data:o}=i;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:JF(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:QF(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Ne(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:s},error:a}=t;if(a)return{data:null,error:a};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=kh(s.access_token);let o=null;i.aal&&(o=i.aal);let c=o;((n=(r=s.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(c="aal2");const f=i.amr||[];return{data:{currentLevel:o,nextLevel:c,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const s=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+oF>s)return n;const{data:a,error:i}=await Me(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,n=a.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:p,error:g}=await this.getSession();if(g||!p.session)return{data:null,error:g};n=p.session.access_token}const{header:s,payload:a,signature:i,raw:{header:o,payload:c}}=kh(n);r!=null&&r.allowExpired||AF(a.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:a,header:s,signature:i},error:null}}const f=jF(s.alg),d=await crypto.subtle.importKey("jwk",u,f,!0,["verify"]);if(!await crypto.subtle.verify(f,d,i,xF(`${o}.${c}`)))throw new pm("Invalid JWT signature");return{data:{claims:a,header:s,signature:i},error:null}}catch(n){if(Ne(n))return{data:null,error:n};throw n}}}Dc.nextInstanceID=0;const cO=Dc;class uO extends cO{constructor(t){super(t)}}var fO=function(e,t,r,n){function s(a){return a instanceof r?a:new r(function(i){i(a)})}return new(r||(r=Promise))(function(a,i){function o(f){try{u(n.next(f))}catch(d){i(d)}}function c(f){try{u(n.throw(f))}catch(d){i(d)}}function u(f){f.done?a(f.value):s(f.value).then(o,c)}u((n=n.apply(e,t||[])).next())})};class dO{constructor(t,r,n){var s,a,i;this.supabaseUrl=t,this.supabaseKey=r;const o=rF(t);if(!r)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",o),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",o),this.storageUrl=new URL("storage/v1",o),this.functionsUrl=new URL("functions/v1",o);const c=`sb-${o.hostname.split(".")[0]}-auth-token`,u={db:GR,realtime:KR,auth:Object.assign(Object.assign({},qR),{storageKey:c}),global:HR},f=tF(n??{},u);this.storageKey=(s=f.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=f.global.headers)!==null&&a!==void 0?a:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=f.auth)!==null&&i!==void 0?i:{},this.headers,f.global.fetch),this.fetch=QR(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new lR(new URL("rest/v1",o).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new zR(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new UP(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return fO(this,void 0,void 0,function*(){var t,r;if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:a,storageKey:i,flowType:o,lock:c,debug:u},f,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new uO({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),f),storageKey:i,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:s,userStorage:a,flowType:o,lock:c,debug:u,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(p=>p.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new ER(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const hO=(e,t,r)=>new dO(e,t,r);function pO(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}pO()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const mO="https://ubjttptjigwbjwqyiwmi.supabase.co",xO="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVianR0cHRqaWd3Ymp3cXlpd21pIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2MTI2NjgsImV4cCI6MjA3NjE4ODY2OH0.ZtCjm5IaMPRGoQpXu6L2iM7TzCPdGEL8iru2UQdpvLA",ge=hO(mO,xO,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}}),lS=_.createContext(void 0),gO=({children:e})=>{const[t,r]=_.useState(null),n=async u=>{try{const{data:f,error:d}=await ge.from("players").select("id, full_name, email, cssbattle_profile_link, group_name, phone, video_completed").eq("id",u.user.id).single();if(d){console.error("AuthContext - Error fetching player profile:",d);const{data:p,error:g}=await ge.from("players").select("id, full_name, email, cssbattle_profile_link, group_name, phone, video_completed").eq("email",u.user.email).single();if(g)return console.error("AuthContext - Error fetching by email:",g),{id:u.user.id,email:u.user.email,full_name:u.user.email,email_confirmed_at:u.user.email_confirmed_at,video_completed:!1,unreadMessageCount:0};const m=p}const h=await s(f.email);return{id:f.id,email:f.email,full_name:f.full_name||"",cssbattle_profile_link:f.cssbattle_profile_link||void 0,email_confirmed_at:u.user.email_confirmed_at,group_name:f.group_name||void 0,phone:f.phone||void 0,video_completed:f.video_completed||!1,unreadMessageCount:h}}catch(f){return console.error("AuthContext - Error in fetchUserProfile:",f),{id:u.user.id,email:u.user.email,full_name:u.user.email,email_confirmed_at:u.user.email_confirmed_at,video_completed:!1,unreadMessageCount:0}}},s=async u=>{if(!u)return 0;try{const{count:f,error:d}=await ge.from("contact_messages").select("*",{count:"exact",head:!0}).eq("recipient_email",u).eq("status","unread");return!d&&f!==null?f:0}catch(f){return console.error("Error fetching unread message count:",f),0}};_.useEffect(()=>{let u=!0;(async()=>{try{const{data:{session:p}}=await ge.auth.getSession();if(p!=null&&p.user&&u){if(localStorage.getItem("hardcoded_admin")){await ge.auth.signOut(),u&&r(null);return}const m=await n(p);r(m)}}catch(p){console.error("Error initializing auth:",p)}})();const{data:{subscription:d}}=ge.auth.onAuthStateChange((p,g)=>{if(!u)return;if(localStorage.getItem("hardcoded_admin")&&(g!=null&&g.user)){ge.auth.signOut(),u&&r(null);return}g!=null&&g.user?n(g).then(x=>{u&&r(x)}):u&&r(null)}),h=()=>{t!=null&&t.email&&s(t.email).then(p=>{u&&r(g=>g?{...g,unreadMessageCount:p}:null)})};return window.addEventListener("playerMessagesRead",h),()=>{u=!1,d==null||d.unsubscribe(),window.removeEventListener("playerMessagesRead",h)}},[t==null?void 0:t.email]);const a=async(u,f)=>{try{const{data:d,error:h}=await ge.auth.signInWithPassword({email:u,password:f});if(h)return{success:!1,error:h.message};if(d.user){if(!d.user.email_confirmed_at)return{success:!1,error:"Please verify your email before logging in.",emailVerified:!1};const p=await n(d.session);return r(p),{success:!0}}return{success:!1,error:"Login failed"}}catch(d){return{success:!1,error:d.message}}},i=async()=>{try{await ge.auth.signOut(),r(null)}catch(u){console.error("Error during logout:",u)}},o=async u=>{try{const{data:f,error:d}=await ge.auth.signUp({email:u.email,password:u.password,options:{emailRedirectTo:window.location.origin}});if(d)return{success:!1,error:d.message};if(f.user){if(u.cssLink){const{data:p,error:g}=await ge.from("players").select("id, full_name").eq("cssbattle_profile_link",u.cssLink);if(g)return{success:!1,error:`Database error: ${g.message}`};if(p&&p.length>0)return{success:!1,error:"CSS Battle link is already in use by another player"}}const{error:h}=await ge.from("players").insert([{id:f.user.id,full_name:u.fullName,email:u.email,cssbattle_profile_link:u.cssLink||null,group_name:u.group,phone:u.phone||null,score:0}]);return h?(console.error("AuthContext - Insert error:",h),{success:!1,error:h.message}):(console.log("AuthContext - Player registered successfully"),{success:!0,requiresEmailVerification:!0})}return{success:!1,error:"Registration failed"}}catch(f){return console.error("AuthContext - Registration error:",f),{success:!1,error:f.message}}},c=async()=>{const{data:{session:u}}=await ge.auth.getSession();return u!=null&&u.user?{isVerified:!!u.user.email_confirmed_at}:{isVerified:!1}};return l.jsx(lS.Provider,{value:{user:t,login:a,logout:i,register:o,checkEmailVerification:c},children:e})},mn=()=>{const e=_.useContext(lS);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},cS=_.createContext(void 0),vO=({children:e})=>{const[t,r]=_.useState(null),[n,s]=_.useState(!1),[a,i]=_.useState(!0),[o,c]=_.useState(0);_.useEffect(()=>{let d=!0;(async()=>{try{const m=localStorage.getItem("hardcoded_admin");if(m)try{const x=JSON.parse(m);d&&(r(x),s(!0))}catch(x){console.error("Invalid admin data in localStorage:",x),localStorage.removeItem("hardcoded_admin")}}catch(m){console.error("Error initializing admin:",m)}finally{d&&i(!1)}})();const p=m=>{if(!(!d||m.key!=="hardcoded_admin"))if(m.newValue)try{const x=JSON.parse(m.newValue);d&&(r(x),s(!0))}catch(x){console.error("Invalid admin data:",x),localStorage.removeItem("hardcoded_admin")}else d&&(r(null),s(!1))};window.addEventListener("storage",p);const{data:{subscription:g}}=ge.auth.onAuthStateChange(async(m,x)=>{if(d){if(x!=null&&x.user){const y=localStorage.getItem("hardcoded_admin");if(y)try{const w=JSON.parse(y);d&&(r(w),s(!0));return}catch(w){console.error("Invalid admin data:",w),localStorage.removeItem("hardcoded_admin")}try{const{data:w,error:v}=await ge.from("user_roles").select("role").eq("user_id",x.user.id).eq("role","admin").maybeSingle();!v&&w&&d?(r(x.user),s(!0)):d&&(r(null),s(!1))}catch(w){console.error("Error checking admin role:",w),d&&(r(null),s(!1))}}else if(d){const y=localStorage.getItem("hardcoded_admin");if(y)try{const w=JSON.parse(y);d&&(r(w),s(!0))}catch(w){console.error("Invalid admin data:",w),localStorage.removeItem("hardcoded_admin")}else r(null),s(!1)}}});return()=>{d=!1,g==null||g.unsubscribe(),window.removeEventListener("storage",p)}},[]);const u=async()=>{if(t!=null&&t.email)try{const{count:d,error:h}=await ge.from("contact_messages").select("*",{count:"exact",head:!0}).eq("recipient_email",t.email).eq("status","unread");!h&&d!==null&&c(d)}catch(d){console.error("Error fetching unread message count:",d)}},f=async()=>{localStorage.removeItem("hardcoded_admin"),r(null),s(!1),c(0)};return _.useEffect(()=>{n&&(t!=null&&t.email)&&u()},[n,t==null?void 0:t.email]),l.jsx(cS.Provider,{value:{admin:t,isAdmin:n,loading:a,unreadMessageCount:o,fetchUnreadMessageCount:u,logout:f},children:e})},Kr=()=>{const e=_.useContext(cS);if(e===void 0)throw new Error("useAdmin must be used within an AdminProvider");return e},uS=_.createContext(void 0),iw={en:{"navbar.home":"Home","navbar.leaderboard":"Leaderboard","navbar.learning":"Learning","navbar.contact":"Contact","navbar.dashboard":"Dashboard","navbar.messages":"Messages","navbar.manageLearning":"Manage Learning","navbar.logout":"Logout","navbar.login":"Log in","navbar.register":"Sign up","navbar.institute":"Specialized Training Institute for Offshoring","learning.title":"Learning Center","learning.subtitle":"Master CSS Battle with our tutorials, quizzes, and learning resources","learning.video.title":"Video Tutorial","learning.quiz.title":"Knowledge Check","learning.quiz.videoRequired":"Video Required","learning.quiz.videoRequiredDesc":"Please complete the video tutorial first to unlock the quiz.","learning.quiz.watchVideo":"Watch Video","learning.quiz.completed":"Quiz Completed!","learning.quiz.score":"You scored {score}/{total}","learning.quiz.completedMessage":"Congratulations! You have successfully completed the quiz. This section will remain hidden even after you log out.","learning.quiz.question":"Question {current} of {total}","learning.quiz.submit":"Submit Answer","learning.quiz.next":"Next Question","learning.quiz.select":"Please select an answer","learning.quiz.selectDesc":"You need to choose an option before submitting.","learning.quiz.correct":"Correct!","learning.quiz.incorrect":"Incorrect","learning.resources.title":"Learning Resources","learning.resources.add":"Add Resource","learning.resources.accessDenied":"Access Denied","learning.resources.accessDeniedDesc":"Only administrators can upload resources.","learning.resources.missingInfo":"Missing Information","learning.resources.missingInfoDesc":"Please fill in all required fields for the resource.","learning.resources.missingFile":"Missing File or URL","learning.resources.missingFileDesc":"Please either select a file or provide a URL.","learning.resources.added":"Resource Added!","learning.resources.addedDesc":"Your learning resource has been added successfully.","learning.resources.adminOnly":"Only administrators can add new learning resources.","learning.resources.playerInfo":"Players can only view and download existing resources.","learning.resources.form.title":"Add New Resource","learning.resources.form.titleLabel":"Title *","learning.resources.form.typeLabel":"Resource Type","learning.resources.form.descLabel":"Description *","learning.resources.form.fileLabel":"Upload File (Optional)","learning.resources.form.urlLabel":"URL (Required if no file uploaded)","learning.video.completed":"Video Completed!","learning.video.completedDesc":"You've finished watching the tutorial. Now try the quiz!","learning.video.notCompleted":"Not completed","learning.video.reset":"Reset","learning.video.restricted":"Navigation Restricted","learning.video.restrictedDesc":"You can only navigate to parts of the video you've already watched.","learning.video.fullscreenError":"Fullscreen Error","learning.video.fullscreenErrorDesc":"Could not enter fullscreen mode.","learning.video.fullscreenExitErrorDesc":"Could not exit fullscreen mode.","learning.video.screenshotRestricted":"Action Restricted","learning.video.screenshotRestrictedDesc":"Screenshots are not allowed during learning.","learning.video.copyRestrictedDesc":"Copy/paste actions are not allowed during learning.","common.loading":"Loading...","common.error":"Error","common.success":"Success","common.cancel":"Cancel","common.save":"Save","common.delete":"Delete","common.edit":"Edit","common.view":"View","common.download":"Download","common.upload":"Upload","common.reset":"Reset","common.retry":"Retry","common.close":"Close","common.back":"Back","common.next":"Next","common.previous":"Previous","common.finish":"Finish","common.start":"Start","common.continue":"Continue","common.confirm":"Confirm","common.yes":"Yes","common.no":"No"},fr:{"navbar.home":"Accueil","navbar.leaderboard":"Classement","navbar.learning":"Apprentissage","navbar.contact":"Contact","navbar.dashboard":"Tableau de bord","navbar.messages":"Messages","navbar.manageLearning":"Gérer l'Apprentissage","navbar.logout":"Déconnexion","navbar.login":"Connexion","navbar.register":"S'inscrire","navbar.institute":"Institut Spécialisé de Formation de l'Offshoring","learning.title":"Centre d'Apprentissage","learning.subtitle":"Maîtrisez CSS Battle avec nos tutoriels, quiz et ressources d'apprentissage","learning.video.title":"Tutoriel Vidéo","learning.quiz.title":"Vérification des Connaissances","learning.quiz.videoRequired":"Vidéo Requise","learning.quiz.videoRequiredDesc":"Veuillez d'abord terminer le tutoriel vidéo pour débloquer le quiz.","learning.quiz.watchVideo":"Regarder la Vidéo","learning.quiz.completed":"Quiz Terminé !","learning.quiz.score":"Vous avez obtenu {score}/{total}","learning.quiz.completedMessage":"Félicitations ! Vous avez terminé avec succès le quiz. Cette section restera masquée même après votre déconnexion.","learning.quiz.question":"Question {current} sur {total}","learning.quiz.submit":"Soumettre la Réponse","learning.quiz.next":"Question Suivante","learning.quiz.select":"Veuillez sélectionner une réponse","learning.quiz.selectDesc":"Vous devez choisir une option avant de soumettre.","learning.quiz.correct":"Correct !","learning.quiz.incorrect":"Incorrect","learning.resources.title":"Ressources d'Apprentissage","learning.resources.add":"Ajouter une Ressource","learning.resources.accessDenied":"Accès Refusé","learning.resources.accessDeniedDesc":"Seuls les administrateurs peuvent télécharger des ressources.","learning.resources.missingInfo":"Informations Manquantes","learning.resources.missingInfoDesc":"Veuillez remplir tous les champs obligatoires pour la ressource.","learning.resources.missingFile":"Fichier ou URL Manquant","learning.resources.missingFileDesc":"Veuillez sélectionner un fichier ou fournir une URL.","learning.resources.added":"Ressource Ajoutée !","learning.resources.addedDesc":"Votre ressource d'apprentissage a été ajoutée avec succès.","learning.resources.adminOnly":"Seuls les administrateurs peuvent ajouter de nouvelles ressources d'apprentissage.","learning.resources.playerInfo":"Les joueurs ne peuvent que visualiser et télécharger les ressources existantes.","learning.resources.form.title":"Ajouter une Nouvelle Ressource","learning.resources.form.titleLabel":"Titre *","learning.resources.form.typeLabel":"Type de Ressource","learning.resources.form.descLabel":"Description *","learning.resources.form.fileLabel":"Télécharger un Fichier (Optionnel)","learning.resources.form.urlLabel":"URL (Requise si aucun fichier téléchargé)","learning.video.completed":"Vidéo Terminée !","learning.video.completedDesc":"Vous avez terminé de regarder le tutoriel. Maintenant, essayez le quiz !","learning.video.notCompleted":"Non terminé","learning.video.reset":"Réinitialiser","learning.video.restricted":"Navigation Restreinte","learning.video.restrictedDesc":"Vous ne pouvez naviguer que vers les parties de la vidéo que vous avez déjà regardées.","learning.video.fullscreenError":"Erreur Plein Écran","learning.video.fullscreenErrorDesc":"Impossible d'entrer en mode plein écran.","learning.video.fullscreenExitErrorDesc":"Impossible de quitter le mode plein écran.","learning.video.screenshotRestricted":"Action Restreinte","learning.video.screenshotRestrictedDesc":"Les captures d'écran ne sont pas autorisées pendant l'apprentissage.","learning.video.copyRestrictedDesc":"Les actions de copier/coller ne sont pas autorisées pendant l'apprentissage.","common.loading":"Chargement...","common.error":"Erreur","common.success":"Succès","common.cancel":"Annuler","common.save":"Sauvegarder","common.delete":"Supprimer","common.edit":"Modifier","common.view":"Voir","common.download":"Télécharger","common.upload":"Télécharger","common.reset":"Réinitialiser","common.retry":"Réessayer","common.close":"Fermer","common.back":"Retour","common.next":"Suivant","common.previous":"Précédent","common.finish":"Terminer","common.start":"Commencer","common.continue":"Continuer","common.confirm":"Confirmer","common.yes":"Oui","common.no":"Non"}},wO=({children:e})=>{const[t,r]=_.useState(()=>localStorage.getItem("language")||"en");_.useEffect(()=>{localStorage.setItem("language",t),document.documentElement.lang=t},[t]);const s={language:t,setLanguage:r,t:a=>{const i=iw[t][a]||iw.en[a]||a;return i.includes("{"),i}};return l.jsx(uS.Provider,{value:s,children:e})},Js=()=>{const e=_.useContext(uS);if(e===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return e},ow=()=>{const e=new Date().getHours();return e>=6&&e<18?"light":"dark"},lw=e=>{e==="dark"?(document.documentElement.classList.add("dark"),document.documentElement.classList.remove("light")):(document.documentElement.classList.remove("dark"),document.documentElement.classList.add("light"))},yO=()=>{const[e,t]=_.useState(()=>localStorage.getItem("theme-preference")||"auto"),[r,n]=_.useState("dark");_.useEffect(()=>{const i=e==="auto"?ow():e;n(i),lw(i)},[e]),_.useEffect(()=>{if(e==="auto"){const i=setInterval(()=>{const o=ow();o!==r&&(n(o),lw(o))},6e4);return()=>clearInterval(i)}},[e,r]);const s=i=>{t(i),localStorage.setItem("theme-preference",i)};return{themePreference:e,appliedTheme:r,setTheme:s,toggleTheme:()=>{s(e==="auto"?"light":e==="light"?"dark":"auto")}}},_O=e=>{const[t,r]=_.useState(0),[n,s]=_.useState(!0),a=async()=>{if(!e){r(0),s(!1);return}try{console.log("Fetching unread message count for:",e);const{count:o,error:c}=await ge.from("contact_messages").select("*",{count:"exact",head:!0}).eq("recipient_email",e).eq("status","unread");!c&&o!==null?(console.log("Unread message count:",o),r(o)):(console.log("No unread messages or error:",c),r(0))}catch(o){console.error("Error fetching unread message count:",o),r(0)}finally{s(!1)}},i=async()=>{if(e)try{const{error:o}=await ge.from("contact_messages").update({status:"read",updated_at:new Date().toISOString()}).eq("recipient_email",e).eq("status","unread");o||(r(0),console.log("Dispatching playerMessagesRead event from markMessagesAsRead"),window.dispatchEvent(new CustomEvent("playerMessagesRead")))}catch(o){console.error("Error marking messages as read:",o)}};return _.useEffect(()=>{if(!e){console.log("usePlayerMessages: No player email provided, skipping fetch"),r(0),s(!1);return}console.log("usePlayerMessages: Initializing for player email:",e),a();const o=()=>{console.log("Received playerMessagesRead event in usePlayerMessages, refreshing count"),a()};window.addEventListener("playerMessagesRead",o);const c=setInterval(()=>{console.log("Periodic refresh of player message count"),a()},3e4);return()=>{window.removeEventListener("playerMessagesRead",o),clearInterval(c)}},[e]),{unreadCount:t,loading:n,fetchUnreadCount:a,markMessagesAsRead:i}};function Ce(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e==null||e(s),r===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function bO(e,t){const r=_.createContext(t),n=a=>{const{children:i,...o}=a,c=_.useMemo(()=>o,Object.values(o));return l.jsx(r.Provider,{value:c,children:i})};n.displayName=e+"Provider";function s(a){const i=_.useContext(r);if(i)return i;if(t!==void 0)return t;throw new Error(`\`${a}\` must be used within \`${e}\``)}return[n,s]}function Ha(e,t=[]){let r=[];function n(a,i){const o=_.createContext(i),c=r.length;r=[...r,i];const u=d=>{var y;const{scope:h,children:p,...g}=d,m=((y=h==null?void 0:h[e])==null?void 0:y[c])||o,x=_.useMemo(()=>g,Object.values(g));return l.jsx(m.Provider,{value:x,children:p})};u.displayName=a+"Provider";function f(d,h){var m;const p=((m=h==null?void 0:h[e])==null?void 0:m[c])||o,g=_.useContext(p);if(g)return g;if(i!==void 0)return i;throw new Error(`\`${d}\` must be used within \`${a}\``)}return[u,f]}const s=()=>{const a=r.map(i=>_.createContext(i));return function(o){const c=(o==null?void 0:o[e])||a;return _.useMemo(()=>({[`__scope${e}`]:{...o,[e]:c}}),[o,c])}};return s.scopeName=e,[n,SO(s,...t)]}function SO(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(a){const i=n.reduce((o,{useScope:c,scopeName:u})=>{const d=c(a)[`__scope${u}`];return{...o,...d}},{});return _.useMemo(()=>({[`__scope${t.scopeName}`]:i}),[i])}};return r.scopeName=t.scopeName,r}var Lt=globalThis!=null&&globalThis.document?_.useLayoutEffect:()=>{},kO=Ym[" useInsertionEffect ".trim().toString()]||Lt;function Qo({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[s,a,i]=EO({defaultProp:t,onChange:r}),o=e!==void 0,c=o?e:s;{const f=_.useRef(e!==void 0);_.useEffect(()=>{const d=f.current;d!==o&&console.warn(`${n} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),f.current=o},[o,n])}const u=_.useCallback(f=>{var d;if(o){const h=TO(f)?f(e):f;h!==e&&((d=i.current)==null||d.call(i,h))}else a(f)},[o,e,a,i]);return[c,u]}function EO({defaultProp:e,onChange:t}){const[r,n]=_.useState(e),s=_.useRef(r),a=_.useRef(t);return kO(()=>{a.current=t},[t]),_.useEffect(()=>{var i;s.current!==r&&((i=a.current)==null||i.call(a,r),s.current=r)},[r,s]),[r,n,a]}function TO(e){return typeof e=="function"}var NO=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Le=NO.reduce((e,t)=>{const r=Ti(`Primitive.${t}`),n=_.forwardRef((s,a)=>{const{asChild:i,...o}=s,c=i?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),l.jsx(c,{...o,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function uu(e,t){e&&Ui.flushSync(()=>e.dispatchEvent(t))}function f0(e){const t=e+"CollectionProvider",[r,n]=Ha(t),[s,a]=r(t,{collectionRef:{current:null},itemMap:new Map}),i=m=>{const{scope:x,children:y}=m,w=oa.useRef(null),v=oa.useRef(new Map).current;return l.jsx(s,{scope:x,itemMap:v,collectionRef:w,children:y})};i.displayName=t;const o=e+"CollectionSlot",c=Ti(o),u=oa.forwardRef((m,x)=>{const{scope:y,children:w}=m,v=a(o,y),S=Ye(x,v.collectionRef);return l.jsx(c,{ref:S,children:w})});u.displayName=o;const f=e+"CollectionItemSlot",d="data-radix-collection-item",h=Ti(f),p=oa.forwardRef((m,x)=>{const{scope:y,children:w,...v}=m,S=oa.useRef(null),E=Ye(x,S),k=a(f,y);return oa.useEffect(()=>(k.itemMap.set(S,{ref:S,...v}),()=>void k.itemMap.delete(S))),l.jsx(h,{[d]:"",ref:E,children:w})});p.displayName=f;function g(m){const x=a(e+"CollectionConsumer",m);return oa.useCallback(()=>{const w=x.collectionRef.current;if(!w)return[];const v=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(x.itemMap.values()).sort((k,b)=>v.indexOf(k.ref.current)-v.indexOf(b.ref.current))},[x.collectionRef,x.itemMap])}return[{Provider:i,Slot:u,ItemSlot:p},g,n]}var CO=_.createContext(void 0);function Qx(e){const t=_.useContext(CO);return e||t||"ltr"}function nr(e){const t=_.useRef(e);return _.useEffect(()=>{t.current=e}),_.useMemo(()=>(...r)=>{var n;return(n=t.current)==null?void 0:n.call(t,...r)},[])}function Zx(e,t=globalThis==null?void 0:globalThis.document){const r=nr(e);_.useEffect(()=>{const n=s=>{s.key==="Escape"&&r(s)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var AO="DismissableLayer",mm="dismissableLayer.update",jO="dismissableLayer.pointerDownOutside",PO="dismissableLayer.focusOutside",cw,fS=_.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),eg=_.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:i,onDismiss:o,...c}=e,u=_.useContext(fS),[f,d]=_.useState(null),h=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=_.useState({}),g=Ye(t,b=>d(b)),m=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),y=m.indexOf(x),w=f?m.indexOf(f):-1,v=u.layersWithOutsidePointerEventsDisabled.size>0,S=w>=y,E=OO(b=>{const N=b.target,A=[...u.branches].some(O=>O.contains(N));!S||A||(s==null||s(b),i==null||i(b),b.defaultPrevented||o==null||o())},h),k=IO(b=>{const N=b.target;[...u.branches].some(O=>O.contains(N))||(a==null||a(b),i==null||i(b),b.defaultPrevented||o==null||o())},h);return Zx(b=>{w===u.layers.size-1&&(n==null||n(b),!b.defaultPrevented&&o&&(b.preventDefault(),o()))},h),_.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(cw=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),uw(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=cw)}},[f,h,r,u]),_.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),uw())},[f,u]),_.useEffect(()=>{const b=()=>p({});return document.addEventListener(mm,b),()=>document.removeEventListener(mm,b)},[]),l.jsx(Le.div,{...c,ref:g,style:{pointerEvents:v?S?"auto":"none":void 0,...e.style},onFocusCapture:Ce(e.onFocusCapture,k.onFocusCapture),onBlurCapture:Ce(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:Ce(e.onPointerDownCapture,E.onPointerDownCapture)})});eg.displayName=AO;var RO="DismissableLayerBranch",FO=_.forwardRef((e,t)=>{const r=_.useContext(fS),n=_.useRef(null),s=Ye(t,n);return _.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),l.jsx(Le.div,{...e,ref:s})});FO.displayName=RO;function OO(e,t=globalThis==null?void 0:globalThis.document){const r=nr(e),n=_.useRef(!1),s=_.useRef(()=>{});return _.useEffect(()=>{const a=o=>{if(o.target&&!n.current){let c=function(){dS(jO,r,u,{discrete:!0})};const u={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",a),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function IO(e,t=globalThis==null?void 0:globalThis.document){const r=nr(e),n=_.useRef(!1);return _.useEffect(()=>{const s=a=>{a.target&&!n.current&&dS(PO,r,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function uw(){const e=new CustomEvent(mm);document.dispatchEvent(e)}function dS(e,t,r,{discrete:n}){const s=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?uu(s,a):s.dispatchEvent(a)}var Nh=0;function hS(){_.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??fw()),document.body.insertAdjacentElement("beforeend",e[1]??fw()),Nh++,()=>{Nh===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),Nh--}},[])}function fw(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Ch="focusScope.autoFocusOnMount",Ah="focusScope.autoFocusOnUnmount",dw={bubbles:!1,cancelable:!0},DO="FocusScope",d0=_.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:s,onUnmountAutoFocus:a,...i}=e,[o,c]=_.useState(null),u=nr(s),f=nr(a),d=_.useRef(null),h=Ye(t,m=>c(m)),p=_.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;_.useEffect(()=>{if(n){let m=function(v){if(p.paused||!o)return;const S=v.target;o.contains(S)?d.current=S:ca(d.current,{select:!0})},x=function(v){if(p.paused||!o)return;const S=v.relatedTarget;S!==null&&(o.contains(S)||ca(d.current,{select:!0}))},y=function(v){if(document.activeElement===document.body)for(const E of v)E.removedNodes.length>0&&ca(o)};document.addEventListener("focusin",m),document.addEventListener("focusout",x);const w=new MutationObserver(y);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",x),w.disconnect()}}},[n,o,p.paused]),_.useEffect(()=>{if(o){pw.add(p);const m=document.activeElement;if(!o.contains(m)){const y=new CustomEvent(Ch,dw);o.addEventListener(Ch,u),o.dispatchEvent(y),y.defaultPrevented||(LO(zO(pS(o)),{select:!0}),document.activeElement===m&&ca(o))}return()=>{o.removeEventListener(Ch,u),setTimeout(()=>{const y=new CustomEvent(Ah,dw);o.addEventListener(Ah,f),o.dispatchEvent(y),y.defaultPrevented||ca(m??document.body,{select:!0}),o.removeEventListener(Ah,f),pw.remove(p)},0)}}},[o,u,f,p]);const g=_.useCallback(m=>{if(!r&&!n||p.paused)return;const x=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,y=document.activeElement;if(x&&y){const w=m.currentTarget,[v,S]=MO(w);v&&S?!m.shiftKey&&y===S?(m.preventDefault(),r&&ca(v,{select:!0})):m.shiftKey&&y===v&&(m.preventDefault(),r&&ca(S,{select:!0})):y===w&&m.preventDefault()}},[r,n,p.paused]);return l.jsx(Le.div,{tabIndex:-1,...i,ref:h,onKeyDown:g})});d0.displayName=DO;function LO(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(ca(n,{select:t}),document.activeElement!==r)return}function MO(e){const t=pS(e),r=hw(t,e),n=hw(t.reverse(),e);return[r,n]}function pS(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function hw(e,t){for(const r of e)if(!BO(r,{upTo:t}))return r}function BO(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function UO(e){return e instanceof HTMLInputElement&&"select"in e}function ca(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&UO(e)&&t&&e.select()}}var pw=$O();function $O(){let e=[];return{add(t){const r=e[0];t!==r&&(r==null||r.pause()),e=mw(e,t),e.unshift(t)},remove(t){var r;e=mw(e,t),(r=e[0])==null||r.resume()}}}function mw(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function zO(e){return e.filter(t=>t.tagName!=="A")}var WO=Ym[" useId ".trim().toString()]||(()=>{}),VO=0;function Bs(e){const[t,r]=_.useState(WO());return Lt(()=>{r(n=>n??String(VO++))},[e]),t?`radix-${t}`:""}const HO=["top","right","bottom","left"],Oa=Math.min,Zr=Math.max,wd=Math.round,Zu=Math.floor,Ss=e=>({x:e,y:e}),GO={left:"right",right:"left",bottom:"top",top:"bottom"},qO={start:"end",end:"start"};function xm(e,t,r){return Zr(e,Oa(t,r))}function qs(e,t){return typeof e=="function"?e(t):e}function Ks(e){return e.split("-")[0]}function dl(e){return e.split("-")[1]}function tg(e){return e==="x"?"y":"x"}function rg(e){return e==="y"?"height":"width"}const KO=new Set(["top","bottom"]);function ms(e){return KO.has(Ks(e))?"y":"x"}function ng(e){return tg(ms(e))}function XO(e,t,r){r===void 0&&(r=!1);const n=dl(e),s=ng(e),a=rg(s);let i=s==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(i=yd(i)),[i,yd(i)]}function YO(e){const t=yd(e);return[gm(e),t,gm(t)]}function gm(e){return e.replace(/start|end/g,t=>qO[t])}const xw=["left","right"],gw=["right","left"],JO=["top","bottom"],QO=["bottom","top"];function ZO(e,t,r){switch(e){case"top":case"bottom":return r?t?gw:xw:t?xw:gw;case"left":case"right":return t?JO:QO;default:return[]}}function eI(e,t,r,n){const s=dl(e);let a=ZO(Ks(e),r==="start",n);return s&&(a=a.map(i=>i+"-"+s),t&&(a=a.concat(a.map(gm)))),a}function yd(e){return e.replace(/left|right|bottom|top/g,t=>GO[t])}function tI(e){return{top:0,right:0,bottom:0,left:0,...e}}function mS(e){return typeof e!="number"?tI(e):{top:e,right:e,bottom:e,left:e}}function _d(e){const{x:t,y:r,width:n,height:s}=e;return{width:n,height:s,top:r,left:t,right:t+n,bottom:r+s,x:t,y:r}}function vw(e,t,r){let{reference:n,floating:s}=e;const a=ms(t),i=ng(t),o=rg(i),c=Ks(t),u=a==="y",f=n.x+n.width/2-s.width/2,d=n.y+n.height/2-s.height/2,h=n[o]/2-s[o]/2;let p;switch(c){case"top":p={x:f,y:n.y-s.height};break;case"bottom":p={x:f,y:n.y+n.height};break;case"right":p={x:n.x+n.width,y:d};break;case"left":p={x:n.x-s.width,y:d};break;default:p={x:n.x,y:n.y}}switch(dl(t)){case"start":p[i]-=h*(r&&u?-1:1);break;case"end":p[i]+=h*(r&&u?-1:1);break}return p}const rI=async(e,t,r)=>{const{placement:n="bottom",strategy:s="absolute",middleware:a=[],platform:i}=r,o=a.filter(Boolean),c=await(i.isRTL==null?void 0:i.isRTL(t));let u=await i.getElementRects({reference:e,floating:t,strategy:s}),{x:f,y:d}=vw(u,n,c),h=n,p={},g=0;for(let m=0;m<o.length;m++){const{name:x,fn:y}=o[m],{x:w,y:v,data:S,reset:E}=await y({x:f,y:d,initialPlacement:n,placement:h,strategy:s,middlewareData:p,rects:u,platform:i,elements:{reference:e,floating:t}});f=w??f,d=v??d,p={...p,[x]:{...p[x],...S}},E&&g<=50&&(g++,typeof E=="object"&&(E.placement&&(h=E.placement),E.rects&&(u=E.rects===!0?await i.getElementRects({reference:e,floating:t,strategy:s}):E.rects),{x:f,y:d}=vw(u,h,c)),m=-1)}return{x:f,y:d,placement:h,strategy:s,middlewareData:p}};async function Lc(e,t){var r;t===void 0&&(t={});const{x:n,y:s,platform:a,rects:i,elements:o,strategy:c}=e,{boundary:u="clippingAncestors",rootBoundary:f="viewport",elementContext:d="floating",altBoundary:h=!1,padding:p=0}=qs(t,e),g=mS(p),x=o[h?d==="floating"?"reference":"floating":d],y=_d(await a.getClippingRect({element:(r=await(a.isElement==null?void 0:a.isElement(x)))==null||r?x:x.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(o.floating)),boundary:u,rootBoundary:f,strategy:c})),w=d==="floating"?{x:n,y:s,width:i.floating.width,height:i.floating.height}:i.reference,v=await(a.getOffsetParent==null?void 0:a.getOffsetParent(o.floating)),S=await(a.isElement==null?void 0:a.isElement(v))?await(a.getScale==null?void 0:a.getScale(v))||{x:1,y:1}:{x:1,y:1},E=_d(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:w,offsetParent:v,strategy:c}):w);return{top:(y.top-E.top+g.top)/S.y,bottom:(E.bottom-y.bottom+g.bottom)/S.y,left:(y.left-E.left+g.left)/S.x,right:(E.right-y.right+g.right)/S.x}}const nI=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:s,rects:a,platform:i,elements:o,middlewareData:c}=t,{element:u,padding:f=0}=qs(e,t)||{};if(u==null)return{};const d=mS(f),h={x:r,y:n},p=ng(s),g=rg(p),m=await i.getDimensions(u),x=p==="y",y=x?"top":"left",w=x?"bottom":"right",v=x?"clientHeight":"clientWidth",S=a.reference[g]+a.reference[p]-h[p]-a.floating[g],E=h[p]-a.reference[p],k=await(i.getOffsetParent==null?void 0:i.getOffsetParent(u));let b=k?k[v]:0;(!b||!await(i.isElement==null?void 0:i.isElement(k)))&&(b=o.floating[v]||a.floating[g]);const N=S/2-E/2,A=b/2-m[g]/2-1,O=Oa(d[y],A),V=Oa(d[w],A),C=O,B=b-m[g]-V,G=b/2-m[g]/2+N,X=xm(C,G,B),z=!c.arrow&&dl(s)!=null&&G!==X&&a.reference[g]/2-(G<C?O:V)-m[g]/2<0,q=z?G<C?G-C:G-B:0;return{[p]:h[p]+q,data:{[p]:X,centerOffset:G-X-q,...z&&{alignmentOffset:q}},reset:z}}}),sI=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:s,middlewareData:a,rects:i,initialPlacement:o,platform:c,elements:u}=t,{mainAxis:f=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:m=!0,...x}=qs(e,t);if((r=a.arrow)!=null&&r.alignmentOffset)return{};const y=Ks(s),w=ms(o),v=Ks(o)===o,S=await(c.isRTL==null?void 0:c.isRTL(u.floating)),E=h||(v||!m?[yd(o)]:YO(o)),k=g!=="none";!h&&k&&E.push(...eI(o,m,g,S));const b=[o,...E],N=await Lc(t,x),A=[];let O=((n=a.flip)==null?void 0:n.overflows)||[];if(f&&A.push(N[y]),d){const G=XO(s,i,S);A.push(N[G[0]],N[G[1]])}if(O=[...O,{placement:s,overflows:A}],!A.every(G=>G<=0)){var V,C;const G=(((V=a.flip)==null?void 0:V.index)||0)+1,X=b[G];if(X&&(!(d==="alignment"?w!==ms(X):!1)||O.every(K=>K.overflows[0]>0&&ms(K.placement)===w)))return{data:{index:G,overflows:O},reset:{placement:X}};let z=(C=O.filter(q=>q.overflows[0]<=0).sort((q,K)=>q.overflows[1]-K.overflows[1])[0])==null?void 0:C.placement;if(!z)switch(p){case"bestFit":{var B;const q=(B=O.filter(K=>{if(k){const F=ms(K.placement);return F===w||F==="y"}return!0}).map(K=>[K.placement,K.overflows.filter(F=>F>0).reduce((F,ne)=>F+ne,0)]).sort((K,F)=>K[1]-F[1])[0])==null?void 0:B[0];q&&(z=q);break}case"initialPlacement":z=o;break}if(s!==z)return{reset:{placement:z}}}return{}}}};function ww(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function yw(e){return HO.some(t=>e[t]>=0)}const aI=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...s}=qs(e,t);switch(n){case"referenceHidden":{const a=await Lc(t,{...s,elementContext:"reference"}),i=ww(a,r.reference);return{data:{referenceHiddenOffsets:i,referenceHidden:yw(i)}}}case"escaped":{const a=await Lc(t,{...s,altBoundary:!0}),i=ww(a,r.floating);return{data:{escapedOffsets:i,escaped:yw(i)}}}default:return{}}}}},xS=new Set(["left","top"]);async function iI(e,t){const{placement:r,platform:n,elements:s}=e,a=await(n.isRTL==null?void 0:n.isRTL(s.floating)),i=Ks(r),o=dl(r),c=ms(r)==="y",u=xS.has(i)?-1:1,f=a&&c?-1:1,d=qs(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:g}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof g=="number"&&(p=o==="end"?g*-1:g),c?{x:p*f,y:h*u}:{x:h*u,y:p*f}}const oI=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:s,y:a,placement:i,middlewareData:o}=t,c=await iI(t,e);return i===((r=o.offset)==null?void 0:r.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:s+c.x,y:a+c.y,data:{...c,placement:i}}}}},lI=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:s}=t,{mainAxis:a=!0,crossAxis:i=!1,limiter:o={fn:x=>{let{x:y,y:w}=x;return{x:y,y:w}}},...c}=qs(e,t),u={x:r,y:n},f=await Lc(t,c),d=ms(Ks(s)),h=tg(d);let p=u[h],g=u[d];if(a){const x=h==="y"?"top":"left",y=h==="y"?"bottom":"right",w=p+f[x],v=p-f[y];p=xm(w,p,v)}if(i){const x=d==="y"?"top":"left",y=d==="y"?"bottom":"right",w=g+f[x],v=g-f[y];g=xm(w,g,v)}const m=o.fn({...t,[h]:p,[d]:g});return{...m,data:{x:m.x-r,y:m.y-n,enabled:{[h]:a,[d]:i}}}}}},cI=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:s,rects:a,middlewareData:i}=t,{offset:o=0,mainAxis:c=!0,crossAxis:u=!0}=qs(e,t),f={x:r,y:n},d=ms(s),h=tg(d);let p=f[h],g=f[d];const m=qs(o,t),x=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(c){const v=h==="y"?"height":"width",S=a.reference[h]-a.floating[v]+x.mainAxis,E=a.reference[h]+a.reference[v]-x.mainAxis;p<S?p=S:p>E&&(p=E)}if(u){var y,w;const v=h==="y"?"width":"height",S=xS.has(Ks(s)),E=a.reference[d]-a.floating[v]+(S&&((y=i.offset)==null?void 0:y[d])||0)+(S?0:x.crossAxis),k=a.reference[d]+a.reference[v]+(S?0:((w=i.offset)==null?void 0:w[d])||0)-(S?x.crossAxis:0);g<E?g=E:g>k&&(g=k)}return{[h]:p,[d]:g}}}},uI=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:s,rects:a,platform:i,elements:o}=t,{apply:c=()=>{},...u}=qs(e,t),f=await Lc(t,u),d=Ks(s),h=dl(s),p=ms(s)==="y",{width:g,height:m}=a.floating;let x,y;d==="top"||d==="bottom"?(x=d,y=h===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(y=d,x=h==="end"?"top":"bottom");const w=m-f.top-f.bottom,v=g-f.left-f.right,S=Oa(m-f[x],w),E=Oa(g-f[y],v),k=!t.middlewareData.shift;let b=S,N=E;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(N=v),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(b=w),k&&!h){const O=Zr(f.left,0),V=Zr(f.right,0),C=Zr(f.top,0),B=Zr(f.bottom,0);p?N=g-2*(O!==0||V!==0?O+V:Zr(f.left,f.right)):b=m-2*(C!==0||B!==0?C+B:Zr(f.top,f.bottom))}await c({...t,availableWidth:N,availableHeight:b});const A=await i.getDimensions(o.floating);return g!==A.width||m!==A.height?{reset:{rects:!0}}:{}}}};function h0(){return typeof window<"u"}function hl(e){return gS(e)?(e.nodeName||"").toLowerCase():"#document"}function un(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Es(e){var t;return(t=(gS(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function gS(e){return h0()?e instanceof Node||e instanceof un(e).Node:!1}function ts(e){return h0()?e instanceof Element||e instanceof un(e).Element:!1}function ks(e){return h0()?e instanceof HTMLElement||e instanceof un(e).HTMLElement:!1}function _w(e){return!h0()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof un(e).ShadowRoot}const fI=new Set(["inline","contents"]);function fu(e){const{overflow:t,overflowX:r,overflowY:n,display:s}=rs(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!fI.has(s)}const dI=new Set(["table","td","th"]);function hI(e){return dI.has(hl(e))}const pI=[":popover-open",":modal"];function p0(e){return pI.some(t=>{try{return e.matches(t)}catch{return!1}})}const mI=["transform","translate","scale","rotate","perspective"],xI=["transform","translate","scale","rotate","perspective","filter"],gI=["paint","layout","strict","content"];function sg(e){const t=ag(),r=ts(e)?rs(e):e;return mI.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||xI.some(n=>(r.willChange||"").includes(n))||gI.some(n=>(r.contain||"").includes(n))}function vI(e){let t=Ia(e);for(;ks(t)&&!Zo(t);){if(sg(t))return t;if(p0(t))return null;t=Ia(t)}return null}function ag(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const wI=new Set(["html","body","#document"]);function Zo(e){return wI.has(hl(e))}function rs(e){return un(e).getComputedStyle(e)}function m0(e){return ts(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ia(e){if(hl(e)==="html")return e;const t=e.assignedSlot||e.parentNode||_w(e)&&e.host||Es(e);return _w(t)?t.host:t}function vS(e){const t=Ia(e);return Zo(t)?e.ownerDocument?e.ownerDocument.body:e.body:ks(t)&&fu(t)?t:vS(t)}function Mc(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const s=vS(e),a=s===((n=e.ownerDocument)==null?void 0:n.body),i=un(s);if(a){const o=vm(i);return t.concat(i,i.visualViewport||[],fu(s)?s:[],o&&r?Mc(o):[])}return t.concat(s,Mc(s,[],r))}function vm(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function wS(e){const t=rs(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const s=ks(e),a=s?e.offsetWidth:r,i=s?e.offsetHeight:n,o=wd(r)!==a||wd(n)!==i;return o&&(r=a,n=i),{width:r,height:n,$:o}}function ig(e){return ts(e)?e:e.contextElement}function Lo(e){const t=ig(e);if(!ks(t))return Ss(1);const r=t.getBoundingClientRect(),{width:n,height:s,$:a}=wS(t);let i=(a?wd(r.width):r.width)/n,o=(a?wd(r.height):r.height)/s;return(!i||!Number.isFinite(i))&&(i=1),(!o||!Number.isFinite(o))&&(o=1),{x:i,y:o}}const yI=Ss(0);function yS(e){const t=un(e);return!ag()||!t.visualViewport?yI:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function _I(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==un(e)?!1:t}function Ci(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const s=e.getBoundingClientRect(),a=ig(e);let i=Ss(1);t&&(n?ts(n)&&(i=Lo(n)):i=Lo(e));const o=_I(a,r,n)?yS(a):Ss(0);let c=(s.left+o.x)/i.x,u=(s.top+o.y)/i.y,f=s.width/i.x,d=s.height/i.y;if(a){const h=un(a),p=n&&ts(n)?un(n):n;let g=h,m=vm(g);for(;m&&n&&p!==g;){const x=Lo(m),y=m.getBoundingClientRect(),w=rs(m),v=y.left+(m.clientLeft+parseFloat(w.paddingLeft))*x.x,S=y.top+(m.clientTop+parseFloat(w.paddingTop))*x.y;c*=x.x,u*=x.y,f*=x.x,d*=x.y,c+=v,u+=S,g=un(m),m=vm(g)}}return _d({width:f,height:d,x:c,y:u})}function og(e,t){const r=m0(e).scrollLeft;return t?t.left+r:Ci(Es(e)).left+r}function _S(e,t,r){r===void 0&&(r=!1);const n=e.getBoundingClientRect(),s=n.left+t.scrollLeft-(r?0:og(e,n)),a=n.top+t.scrollTop;return{x:s,y:a}}function bI(e){let{elements:t,rect:r,offsetParent:n,strategy:s}=e;const a=s==="fixed",i=Es(n),o=t?p0(t.floating):!1;if(n===i||o&&a)return r;let c={scrollLeft:0,scrollTop:0},u=Ss(1);const f=Ss(0),d=ks(n);if((d||!d&&!a)&&((hl(n)!=="body"||fu(i))&&(c=m0(n)),ks(n))){const p=Ci(n);u=Lo(n),f.x=p.x+n.clientLeft,f.y=p.y+n.clientTop}const h=i&&!d&&!a?_S(i,c,!0):Ss(0);return{width:r.width*u.x,height:r.height*u.y,x:r.x*u.x-c.scrollLeft*u.x+f.x+h.x,y:r.y*u.y-c.scrollTop*u.y+f.y+h.y}}function SI(e){return Array.from(e.getClientRects())}function kI(e){const t=Es(e),r=m0(e),n=e.ownerDocument.body,s=Zr(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),a=Zr(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let i=-r.scrollLeft+og(e);const o=-r.scrollTop;return rs(n).direction==="rtl"&&(i+=Zr(t.clientWidth,n.clientWidth)-s),{width:s,height:a,x:i,y:o}}function EI(e,t){const r=un(e),n=Es(e),s=r.visualViewport;let a=n.clientWidth,i=n.clientHeight,o=0,c=0;if(s){a=s.width,i=s.height;const u=ag();(!u||u&&t==="fixed")&&(o=s.offsetLeft,c=s.offsetTop)}return{width:a,height:i,x:o,y:c}}const TI=new Set(["absolute","fixed"]);function NI(e,t){const r=Ci(e,!0,t==="fixed"),n=r.top+e.clientTop,s=r.left+e.clientLeft,a=ks(e)?Lo(e):Ss(1),i=e.clientWidth*a.x,o=e.clientHeight*a.y,c=s*a.x,u=n*a.y;return{width:i,height:o,x:c,y:u}}function bw(e,t,r){let n;if(t==="viewport")n=EI(e,r);else if(t==="document")n=kI(Es(e));else if(ts(t))n=NI(t,r);else{const s=yS(e);n={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return _d(n)}function bS(e,t){const r=Ia(e);return r===t||!ts(r)||Zo(r)?!1:rs(r).position==="fixed"||bS(r,t)}function CI(e,t){const r=t.get(e);if(r)return r;let n=Mc(e,[],!1).filter(o=>ts(o)&&hl(o)!=="body"),s=null;const a=rs(e).position==="fixed";let i=a?Ia(e):e;for(;ts(i)&&!Zo(i);){const o=rs(i),c=sg(i);!c&&o.position==="fixed"&&(s=null),(a?!c&&!s:!c&&o.position==="static"&&!!s&&TI.has(s.position)||fu(i)&&!c&&bS(e,i))?n=n.filter(f=>f!==i):s=o,i=Ia(i)}return t.set(e,n),n}function AI(e){let{element:t,boundary:r,rootBoundary:n,strategy:s}=e;const i=[...r==="clippingAncestors"?p0(t)?[]:CI(t,this._c):[].concat(r),n],o=i[0],c=i.reduce((u,f)=>{const d=bw(t,f,s);return u.top=Zr(d.top,u.top),u.right=Oa(d.right,u.right),u.bottom=Oa(d.bottom,u.bottom),u.left=Zr(d.left,u.left),u},bw(t,o,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function jI(e){const{width:t,height:r}=wS(e);return{width:t,height:r}}function PI(e,t,r){const n=ks(t),s=Es(t),a=r==="fixed",i=Ci(e,!0,a,t);let o={scrollLeft:0,scrollTop:0};const c=Ss(0);function u(){c.x=og(s)}if(n||!n&&!a)if((hl(t)!=="body"||fu(s))&&(o=m0(t)),n){const p=Ci(t,!0,a,t);c.x=p.x+t.clientLeft,c.y=p.y+t.clientTop}else s&&u();a&&!n&&s&&u();const f=s&&!n&&!a?_S(s,o):Ss(0),d=i.left+o.scrollLeft-c.x-f.x,h=i.top+o.scrollTop-c.y-f.y;return{x:d,y:h,width:i.width,height:i.height}}function jh(e){return rs(e).position==="static"}function Sw(e,t){if(!ks(e)||rs(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return Es(e)===r&&(r=r.ownerDocument.body),r}function SS(e,t){const r=un(e);if(p0(e))return r;if(!ks(e)){let s=Ia(e);for(;s&&!Zo(s);){if(ts(s)&&!jh(s))return s;s=Ia(s)}return r}let n=Sw(e,t);for(;n&&hI(n)&&jh(n);)n=Sw(n,t);return n&&Zo(n)&&jh(n)&&!sg(n)?r:n||vI(e)||r}const RI=async function(e){const t=this.getOffsetParent||SS,r=this.getDimensions,n=await r(e.floating);return{reference:PI(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function FI(e){return rs(e).direction==="rtl"}const OI={convertOffsetParentRelativeRectToViewportRelativeRect:bI,getDocumentElement:Es,getClippingRect:AI,getOffsetParent:SS,getElementRects:RI,getClientRects:SI,getDimensions:jI,getScale:Lo,isElement:ts,isRTL:FI};function kS(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function II(e,t){let r=null,n;const s=Es(e);function a(){var o;clearTimeout(n),(o=r)==null||o.disconnect(),r=null}function i(o,c){o===void 0&&(o=!1),c===void 0&&(c=1),a();const u=e.getBoundingClientRect(),{left:f,top:d,width:h,height:p}=u;if(o||t(),!h||!p)return;const g=Zu(d),m=Zu(s.clientWidth-(f+h)),x=Zu(s.clientHeight-(d+p)),y=Zu(f),v={rootMargin:-g+"px "+-m+"px "+-x+"px "+-y+"px",threshold:Zr(0,Oa(1,c))||1};let S=!0;function E(k){const b=k[0].intersectionRatio;if(b!==c){if(!S)return i();b?i(!1,b):n=setTimeout(()=>{i(!1,1e-7)},1e3)}b===1&&!kS(u,e.getBoundingClientRect())&&i(),S=!1}try{r=new IntersectionObserver(E,{...v,root:s.ownerDocument})}catch{r=new IntersectionObserver(E,v)}r.observe(e)}return i(!0),a}function DI(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,u=ig(e),f=s||a?[...u?Mc(u):[],...Mc(t)]:[];f.forEach(y=>{s&&y.addEventListener("scroll",r,{passive:!0}),a&&y.addEventListener("resize",r)});const d=u&&o?II(u,r):null;let h=-1,p=null;i&&(p=new ResizeObserver(y=>{let[w]=y;w&&w.target===u&&p&&(p.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var v;(v=p)==null||v.observe(t)})),r()}),u&&!c&&p.observe(u),p.observe(t));let g,m=c?Ci(e):null;c&&x();function x(){const y=Ci(e);m&&!kS(m,y)&&r(),m=y,g=requestAnimationFrame(x)}return r(),()=>{var y;f.forEach(w=>{s&&w.removeEventListener("scroll",r),a&&w.removeEventListener("resize",r)}),d==null||d(),(y=p)==null||y.disconnect(),p=null,c&&cancelAnimationFrame(g)}}const LI=oI,MI=lI,BI=sI,UI=uI,$I=aI,kw=nI,zI=cI,WI=(e,t,r)=>{const n=new Map,s={platform:OI,...r},a={...s.platform,_c:n};return rI(e,t,{...s,platform:a})};var VI=typeof document<"u",HI=function(){},Ff=VI?_.useLayoutEffect:HI;function bd(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!bd(e[n],t[n]))return!1;return!0}if(s=Object.keys(e),r=s.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,s[n]))return!1;for(n=r;n--!==0;){const a=s[n];if(!(a==="_owner"&&e.$$typeof)&&!bd(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function ES(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function Ew(e,t){const r=ES(e);return Math.round(t*r)/r}function Ph(e){const t=_.useRef(e);return Ff(()=>{t.current=e}),t}function GI(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:s,elements:{reference:a,floating:i}={},transform:o=!0,whileElementsMounted:c,open:u}=e,[f,d]=_.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[h,p]=_.useState(n);bd(h,n)||p(n);const[g,m]=_.useState(null),[x,y]=_.useState(null),w=_.useCallback(K=>{K!==k.current&&(k.current=K,m(K))},[]),v=_.useCallback(K=>{K!==b.current&&(b.current=K,y(K))},[]),S=a||g,E=i||x,k=_.useRef(null),b=_.useRef(null),N=_.useRef(f),A=c!=null,O=Ph(c),V=Ph(s),C=Ph(u),B=_.useCallback(()=>{if(!k.current||!b.current)return;const K={placement:t,strategy:r,middleware:h};V.current&&(K.platform=V.current),WI(k.current,b.current,K).then(F=>{const ne={...F,isPositioned:C.current!==!1};G.current&&!bd(N.current,ne)&&(N.current=ne,Ui.flushSync(()=>{d(ne)}))})},[h,t,r,V,C]);Ff(()=>{u===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,d(K=>({...K,isPositioned:!1})))},[u]);const G=_.useRef(!1);Ff(()=>(G.current=!0,()=>{G.current=!1}),[]),Ff(()=>{if(S&&(k.current=S),E&&(b.current=E),S&&E){if(O.current)return O.current(S,E,B);B()}},[S,E,B,O,A]);const X=_.useMemo(()=>({reference:k,floating:b,setReference:w,setFloating:v}),[w,v]),z=_.useMemo(()=>({reference:S,floating:E}),[S,E]),q=_.useMemo(()=>{const K={position:r,left:0,top:0};if(!z.floating)return K;const F=Ew(z.floating,f.x),ne=Ew(z.floating,f.y);return o?{...K,transform:"translate("+F+"px, "+ne+"px)",...ES(z.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:F,top:ne}},[r,o,z.floating,f.x,f.y]);return _.useMemo(()=>({...f,update:B,refs:X,elements:z,floatingStyles:q}),[f,B,X,z,q])}const qI=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:s}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?kw({element:n.current,padding:s}).fn(r):{}:n?kw({element:n,padding:s}).fn(r):{}}}},KI=(e,t)=>({...LI(e),options:[e,t]}),XI=(e,t)=>({...MI(e),options:[e,t]}),YI=(e,t)=>({...zI(e),options:[e,t]}),JI=(e,t)=>({...BI(e),options:[e,t]}),QI=(e,t)=>({...UI(e),options:[e,t]}),ZI=(e,t)=>({...$I(e),options:[e,t]}),e5=(e,t)=>({...qI(e),options:[e,t]});var t5="Arrow",TS=_.forwardRef((e,t)=>{const{children:r,width:n=10,height:s=5,...a}=e;return l.jsx(Le.svg,{...a,ref:t,width:n,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:l.jsx("polygon",{points:"0,0 30,0 15,10"})})});TS.displayName=t5;var r5=TS;function n5(e){const[t,r]=_.useState(void 0);return Lt(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const a=s[0];let i,o;if("borderBoxSize"in a){const c=a.borderBoxSize,u=Array.isArray(c)?c[0]:c;i=u.inlineSize,o=u.blockSize}else i=e.offsetWidth,o=e.offsetHeight;r({width:i,height:o})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var lg="Popper",[NS,x0]=Ha(lg),[s5,CS]=NS(lg),AS=e=>{const{__scopePopper:t,children:r}=e,[n,s]=_.useState(null);return l.jsx(s5,{scope:t,anchor:n,onAnchorChange:s,children:r})};AS.displayName=lg;var jS="PopperAnchor",PS=_.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...s}=e,a=CS(jS,r),i=_.useRef(null),o=Ye(t,i);return _.useEffect(()=>{a.onAnchorChange((n==null?void 0:n.current)||i.current)}),n?null:l.jsx(Le.div,{...s,ref:o})});PS.displayName=jS;var cg="PopperContent",[a5,i5]=NS(cg),RS=_.forwardRef((e,t)=>{var te,oe,ae,se,de,I;const{__scopePopper:r,side:n="bottom",sideOffset:s=0,align:a="center",alignOffset:i=0,arrowPadding:o=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:f=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:p="optimized",onPlaced:g,...m}=e,x=CS(cg,r),[y,w]=_.useState(null),v=Ye(t,Be=>w(Be)),[S,E]=_.useState(null),k=n5(S),b=(k==null?void 0:k.width)??0,N=(k==null?void 0:k.height)??0,A=n+(a!=="center"?"-"+a:""),O=typeof f=="number"?f:{top:0,right:0,bottom:0,left:0,...f},V=Array.isArray(u)?u:[u],C=V.length>0,B={padding:O,boundary:V.filter(l5),altBoundary:C},{refs:G,floatingStyles:X,placement:z,isPositioned:q,middlewareData:K}=GI({strategy:"fixed",placement:A,whileElementsMounted:(...Be)=>DI(...Be,{animationFrame:p==="always"}),elements:{reference:x.anchor},middleware:[KI({mainAxis:s+N,alignmentAxis:i}),c&&XI({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?YI():void 0,...B}),c&&JI({...B}),QI({...B,apply:({elements:Be,rects:Re,availableWidth:Ve,availableHeight:Oe})=>{const{width:xe,height:it}=Re.reference,Rt=Be.floating.style;Rt.setProperty("--radix-popper-available-width",`${Ve}px`),Rt.setProperty("--radix-popper-available-height",`${Oe}px`),Rt.setProperty("--radix-popper-anchor-width",`${xe}px`),Rt.setProperty("--radix-popper-anchor-height",`${it}px`)}}),S&&e5({element:S,padding:o}),c5({arrowWidth:b,arrowHeight:N}),h&&ZI({strategy:"referenceHidden",...B})]}),[F,ne]=IS(z),Y=nr(g);Lt(()=>{q&&(Y==null||Y())},[q,Y]);const j=(te=K.arrow)==null?void 0:te.x,H=(oe=K.arrow)==null?void 0:oe.y,U=((ae=K.arrow)==null?void 0:ae.centerOffset)!==0,[W,J]=_.useState();return Lt(()=>{y&&J(window.getComputedStyle(y).zIndex)},[y]),l.jsx("div",{ref:G.setFloating,"data-radix-popper-content-wrapper":"",style:{...X,transform:q?X.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:W,"--radix-popper-transform-origin":[(se=K.transformOrigin)==null?void 0:se.x,(de=K.transformOrigin)==null?void 0:de.y].join(" "),...((I=K.hide)==null?void 0:I.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:l.jsx(a5,{scope:r,placedSide:F,onArrowChange:E,arrowX:j,arrowY:H,shouldHideArrow:U,children:l.jsx(Le.div,{"data-side":F,"data-align":ne,...m,ref:v,style:{...m.style,animation:q?void 0:"none"}})})})});RS.displayName=cg;var FS="PopperArrow",o5={top:"bottom",right:"left",bottom:"top",left:"right"},OS=_.forwardRef(function(t,r){const{__scopePopper:n,...s}=t,a=i5(FS,n),i=o5[a.placedSide];return l.jsx("span",{ref:a.onArrowChange,style:{position:"absolute",left:a.arrowX,top:a.arrowY,[i]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[a.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[a.placedSide],visibility:a.shouldHideArrow?"hidden":void 0},children:l.jsx(r5,{...s,ref:r,style:{...s.style,display:"block"}})})});OS.displayName=FS;function l5(e){return e!==null}var c5=e=>({name:"transformOrigin",options:e,fn(t){var x,y,w;const{placement:r,rects:n,middlewareData:s}=t,i=((x=s.arrow)==null?void 0:x.centerOffset)!==0,o=i?0:e.arrowWidth,c=i?0:e.arrowHeight,[u,f]=IS(r),d={start:"0%",center:"50%",end:"100%"}[f],h=(((y=s.arrow)==null?void 0:y.x)??0)+o/2,p=(((w=s.arrow)==null?void 0:w.y)??0)+c/2;let g="",m="";return u==="bottom"?(g=i?d:`${h}px`,m=`${-c}px`):u==="top"?(g=i?d:`${h}px`,m=`${n.floating.height+c}px`):u==="right"?(g=`${-c}px`,m=i?d:`${p}px`):u==="left"&&(g=`${n.floating.width+c}px`,m=i?d:`${p}px`),{data:{x:g,y:m}}}});function IS(e){const[t,r="center"]=e.split("-");return[t,r]}var DS=AS,LS=PS,MS=RS,BS=OS,u5="Portal",du=_.forwardRef((e,t)=>{var o;const{container:r,...n}=e,[s,a]=_.useState(!1);Lt(()=>a(!0),[]);const i=r||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return i?_j.createPortal(l.jsx(Le.div,{...n,ref:t}),i):null});du.displayName=u5;function f5(e,t){return _.useReducer((r,n)=>t[r][n]??r,e)}var hu=e=>{const{present:t,children:r}=e,n=d5(t),s=typeof r=="function"?r({present:n.isPresent}):_.Children.only(r),a=Ye(n.ref,h5(s));return typeof r=="function"||n.isPresent?_.cloneElement(s,{ref:a}):null};hu.displayName="Presence";function d5(e){const[t,r]=_.useState(),n=_.useRef(null),s=_.useRef(e),a=_.useRef("none"),i=e?"mounted":"unmounted",[o,c]=f5(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return _.useEffect(()=>{const u=ef(n.current);a.current=o==="mounted"?u:"none"},[o]),Lt(()=>{const u=n.current,f=s.current;if(f!==e){const h=a.current,p=ef(u);e?c("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(f&&h!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),Lt(()=>{if(t){let u;const f=t.ownerDocument.defaultView??window,d=p=>{const m=ef(n.current).includes(p.animationName);if(p.target===t&&m&&(c("ANIMATION_END"),!s.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",u=f.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},h=p=>{p.target===t&&(a.current=ef(n.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{f.clearTimeout(u),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:_.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function ef(e){return(e==null?void 0:e.animationName)||"none"}function h5(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var Rh="rovingFocusGroup.onEntryFocus",p5={bubbles:!1,cancelable:!0},pu="RovingFocusGroup",[wm,US,m5]=f0(pu),[x5,$S]=Ha(pu,[m5]),[g5,v5]=x5(pu),zS=_.forwardRef((e,t)=>l.jsx(wm.Provider,{scope:e.__scopeRovingFocusGroup,children:l.jsx(wm.Slot,{scope:e.__scopeRovingFocusGroup,children:l.jsx(w5,{...e,ref:t})})}));zS.displayName=pu;var w5=_.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,orientation:n,loop:s=!1,dir:a,currentTabStopId:i,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:f=!1,...d}=e,h=_.useRef(null),p=Ye(t,h),g=Qx(a),[m,x]=Qo({prop:i,defaultProp:o??null,onChange:c,caller:pu}),[y,w]=_.useState(!1),v=nr(u),S=US(r),E=_.useRef(!1),[k,b]=_.useState(0);return _.useEffect(()=>{const N=h.current;if(N)return N.addEventListener(Rh,v),()=>N.removeEventListener(Rh,v)},[v]),l.jsx(g5,{scope:r,orientation:n,dir:g,loop:s,currentTabStopId:m,onItemFocus:_.useCallback(N=>x(N),[x]),onItemShiftTab:_.useCallback(()=>w(!0),[]),onFocusableItemAdd:_.useCallback(()=>b(N=>N+1),[]),onFocusableItemRemove:_.useCallback(()=>b(N=>N-1),[]),children:l.jsx(Le.div,{tabIndex:y||k===0?-1:0,"data-orientation":n,...d,ref:p,style:{outline:"none",...e.style},onMouseDown:Ce(e.onMouseDown,()=>{E.current=!0}),onFocus:Ce(e.onFocus,N=>{const A=!E.current;if(N.target===N.currentTarget&&A&&!y){const O=new CustomEvent(Rh,p5);if(N.currentTarget.dispatchEvent(O),!O.defaultPrevented){const V=S().filter(z=>z.focusable),C=V.find(z=>z.active),B=V.find(z=>z.id===m),X=[C,B,...V].filter(Boolean).map(z=>z.ref.current);HS(X,f)}}E.current=!1}),onBlur:Ce(e.onBlur,()=>w(!1))})})}),WS="RovingFocusGroupItem",VS=_.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:r,focusable:n=!0,active:s=!1,tabStopId:a,children:i,...o}=e,c=Bs(),u=a||c,f=v5(WS,r),d=f.currentTabStopId===u,h=US(r),{onFocusableItemAdd:p,onFocusableItemRemove:g,currentTabStopId:m}=f;return _.useEffect(()=>{if(n)return p(),()=>g()},[n,p,g]),l.jsx(wm.ItemSlot,{scope:r,id:u,focusable:n,active:s,children:l.jsx(Le.span,{tabIndex:d?0:-1,"data-orientation":f.orientation,...o,ref:t,onMouseDown:Ce(e.onMouseDown,x=>{n?f.onItemFocus(u):x.preventDefault()}),onFocus:Ce(e.onFocus,()=>f.onItemFocus(u)),onKeyDown:Ce(e.onKeyDown,x=>{if(x.key==="Tab"&&x.shiftKey){f.onItemShiftTab();return}if(x.target!==x.currentTarget)return;const y=b5(x,f.orientation,f.dir);if(y!==void 0){if(x.metaKey||x.ctrlKey||x.altKey||x.shiftKey)return;x.preventDefault();let v=h().filter(S=>S.focusable).map(S=>S.ref.current);if(y==="last")v.reverse();else if(y==="prev"||y==="next"){y==="prev"&&v.reverse();const S=v.indexOf(x.currentTarget);v=f.loop?S5(v,S+1):v.slice(S+1)}setTimeout(()=>HS(v))}}),children:typeof i=="function"?i({isCurrentTabStop:d,hasTabStop:m!=null}):i})})});VS.displayName=WS;var y5={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function _5(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function b5(e,t,r){const n=_5(e.key,r);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return y5[n]}function HS(e,t=!1){const r=document.activeElement;for(const n of e)if(n===r||(n.focus({preventScroll:t}),document.activeElement!==r))return}function S5(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var k5=zS,E5=VS,T5=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},ao=new WeakMap,tf=new WeakMap,rf={},Fh=0,GS=function(e){return e&&(e.host||GS(e.parentNode))},N5=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=GS(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},C5=function(e,t,r,n){var s=N5(t,Array.isArray(e)?e:[e]);rf[r]||(rf[r]=new WeakMap);var a=rf[r],i=[],o=new Set,c=new Set(s),u=function(d){!d||o.has(d)||(o.add(d),u(d.parentNode))};s.forEach(u);var f=function(d){!d||c.has(d)||Array.prototype.forEach.call(d.children,function(h){if(o.has(h))f(h);else try{var p=h.getAttribute(n),g=p!==null&&p!=="false",m=(ao.get(h)||0)+1,x=(a.get(h)||0)+1;ao.set(h,m),a.set(h,x),i.push(h),m===1&&g&&tf.set(h,!0),x===1&&h.setAttribute(r,"true"),g||h.setAttribute(n,"true")}catch(y){console.error("aria-hidden: cannot operate on ",h,y)}})};return f(t),o.clear(),Fh++,function(){i.forEach(function(d){var h=ao.get(d)-1,p=a.get(d)-1;ao.set(d,h),a.set(d,p),h||(tf.has(d)||d.removeAttribute(n),tf.delete(d)),p||d.removeAttribute(r)}),Fh--,Fh||(ao=new WeakMap,ao=new WeakMap,tf=new WeakMap,rf={})}},ug=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),s=T5(e);return s?(n.push.apply(n,Array.from(s.querySelectorAll("[aria-live]"))),C5(n,s,r,"aria-hidden")):function(){return null}},ps=function(){return ps=Object.assign||function(t){for(var r,n=1,s=arguments.length;n<s;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},ps.apply(this,arguments)};function qS(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,n=Object.getOwnPropertySymbols(e);s<n.length;s++)t.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(r[n[s]]=e[n[s]]);return r}function A5(e,t,r){if(r||arguments.length===2)for(var n=0,s=t.length,a;n<s;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}var Of="right-scroll-bar-position",If="width-before-scroll-bar",j5="with-scroll-bars-hidden",P5="--removed-body-scroll-bar-size";function Oh(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function R5(e,t){var r=_.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var s=r.value;s!==n&&(r.value=n,r.callback(n,s))}}}})[0];return r.callback=t,r.facade}var F5=typeof window<"u"?_.useLayoutEffect:_.useEffect,Tw=new WeakMap;function O5(e,t){var r=R5(null,function(n){return e.forEach(function(s){return Oh(s,n)})});return F5(function(){var n=Tw.get(r);if(n){var s=new Set(n),a=new Set(e),i=r.current;s.forEach(function(o){a.has(o)||Oh(o,null)}),a.forEach(function(o){s.has(o)||Oh(o,i)})}Tw.set(r,e)},[e]),r}function I5(e){return e}function D5(e,t){t===void 0&&(t=I5);var r=[],n=!1,s={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(a){var i=t(a,n);return r.push(i),function(){r=r.filter(function(o){return o!==i})}},assignSyncMedium:function(a){for(n=!0;r.length;){var i=r;r=[],i.forEach(a)}r={push:function(o){return a(o)},filter:function(){return r}}},assignMedium:function(a){n=!0;var i=[];if(r.length){var o=r;r=[],o.forEach(a),i=r}var c=function(){var f=i;i=[],f.forEach(a)},u=function(){return Promise.resolve().then(c)};u(),r={push:function(f){i.push(f),u()},filter:function(f){return i=i.filter(f),r}}}};return s}function L5(e){e===void 0&&(e={});var t=D5(null);return t.options=ps({async:!0,ssr:!1},e),t}var KS=function(e){var t=e.sideCar,r=qS(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return _.createElement(n,ps({},r))};KS.isSideCarExport=!0;function M5(e,t){return e.useMedium(t),KS}var XS=L5(),Ih=function(){},g0=_.forwardRef(function(e,t){var r=_.useRef(null),n=_.useState({onScrollCapture:Ih,onWheelCapture:Ih,onTouchMoveCapture:Ih}),s=n[0],a=n[1],i=e.forwardProps,o=e.children,c=e.className,u=e.removeScrollBar,f=e.enabled,d=e.shards,h=e.sideCar,p=e.noRelative,g=e.noIsolation,m=e.inert,x=e.allowPinchZoom,y=e.as,w=y===void 0?"div":y,v=e.gapMode,S=qS(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),E=h,k=O5([r,t]),b=ps(ps({},S),s);return _.createElement(_.Fragment,null,f&&_.createElement(E,{sideCar:XS,removeScrollBar:u,shards:d,noRelative:p,noIsolation:g,inert:m,setCallbacks:a,allowPinchZoom:!!x,lockRef:r,gapMode:v}),i?_.cloneElement(_.Children.only(o),ps(ps({},b),{ref:k})):_.createElement(w,ps({},b,{className:c,ref:k}),o))});g0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};g0.classNames={fullWidth:If,zeroRight:Of};var B5=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function U5(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=B5();return t&&e.setAttribute("nonce",t),e}function $5(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function z5(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var W5=function(){var e=0,t=null;return{add:function(r){e==0&&(t=U5())&&($5(t,r),z5(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},V5=function(){var e=W5();return function(t,r){_.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},YS=function(){var e=V5(),t=function(r){var n=r.styles,s=r.dynamic;return e(n,s),null};return t},H5={left:0,top:0,right:0,gap:0},Dh=function(e){return parseInt(e||"",10)||0},G5=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[Dh(r),Dh(n),Dh(s)]},q5=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return H5;var t=G5(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},K5=YS(),Mo="data-scroll-locked",X5=function(e,t,r,n){var s=e.left,a=e.top,i=e.right,o=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(j5,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(o,"px ").concat(n,`;
  }
  body[`).concat(Mo,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(i,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(o,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Of,` {
    right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(If,` {
    margin-right: `).concat(o,"px ").concat(n,`;
  }
  
  .`).concat(Of," .").concat(Of,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(If," .").concat(If,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Mo,`] {
    `).concat(P5,": ").concat(o,`px;
  }
`)},Nw=function(){var e=parseInt(document.body.getAttribute(Mo)||"0",10);return isFinite(e)?e:0},Y5=function(){_.useEffect(function(){return document.body.setAttribute(Mo,(Nw()+1).toString()),function(){var e=Nw()-1;e<=0?document.body.removeAttribute(Mo):document.body.setAttribute(Mo,e.toString())}},[])},J5=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,s=n===void 0?"margin":n;Y5();var a=_.useMemo(function(){return q5(s)},[s]);return _.createElement(K5,{styles:X5(a,!t,s,r?"":"!important")})},ym=!1;if(typeof window<"u")try{var nf=Object.defineProperty({},"passive",{get:function(){return ym=!0,!0}});window.addEventListener("test",nf,nf),window.removeEventListener("test",nf,nf)}catch{ym=!1}var io=ym?{passive:!1}:!1,Q5=function(e){return e.tagName==="TEXTAREA"},JS=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Q5(e)&&r[t]==="visible")},Z5=function(e){return JS(e,"overflowY")},eD=function(e){return JS(e,"overflowX")},Cw=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var s=QS(e,n);if(s){var a=ZS(e,n),i=a[1],o=a[2];if(i>o)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},tD=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},rD=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},QS=function(e,t){return e==="v"?Z5(t):eD(t)},ZS=function(e,t){return e==="v"?tD(t):rD(t)},nD=function(e,t){return e==="h"&&t==="rtl"?-1:1},sD=function(e,t,r,n,s){var a=nD(e,window.getComputedStyle(t).direction),i=a*n,o=r.target,c=t.contains(o),u=!1,f=i>0,d=0,h=0;do{if(!o)break;var p=ZS(e,o),g=p[0],m=p[1],x=p[2],y=m-x-a*g;(g||y)&&QS(e,o)&&(d+=y,h+=g);var w=o.parentNode;o=w&&w.nodeType===Node.DOCUMENT_FRAGMENT_NODE?w.host:w}while(!c&&o!==document.body||c&&(t.contains(o)||t===o));return(f&&(Math.abs(d)<1||!s)||!f&&(Math.abs(h)<1||!s))&&(u=!0),u},sf=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},Aw=function(e){return[e.deltaX,e.deltaY]},jw=function(e){return e&&"current"in e?e.current:e},aD=function(e,t){return e[0]===t[0]&&e[1]===t[1]},iD=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},oD=0,oo=[];function lD(e){var t=_.useRef([]),r=_.useRef([0,0]),n=_.useRef(),s=_.useState(oD++)[0],a=_.useState(YS)[0],i=_.useRef(e);_.useEffect(function(){i.current=e},[e]),_.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var m=A5([e.lockRef.current],(e.shards||[]).map(jw),!0).filter(Boolean);return m.forEach(function(x){return x.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),m.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var o=_.useCallback(function(m,x){if("touches"in m&&m.touches.length===2||m.type==="wheel"&&m.ctrlKey)return!i.current.allowPinchZoom;var y=sf(m),w=r.current,v="deltaX"in m?m.deltaX:w[0]-y[0],S="deltaY"in m?m.deltaY:w[1]-y[1],E,k=m.target,b=Math.abs(v)>Math.abs(S)?"h":"v";if("touches"in m&&b==="h"&&k.type==="range")return!1;var N=Cw(b,k);if(!N)return!0;if(N?E=b:(E=b==="v"?"h":"v",N=Cw(b,k)),!N)return!1;if(!n.current&&"changedTouches"in m&&(v||S)&&(n.current=E),!E)return!0;var A=n.current||E;return sD(A,x,m,A==="h"?v:S,!0)},[]),c=_.useCallback(function(m){var x=m;if(!(!oo.length||oo[oo.length-1]!==a)){var y="deltaY"in x?Aw(x):sf(x),w=t.current.filter(function(E){return E.name===x.type&&(E.target===x.target||x.target===E.shadowParent)&&aD(E.delta,y)})[0];if(w&&w.should){x.cancelable&&x.preventDefault();return}if(!w){var v=(i.current.shards||[]).map(jw).filter(Boolean).filter(function(E){return E.contains(x.target)}),S=v.length>0?o(x,v[0]):!i.current.noIsolation;S&&x.cancelable&&x.preventDefault()}}},[]),u=_.useCallback(function(m,x,y,w){var v={name:m,delta:x,target:y,should:w,shadowParent:cD(y)};t.current.push(v),setTimeout(function(){t.current=t.current.filter(function(S){return S!==v})},1)},[]),f=_.useCallback(function(m){r.current=sf(m),n.current=void 0},[]),d=_.useCallback(function(m){u(m.type,Aw(m),m.target,o(m,e.lockRef.current))},[]),h=_.useCallback(function(m){u(m.type,sf(m),m.target,o(m,e.lockRef.current))},[]);_.useEffect(function(){return oo.push(a),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",c,io),document.addEventListener("touchmove",c,io),document.addEventListener("touchstart",f,io),function(){oo=oo.filter(function(m){return m!==a}),document.removeEventListener("wheel",c,io),document.removeEventListener("touchmove",c,io),document.removeEventListener("touchstart",f,io)}},[]);var p=e.removeScrollBar,g=e.inert;return _.createElement(_.Fragment,null,g?_.createElement(a,{styles:iD(s)}):null,p?_.createElement(J5,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function cD(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const uD=M5(XS,lD);var v0=_.forwardRef(function(e,t){return _.createElement(g0,ps({},e,{ref:t,sideCar:uD}))});v0.classNames=g0.classNames;var _m=["Enter"," "],fD=["ArrowDown","PageUp","Home"],ek=["ArrowUp","PageDown","End"],dD=[...fD,...ek],hD={ltr:[..._m,"ArrowRight"],rtl:[..._m,"ArrowLeft"]},pD={ltr:["ArrowLeft"],rtl:["ArrowRight"]},mu="Menu",[Bc,mD,xD]=f0(mu),[Wi,tk]=Ha(mu,[xD,x0,$S]),w0=x0(),rk=$S(),[gD,Vi]=Wi(mu),[vD,xu]=Wi(mu),nk=e=>{const{__scopeMenu:t,open:r=!1,children:n,dir:s,onOpenChange:a,modal:i=!0}=e,o=w0(t),[c,u]=_.useState(null),f=_.useRef(!1),d=nr(a),h=Qx(s);return _.useEffect(()=>{const p=()=>{f.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>f.current=!1;return document.addEventListener("keydown",p,{capture:!0}),()=>{document.removeEventListener("keydown",p,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),l.jsx(DS,{...o,children:l.jsx(gD,{scope:t,open:r,onOpenChange:d,content:c,onContentChange:u,children:l.jsx(vD,{scope:t,onClose:_.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:f,dir:h,modal:i,children:n})})})};nk.displayName=mu;var wD="MenuAnchor",fg=_.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,s=w0(r);return l.jsx(LS,{...s,...n,ref:t})});fg.displayName=wD;var dg="MenuPortal",[yD,sk]=Wi(dg,{forceMount:void 0}),ak=e=>{const{__scopeMenu:t,forceMount:r,children:n,container:s}=e,a=Vi(dg,t);return l.jsx(yD,{scope:t,forceMount:r,children:l.jsx(hu,{present:r||a.open,children:l.jsx(du,{asChild:!0,container:s,children:n})})})};ak.displayName=dg;var Nn="MenuContent",[_D,hg]=Wi(Nn),ik=_.forwardRef((e,t)=>{const r=sk(Nn,e.__scopeMenu),{forceMount:n=r.forceMount,...s}=e,a=Vi(Nn,e.__scopeMenu),i=xu(Nn,e.__scopeMenu);return l.jsx(Bc.Provider,{scope:e.__scopeMenu,children:l.jsx(hu,{present:n||a.open,children:l.jsx(Bc.Slot,{scope:e.__scopeMenu,children:i.modal?l.jsx(bD,{...s,ref:t}):l.jsx(SD,{...s,ref:t})})})})}),bD=_.forwardRef((e,t)=>{const r=Vi(Nn,e.__scopeMenu),n=_.useRef(null),s=Ye(t,n);return _.useEffect(()=>{const a=n.current;if(a)return ug(a)},[]),l.jsx(pg,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Ce(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),SD=_.forwardRef((e,t)=>{const r=Vi(Nn,e.__scopeMenu);return l.jsx(pg,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),kD=Ti("MenuContent.ScrollLock"),pg=_.forwardRef((e,t)=>{const{__scopeMenu:r,loop:n=!1,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:d,onInteractOutside:h,onDismiss:p,disableOutsideScroll:g,...m}=e,x=Vi(Nn,r),y=xu(Nn,r),w=w0(r),v=rk(r),S=mD(r),[E,k]=_.useState(null),b=_.useRef(null),N=Ye(t,b,x.onContentChange),A=_.useRef(0),O=_.useRef(""),V=_.useRef(0),C=_.useRef(null),B=_.useRef("right"),G=_.useRef(0),X=g?v0:_.Fragment,z=g?{as:kD,allowPinchZoom:!0}:void 0,q=F=>{var te,oe;const ne=O.current+F,Y=S().filter(ae=>!ae.disabled),j=document.activeElement,H=(te=Y.find(ae=>ae.ref.current===j))==null?void 0:te.textValue,U=Y.map(ae=>ae.textValue),W=DD(U,ne,H),J=(oe=Y.find(ae=>ae.textValue===W))==null?void 0:oe.ref.current;(function ae(se){O.current=se,window.clearTimeout(A.current),se!==""&&(A.current=window.setTimeout(()=>ae(""),1e3))})(ne),J&&setTimeout(()=>J.focus())};_.useEffect(()=>()=>window.clearTimeout(A.current),[]),hS();const K=_.useCallback(F=>{var Y,j;return B.current===((Y=C.current)==null?void 0:Y.side)&&MD(F,(j=C.current)==null?void 0:j.area)},[]);return l.jsx(_D,{scope:r,searchRef:O,onItemEnter:_.useCallback(F=>{K(F)&&F.preventDefault()},[K]),onItemLeave:_.useCallback(F=>{var ne;K(F)||((ne=b.current)==null||ne.focus(),k(null))},[K]),onTriggerLeave:_.useCallback(F=>{K(F)&&F.preventDefault()},[K]),pointerGraceTimerRef:V,onPointerGraceIntentChange:_.useCallback(F=>{C.current=F},[]),children:l.jsx(X,{...z,children:l.jsx(d0,{asChild:!0,trapped:s,onMountAutoFocus:Ce(a,F=>{var ne;F.preventDefault(),(ne=b.current)==null||ne.focus({preventScroll:!0})}),onUnmountAutoFocus:i,children:l.jsx(eg,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:u,onPointerDownOutside:f,onFocusOutside:d,onInteractOutside:h,onDismiss:p,children:l.jsx(k5,{asChild:!0,...v,dir:y.dir,orientation:"vertical",loop:n,currentTabStopId:E,onCurrentTabStopIdChange:k,onEntryFocus:Ce(c,F=>{y.isUsingKeyboardRef.current||F.preventDefault()}),preventScrollOnEntryFocus:!0,children:l.jsx(MS,{role:"menu","aria-orientation":"vertical","data-state":bk(x.open),"data-radix-menu-content":"",dir:y.dir,...w,...m,ref:N,style:{outline:"none",...m.style},onKeyDown:Ce(m.onKeyDown,F=>{const Y=F.target.closest("[data-radix-menu-content]")===F.currentTarget,j=F.ctrlKey||F.altKey||F.metaKey,H=F.key.length===1;Y&&(F.key==="Tab"&&F.preventDefault(),!j&&H&&q(F.key));const U=b.current;if(F.target!==U||!dD.includes(F.key))return;F.preventDefault();const J=S().filter(te=>!te.disabled).map(te=>te.ref.current);ek.includes(F.key)&&J.reverse(),OD(J)}),onBlur:Ce(e.onBlur,F=>{F.currentTarget.contains(F.target)||(window.clearTimeout(A.current),O.current="")}),onPointerMove:Ce(e.onPointerMove,Uc(F=>{const ne=F.target,Y=G.current!==F.clientX;if(F.currentTarget.contains(ne)&&Y){const j=F.clientX>G.current?"right":"left";B.current=j,G.current=F.clientX}}))})})})})})})});ik.displayName=Nn;var ED="MenuGroup",mg=_.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(Le.div,{role:"group",...n,ref:t})});mg.displayName=ED;var TD="MenuLabel",ok=_.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(Le.div,{...n,ref:t})});ok.displayName=TD;var Sd="MenuItem",Pw="menu.itemSelect",y0=_.forwardRef((e,t)=>{const{disabled:r=!1,onSelect:n,...s}=e,a=_.useRef(null),i=xu(Sd,e.__scopeMenu),o=hg(Sd,e.__scopeMenu),c=Ye(t,a),u=_.useRef(!1),f=()=>{const d=a.current;if(!r&&d){const h=new CustomEvent(Pw,{bubbles:!0,cancelable:!0});d.addEventListener(Pw,p=>n==null?void 0:n(p),{once:!0}),uu(d,h),h.defaultPrevented?u.current=!1:i.onClose()}};return l.jsx(lk,{...s,ref:c,disabled:r,onClick:Ce(e.onClick,f),onPointerDown:d=>{var h;(h=e.onPointerDown)==null||h.call(e,d),u.current=!0},onPointerUp:Ce(e.onPointerUp,d=>{var h;u.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:Ce(e.onKeyDown,d=>{const h=o.searchRef.current!=="";r||h&&d.key===" "||_m.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});y0.displayName=Sd;var lk=_.forwardRef((e,t)=>{const{__scopeMenu:r,disabled:n=!1,textValue:s,...a}=e,i=hg(Sd,r),o=rk(r),c=_.useRef(null),u=Ye(t,c),[f,d]=_.useState(!1),[h,p]=_.useState("");return _.useEffect(()=>{const g=c.current;g&&p((g.textContent??"").trim())},[a.children]),l.jsx(Bc.ItemSlot,{scope:r,disabled:n,textValue:s??h,children:l.jsx(E5,{asChild:!0,...o,focusable:!n,children:l.jsx(Le.div,{role:"menuitem","data-highlighted":f?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...a,ref:u,onPointerMove:Ce(e.onPointerMove,Uc(g=>{n?i.onItemLeave(g):(i.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Ce(e.onPointerLeave,Uc(g=>i.onItemLeave(g))),onFocus:Ce(e.onFocus,()=>d(!0)),onBlur:Ce(e.onBlur,()=>d(!1))})})})}),ND="MenuCheckboxItem",ck=_.forwardRef((e,t)=>{const{checked:r=!1,onCheckedChange:n,...s}=e;return l.jsx(pk,{scope:e.__scopeMenu,checked:r,children:l.jsx(y0,{role:"menuitemcheckbox","aria-checked":kd(r)?"mixed":r,...s,ref:t,"data-state":gg(r),onSelect:Ce(s.onSelect,()=>n==null?void 0:n(kd(r)?!0:!r),{checkForDefaultPrevented:!1})})})});ck.displayName=ND;var uk="MenuRadioGroup",[CD,AD]=Wi(uk,{value:void 0,onValueChange:()=>{}}),fk=_.forwardRef((e,t)=>{const{value:r,onValueChange:n,...s}=e,a=nr(n);return l.jsx(CD,{scope:e.__scopeMenu,value:r,onValueChange:a,children:l.jsx(mg,{...s,ref:t})})});fk.displayName=uk;var dk="MenuRadioItem",hk=_.forwardRef((e,t)=>{const{value:r,...n}=e,s=AD(dk,e.__scopeMenu),a=r===s.value;return l.jsx(pk,{scope:e.__scopeMenu,checked:a,children:l.jsx(y0,{role:"menuitemradio","aria-checked":a,...n,ref:t,"data-state":gg(a),onSelect:Ce(n.onSelect,()=>{var i;return(i=s.onValueChange)==null?void 0:i.call(s,r)},{checkForDefaultPrevented:!1})})})});hk.displayName=dk;var xg="MenuItemIndicator",[pk,jD]=Wi(xg,{checked:!1}),mk=_.forwardRef((e,t)=>{const{__scopeMenu:r,forceMount:n,...s}=e,a=jD(xg,r);return l.jsx(hu,{present:n||kd(a.checked)||a.checked===!0,children:l.jsx(Le.span,{...s,ref:t,"data-state":gg(a.checked)})})});mk.displayName=xg;var PD="MenuSeparator",xk=_.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e;return l.jsx(Le.div,{role:"separator","aria-orientation":"horizontal",...n,ref:t})});xk.displayName=PD;var RD="MenuArrow",gk=_.forwardRef((e,t)=>{const{__scopeMenu:r,...n}=e,s=w0(r);return l.jsx(BS,{...s,...n,ref:t})});gk.displayName=RD;var FD="MenuSub",[sK,vk]=Wi(FD),$l="MenuSubTrigger",wk=_.forwardRef((e,t)=>{const r=Vi($l,e.__scopeMenu),n=xu($l,e.__scopeMenu),s=vk($l,e.__scopeMenu),a=hg($l,e.__scopeMenu),i=_.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:c}=a,u={__scopeMenu:e.__scopeMenu},f=_.useCallback(()=>{i.current&&window.clearTimeout(i.current),i.current=null},[]);return _.useEffect(()=>f,[f]),_.useEffect(()=>{const d=o.current;return()=>{window.clearTimeout(d),c(null)}},[o,c]),l.jsx(fg,{asChild:!0,...u,children:l.jsx(lk,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":s.contentId,"data-state":bk(r.open),...e,ref:n0(t,s.onTriggerChange),onClick:d=>{var h;(h=e.onClick)==null||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Ce(e.onPointerMove,Uc(d=>{a.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!r.open&&!i.current&&(a.onPointerGraceIntentChange(null),i.current=window.setTimeout(()=>{r.onOpenChange(!0),f()},100))})),onPointerLeave:Ce(e.onPointerLeave,Uc(d=>{var p,g;f();const h=(p=r.content)==null?void 0:p.getBoundingClientRect();if(h){const m=(g=r.content)==null?void 0:g.dataset.side,x=m==="right",y=x?-5:5,w=h[x?"left":"right"],v=h[x?"right":"left"];a.onPointerGraceIntentChange({area:[{x:d.clientX+y,y:d.clientY},{x:w,y:h.top},{x:v,y:h.top},{x:v,y:h.bottom},{x:w,y:h.bottom}],side:m}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>a.onPointerGraceIntentChange(null),300)}else{if(a.onTriggerLeave(d),d.defaultPrevented)return;a.onPointerGraceIntentChange(null)}})),onKeyDown:Ce(e.onKeyDown,d=>{var p;const h=a.searchRef.current!=="";e.disabled||h&&d.key===" "||hD[n.dir].includes(d.key)&&(r.onOpenChange(!0),(p=r.content)==null||p.focus(),d.preventDefault())})})})});wk.displayName=$l;var yk="MenuSubContent",_k=_.forwardRef((e,t)=>{const r=sk(Nn,e.__scopeMenu),{forceMount:n=r.forceMount,...s}=e,a=Vi(Nn,e.__scopeMenu),i=xu(Nn,e.__scopeMenu),o=vk(yk,e.__scopeMenu),c=_.useRef(null),u=Ye(t,c);return l.jsx(Bc.Provider,{scope:e.__scopeMenu,children:l.jsx(hu,{present:n||a.open,children:l.jsx(Bc.Slot,{scope:e.__scopeMenu,children:l.jsx(pg,{id:o.contentId,"aria-labelledby":o.triggerId,...s,ref:u,align:"start",side:i.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:f=>{var d;i.isUsingKeyboardRef.current&&((d=c.current)==null||d.focus()),f.preventDefault()},onCloseAutoFocus:f=>f.preventDefault(),onFocusOutside:Ce(e.onFocusOutside,f=>{f.target!==o.trigger&&a.onOpenChange(!1)}),onEscapeKeyDown:Ce(e.onEscapeKeyDown,f=>{i.onClose(),f.preventDefault()}),onKeyDown:Ce(e.onKeyDown,f=>{var p;const d=f.currentTarget.contains(f.target),h=pD[i.dir].includes(f.key);d&&h&&(a.onOpenChange(!1),(p=o.trigger)==null||p.focus(),f.preventDefault())})})})})})});_k.displayName=yk;function bk(e){return e?"open":"closed"}function kd(e){return e==="indeterminate"}function gg(e){return kd(e)?"indeterminate":e?"checked":"unchecked"}function OD(e){const t=document.activeElement;for(const r of e)if(r===t||(r.focus(),document.activeElement!==t))return}function ID(e,t){return e.map((r,n)=>e[(t+n)%e.length])}function DD(e,t,r){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,a=r?e.indexOf(r):-1;let i=ID(e,Math.max(a,0));s.length===1&&(i=i.filter(u=>u!==r));const c=i.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function LD(e,t){const{x:r,y:n}=e;let s=!1;for(let a=0,i=t.length-1;a<t.length;i=a++){const o=t[a],c=t[i],u=o.x,f=o.y,d=c.x,h=c.y;f>n!=h>n&&r<(d-u)*(n-f)/(h-f)+u&&(s=!s)}return s}function MD(e,t){if(!t)return!1;const r={x:e.clientX,y:e.clientY};return LD(r,t)}function Uc(e){return t=>t.pointerType==="mouse"?e(t):void 0}var BD=nk,UD=fg,$D=ak,zD=ik,WD=mg,VD=ok,HD=y0,GD=ck,qD=fk,KD=hk,XD=mk,YD=xk,JD=gk,QD=wk,ZD=_k,_0="DropdownMenu",[e8,aK]=Ha(_0,[tk]),Dr=tk(),[t8,Sk]=e8(_0),kk=e=>{const{__scopeDropdownMenu:t,children:r,dir:n,open:s,defaultOpen:a,onOpenChange:i,modal:o=!0}=e,c=Dr(t),u=_.useRef(null),[f,d]=Qo({prop:s,defaultProp:a??!1,onChange:i,caller:_0});return l.jsx(t8,{scope:t,triggerId:Bs(),triggerRef:u,contentId:Bs(),open:f,onOpenChange:d,onOpenToggle:_.useCallback(()=>d(h=>!h),[d]),modal:o,children:l.jsx(BD,{...c,open:f,onOpenChange:d,dir:n,modal:o,children:r})})};kk.displayName=_0;var Ek="DropdownMenuTrigger",Tk=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,disabled:n=!1,...s}=e,a=Sk(Ek,r),i=Dr(r);return l.jsx(UD,{asChild:!0,...i,children:l.jsx(Le.button,{type:"button",id:a.triggerId,"aria-haspopup":"menu","aria-expanded":a.open,"aria-controls":a.open?a.contentId:void 0,"data-state":a.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...s,ref:n0(t,a.triggerRef),onPointerDown:Ce(e.onPointerDown,o=>{!n&&o.button===0&&o.ctrlKey===!1&&(a.onOpenToggle(),a.open||o.preventDefault())}),onKeyDown:Ce(e.onKeyDown,o=>{n||(["Enter"," "].includes(o.key)&&a.onOpenToggle(),o.key==="ArrowDown"&&a.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});Tk.displayName=Ek;var r8="DropdownMenuPortal",Nk=e=>{const{__scopeDropdownMenu:t,...r}=e,n=Dr(t);return l.jsx($D,{...n,...r})};Nk.displayName=r8;var Ck="DropdownMenuContent",Ak=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Sk(Ck,r),a=Dr(r),i=_.useRef(!1);return l.jsx(zD,{id:s.contentId,"aria-labelledby":s.triggerId,...a,...n,ref:t,onCloseAutoFocus:Ce(e.onCloseAutoFocus,o=>{var c;i.current||(c=s.triggerRef.current)==null||c.focus(),i.current=!1,o.preventDefault()}),onInteractOutside:Ce(e.onInteractOutside,o=>{const c=o.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,f=c.button===2||u;(!s.modal||f)&&(i.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Ak.displayName=Ck;var n8="DropdownMenuGroup",s8=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Dr(r);return l.jsx(WD,{...s,...n,ref:t})});s8.displayName=n8;var a8="DropdownMenuLabel",jk=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Dr(r);return l.jsx(VD,{...s,...n,ref:t})});jk.displayName=a8;var i8="DropdownMenuItem",Pk=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Dr(r);return l.jsx(HD,{...s,...n,ref:t})});Pk.displayName=i8;var o8="DropdownMenuCheckboxItem",Rk=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Dr(r);return l.jsx(GD,{...s,...n,ref:t})});Rk.displayName=o8;var l8="DropdownMenuRadioGroup",c8=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Dr(r);return l.jsx(qD,{...s,...n,ref:t})});c8.displayName=l8;var u8="DropdownMenuRadioItem",Fk=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Dr(r);return l.jsx(KD,{...s,...n,ref:t})});Fk.displayName=u8;var f8="DropdownMenuItemIndicator",Ok=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Dr(r);return l.jsx(XD,{...s,...n,ref:t})});Ok.displayName=f8;var d8="DropdownMenuSeparator",Ik=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Dr(r);return l.jsx(YD,{...s,...n,ref:t})});Ik.displayName=d8;var h8="DropdownMenuArrow",p8=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Dr(r);return l.jsx(JD,{...s,...n,ref:t})});p8.displayName=h8;var m8="DropdownMenuSubTrigger",Dk=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Dr(r);return l.jsx(QD,{...s,...n,ref:t})});Dk.displayName=m8;var x8="DropdownMenuSubContent",Lk=_.forwardRef((e,t)=>{const{__scopeDropdownMenu:r,...n}=e,s=Dr(r);return l.jsx(ZD,{...s,...n,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Lk.displayName=x8;var g8=kk,v8=Tk,w8=Nk,Mk=Ak,Bk=jk,Uk=Pk,$k=Rk,zk=Fk,Wk=Ok,Vk=Ik,Hk=Dk,Gk=Lk;const Lh=g8,Mh=v8,y8=_.forwardRef(({className:e,inset:t,children:r,...n},s)=>l.jsxs(Hk,{ref:s,className:Ke("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...n,children:[r,l.jsx(mP,{className:"ml-auto h-4 w-4"})]}));y8.displayName=Hk.displayName;const _8=_.forwardRef(({className:e,...t},r)=>l.jsx(Gk,{ref:r,className:Ke("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));_8.displayName=Gk.displayName;const Df=_.forwardRef(({className:e,sideOffset:t=4,...r},n)=>l.jsx(w8,{children:l.jsx(Mk,{ref:n,sideOffset:t,className:Ke("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));Df.displayName=Mk.displayName;const ii=_.forwardRef(({className:e,inset:t,...r},n)=>l.jsx(Uk,{ref:n,className:Ke("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...r}));ii.displayName=Uk.displayName;const b8=_.forwardRef(({className:e,children:t,checked:r,...n},s)=>l.jsxs($k,{ref:s,className:Ke("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:r,...n,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(Wk,{children:l.jsx(a0,{className:"h-4 w-4"})})}),t]}));b8.displayName=$k.displayName;const S8=_.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(zk,{ref:n,className:Ke("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(Wk,{children:l.jsx(vP,{className:"h-2 w-2 fill-current"})})}),t]}));S8.displayName=zk.displayName;const k8=_.forwardRef(({className:e,inset:t,...r},n)=>l.jsx(Bk,{ref:n,className:Ke("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...r}));k8.displayName=Bk.displayName;const Ps=_.forwardRef(({className:e,...t},r)=>l.jsx(Vk,{ref:r,className:Ke("-mx-1 my-1 h-px bg-muted",e),...t}));Ps.displayName=Vk.displayName;const E8=1,T8=1e6;let Bh=0;function N8(){return Bh=(Bh+1)%Number.MAX_SAFE_INTEGER,Bh.toString()}const Uh=new Map,Rw=e=>{if(Uh.has(e))return;const t=setTimeout(()=>{Uh.delete(e),sc({type:"REMOVE_TOAST",toastId:e})},T8);Uh.set(e,t)},C8=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,E8)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(r=>r.id===t.toast.id?{...r,...t.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=t;return r?Rw(r):e.toasts.forEach(n=>{Rw(n.id)}),{...e,toasts:e.toasts.map(n=>n.id===r||r===void 0?{...n,open:!1}:n)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(r=>r.id!==t.toastId)}}},Lf=[];let Mf={toasts:[]};function sc(e){Mf=C8(Mf,e),Lf.forEach(t=>{t(Mf)})}function A8({...e}){const t=N8(),r=s=>sc({type:"UPDATE_TOAST",toast:{...s,id:t}}),n=()=>sc({type:"DISMISS_TOAST",toastId:t});return sc({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:s=>{s||n()}}}),{id:t,dismiss:n,update:r}}function Xr(){const[e,t]=_.useState(Mf);return _.useEffect(()=>(Lf.push(t),()=>{const r=Lf.indexOf(t);r>-1&&Lf.splice(r,1)}),[e]),{...e,toast:A8,dismiss:r=>sc({type:"DISMISS_TOAST",toastId:r})}}const bm=({variant:e="form",className:t=""})=>{const{logout:r}=mn(),{logout:n,isAdmin:s}=Kr(),a=dr(),{toast:i}=Xr(),o=async()=>{console.log("Logout button clicked");try{s?(console.log("Logging out admin"),await n(),a("/admin")):(console.log("Logging out user"),await r(),a("/")),console.log("Logout completed"),i({title:"Success",description:"You have been logged out successfully"})}catch(c){console.error("Logout error:",c),i({title:"Error",description:"Failed to log out. Please try again.",variant:"destructive"})}};return e==="dropdown"?l.jsx("button",{onClick:o,className:`w-full text-left px-2 py-1.5 text-sm rounded-sm hover:bg-accent hover:text-accent-foreground cursor-pointer text-red-500 focus:text-red-500 ${t}`,children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(tm,{className:"w-4 h-4 mr-2"}),"Logout"]})}):l.jsxs(fe,{type:"button",variant:"outline",onClick:o,className:`border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground ${t}`,children:[l.jsx(tm,{className:"w-4 h-4 mr-2"}),"Log Out"]})},Tt=()=>{const[e,t]=_.useState(!1),{themePreference:r,appliedTheme:n,toggleTheme:s}=yO(),{language:a,setLanguage:i,t:o}=Js(),c=ol(),u=dr(),{user:f,logout:d}=mn(),{admin:h,isAdmin:p,logout:g,unreadMessageCount:m}=Kr(),{unreadCount:x,fetchUnreadCount:y}=_O(f==null?void 0:f.email);_.useEffect(()=>{const O=()=>{console.log("Navbar received playerMessagesRead event"),y()};return window.addEventListener("playerMessagesRead",O),()=>{window.removeEventListener("playerMessagesRead",O)}},[y]),_.useEffect(()=>{console.log("Player unread count updated:",x)},[x]);const w=()=>{t(!e)},v=()=>r==="auto"?l.jsx(wP,{className:"h-5 w-5"}):n==="dark"?l.jsx(OP,{className:"h-5 w-5"}):l.jsx(EP,{className:"h-5 w-5"}),S=()=>r==="auto"?"Auto":n==="dark"?a==="fr"?"Mode clair":"Light Mode":a==="fr"?"Mode sombre":"Dark Mode",E=async()=>{console.log("Admin logout clicked"),await g(),console.log("Admin logout completed"),u("/admin")},k=()=>{i(a==="en"?"fr":"en")},A=p?[{name:o("navbar.home"),href:"/"},{name:o("navbar.leaderboard"),href:"/leaderboard"},{name:o("navbar.learning"),href:"/learning"},{name:a==="en"?"Quiz Scores":"Scores du Quiz",href:"/quiz-scores"},{name:a==="en"?"Monthly Winners":"Gagnants du Mois",href:"/monthly-winners"}]:f?[{name:o("navbar.home"),href:"/"},{name:o("navbar.leaderboard"),href:"/leaderboard"},{name:o("navbar.learning"),href:"/learning"},{name:a==="en"?"Monthly Winners":"Gagnants du Mois",href:"/monthly-winners"}]:[{name:o("navbar.home"),href:"/"},{name:o("navbar.leaderboard"),href:"/leaderboard"}];return l.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-background/80 backdrop-blur-md border-b border-battle-purple/20",children:l.jsxs("div",{className:"container mx-auto px-4",children:[l.jsx("div",{className:"md:hidden",children:l.jsxs("div",{className:"flex items-center justify-between h-16 relative",children:[l.jsxs("div",{className:"flex items-center flex-1 min-w-0 z-10",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("img",{src:"/ofppt logo.png",alt:"OFPPT Logo",className:"h-10 w-auto"})}),l.jsx("div",{className:"ml-2 min-w-0",children:l.jsx("div",{className:"text-xs font-medium text-foreground flex flex-col bg-background/80 backdrop-blur-sm rounded-lg py-1 px-2",children:o("navbar.institute").split(" ").length>3?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"leading-tight truncate",children:o("navbar.institute").split(" ").slice(0,2).join(" ")}),l.jsx("span",{className:"leading-tight truncate",children:o("navbar.institute").split(" ").slice(2).join(" ")})]}):l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"text-[11px] leading-tight truncate",children:o("navbar.institute").split(" ").slice(0,3).join(" ")}),l.jsx("span",{className:"text-[11px] leading-tight truncate",children:o("navbar.institute").split(" ").slice(3).join(" ")})]})})})]}),l.jsx("div",{className:"flex items-center ml-auto z-10",children:f||p?l.jsxs(l.Fragment,{children:[l.jsxs(fe,{variant:"ghost",size:"icon",onClick:()=>{p?window.dispatchEvent(new CustomEvent("openMessagesPanel")):window.dispatchEvent(new CustomEvent("openPlayerMessagesPanel"))},className:"text-foreground hover:bg-battle-purple/10 hover:text-foreground mr-2 relative",title:"Messages",children:[l.jsx(gh,{className:"h-5 w-5"}),p&&m>0&&l.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:m>99?"99+":m}),!p&&x>0&&l.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:x>99?"99+":x})]}),l.jsxs(Lh,{children:[l.jsx(Mh,{asChild:!0,children:l.jsx("button",{className:"flex items-center bg-gradient-to-r from-battle-purple to-indigo-600 rounded-full w-10 h-10 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer justify-center",children:l.jsx("span",{className:"text-sm font-bold text-white",children:f?f.full_name?f.full_name.split(" ").map(O=>O[0]).slice(0,2).join(""):"U":"A"})})}),l.jsxs(Df,{align:"end",className:"w-64",children:[l.jsx("div",{className:"px-2 py-2",children:A.map(O=>l.jsx(ii,{onClick:()=>{u(O.href),t(!1)},className:`cursor-pointer ${c.pathname===O.href?"font-bold":""}`,children:O.name},O.name))}),l.jsx(Ps,{}),f&&l.jsxs(l.Fragment,{children:[l.jsxs(ii,{onClick:()=>{u("/profile"),t(!1)},className:"cursor-pointer",children:[l.jsx(Jn,{className:"w-4 h-4 mr-2"}),"Profile"]}),l.jsx(Ps,{})]}),p&&l.jsxs(l.Fragment,{children:[l.jsxs(ii,{onClick:()=>{u("/admin/dashboard"),t(!1)},className:"cursor-pointer",children:[l.jsx(L1,{className:"w-4 h-4 mr-2"}),o("navbar.dashboard")]}),l.jsx(Ps,{})]}),l.jsx("div",{className:"px-2 py-1.5",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[v(),l.jsx("span",{className:"ml-2 text-sm",children:S()})]}),l.jsxs("button",{onClick:O=>{O.stopPropagation(),s(),t(!1)},className:"relative inline-flex h-6 w-11 items-center rounded-full bg-battle-purple/30 transition-colors focus:outline-none focus:ring-2 focus:ring-battle-purple focus:ring-offset-2",children:[l.jsx("span",{className:"sr-only",children:"Toggle theme"}),l.jsx("span",{className:`${n==="dark"?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})]})]})}),l.jsx("div",{className:"px-2 py-1.5",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(Fl,{className:"w-4 h-4 mr-2"}),l.jsx("span",{className:"text-sm",children:a==="en"?"English":"Français"})]}),l.jsxs("button",{onClick:O=>{O.stopPropagation(),k(),t(!1)},className:"relative inline-flex h-6 w-11 items-center rounded-full bg-battle-purple/30 transition-colors focus:outline-none focus:ring-2 focus:ring-battle-purple focus:ring-offset-2",children:[l.jsx("span",{className:"sr-only",children:"Toggle language"}),l.jsx("span",{className:`${a==="fr"?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})]})]})}),l.jsx(Ps,{}),l.jsx(bm,{variant:"dropdown"})]})]})]}):l.jsxs(l.Fragment,{children:[l.jsx(fe,{variant:"ghost",size:"icon",onClick:k,className:"text-foreground hover:bg-battle-purple/10 hover:text-foreground mr-2",title:a==="en"?"Français":"English",children:l.jsx(Fl,{className:"h-5 w-5"})}),l.jsx(fe,{variant:"ghost",size:"icon",onClick:s,className:"text-foreground hover:bg-battle-purple/10 hover:text-foreground mr-2",title:S(),children:v()}),l.jsx(fe,{variant:"ghost",size:"icon",onClick:w,className:"text-foreground hover:bg-battle-purple/10 hover:text-foreground",children:e?l.jsx(rn,{className:"h-6 w-6"}):l.jsx(kP,{className:"h-6 w-6"})})]})})]})}),l.jsxs("div",{className:"hidden md:flex items-center justify-between h-16 w-full",children:[l.jsxs("div",{className:"flex-shrink-0 flex items-center",children:[l.jsx("img",{src:"/ofppt logo.png",alt:"OFPPT Logo",className:"h-10 w-auto"}),l.jsx("div",{className:"ml-3 text-sm font-medium text-foreground flex flex-col justify-center",children:o("navbar.institute").split(" ").length>3?l.jsxs(l.Fragment,{children:[l.jsx("span",{children:o("navbar.institute").split(" ").slice(0,2).join(" ")}),l.jsx("span",{children:o("navbar.institute").split(" ").slice(2).join(" ")})]}):l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"text-[13px]",children:o("navbar.institute").split(" ").slice(0,3).join(" ")}),l.jsx("span",{className:"text-[13px]",children:o("navbar.institute").split(" ").slice(3).join(" ")})]})})]}),l.jsx("nav",{className:`flex items-center ${p?"ml-12":""} absolute left-1/2 transform -translate-x-1/2`,children:A.map(O=>l.jsx(Zp,{to:O.href,className:`${c.pathname===O.href?"text-foreground font-bold border-b-2 border-purple-700":"text-foreground/80 hover:text-foreground hover:border-b-2 hover:border-purple-700/50"} transition-all duration-300 ease-in-out font-medium border-b-2 border-transparent mx-4 whitespace-nowrap ${a==="fr"?"text-sm":"text-base"}`,children:O.name},O.name))}),l.jsx("div",{className:"flex items-center space-x-4",children:l.jsxs("div",{className:"flex items-center space-x-2",children:[p&&l.jsxs("div",{className:"flex items-center space-x-3 mr-4",children:[l.jsxs(fe,{variant:"ghost",size:"icon",onClick:()=>{window.dispatchEvent(new CustomEvent("openMessagesPanel"))},className:"text-foreground hover:bg-battle-purple/10 hover:text-foreground relative",title:o("navbar.messages"),children:[l.jsx(gh,{className:"h-5 w-5"}),m>0&&l.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:m>99?"99+":m})]}),l.jsxs(Lh,{children:[l.jsx(Mh,{asChild:!0,children:l.jsxs("button",{className:"flex items-center bg-gradient-to-r from-battle-purple to-indigo-600 rounded-full px-4 py-1.5 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer",children:[l.jsx("span",{className:"text-xs font-semibold text-white mr-2",children:"ADMIN"}),l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 text-white",children:[l.jsx("path",{d:"M12 5v14"}),l.jsx("path",{d:"M5 12h14"})]})]})}),l.jsxs(Df,{align:"end",className:"w-56",children:[l.jsxs(ii,{onClick:()=>u("/admin/dashboard"),className:"cursor-pointer",children:[l.jsx(L1,{className:"w-4 h-4 mr-2"}),o("navbar.dashboard")]}),l.jsx(Ps,{}),l.jsx("div",{className:"px-2 py-1.5",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[v(),l.jsx("span",{className:"ml-2 text-sm",children:S()})]}),l.jsxs("button",{onClick:O=>{O.stopPropagation(),s()},className:"relative inline-flex h-6 w-11 items-center rounded-full bg-battle-purple/30 transition-colors focus:outline-none focus:ring-2 focus:ring-battle-purple focus:ring-offset-2",children:[l.jsx("span",{className:"sr-only",children:"Toggle theme"}),l.jsx("span",{className:`${n==="dark"?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})]})]})}),l.jsx("div",{className:"px-2 py-1.5",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(Fl,{className:"w-4 h-4 mr-2"}),l.jsx("span",{className:"text-sm",children:a==="en"?"English":"Français"})]}),l.jsxs("button",{onClick:O=>{O.stopPropagation(),k()},className:"relative inline-flex h-6 w-11 items-center rounded-full bg-battle-purple/30 transition-colors focus:outline-none focus:ring-2 focus:ring-battle-purple focus:ring-offset-2",children:[l.jsx("span",{className:"sr-only",children:"Toggle language"}),l.jsx("span",{className:`${a==="fr"?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})]})]})}),l.jsx(Ps,{}),l.jsxs(ii,{onClick:E,className:"cursor-pointer text-red-500 focus:text-red-500",children:[l.jsx(tm,{className:"w-4 h-4 mr-2"}),o("navbar.logout")]})]})]})]}),f?l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsxs(fe,{variant:"ghost",size:"icon",onClick:()=>{window.dispatchEvent(new CustomEvent("openPlayerMessagesPanel"))},className:"text-foreground hover:bg-battle-purple/10 hover:text-foreground relative",title:"Messages",children:[l.jsx(gh,{className:"h-5 w-5"}),x>0&&l.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:x>99?"99+":x})]}),l.jsxs(Lh,{children:[l.jsx(Mh,{asChild:!0,children:l.jsxs("button",{className:"flex items-center bg-gradient-to-r from-battle-purple to-indigo-600 rounded-full px-3 py-1.5 shadow-sm hover:shadow-md transition-all duration-200 cursor-pointer",children:[l.jsx("span",{className:"text-xs font-medium text-white mr-1",children:f.full_name}),l.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4 text-white",children:[l.jsx("path",{d:"M12 5v14"}),l.jsx("path",{d:"M5 12h14"})]})]})}),l.jsxs(Df,{align:"end",className:"w-56",children:[l.jsxs(ii,{onClick:()=>{u("/profile")},className:"cursor-pointer",children:[l.jsx(Jn,{className:"w-4 h-4 mr-2"}),"Profile"]}),l.jsx(Ps,{}),l.jsx("div",{className:"px-2 py-1.5",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[v(),l.jsx("span",{className:"ml-2 text-sm",children:S()})]}),l.jsxs("button",{onClick:O=>{O.stopPropagation(),s()},className:"relative inline-flex h-6 w-11 items-center rounded-full bg-battle-purple/30 transition-colors focus:outline-none focus:ring-2 focus:ring-battle-purple focus:ring-offset-2",children:[l.jsx("span",{className:"sr-only",children:"Toggle theme"}),l.jsx("span",{className:`$ ${n==="dark"?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})]})]})}),l.jsx("div",{className:"px-2 py-1.5",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(Fl,{className:"w-4 h-4 mr-2"}),l.jsx("span",{className:"text-sm",children:a==="en"?"English":"Français"})]}),l.jsxs("button",{onClick:O=>{O.stopPropagation(),k()},className:"relative inline-flex h-6 w-11 items-center rounded-full bg-battle-purple/30 transition-colors focus:outline-none focus:ring-2 focus:ring-battle-purple focus:ring-offset-2",children:[l.jsx("span",{className:"sr-only",children:"Toggle language"}),l.jsx("span",{className:`${a==="fr"?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})]})]})}),l.jsx(Ps,{}),l.jsx(bm,{variant:"dropdown"})]})]})]}):!p&&l.jsxs(l.Fragment,{children:[l.jsx(fe,{variant:"ghost",size:"icon",onClick:k,className:"text-foreground hover:bg-battle-purple/10 hover:text-foreground",title:a==="en"?"Français":"English",children:l.jsx(Fl,{className:"h-5 w-5"})}),l.jsx(fe,{variant:"ghost",size:"icon",onClick:s,className:"text-foreground hover:bg-battle-purple/10 hover:text-foreground",title:S(),children:v()}),l.jsx(fe,{variant:"outline",onClick:()=>u("/login"),className:"border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:o("navbar.login")}),l.jsx(fe,{onClick:()=>window.open("https://css-battle-isfo.vercel.app/","_blank"),className:"bg-gradient-primary hover:scale-105 transition-transform shadow-glow",children:o("navbar.register")})]})]})})]}),e&&l.jsx("div",{className:"md:hidden py-4 border-t border-battle-purple/20",children:l.jsxs("div",{className:"flex flex-col space-y-4",children:[A.map(O=>l.jsx(Zp,{to:O.href,className:`${c.pathname===O.href?"text-foreground font-bold border-b-2 border-purple-700":"text-foreground/80 hover:text-foreground hover:border-b-2 hover:border-purple-700/50"} transition-all duration-300 ease-in-out font-medium border-b-2 border-transparent px-2 py-1 whitespace-nowrap ${a==="fr"?"text-sm":"text-base"}`,onClick:()=>t(!1),children:O.name},O.name)),l.jsx("div",{className:"flex flex-col space-y-2 pt-4",children:!f&&!p&&l.jsxs(l.Fragment,{children:[l.jsx(fe,{variant:"outline",onClick:()=>{u("/login"),t(!1)},className:"w-full border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:o("navbar.login")}),l.jsx(fe,{onClick:()=>{window.open("https://css-battle-isfo.vercel.app/","_blank"),t(!1)},className:"w-full bg-gradient-primary hover:scale-105 transition-transform shadow-glow",children:o("navbar.register")})]})})]})})]})})},j8=()=>{var p;mn(),Kr();const{t:e,language:t}=Js(),[r,n]=_.useState(null),[s,a]=_.useState(0),[i,o]=_.useState(!1),[c,u]=_.useState(null),f=[".battle {","  display: flex;","  background: linear-gradient(135deg, #A020F0, #E796E7);","  transform: scale(1.1);","}"];_.useEffect(()=>{const g=setTimeout(()=>{d(),h()},100);return()=>clearTimeout(g)},[]);const d=async()=>{try{const{count:g,error:m}=await ge.from("players").select("*",{count:"exact",head:!0});n(!m&&g!==null?g:1e3)}catch{n(1e3)}},h=()=>{const g=new Date,x=new Date(g.getFullYear(),g.getMonth()+1,0).getDate()-g.getDate()+1;a(x),o(x<=1)};return _.useEffect(()=>{i&&(async()=>{try{const{data:m,error:x}=await ge.from("players").select("full_name, score").order("score",{ascending:!1}).limit(1).single();!x&&m&&u(m)}catch(m){console.error("Error fetching current winner:",m)}})()},[i]),l.jsxs("main",{className:"min-h-screen bg-background overflow-hidden relative font-heading",children:[l.jsx(Tt,{}),l.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[l.jsxs("div",{className:"hidden sm:block",children:[l.jsx(Ie,{color:"purple",size:200,top:"15%",left:"5%",delay:0}),l.jsx(Ie,{color:"pink",size:150,top:"65%",left:"80%",delay:1,rotation:!0}),l.jsx(Ie,{color:"yellow",size:100,top:"35%",left:"75%",delay:.5}),l.jsx(Ie,{color:"purple",size:80,top:"85%",left:"15%",delay:1.5})]}),l.jsxs("div",{className:"sm:hidden",children:[l.jsx(Ie,{color:"purple",size:120,top:"10%",left:"80%",delay:0}),l.jsx(Ie,{color:"pink",size:90,top:"70%",left:"15%",delay:1,rotation:!0})]})]}),l.jsx("section",{className:"relative z-10 container mx-auto px-4 py-24 md:py-32",children:l.jsxs("div",{className:"text-center",children:[l.jsxs("div",{className:"inline-flex items-center gap-2 bg-gradient-primary text-foreground px-4 py-2 rounded-full mb-6 md:mb-8 shadow-glow",children:[l.jsx(IP,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-semibold uppercase tracking-wider",children:t==="en"?"Live Competition":"Compétition en Direct"})]}),l.jsxs("h1",{className:"text-4xl sm:text-5xl md:text-7xl lg:text-8xl font-bold mb-6 md:mb-8 leading-tight",children:[l.jsx("span",{className:"block text-foreground",children:"CSS"}),l.jsx("span",{className:"block bg-gradient-primary bg-clip-text text-transparent",children:"BATTLE"}),l.jsx("span",{className:"block text-battle-accent",children:t==="en"?"CHAMPIONSHIP":"CHAMPIONNAT"})]}),l.jsx("p",{className:"text-lg md:text-xl lg:text-2xl text-foreground/80 mb-8 md:mb-12 max-w-3xl mx-auto",children:t==="en"?"Compete with other players. Write the cleanest code. Claim victory.":"Affrontez des autres joueurs. Écrivez le code le plus propre. Remportez la victoire."}),l.jsx("div",{className:"max-w-2xl mx-auto mb-12 md:mb-16",children:l.jsx(sP,{lines:f,className:"animate-float"})})]})}),i&&c&&l.jsx("section",{className:"relative z-10 container mx-auto px-4 pb-8",children:l.jsxs(Pe,{className:"bg-gradient-to-r from-yellow-500/20 to-amber-500/20 border-2 border-yellow-500/50 backdrop-blur-sm shadow-lg shadow-yellow-500/20 p-6 md:p-8 text-center max-w-3xl mx-auto",children:[l.jsx("div",{className:"flex justify-center mb-4",children:l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"absolute -inset-4 bg-yellow-500 rounded-full blur-lg opacity-75 animate-pulse"}),l.jsx("div",{className:"relative bg-gradient-to-br from-yellow-400 to-amber-500 rounded-full p-4",children:l.jsx(Fc,{className:"w-12 h-12 text-white"})})]})}),l.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-yellow-500 mb-2",children:t==="en"?"Monthly Champion":"Champion du Mois"}),l.jsx("h3",{className:"text-xl md:text-2xl font-bold text-foreground mb-4",children:c.full_name}),l.jsxs("div",{className:"text-3xl md:text-4xl font-bold text-foreground mb-6",children:[((p=c.score)==null?void 0:p.toLocaleString())||"0"," ","Points"]}),l.jsx("p",{className:"text-lg text-foreground mb-6",children:t==="en"?"Congratulations to our monthly winner!":"Félicitations à notre gagnant du mois !"}),l.jsx(Zp,{to:"/monthly-winners",children:l.jsx(fe,{className:"bg-gradient-primary hover:scale-105 transition-transform",children:t==="en"?"View All Monthly Winners":"Voir Tous les Gagnants"})})]})}),l.jsx("section",{className:"relative z-10 container mx-auto px-4 pb-8 md:pb-12",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6 max-w-6xl mx-auto",children:[l.jsx(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-pink/30 p-4 md:p-6 hover:scale-105 transition-transform hover:shadow-glow-pink",children:l.jsxs("div",{className:"flex flex-col items-center text-center",children:[l.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-battle-pink rounded-lg flex items-center justify-center mb-3 shadow-glow-pink",children:l.jsx(cl,{className:"w-5 h-5 md:w-6 md:h-6 text-background"})}),l.jsx("h3",{className:"text-lg md:text-xl font-bold mb-1 text-foreground",children:t==="en"?"Players":"Joueurs"}),l.jsx("p",{className:"text-xl md:text-2xl font-bold text-battle-pink mb-1",children:r!==null?r.toLocaleString():"20+"}),l.jsx("p",{className:"text-sm text-foreground/70",children:t==="en"?"Developers competing":"Développeurs en compétition"})]})}),l.jsx(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-accent/30 p-4 md:p-6 hover:scale-105 transition-transform hover:shadow-glow-accent",children:l.jsxs("div",{className:"flex flex-col items-center text-center",children:[l.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-battle-accent rounded-lg flex items-center justify-center mb-3 shadow-glow-accent",children:l.jsx(yP,{className:"w-5 h-5 md:w-6 md:h-6 text-background"})}),l.jsx("h3",{className:"text-lg md:text-xl font-bold mb-1 text-foreground",children:t==="en"?"Challenges":"Défis"}),l.jsx("p",{className:"text-xl md:text-2xl font-bold text-battle-accent mb-1",children:"50+"}),l.jsx("p",{className:"text-sm text-foreground/70",children:t==="en"?"Unique CSS battles":"Batailles CSS uniques"})]})}),l.jsx(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-4 md:p-6 hover:scale-105 transition-transform hover:shadow-glow",children:l.jsxs("div",{className:"flex flex-col items-center text-center",children:[l.jsx("div",{className:"w-10 h-10 md:w-12 md:h-12 bg-gradient-primary rounded-lg flex items-center justify-center mb-3 shadow-glow",children:l.jsx(Fa,{className:"w-5 h-5 md:w-6 md:h-6 text-foreground"})}),l.jsx("h3",{className:"text-lg md:text-xl font-bold mb-1 text-foreground",children:t==="en"?"Daily Challenge":"Défi Quotidien"}),l.jsx("p",{className:"text-sm text-foreground/70 mb-3",children:t==="en"?"Test your skills":"Testez vos compétences"}),l.jsx("a",{href:"https://cssbattle.dev/daily",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center bg-gradient-primary text-foreground px-4 py-2 rounded-lg text-sm font-semibold hover:scale-105 transition-transform shadow-glow",children:t==="en"?"Take Challenge":"Relever le Défi"})]})})]})}),l.jsx("section",{className:"relative z-10 container mx-auto px-4 pb-12 md:pb-20",children:l.jsxs(Pe,{className:"bg-gradient-primary p-6 md:p-8 text-center shadow-glow max-w-3xl mx-auto",children:[l.jsxs("div",{className:"flex flex-wrap gap-3 justify-center text-sm md:text-base",children:[l.jsx("div",{className:"bg-background/20 backdrop-blur-sm px-3 md:px-5 py-1.5 md:py-2 rounded-lg",children:l.jsx("span",{className:"text-foreground/80",children:t==="en"?"Online Event":"Événement en Ligne"})}),l.jsx("div",{className:"bg-background/20 backdrop-blur-sm px-3 md:px-5 py-1.5 md:py-2 rounded-lg",children:l.jsx("span",{className:"text-foreground/80",children:t==="en"?"All Skill Levels":"Tous Niveaux de Compétence"})}),l.jsx("div",{className:"bg-background/20 backdrop-blur-sm px-3 md:px-5 py-1.5 md:py-2 rounded-lg",children:l.jsx("span",{className:"text-foreground/80",children:t==="en"?"Live Leaderboard":"Classement en Direct"})})]}),l.jsxs(Pe,{className:"mt-8 bg-background/30 backdrop-blur-sm border-foreground/20 p-6 max-w-md mx-auto",children:[l.jsxs("div",{className:"flex items-center justify-center gap-3 mb-2",children:[l.jsx(Vx,{className:"w-5 h-5 text-foreground"}),l.jsx("h3",{className:"text-lg md:text-xl font-bold text-foreground",children:t==="en"?"Days Left This Month":"Jours Restants Ce Mois"})]}),l.jsx("p",{className:"text-2xl md:text-3xl font-bold text-battle-accent",children:s})]})]})})]})},tt=_.forwardRef(({className:e,type:t,...r},n)=>l.jsx("input",{type:t,className:Ke("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));tt.displayName="Input";var P8="Label",qk=_.forwardRef((e,t)=>l.jsx(Le.label,{...e,ref:t,onMouseDown:r=>{var s;r.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));qk.displayName=P8;var Kk=qk;const R8=s0("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),He=_.forwardRef(({className:e,...t},r)=>l.jsx(Kk,{ref:r,className:Ke(R8(),e),...t}));He.displayName=Kk.displayName;function Fw(e,[t,r]){return Math.min(r,Math.max(t,e))}function F8(e){const t=_.useRef({value:e,previous:e});return _.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Xk=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),O8="VisuallyHidden",vg=_.forwardRef((e,t)=>l.jsx(Le.span,{...e,ref:t,style:{...Xk,...e.style}}));vg.displayName=O8;var I8=[" ","Enter","ArrowUp","ArrowDown"],D8=[" ","Enter"],Ai="Select",[b0,S0,L8]=f0(Ai),[pl,iK]=Ha(Ai,[L8,x0]),k0=x0(),[M8,Ga]=pl(Ai),[B8,U8]=pl(Ai),Yk=e=>{const{__scopeSelect:t,children:r,open:n,defaultOpen:s,onOpenChange:a,value:i,defaultValue:o,onValueChange:c,dir:u,name:f,autoComplete:d,disabled:h,required:p,form:g}=e,m=k0(t),[x,y]=_.useState(null),[w,v]=_.useState(null),[S,E]=_.useState(!1),k=Qx(u),[b,N]=Qo({prop:n,defaultProp:s??!1,onChange:a,caller:Ai}),[A,O]=Qo({prop:i,defaultProp:o,onChange:c,caller:Ai}),V=_.useRef(null),C=x?g||!!x.closest("form"):!0,[B,G]=_.useState(new Set),X=Array.from(B).map(z=>z.props.value).join(";");return l.jsx(DS,{...m,children:l.jsxs(M8,{required:p,scope:t,trigger:x,onTriggerChange:y,valueNode:w,onValueNodeChange:v,valueNodeHasChildren:S,onValueNodeHasChildrenChange:E,contentId:Bs(),value:A,onValueChange:O,open:b,onOpenChange:N,dir:k,triggerPointerDownPosRef:V,disabled:h,children:[l.jsx(b0.Provider,{scope:t,children:l.jsx(B8,{scope:e.__scopeSelect,onNativeOptionAdd:_.useCallback(z=>{G(q=>new Set(q).add(z))},[]),onNativeOptionRemove:_.useCallback(z=>{G(q=>{const K=new Set(q);return K.delete(z),K})},[]),children:r})}),C?l.jsxs(_E,{"aria-hidden":!0,required:p,tabIndex:-1,name:f,autoComplete:d,value:A,onChange:z=>O(z.target.value),disabled:h,form:g,children:[A===void 0?l.jsx("option",{value:""}):null,Array.from(B)]},X):null]})})};Yk.displayName=Ai;var Jk="SelectTrigger",Qk=_.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...s}=e,a=k0(r),i=Ga(Jk,r),o=i.disabled||n,c=Ye(t,i.onTriggerChange),u=S0(r),f=_.useRef("touch"),[d,h,p]=SE(m=>{const x=u().filter(v=>!v.disabled),y=x.find(v=>v.value===i.value),w=kE(x,m,y);w!==void 0&&i.onValueChange(w.value)}),g=m=>{o||(i.onOpenChange(!0),p()),m&&(i.triggerPointerDownPosRef.current={x:Math.round(m.pageX),y:Math.round(m.pageY)})};return l.jsx(LS,{asChild:!0,...a,children:l.jsx(Le.button,{type:"button",role:"combobox","aria-controls":i.contentId,"aria-expanded":i.open,"aria-required":i.required,"aria-autocomplete":"none",dir:i.dir,"data-state":i.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":bE(i.value)?"":void 0,...s,ref:c,onClick:Ce(s.onClick,m=>{m.currentTarget.focus(),f.current!=="mouse"&&g(m)}),onPointerDown:Ce(s.onPointerDown,m=>{f.current=m.pointerType;const x=m.target;x.hasPointerCapture(m.pointerId)&&x.releasePointerCapture(m.pointerId),m.button===0&&m.ctrlKey===!1&&m.pointerType==="mouse"&&(g(m),m.preventDefault())}),onKeyDown:Ce(s.onKeyDown,m=>{const x=d.current!=="";!(m.ctrlKey||m.altKey||m.metaKey)&&m.key.length===1&&h(m.key),!(x&&m.key===" ")&&I8.includes(m.key)&&(g(),m.preventDefault())})})})});Qk.displayName=Jk;var Zk="SelectValue",eE=_.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,children:a,placeholder:i="",...o}=e,c=Ga(Zk,r),{onValueNodeHasChildrenChange:u}=c,f=a!==void 0,d=Ye(t,c.onValueNodeChange);return Lt(()=>{u(f)},[u,f]),l.jsx(Le.span,{...o,ref:d,style:{pointerEvents:"none"},children:bE(c.value)?l.jsx(l.Fragment,{children:i}):a})});eE.displayName=Zk;var $8="SelectIcon",tE=_.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...s}=e;return l.jsx(Le.span,{"aria-hidden":!0,...s,ref:t,children:n||"▼"})});tE.displayName=$8;var z8="SelectPortal",rE=e=>l.jsx(du,{asChild:!0,...e});rE.displayName=z8;var ji="SelectContent",nE=_.forwardRef((e,t)=>{const r=Ga(ji,e.__scopeSelect),[n,s]=_.useState();if(Lt(()=>{s(new DocumentFragment)},[]),!r.open){const a=n;return a?Ui.createPortal(l.jsx(sE,{scope:e.__scopeSelect,children:l.jsx(b0.Slot,{scope:e.__scopeSelect,children:l.jsx("div",{children:e.children})})}),a):null}return l.jsx(aE,{...e,ref:t})});nE.displayName=ji;var Un=10,[sE,qa]=pl(ji),W8="SelectContentImpl",V8=Ti("SelectContent.RemoveScroll"),aE=_.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:a,onPointerDownOutside:i,side:o,sideOffset:c,align:u,alignOffset:f,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:g,hideWhenDetached:m,avoidCollisions:x,...y}=e,w=Ga(ji,r),[v,S]=_.useState(null),[E,k]=_.useState(null),b=Ye(t,te=>S(te)),[N,A]=_.useState(null),[O,V]=_.useState(null),C=S0(r),[B,G]=_.useState(!1),X=_.useRef(!1);_.useEffect(()=>{if(v)return ug(v)},[v]),hS();const z=_.useCallback(te=>{const[oe,...ae]=C().map(I=>I.ref.current),[se]=ae.slice(-1),de=document.activeElement;for(const I of te)if(I===de||(I==null||I.scrollIntoView({block:"nearest"}),I===oe&&E&&(E.scrollTop=0),I===se&&E&&(E.scrollTop=E.scrollHeight),I==null||I.focus(),document.activeElement!==de))return},[C,E]),q=_.useCallback(()=>z([N,v]),[z,N,v]);_.useEffect(()=>{B&&q()},[B,q]);const{onOpenChange:K,triggerPointerDownPosRef:F}=w;_.useEffect(()=>{if(v){let te={x:0,y:0};const oe=se=>{var de,I;te={x:Math.abs(Math.round(se.pageX)-(((de=F.current)==null?void 0:de.x)??0)),y:Math.abs(Math.round(se.pageY)-(((I=F.current)==null?void 0:I.y)??0))}},ae=se=>{te.x<=10&&te.y<=10?se.preventDefault():v.contains(se.target)||K(!1),document.removeEventListener("pointermove",oe),F.current=null};return F.current!==null&&(document.addEventListener("pointermove",oe),document.addEventListener("pointerup",ae,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",oe),document.removeEventListener("pointerup",ae,{capture:!0})}}},[v,K,F]),_.useEffect(()=>{const te=()=>K(!1);return window.addEventListener("blur",te),window.addEventListener("resize",te),()=>{window.removeEventListener("blur",te),window.removeEventListener("resize",te)}},[K]);const[ne,Y]=SE(te=>{const oe=C().filter(de=>!de.disabled),ae=oe.find(de=>de.ref.current===document.activeElement),se=kE(oe,te,ae);se&&setTimeout(()=>se.ref.current.focus())}),j=_.useCallback((te,oe,ae)=>{const se=!X.current&&!ae;(w.value!==void 0&&w.value===oe||se)&&(A(te),se&&(X.current=!0))},[w.value]),H=_.useCallback(()=>v==null?void 0:v.focus(),[v]),U=_.useCallback((te,oe,ae)=>{const se=!X.current&&!ae;(w.value!==void 0&&w.value===oe||se)&&V(te)},[w.value]),W=n==="popper"?Sm:iE,J=W===Sm?{side:o,sideOffset:c,align:u,alignOffset:f,arrowPadding:d,collisionBoundary:h,collisionPadding:p,sticky:g,hideWhenDetached:m,avoidCollisions:x}:{};return l.jsx(sE,{scope:r,content:v,viewport:E,onViewportChange:k,itemRefCallback:j,selectedItem:N,onItemLeave:H,itemTextRefCallback:U,focusSelectedItem:q,selectedItemText:O,position:n,isPositioned:B,searchRef:ne,children:l.jsx(v0,{as:V8,allowPinchZoom:!0,children:l.jsx(d0,{asChild:!0,trapped:w.open,onMountAutoFocus:te=>{te.preventDefault()},onUnmountAutoFocus:Ce(s,te=>{var oe;(oe=w.trigger)==null||oe.focus({preventScroll:!0}),te.preventDefault()}),children:l.jsx(eg,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:a,onPointerDownOutside:i,onFocusOutside:te=>te.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:l.jsx(W,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:te=>te.preventDefault(),...y,...J,onPlaced:()=>G(!0),ref:b,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:Ce(y.onKeyDown,te=>{const oe=te.ctrlKey||te.altKey||te.metaKey;if(te.key==="Tab"&&te.preventDefault(),!oe&&te.key.length===1&&Y(te.key),["ArrowUp","ArrowDown","Home","End"].includes(te.key)){let se=C().filter(de=>!de.disabled).map(de=>de.ref.current);if(["ArrowUp","End"].includes(te.key)&&(se=se.slice().reverse()),["ArrowUp","ArrowDown"].includes(te.key)){const de=te.target,I=se.indexOf(de);se=se.slice(I+1)}setTimeout(()=>z(se)),te.preventDefault()}})})})})})})});aE.displayName=W8;var H8="SelectItemAlignedPosition",iE=_.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...s}=e,a=Ga(ji,r),i=qa(ji,r),[o,c]=_.useState(null),[u,f]=_.useState(null),d=Ye(t,b=>f(b)),h=S0(r),p=_.useRef(!1),g=_.useRef(!0),{viewport:m,selectedItem:x,selectedItemText:y,focusSelectedItem:w}=i,v=_.useCallback(()=>{if(a.trigger&&a.valueNode&&o&&u&&m&&x&&y){const b=a.trigger.getBoundingClientRect(),N=u.getBoundingClientRect(),A=a.valueNode.getBoundingClientRect(),O=y.getBoundingClientRect();if(a.dir!=="rtl"){const de=O.left-N.left,I=A.left-de,Be=b.left-I,Re=b.width+Be,Ve=Math.max(Re,N.width),Oe=window.innerWidth-Un,xe=Fw(I,[Un,Math.max(Un,Oe-Ve)]);o.style.minWidth=Re+"px",o.style.left=xe+"px"}else{const de=N.right-O.right,I=window.innerWidth-A.right-de,Be=window.innerWidth-b.right-I,Re=b.width+Be,Ve=Math.max(Re,N.width),Oe=window.innerWidth-Un,xe=Fw(I,[Un,Math.max(Un,Oe-Ve)]);o.style.minWidth=Re+"px",o.style.right=xe+"px"}const V=h(),C=window.innerHeight-Un*2,B=m.scrollHeight,G=window.getComputedStyle(u),X=parseInt(G.borderTopWidth,10),z=parseInt(G.paddingTop,10),q=parseInt(G.borderBottomWidth,10),K=parseInt(G.paddingBottom,10),F=X+z+B+K+q,ne=Math.min(x.offsetHeight*5,F),Y=window.getComputedStyle(m),j=parseInt(Y.paddingTop,10),H=parseInt(Y.paddingBottom,10),U=b.top+b.height/2-Un,W=C-U,J=x.offsetHeight/2,te=x.offsetTop+J,oe=X+z+te,ae=F-oe;if(oe<=U){const de=V.length>0&&x===V[V.length-1].ref.current;o.style.bottom="0px";const I=u.clientHeight-m.offsetTop-m.offsetHeight,Be=Math.max(W,J+(de?H:0)+I+q),Re=oe+Be;o.style.height=Re+"px"}else{const de=V.length>0&&x===V[0].ref.current;o.style.top="0px";const Be=Math.max(U,X+m.offsetTop+(de?j:0)+J)+ae;o.style.height=Be+"px",m.scrollTop=oe-U+m.offsetTop}o.style.margin=`${Un}px 0`,o.style.minHeight=ne+"px",o.style.maxHeight=C+"px",n==null||n(),requestAnimationFrame(()=>p.current=!0)}},[h,a.trigger,a.valueNode,o,u,m,x,y,a.dir,n]);Lt(()=>v(),[v]);const[S,E]=_.useState();Lt(()=>{u&&E(window.getComputedStyle(u).zIndex)},[u]);const k=_.useCallback(b=>{b&&g.current===!0&&(v(),w==null||w(),g.current=!1)},[v,w]);return l.jsx(q8,{scope:r,contentWrapper:o,shouldExpandOnScrollRef:p,onScrollButtonChange:k,children:l.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:S},children:l.jsx(Le.div,{...s,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});iE.displayName=H8;var G8="SelectPopperPosition",Sm=_.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:s=Un,...a}=e,i=k0(r);return l.jsx(MS,{...i,...a,ref:t,align:n,collisionPadding:s,style:{boxSizing:"border-box",...a.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Sm.displayName=G8;var[q8,wg]=pl(ji,{}),km="SelectViewport",oE=_.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...s}=e,a=qa(km,r),i=wg(km,r),o=Ye(t,a.onViewportChange),c=_.useRef(0);return l.jsxs(l.Fragment,{children:[l.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),l.jsx(b0.Slot,{scope:r,children:l.jsx(Le.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Ce(s.onScroll,u=>{const f=u.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=i;if(h!=null&&h.current&&d){const p=Math.abs(c.current-f.scrollTop);if(p>0){const g=window.innerHeight-Un*2,m=parseFloat(d.style.minHeight),x=parseFloat(d.style.height),y=Math.max(m,x);if(y<g){const w=y+p,v=Math.min(g,w),S=w-v;d.style.height=v+"px",d.style.bottom==="0px"&&(f.scrollTop=S>0?S:0,d.style.justifyContent="flex-end")}}}c.current=f.scrollTop})})})]})});oE.displayName=km;var lE="SelectGroup",[K8,X8]=pl(lE),cE=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=Bs();return l.jsx(K8,{scope:r,id:s,children:l.jsx(Le.div,{role:"group","aria-labelledby":s,...n,ref:t})})});cE.displayName=lE;var uE="SelectLabel",fE=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=X8(uE,r);return l.jsx(Le.div,{id:s.id,...n,ref:t})});fE.displayName=uE;var Ed="SelectItem",[Y8,dE]=pl(Ed),hE=_.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:s=!1,textValue:a,...i}=e,o=Ga(Ed,r),c=qa(Ed,r),u=o.value===n,[f,d]=_.useState(a??""),[h,p]=_.useState(!1),g=Ye(t,w=>{var v;return(v=c.itemRefCallback)==null?void 0:v.call(c,w,n,s)}),m=Bs(),x=_.useRef("touch"),y=()=>{s||(o.onValueChange(n),o.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return l.jsx(Y8,{scope:r,value:n,disabled:s,textId:m,isSelected:u,onItemTextChange:_.useCallback(w=>{d(v=>v||((w==null?void 0:w.textContent)??"").trim())},[]),children:l.jsx(b0.ItemSlot,{scope:r,value:n,disabled:s,textValue:f,children:l.jsx(Le.div,{role:"option","aria-labelledby":m,"data-highlighted":h?"":void 0,"aria-selected":u&&h,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...i,ref:g,onFocus:Ce(i.onFocus,()=>p(!0)),onBlur:Ce(i.onBlur,()=>p(!1)),onClick:Ce(i.onClick,()=>{x.current!=="mouse"&&y()}),onPointerUp:Ce(i.onPointerUp,()=>{x.current==="mouse"&&y()}),onPointerDown:Ce(i.onPointerDown,w=>{x.current=w.pointerType}),onPointerMove:Ce(i.onPointerMove,w=>{var v;x.current=w.pointerType,s?(v=c.onItemLeave)==null||v.call(c):x.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ce(i.onPointerLeave,w=>{var v;w.currentTarget===document.activeElement&&((v=c.onItemLeave)==null||v.call(c))}),onKeyDown:Ce(i.onKeyDown,w=>{var S;((S=c.searchRef)==null?void 0:S.current)!==""&&w.key===" "||(D8.includes(w.key)&&y(),w.key===" "&&w.preventDefault())})})})})});hE.displayName=Ed;var zl="SelectItemText",pE=_.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:s,...a}=e,i=Ga(zl,r),o=qa(zl,r),c=dE(zl,r),u=U8(zl,r),[f,d]=_.useState(null),h=Ye(t,y=>d(y),c.onItemTextChange,y=>{var w;return(w=o.itemTextRefCallback)==null?void 0:w.call(o,y,c.value,c.disabled)}),p=f==null?void 0:f.textContent,g=_.useMemo(()=>l.jsx("option",{value:c.value,disabled:c.disabled,children:p},c.value),[c.disabled,c.value,p]),{onNativeOptionAdd:m,onNativeOptionRemove:x}=u;return Lt(()=>(m(g),()=>x(g)),[m,x,g]),l.jsxs(l.Fragment,{children:[l.jsx(Le.span,{id:c.textId,...a,ref:h}),c.isSelected&&i.valueNode&&!i.valueNodeHasChildren?Ui.createPortal(a.children,i.valueNode):null]})});pE.displayName=zl;var mE="SelectItemIndicator",xE=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return dE(mE,r).isSelected?l.jsx(Le.span,{"aria-hidden":!0,...n,ref:t}):null});xE.displayName=mE;var Em="SelectScrollUpButton",gE=_.forwardRef((e,t)=>{const r=qa(Em,e.__scopeSelect),n=wg(Em,e.__scopeSelect),[s,a]=_.useState(!1),i=Ye(t,n.onScrollButtonChange);return Lt(()=>{if(r.viewport&&r.isPositioned){let o=function(){const u=c.scrollTop>0;a(u)};const c=r.viewport;return o(),c.addEventListener("scroll",o),()=>c.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),s?l.jsx(wE,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:c}=r;o&&c&&(o.scrollTop=o.scrollTop-c.offsetHeight)}}):null});gE.displayName=Em;var Tm="SelectScrollDownButton",vE=_.forwardRef((e,t)=>{const r=qa(Tm,e.__scopeSelect),n=wg(Tm,e.__scopeSelect),[s,a]=_.useState(!1),i=Ye(t,n.onScrollButtonChange);return Lt(()=>{if(r.viewport&&r.isPositioned){let o=function(){const u=c.scrollHeight-c.clientHeight,f=Math.ceil(c.scrollTop)<u;a(f)};const c=r.viewport;return o(),c.addEventListener("scroll",o),()=>c.removeEventListener("scroll",o)}},[r.viewport,r.isPositioned]),s?l.jsx(wE,{...e,ref:i,onAutoScroll:()=>{const{viewport:o,selectedItem:c}=r;o&&c&&(o.scrollTop=o.scrollTop+c.offsetHeight)}}):null});vE.displayName=Tm;var wE=_.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...s}=e,a=qa("SelectScrollButton",r),i=_.useRef(null),o=S0(r),c=_.useCallback(()=>{i.current!==null&&(window.clearInterval(i.current),i.current=null)},[]);return _.useEffect(()=>()=>c(),[c]),Lt(()=>{var f;const u=o().find(d=>d.ref.current===document.activeElement);(f=u==null?void 0:u.ref.current)==null||f.scrollIntoView({block:"nearest"})},[o]),l.jsx(Le.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Ce(s.onPointerDown,()=>{i.current===null&&(i.current=window.setInterval(n,50))}),onPointerMove:Ce(s.onPointerMove,()=>{var u;(u=a.onItemLeave)==null||u.call(a),i.current===null&&(i.current=window.setInterval(n,50))}),onPointerLeave:Ce(s.onPointerLeave,()=>{c()})})}),J8="SelectSeparator",yE=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return l.jsx(Le.div,{"aria-hidden":!0,...n,ref:t})});yE.displayName=J8;var Nm="SelectArrow",Q8=_.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,s=k0(r),a=Ga(Nm,r),i=qa(Nm,r);return a.open&&i.position==="popper"?l.jsx(BS,{...s,...n,ref:t}):null});Q8.displayName=Nm;var Z8="SelectBubbleInput",_E=_.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const s=_.useRef(null),a=Ye(n,s),i=F8(t);return _.useEffect(()=>{const o=s.current;if(!o)return;const c=window.HTMLSelectElement.prototype,f=Object.getOwnPropertyDescriptor(c,"value").set;if(i!==t&&f){const d=new Event("change",{bubbles:!0});f.call(o,t),o.dispatchEvent(d)}},[i,t]),l.jsx(Le.select,{...r,style:{...Xk,...r.style},ref:a,defaultValue:t})});_E.displayName=Z8;function bE(e){return e===""||e===void 0}function SE(e){const t=nr(e),r=_.useRef(""),n=_.useRef(0),s=_.useCallback(i=>{const o=r.current+i;t(o),function c(u){r.current=u,window.clearTimeout(n.current),u!==""&&(n.current=window.setTimeout(()=>c(""),1e3))}(o)},[t]),a=_.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return _.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,s,a]}function kE(e,t,r){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,a=r?e.indexOf(r):-1;let i=e6(e,Math.max(a,0));s.length===1&&(i=i.filter(u=>u!==r));const c=i.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==r?c:void 0}function e6(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var t6=Yk,EE=Qk,r6=eE,n6=tE,s6=rE,TE=nE,a6=oE,i6=cE,NE=fE,CE=hE,o6=pE,l6=xE,AE=gE,jE=vE,PE=yE;const xs=t6,Ow=i6,gs=r6,Hn=_.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(EE,{ref:n,className:Ke("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,l.jsx(n6,{asChild:!0,children:l.jsx(Hx,{className:"h-4 w-4 opacity-50"})})]}));Hn.displayName=EE.displayName;const RE=_.forwardRef(({className:e,...t},r)=>l.jsx(AE,{ref:r,className:Ke("flex cursor-default items-center justify-center py-1",e),...t,children:l.jsx(xP,{className:"h-4 w-4"})}));RE.displayName=AE.displayName;const FE=_.forwardRef(({className:e,...t},r)=>l.jsx(jE,{ref:r,className:Ke("flex cursor-default items-center justify-center py-1",e),...t,children:l.jsx(Hx,{className:"h-4 w-4"})}));FE.displayName=jE.displayName;const Gn=_.forwardRef(({className:e,children:t,position:r="popper",...n},s)=>l.jsx(s6,{children:l.jsxs(TE,{ref:s,className:Ke("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[l.jsx(RE,{}),l.jsx(a6,{className:Ke("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),l.jsx(FE,{})]})}));Gn.displayName=TE.displayName;const Cm=_.forwardRef(({className:e,...t},r)=>l.jsx(NE,{ref:r,className:Ke("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));Cm.displayName=NE.displayName;const Ct=_.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(CE,{ref:n,className:Ke("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[l.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:l.jsx(l6,{children:l.jsx(a0,{className:"h-4 w-4"})})}),l.jsx(o6,{children:t})]}));Ct.displayName=CE.displayName;const c6=_.forwardRef(({className:e,...t},r)=>l.jsx(PE,{ref:r,className:Ke("-mx-1 my-1 h-px bg-muted",e),...t}));c6.displayName=PE.displayName;const $c=({label:e,error:t,...r})=>{const[n,s]=_.useState(!1);return l.jsxs("div",{className:"space-y-2",children:[e&&l.jsx("label",{className:"text-sm font-medium text-foreground",children:e}),l.jsxs("div",{className:"relative",children:[l.jsx(tt,{type:n?"text":"password",className:`pr-10 ${t?"border-red-500":""}`,...r}),l.jsx(fe,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>s(!n),children:n?l.jsx(bP,{className:"h-4 w-4 text-muted-foreground"}):l.jsx(Fb,{className:"h-4 w-4 text-muted-foreground"})})]}),t&&l.jsx("p",{className:"text-sm text-red-500",children:t})]})},ns=[{value:"DD101",label:"DD101",category:"DEV"},{value:"DD102",label:"DD102",category:"DEV"},{value:"DD103",label:"DD103",category:"DEV"},{value:"DD104",label:"DD104",category:"DEV"},{value:"DD105",label:"DD105",category:"DEV"},{value:"DD106",label:"DD106",category:"DEV"},{value:"DD107",label:"DD107",category:"DEV"},{value:"DEVOWS201",label:"DEVOWS201",category:"DEV"},{value:"DEVOWS202",label:"DEVOWS202",category:"DEV"},{value:"DEVOWS203",label:"DEVOWS203",category:"DEV"},{value:"DEVOWS204",label:"DEVOWS204",category:"DEV"},{value:"ID101",label:"ID101",category:"ID"},{value:"ID102",label:"ID102",category:"ID"},{value:"ID103",label:"ID103",category:"ID"},{value:"ID104",label:"ID104",category:"ID"},{value:"IDOSR201",label:"IDOSR201",category:"ID"},{value:"IDOSR202",label:"IDOSR202",category:"ID"},{value:"IDOSR203",label:"IDOSR203",category:"ID"},{value:"IDOSR204",label:"IDOSR204",category:"ID"}],u6=ns.map(e=>e.value),f6=ns.filter(e=>e.category==="DEV"),d6=ns.filter(e=>e.category==="ID"),h6=()=>{const e=dr(),{register:t,user:r}=mn(),[n,s]=_.useState({fullName:"",email:"",cssBattleProfileLink:"",password:"",group:""}),[a,i]=_.useState(!1),[o,c]=_.useState(null),[u,f]=_.useState(!1);_.useEffect(()=>{r&&e("/")},[r,e]);const d=p=>{const{name:g,value:m}=p.target;s(x=>({...x,[g]:m}))},h=async p=>{if(p.preventDefault(),i(!0),c(null),!n.fullName||!n.email||!n.password||!n.group){c("Please fill in all required fields"),i(!1);return}try{const g=await t({fullName:n.fullName,email:n.email,cssLink:n.cssBattleProfileLink,password:n.password,group:n.group,phone:void 0});g.success?g.requiresEmailVerification?f(!0):e("/"):c(g.error||"Registration failed")}catch{c("An unexpected error occurred")}finally{i(!1)}};return u?l.jsx("div",{className:"min-h-screen bg-background py-12 px-4 sm:px-6",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"flex items-center justify-between mb-8",children:[l.jsxs(fe,{variant:"ghost",onClick:()=>e("/"),className:"flex items-center gap-2 text-foreground hover:bg-battle-purple/10",children:[l.jsx(Yo,{className:"w-4 h-4"}),"Back to Home"]}),l.jsxs("h1",{className:"text-3xl font-bold text-center flex-1 text-foreground",children:["CSS"," ",l.jsx("span",{className:"bg-gradient-primary bg-clip-text text-transparent",children:"BATTLE"})," ","Championship"]}),l.jsx("div",{className:"w-24"})," "]}),l.jsx(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-6 md:p-8 max-w-2xl mx-auto",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-primary flex items-center justify-center mx-auto mb-6",children:l.jsx(Ni,{className:"w-8 h-8 text-foreground"})}),l.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-foreground mb-4",children:"Check Your Email"}),l.jsxs("p",{className:"text-foreground/80 mb-6",children:["We've sent a verification email to"," ",l.jsx("span",{className:"font-semibold",children:n.email}),". Please check your inbox and click the verification link to complete your registration."]}),l.jsx("div",{className:"bg-background/50 border border-battle-purple/30 rounded-lg p-4 mb-6",children:l.jsxs("p",{className:"text-sm text-foreground/70",children:["Didn't receive the email? Check your spam folder or"," ",l.jsx("button",{onClick:()=>f(!1),className:"text-battle-purple hover:underline",children:"try again"})]})}),l.jsx(fe,{onClick:()=>e("/login"),className:"bg-gradient-primary hover:scale-105 transition-transform shadow-glow",children:"Go to Login"})]})})]})}):l.jsx("div",{className:"min-h-screen bg-background py-12 px-4 sm:px-6",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"flex items-center justify-between mb-8",children:[l.jsxs(fe,{variant:"ghost",onClick:()=>e("/"),className:"flex items-center gap-2 text-foreground hover:bg-battle-purple/10",children:[l.jsx(Yo,{className:"w-4 h-4"}),"Back to Home"]}),l.jsxs("h1",{className:"text-3xl font-bold text-center flex-1 text-foreground",children:["CSS"," ",l.jsx("span",{className:"bg-gradient-primary bg-clip-text text-transparent",children:"BATTLE"})," ","Championship"]}),l.jsx("div",{className:"w-24"})," "]}),l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-6 md:p-8 max-w-2xl mx-auto",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-foreground mb-2",children:"Player Registration"}),l.jsx("p",{className:"text-foreground/80",children:"Join the CSS Battle Championship today"})]}),o&&l.jsxs("div",{className:"mb-6 p-4 bg-red-500/20 border border-red-500/50 rounded-lg text-foreground",children:["Error: ",o]}),l.jsxs("form",{onSubmit:h,className:"space-y-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"fullName",className:"text-foreground",children:"Full Name"}),l.jsxs("div",{className:"relative",children:[l.jsx(Jn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-5 h-5"}),l.jsx(tt,{id:"fullName",name:"fullName",value:n.fullName,onChange:d,placeholder:"Enter your full name",className:"pl-10 bg-background/50 border-battle-purple/30",required:!0})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"email",className:"text-foreground",children:"Email"}),l.jsxs("div",{className:"relative",children:[l.jsx(Ni,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-5 h-5"}),l.jsx(tt,{id:"email",name:"email",type:"email",value:n.email,onChange:d,placeholder:"Enter your email",className:"pl-10 bg-background/50 border-battle-purple/30",required:!0})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"cssBattleProfileLink",className:"text-foreground",children:"CSSBattle Profile Link"}),l.jsxs("div",{className:"relative",children:[l.jsx(Oc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-5 h-5"}),l.jsx(tt,{id:"cssBattleProfileLink",name:"cssBattleProfileLink",value:n.cssBattleProfileLink,onChange:d,placeholder:"https://cssbattle.dev/player/...",className:"pl-10 bg-background/50 border-battle-purple/30"})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"group",className:"text-foreground",children:"Player Group *"}),l.jsxs(xs,{value:n.group,onValueChange:p=>s(g=>({...g,group:p})),children:[l.jsx(Hn,{className:"bg-background/50 border-battle-purple/30",children:l.jsx(gs,{placeholder:"Select your group"})}),l.jsxs(Gn,{children:[l.jsxs(Ow,{children:[l.jsx(Cm,{children:"DEV Groups"}),f6.map(p=>l.jsx(Ct,{value:p.value,children:p.label},p.value))]}),l.jsxs(Ow,{children:[l.jsx(Cm,{children:"ID Groups"}),d6.map(p=>l.jsx(Ct,{value:p.value,children:p.label},p.value))]})]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"password",className:"text-foreground",children:"Password"}),l.jsx($c,{id:"password",name:"password",value:n.password,onChange:d,placeholder:"Create a password",className:"bg-background/50 border-battle-purple/30",required:!0})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-4",children:[l.jsx(fe,{type:"button",variant:"outline",onClick:()=>e("/"),className:"flex-1 border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:"Cancel"}),l.jsx(fe,{type:"submit",disabled:a,className:"flex-1 bg-gradient-primary hover:scale-105 transition-transform shadow-glow text-foreground",children:a?"Submitting...":"Complete Registration"})]})]})]})]})})},p6=({onBackToLogin:e})=>{const{t,language:r}=Js(),{toast:n}=Xr(),[s,a]=_.useState(""),[i,o]=_.useState(!1),[c,u]=_.useState(!1),[f,d]=_.useState(null),h=async p=>{p.preventDefault(),o(!0),d(null);try{const{error:g}=await ge.auth.resetPasswordForEmail(s,{redirectTo:`${window.location.origin}/reset-password`});if(g)throw new Error(g.message);u(!0),n({title:r==="en"?"Email Sent":"E-mail envoyé",description:r==="en"?"Check your email for the password reset link":"Vérifiez votre e-mail pour le lien de réinitialisation du mot de passe"})}catch(g){console.error("Forgot password error:",g),d(g.message||(r==="en"?"Failed to send reset email":"Échec de l'envoi de l'e-mail de réinitialisation"))}finally{o(!1)}};return c?l.jsx(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-6 md:p-8 max-w-md mx-auto",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 bg-green-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),l.jsx("h2",{className:"text-2xl font-bold text-foreground mb-4",children:r==="en"?"Email Sent":"E-mail envoyé"}),l.jsx("p",{className:"text-foreground/80 mb-6",children:r==="en"?"We've sent a password reset link to your email address. Please check your inbox and follow the instructions.":"Nous avons envoyé un lien de réinitialisation du mot de passe à votre adresse e-mail. Veuillez vérifier votre boîte de réception et suivre les instructions."}),l.jsx(fe,{onClick:e,className:"bg-gradient-primary hover:scale-105 transition-transform shadow-glow",children:r==="en"?"Back to Login":"Retour à la connexion"})]})}):l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-6 md:p-8 max-w-md mx-auto",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-foreground mb-2",children:r==="en"?"Forgot Password":"Mot de passe oublié"}),l.jsx("p",{className:"text-foreground/80",children:r==="en"?"Enter your email to receive a password reset link":"Entrez votre e-mail pour recevoir un lien de réinitialisation du mot de passe"})]}),f&&l.jsx("div",{className:"mb-6 p-4 bg-red-500/20 border border-red-500/50 rounded-lg text-foreground",children:f}),l.jsxs("form",{onSubmit:h,className:"space-y-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"email",className:"text-foreground",children:r==="en"?"Email":"E-mail"}),l.jsxs("div",{className:"relative",children:[l.jsx(Ni,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-5 h-5"}),l.jsx(tt,{id:"email",type:"email",value:s,onChange:p=>a(p.target.value),placeholder:r==="en"?"Enter your email":"Entrez votre e-mail",className:"pl-10 bg-background/50 border-battle-purple/30",required:!0})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-4",children:[l.jsxs(fe,{type:"button",variant:"outline",onClick:e,className:"flex-1 border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:[l.jsx(Yo,{className:"w-4 h-4 mr-2"}),r==="en"?"Back":"Retour"]}),l.jsx(fe,{type:"submit",disabled:i,className:"flex-1 bg-gradient-primary hover:scale-105 transition-transform shadow-glow text-foreground",children:i?l.jsxs("span",{className:"flex items-center",children:[l.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),r==="en"?"Sending...":"Envoi en cours..."]}):r==="en"?"Send Reset Link":"Envoyer le lien"})]})]})]})},m6=()=>{const e=dr(),{login:t,user:r}=mn(),{isAdmin:n,logout:s}=Kr(),{t:a,language:i}=Js(),{toast:o}=Xr(),[c,u]=_.useState({email:"",password:""}),[f,d]=_.useState(!1),[h,p]=_.useState(null),[g,m]=_.useState(!1),[x,y]=_.useState(!1);_.useEffect(()=>{r&&e("/")},[r,e]);const w=S=>{const{name:E,value:k}=S.target;u(b=>({...b,[E]:k}))},v=async S=>{S.preventDefault(),d(!0),p(null),m(!1);try{n&&(console.log("Logging out admin session before player login"),await s(),o({title:i==="en"?"Session Switched":"Session changée",description:i==="en"?"You have been logged out as admin. Logging in as player...":"Vous avez été déconnecté en tant qu'administrateur. Connexion en tant que joueur..."})),console.log("Login - Attempting login with:",c.email);const E=await t(c.email,c.password);console.log("Login - Result:",E),E.success?(console.log("Login successful!"),o({title:i==="en"?"Success":"Succès",description:i==="en"?"You have been logged in successfully!":"Vous vous êtes connecté avec succès !"}),e("/")):E.emailVerified===!1?m(!0):p(E.error||(i==="en"?"Login failed":"Échec de la connexion"))}catch(E){console.error("Login - Unexpected error:",E),p(i==="en"?"An unexpected error occurred":"Une erreur inattendue s'est produite"),o({title:i==="en"?"Error":"Erreur",description:i==="en"?"An unexpected error occurred during login":"Une erreur inattendue s'est produite lors de la connexion",variant:"destructive"})}finally{d(!1)}};return x?l.jsx("div",{className:"min-h-screen bg-background py-12 px-4 sm:px-6",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"flex items-center justify-center mb-8 pt-16",children:[" ",l.jsxs("h1",{className:"text-2xl font-bold text-center text-foreground",children:["CSS"," ",l.jsx("span",{className:"bg-gradient-primary bg-clip-text text-transparent",children:"BATTLE"})]})]}),l.jsx(p6,{onBackToLogin:()=>y(!1)})]})}):l.jsx("div",{className:"min-h-screen bg-background py-12 px-4 sm:px-6",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"flex items-center justify-center mb-8 pt-16",children:[" ",l.jsxs("h1",{className:"text-2xl font-bold text-center text-foreground",children:["CSS"," ",l.jsx("span",{className:"bg-gradient-primary bg-clip-text text-transparent",children:"BATTLE"})]})]}),l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-6 md:p-8 max-w-md mx-auto",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-foreground mb-2",children:i==="en"?"Log In":"Connexion"}),l.jsx("p",{className:"text-foreground/80",children:i==="en"?"Access your account":"Accédez à votre compte"})]}),g&&l.jsxs("div",{className:"mb-6 p-4 bg-yellow-500/20 border border-yellow-500/50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(dd,{className:"w-5 h-5 text-yellow-500 mr-2"}),l.jsx("span",{className:"text-yellow-200 font-medium",children:i==="en"?"Email Verification Required":"Vérification de l'e-mail requise"})]}),l.jsx("p",{className:"text-sm text-yellow-200 mt-2",children:i==="en"?"Please check your email and click the verification link before logging in.":"Veuillez vérifier votre e-mail et cliquer sur le lien de vérification avant de vous connecter."})]}),h&&!g&&l.jsxs("div",{className:"mb-6 p-4 bg-red-500/20 border border-red-500/50 rounded-lg text-foreground",children:[i==="en"?"Error:":"Erreur :"," ",h]}),l.jsxs("form",{onSubmit:v,className:"space-y-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"email",className:"text-foreground",children:i==="en"?"Email":"E-mail"}),l.jsxs("div",{className:"relative",children:[l.jsx(Ni,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-5 h-5"}),l.jsx(tt,{id:"email",name:"email",type:"email",value:c.email,onChange:w,placeholder:i==="en"?"Enter your email":"Entrez votre e-mail",className:"pl-10 bg-background/50 border-battle-purple/30",required:!0})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"password",className:"text-foreground",children:i==="en"?"Password":"Mot de passe"}),l.jsx($c,{id:"password",name:"password",value:c.password,onChange:w,placeholder:i==="en"?"Enter your password":"Entrez votre mot de passe",className:"bg-background/50 border-battle-purple/30",required:!0})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-2 sm:gap-0",children:[l.jsx(fe,{type:"button",variant:"link",onClick:()=>window.open("https://css-battle-isfo.vercel.app/","_blank"),className:"px-0 text-battle-purple hover:text-battle-pink",children:i==="en"?"Don't have an account? Register":"Pas de compte ? Inscrivez-vous"}),l.jsx(fe,{type:"button",variant:"link",onClick:()=>y(!0),className:"px-0 text-battle-purple hover:text-battle-pink",children:i==="en"?"Forgot Password?":"Mot de passe oublié ?"})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-4",children:[l.jsx(fe,{type:"button",variant:"outline",onClick:()=>e("/"),className:"flex-1 border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:i==="en"?"Cancel":"Annuler"}),l.jsx(fe,{type:"submit",disabled:f,className:"flex-1 bg-gradient-primary hover:scale-105 transition-transform shadow-glow text-foreground",children:f?l.jsxs("span",{className:"flex items-center",children:[l.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),i==="en"?"Logging in...":"Connexion en cours..."]}):i==="en"?"Log In":"Se connecter"})]})]})]})]})})},x6=()=>{const e=dr(),{toast:t}=Xr(),{isAdmin:r,admin:n,logout:s}=Kr(),{user:a,logout:i}=mn(),o=["ibrahimchallal@admincss.com","younesshlibi@admincss.com","mazgouraabdalmonim@admincss.com"],c="passwordPro",[u,f]=_.useState(""),[d,h]=_.useState(""),[p,g]=_.useState(!1);_.useEffect(()=>{console.log("AdminLogin - isAdmin:",r,"admin:",n),r&&n&&(console.log("Already logged in, redirecting to dashboard"),e("/admin/dashboard"))},[r,n,e]),_.useEffect(()=>{console.log("Checking localStorage for admin data");const x=localStorage.getItem("hardcoded_admin");if(console.log("Found hardcodedAdmin:",x),x)try{const y=JSON.parse(x);console.log("Parsed adminData:",y),y&&y.email&&(console.log("Admin data found, redirecting to dashboard"),e("/admin/dashboard"))}catch(y){console.error("Error parsing admin data:",y),localStorage.removeItem("hardcoded_admin")}},[e]);const m=async x=>{x.preventDefault(),g(!0);try{if(a&&(console.log("Logging out player session before admin login"),await i(),t({title:"Session Switched",description:"You have been logged out as player. Logging in as admin..."})),!o.includes(u))throw new Error("Invalid admin email");if(d!==c)throw new Error("Invalid password");let y="00000000-0000-0000-0000-000000000000",w=!1;try{const{data:S,error:E}=await ge.from("user_roles").select("user_id").eq("role","admin").limit(1);!E&&S&&S.length>0?(y=S[0].user_id,w=!0,console.log("Found real admin user ID:",y)):console.log("No real admin users found, using placeholder UUID")}catch(S){console.warn("Could not fetch admin user ID from database:",S)}const v={id:y,email:u,email_confirmed_at:new Date().toISOString(),created_at:new Date().toISOString()};localStorage.setItem("hardcoded_admin",JSON.stringify(v)),window.dispatchEvent(new StorageEvent("storage",{key:"hardcoded_admin",newValue:JSON.stringify(v),url:window.location.href})),t({title:"Success",description:w?"Logged in successfully as admin":"Logged in successfully (limited functionality mode)"}),setTimeout(()=>{e("/admin/dashboard")},100)}catch(y){t({title:"Error",description:y.message||"Login failed. Please try again.",variant:"destructive"})}finally{g(!1)}};return l.jsx("div",{className:"min-h-screen bg-background py-12 px-4 sm:px-6",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"flex items-center justify-between mb-8",children:[l.jsxs(fe,{variant:"ghost",onClick:()=>e("/"),className:"flex items-center gap-2 text-foreground hover:bg-battle-purple/10",children:[l.jsx(Yo,{className:"w-4 h-4"}),"Back to Home"]}),l.jsxs("h1",{className:"text-3xl font-bold text-center flex-1 text-foreground",children:["CSS"," ",l.jsx("span",{className:"bg-gradient-primary bg-clip-text text-transparent",children:"BATTLE"})," ","Admin"]}),l.jsx("div",{className:"w-24"})," "]}),l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-6 md:p-8 max-w-md mx-auto",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-primary flex items-center justify-center mx-auto mb-4",children:l.jsx(pd,{className:"w-8 h-8 text-foreground"})}),l.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-foreground mb-2",children:"Admin Login"}),l.jsx("p",{className:"text-foreground/80",children:"Access the admin dashboard"})]}),l.jsxs("form",{onSubmit:m,className:"space-y-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"email",className:"text-foreground",children:"Admin Email"}),l.jsxs("div",{className:"relative",children:[l.jsx(Ni,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-muted-foreground"}),l.jsxs("select",{id:"email",value:u,onChange:x=>f(x.target.value),className:"flex h-10 w-full rounded-md border border-battle-purple/30 bg-background/50 px-3 py-2 pl-10 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",required:!0,"aria-label":"Select admin email",children:[l.jsx("option",{value:"",children:"Select admin email..."}),o.map(x=>l.jsx("option",{value:x,children:x},x))]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"password",className:"text-foreground",children:"Password"}),l.jsx($c,{id:"password",name:"password",value:d,onChange:x=>h(x.target.value),placeholder:"Enter admin password",className:"bg-background/50 border-battle-purple/30",required:!0})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 pt-4",children:[l.jsx(fe,{type:"button",variant:"outline",onClick:()=>e("/"),className:"flex-1 border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:"Cancel"}),l.jsx(fe,{type:"submit",disabled:p,className:"flex-1 bg-gradient-primary hover:scale-105 transition-transform shadow-glow text-foreground",children:p?"Logging in...":"Login as Admin"})]})]})]})]})})},yg=()=>{const{user:e}=mn(),{isAdmin:t}=Kr();_.useEffect(()=>{if(!t){const r=n=>(n.preventDefault(),!1);return document.addEventListener("contextmenu",r),()=>{document.removeEventListener("contextmenu",r)}}},[t,e])},g6=()=>{var X;const e=dr(),{user:t,logout:r}=mn(),{isAdmin:n}=Kr(),{language:s}=Js(),[a,i]=_.useState(!1),[o,c]=_.useState(null),[u,f]=_.useState(!0),[d,h]=_.useState({fullName:"",cssBattleProfileLink:"",phoneNumber:"",group:""}),[p,g]=_.useState(!1),[m,x]=_.useState(null),[y,w]=_.useState(null),[v,S]=_.useState(null),[E,k]=_.useState(null),[b,N]=_.useState(!1);yg();const A=async()=>{if(t!=null&&t.id)try{f(!0);const{data:z,error:q}=await ge.from("players").select("id, full_name, email, phone, group_name, cssbattle_profile_link").eq("id",t.id).single();if(q)throw new Error(`Failed to fetch profile: ${q.message}`);c(z),h({fullName:z.full_name||"",cssBattleProfileLink:z.cssbattle_profile_link||"",phoneNumber:z.phone||"",group:z.group_name||""})}catch(z){console.error("Error fetching player profile:",z),x(`Failed to load profile: ${z.message}`)}finally{f(!1)}},O=async()=>{if(t!=null&&t.email)try{const{data:z,error:q}=await ge.from("players").select("id, full_name, score, group_name, email");if(q){console.error("Error fetching leaderboard data:",q);return}const K=(z||[]).sort((ne,Y)=>{const j=ne.score!==null&&ne.score!==void 0?ne.score:0;return(Y.score!==null&&Y.score!==void 0?Y.score:0)-j}),F=K.findIndex(ne=>ne.email===t.email);F!==-1?(S(F+1),k(K[F].score||0)):(S(null),k(null))}catch(z){console.error("Error fetching player rank and score:",z)}},V=async()=>{if(t!=null&&t.id)try{N(!1)}catch(z){console.error("Error checking monthly winner status:",z)}};_.useEffect(()=>{if(A(),t!=null&&t.email){O(),V();const z=setInterval(()=>{O(),V()},3e4);return()=>clearInterval(z)}},[t==null?void 0:t.id,t==null?void 0:t.email]);const C=z=>{const{name:q,value:K}=z.target;h(F=>({...F,[q]:K}))},B=z=>{h(q=>({...q,group:z}))},G=async z=>{if(z.preventDefault(),!!(o!=null&&o.id)){g(!0),x(null),w(null);try{const{error:q}=await ge.from("players").update({full_name:d.fullName,cssbattle_profile_link:d.cssBattleProfileLink||null,phone:d.phoneNumber||null,group_name:d.group||null}).eq("id",o.id);if(q)throw new Error(`Update failed: ${q.message}`);await A(),w("Profile updated successfully!"),i(!1)}catch(q){console.error("Profile update error:",q),x(`Failed to update profile: ${q.message}`)}finally{g(!1)}}};return t?u?l.jsx("div",{className:"min-h-screen bg-background py-12 px-4 sm:px-6 flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-battle-purple mx-auto mb-4"}),l.jsx("p",{className:"text-foreground/80",children:"Loading profile..."})]})}):l.jsxs("div",{className:"min-h-screen bg-background py-8 sm:py-12 px-4 sm:px-6 mt-16 sm:mt-20 overflow-hidden relative",children:[l.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[l.jsxs("div",{className:"hidden sm:block",children:[l.jsx(Ie,{color:"purple",size:80,top:"5%",left:"90%",delay:0}),l.jsx(Ie,{color:"pink",size:60,top:"75%",left:"5%",delay:1,rotation:!0}),l.jsx(Ie,{color:"yellow",size:50,top:"45%",left:"85%",delay:.5}),l.jsx(Ie,{color:"purple",size:60,top:"85%",left:"15%",delay:1.5})]}),l.jsxs("div",{className:"sm:hidden",children:[l.jsx(Ie,{color:"purple",size:50,top:"10%",left:"80%",delay:0}),l.jsx(Ie,{color:"pink",size:40,top:"80%",left:"15%",delay:1,rotation:!0})]})]}),l.jsxs("div",{className:"max-w-4xl mx-auto relative z-10",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mb-6 sm:mb-8 gap-3 sm:gap-4",children:[l.jsxs(fe,{variant:"ghost",onClick:()=>e("/"),className:"flex items-center gap-2 text-foreground hover:bg-battle-purple/10 px-2 py-1 h-auto",children:[l.jsx(Yo,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden xs:inline",children:"Back to Home"})]}),l.jsxs("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-center flex-1 text-foreground px-2",children:["CSS"," ",l.jsx("span",{className:"bg-gradient-primary bg-clip-text text-transparent",children:"BATTLE"})," ",l.jsx("span",{className:"hidden xs:inline",children:"Championship"})]}),l.jsx("div",{className:"w-12 sm:w-16 md:w-24"})," "]}),l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-4 sm:p-6 md:p-8 max-w-2xl mx-auto w-full",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-primary flex items-center justify-center mx-auto mb-4",children:l.jsx(Jn,{className:"w-12 h-12 text-foreground"})}),l.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-foreground mb-2",children:"Your Profile"}),l.jsx("p",{className:"text-foreground/80",children:"Manage your account information"}),b&&l.jsx("div",{className:"mt-2 flex items-center justify-center",children:l.jsxs("div",{className:"inline-flex items-center gap-2 bg-yellow-500/20 px-3 py-1 rounded-full border border-yellow-500/30",children:[l.jsx(Fc,{className:"w-4 h-4 text-yellow-500"}),l.jsx("span",{className:"text-sm font-bold text-yellow-500",children:s==="en"?"Monthly Winner":"Gagnant du Mois"})]})}),n&&l.jsxs("div",{className:"mt-2 flex items-center justify-center",children:[l.jsx(pd,{className:"w-4 h-4 mr-1 text-battle-accent"}),l.jsx("span",{className:"text-sm text-battle-accent font-medium",children:"Admin User"})]}),v!==null&&E!==null&&l.jsxs("div",{className:"mt-4 flex flex-wrap justify-center gap-4",children:[l.jsxs("div",{className:"flex items-center bg-card/50 border border-battle-purple/30 rounded-lg px-4 py-2",children:[l.jsx(Fa,{className:"w-5 h-5 mr-2 text-yellow-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-foreground/70",children:"Rank"}),l.jsxs("p",{className:"text-lg font-bold text-foreground",children:["#",v]})]})]}),l.jsxs("div",{className:"flex items-center bg-card/50 border border-battle-purple/30 rounded-lg px-4 py-2",children:[l.jsx(Gx,{className:"w-5 h-5 mr-2 text-primary"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-xs text-foreground/70",children:"Score"}),l.jsx("p",{className:"text-lg font-bold text-foreground",children:E.toLocaleString()})]})]}),l.jsxs(fe,{variant:"outline",size:"sm",onClick:O,className:"border-battle-purple/50 hover:bg-battle-purple/10",children:[l.jsx(qx,{className:"w-4 h-4 mr-1"}),"Refresh"]})]})]}),m&&l.jsxs("div",{className:"mb-6 p-4 bg-red-500/20 border border-red-500/50 rounded-lg text-foreground",children:["Error: ",m]}),y&&l.jsx("div",{className:"mb-6 p-4 bg-green-500/20 border border-green-500/50 rounded-lg text-foreground",children:y}),l.jsxs("form",{onSubmit:G,className:"space-y-6 text-left",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"fullName",className:"text-sm font-medium text-foreground/70",children:"Full Name"}),a?l.jsxs("div",{className:"relative",children:[l.jsx(Jn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-5 h-5"}),l.jsx(tt,{id:"fullName",name:"fullName",value:d.fullName,onChange:C,placeholder:"Enter your full name",className:"pl-10 bg-background/50 border-battle-purple/30 w-full",required:!0})]}):l.jsx("div",{className:"p-3 bg-background/50 border border-battle-purple/30 rounded-md",children:(o==null?void 0:o.full_name)||"Not provided"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"email",className:"text-sm font-medium text-foreground/70",children:"Email"}),l.jsx("div",{className:"p-3 bg-background/50 border border-battle-purple/30 rounded-md",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(Ni,{className:"w-4 h-4 mr-2 text-muted-foreground flex-shrink-0"}),l.jsx("span",{className:"break-all",children:(o==null?void 0:o.email)||"Not provided"})]})}),l.jsx("p",{className:"text-xs text-foreground/50",children:"Email cannot be changed"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"phoneNumber",className:"text-sm font-medium text-foreground/70",children:"Phone Number"}),a?l.jsxs("div",{className:"relative",children:[l.jsx(rm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-5 h-5"}),l.jsx(tt,{id:"phoneNumber",name:"phoneNumber",value:d.phoneNumber,onChange:C,placeholder:"Enter your phone number",className:"pl-10 bg-background/50 border-battle-purple/30 w-full"})]}):l.jsx("div",{className:"p-3 bg-background/50 border border-battle-purple/30 rounded-md",children:o!=null&&o.phone?l.jsxs("div",{className:"flex items-center",children:[l.jsx(rm,{className:"w-4 h-4 mr-2 text-muted-foreground flex-shrink-0"}),l.jsx("span",{className:"break-all",children:o.phone})]}):l.jsx("span",{className:"text-foreground/50",children:"Not provided"})})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"group",className:"text-sm font-medium text-foreground/70",children:"Player Group"}),a?l.jsxs(xs,{value:d.group,onValueChange:B,children:[l.jsx(Hn,{className:"bg-background/50 border-battle-purple/30 w-full",children:l.jsx(gs,{placeholder:"Select your group"})}),l.jsx(Gn,{children:ns.map(z=>l.jsx(Ct,{value:z.value,children:z.label},z.value))})]}):l.jsx("div",{className:"p-3 bg-background/50 border border-battle-purple/30 rounded-md",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(cl,{className:"w-4 h-4 mr-2 text-muted-foreground flex-shrink-0"}),l.jsx("span",{className:"break-all",children:o!=null&&o.group_name?((X=ns.find(z=>z.value===o.group_name))==null?void 0:X.label)||o.group_name:"No group assigned"})]})})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"cssBattleProfileLink",className:"text-sm font-medium text-foreground/70",children:"CSSBattle Profile"}),a?l.jsxs("div",{className:"relative",children:[l.jsx(Oc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-5 h-5"}),l.jsx(tt,{id:"cssBattleProfileLink",name:"cssBattleProfileLink",value:d.cssBattleProfileLink,onChange:C,placeholder:"https://cssbattle.dev/player/...",className:"pl-10 bg-background/50 border-battle-purple/30 w-full"})]}):l.jsx("div",{className:"p-3 bg-background/50 border border-battle-purple/30 rounded-md",children:o!=null&&o.cssbattle_profile_link?l.jsxs("div",{className:"flex items-center",children:[l.jsx(Oc,{className:"w-4 h-4 mr-2 text-muted-foreground flex-shrink-0"}),l.jsx("a",{href:o.cssbattle_profile_link,target:"_blank",rel:"noopener noreferrer",className:"text-battle-purple hover:underline break-all",children:o.cssbattle_profile_link})]}):l.jsx("span",{className:"text-foreground/50",children:"Not provided"})})]}),l.jsx("div",{className:"pt-6 flex flex-col sm:flex-row gap-3 sm:gap-4",children:a?l.jsxs(l.Fragment,{children:[l.jsx(fe,{type:"button",variant:"outline",onClick:()=>{i(!1),h({fullName:(o==null?void 0:o.full_name)||"",cssBattleProfileLink:(o==null?void 0:o.cssbattle_profile_link)||"",phoneNumber:(o==null?void 0:o.phone)||"",group:(o==null?void 0:o.group_name)||""}),x(null),w(null)},className:"flex-1 border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:"Cancel"}),l.jsx(fe,{type:"submit",disabled:p,className:"flex-1 bg-gradient-primary hover:scale-105 transition-transform shadow-glow",children:p?l.jsxs("span",{className:"flex items-center justify-center",children:[l.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):l.jsxs(l.Fragment,{children:[l.jsx(AP,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]}):l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 w-full",children:[l.jsx(fe,{type:"button",onClick:()=>i(!0),className:"flex-1 bg-gradient-primary hover:scale-105 transition-transform shadow-glow",children:"Edit Profile"}),n&&l.jsxs(fe,{type:"button",variant:"outline",onClick:()=>e("/admin/dashboard"),className:"flex-1 border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:[l.jsx(pd,{className:"w-4 h-4 mr-2"}),l.jsx("span",{className:"hidden xs:inline",children:"Admin Dashboard"}),l.jsx("span",{className:"xs:hidden",children:"Admin"})]}),l.jsx(bm,{className:"flex-1"})]})})]})]})]})]}):l.jsx("div",{className:"min-h-screen bg-background py-12 px-4 sm:px-6 flex items-center justify-center",children:l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-8 max-w-md w-full text-center",children:[l.jsx("h2",{className:"text-2xl font-bold text-foreground mb-4",children:"Not Logged In"}),l.jsx("p",{className:"text-foreground/80 mb-6",children:"You need to be logged in to view this page."}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[l.jsx(fe,{onClick:()=>e("/login"),className:"flex-1 bg-gradient-primary hover:scale-105 transition-transform shadow-glow",children:"Log In"}),l.jsx(fe,{variant:"outline",onClick:()=>e("/"),className:"flex-1 border-battle-purple/50 hover:bg-battle-purple/10",children:"Home"})]})]})})},v6=s0("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function or({className:e,variant:t,...r}){return l.jsx("div",{className:Ke(v6({variant:t}),e),...r})}const w6=()=>{var E,k,b,N,A,O,V;const[e,t]=_.useState([]),[r,n]=_.useState(!0),[s,a]=_.useState("all"),[i,o]=_.useState(!1),{toast:c}=Xr(),{user:u}=mn(),{t:f,language:d}=Js();yg(),_.useEffect(()=>{const C=new Date,B=new Date(C.getFullYear(),C.getMonth()+1,0),G=C.getDate()===B.getDate();o(G)},[]);const h=async()=>{n(!0);try{const{data:C,error:B}=await ge.from("players").select("id, full_name, score, group_name, email, cssbattle_profile_link, phone, created_at, video_completed");if(B)throw B;console.log("Leaderboard - Fetched players data:",C),console.log("Leaderboard - Total players count:",C==null?void 0:C.length);const G=(C||[]).sort((X,z)=>{const q=X.score!==null&&X.score!==void 0?X.score:0;return(z.score!==null&&z.score!==void 0?z.score:0)-q});console.log("Leaderboard - Sorted players:",G),t(G)}catch(C){console.error("Leaderboard - Error fetching players:",C),c({title:d==="en"?"Error":"Erreur",description:d==="en"?"Failed to fetch leaderboard data":"Échec de la récupération des données du classement",variant:"destructive"})}finally{n(!1)}};_.useEffect(()=>{let C=!0,B;h();const G=ge.channel("leaderboard-changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"players"},X=>{clearTimeout(B),B=setTimeout(()=>{C&&h()},1e3)}).on("postgres_changes",{event:"INSERT",schema:"public",table:"players"},X=>{clearTimeout(B),B=setTimeout(()=>{C&&h()},1e3)}).subscribe();return()=>{C=!1,clearTimeout(B),ge.removeChannel(G)}},[s,d]);const p=C=>C===0?l.jsx(Fc,{className:"w-5 h-5 text-yellow-500"}):C===1?l.jsx(Fa,{className:"w-5 h-5 text-gray-400"}):C===2?l.jsx(Gx,{className:"w-5 h-5 text-amber-700"}):null,g=C=>C===0?"bg-yellow-500/20 text-yellow-500 border-yellow-500/30":C===1?"bg-gray-400/20 text-gray-400 border-gray-400/30":C===2?"bg-amber-700/20 text-amber-700 border-amber-700/30":"bg-primary/20 text-primary border-primary/30",m=C=>{const B=ns.find(G=>G.value===C);return B?B.category==="DEV"?"bg-purple-500/20 text-purple-500 border-purple-500/30":"bg-blue-500/20 text-blue-500 border-blue-500/30":"bg-muted"},x=e.slice(0,3),y=e.slice(3,10),w=u?e.findIndex(C=>C.email===u.email)+1:-1,v=u?e.find(C=>C.email===u.email):null,S=ns.map(C=>C.value);if(i&&x.length>0){const C=x[0];return l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-primary/5 overflow-hidden relative",children:[l.jsx(Tt,{}),l.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[l.jsxs("div",{className:"hidden sm:block",children:[l.jsx(Ie,{color:"purple",size:180,top:"5%",left:"80%",delay:0}),l.jsx(Ie,{color:"pink",size:120,top:"65%",left:"5%",delay:1,rotation:!0}),l.jsx(Ie,{color:"yellow",size:80,top:"35%",left:"85%",delay:.5})]}),l.jsxs("div",{className:"sm:hidden",children:[l.jsx(Ie,{color:"purple",size:100,top:"10%",left:"80%",delay:0}),l.jsx(Ie,{color:"pink",size:70,top:"75%",left:"15%",delay:1,rotation:!0})]})]}),l.jsx("main",{className:"relative z-10 container mx-auto px-4 py-8 mt-20",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:d==="en"?"Monthly Champion":"Champion du Mois"}),l.jsx("p",{className:"text-muted-foreground mt-1",children:d==="en"?"Congratulations to our winner!":"Félicitations à notre gagnant !"})]}),l.jsx(Pe,{className:"bg-gradient-to-br from-yellow-500/20 to-amber-500/20 border-2 border-yellow-500/50 backdrop-blur-sm shadow-lg shadow-yellow-500/20 mb-8",children:l.jsxs(ln,{className:"p-8 text-center",children:[l.jsx("div",{className:"flex justify-center mb-6",children:l.jsxs("div",{className:"relative",children:[l.jsx("div",{className:"absolute -inset-4 bg-yellow-500 rounded-full blur-lg opacity-75 animate-pulse"}),l.jsx("div",{className:"relative bg-gradient-to-br from-yellow-400 to-amber-500 rounded-full p-4",children:l.jsx(Fc,{className:"w-16 h-16 text-white"})})]})}),l.jsx("h2",{className:"text-4xl font-bold text-yellow-500 mb-2",children:C.full_name}),l.jsxs("div",{className:"flex justify-center items-center gap-4 mb-6",children:[l.jsx(or,{className:`${m(C.group_name||"")} py-1 px-3 text-lg`,children:C.group_name||"N/A"}),l.jsxs("div",{className:"text-3xl font-bold text-foreground",children:[((E=C.score)==null?void 0:E.toLocaleString())||"0"," ","Points"]})]}),l.jsx("div",{className:"mb-6",children:l.jsxs("div",{className:"inline-flex items-center gap-2 bg-yellow-500/20 px-4 py-2 rounded-full",children:[l.jsx(M1,{className:"w-5 h-5 text-yellow-500"}),l.jsx("span",{className:"font-bold text-yellow-500",children:d==="en"?"WINNER":"GAGNANT"}),l.jsx(M1,{className:"w-5 h-5 text-yellow-500"})]})}),l.jsx("p",{className:"text-xl text-foreground mb-6",children:d==="en"?"Congratulations on winning this month's CSS Battle Championship!":"Félicitations pour avoir remporté le Championnat CSS Battle de ce mois !"}),l.jsxs("div",{className:"flex justify-center gap-4",children:[l.jsx(vh,{className:"w-6 h-6 text-yellow-500 animate-bounce"}),l.jsx(vh,{className:"w-6 h-6 text-yellow-500 animate-bounce",style:{animationDelay:"0.2s"}}),l.jsx(vh,{className:"w-6 h-6 text-yellow-500 animate-bounce",style:{animationDelay:"0.4s"}})]})]})}),l.jsx("div",{className:"text-center",children:l.jsx(fe,{onClick:()=>o(!1),className:"bg-gradient-primary hover:scale-105 transition-transform",children:d==="en"?"Back to Leaderboard":"Retour au Classement"})})]})})]})}return l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-primary/5 overflow-hidden relative",children:[l.jsx(Tt,{}),l.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[l.jsxs("div",{className:"hidden sm:block",children:[l.jsx(Ie,{color:"purple",size:180,top:"5%",left:"80%",delay:0}),l.jsx(Ie,{color:"pink",size:120,top:"65%",left:"5%",delay:1,rotation:!0}),l.jsx(Ie,{color:"yellow",size:80,top:"35%",left:"85%",delay:.5}),l.jsx(Ie,{color:"purple",size:100,top:"80%",left:"20%",delay:1.5})]}),l.jsxs("div",{className:"sm:hidden",children:[l.jsx(Ie,{color:"purple",size:100,top:"10%",left:"80%",delay:0}),l.jsx(Ie,{color:"pink",size:70,top:"75%",left:"15%",delay:1,rotation:!0})]})]}),l.jsx("main",{className:"relative z-10 container mx-auto px-4 py-8 mt-20",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-8 gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:d==="en"?"Leaderboard":"Classement"}),l.jsx("p",{className:"text-muted-foreground mt-1",children:d==="en"?"CSS Battle Championship":"Championnat CSS Battle"})]}),l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(B1,{className:"w-4 h-4 text-muted-foreground mr-1"}),l.jsxs("span",{className:"text-xs text-muted-foreground",children:[e.length," ",d==="en"?"Players":"Joueurs"]})]}),l.jsxs(fe,{onClick:h,variant:"outline",size:"sm",className:"border-battle-purple/50 hover:bg-battle-purple/10 h-8",children:[l.jsx(qx,{className:`w-3 h-3 mr-1 ${r?"animate-spin":""}`}),d==="en"?"Refresh":"Actualiser"]})]})]}),l.jsx("div",{className:"mb-6 w-48",children:l.jsxs(xs,{value:s,onValueChange:a,children:[l.jsx(Hn,{className:"border-battle-purple/50 hover:bg-battle-purple/10",children:l.jsx(gs,{placeholder:d==="en"?"Select Group":"Sélectionner un Groupe"})}),l.jsxs(Gn,{children:[l.jsx(Ct,{value:"all",children:d==="en"?"All Groups":"Tous les Groupes"}),S.map(C=>l.jsx(Ct,{value:C,children:C},C))]})]})}),r?l.jsx("div",{className:"flex justify-center items-center h-48",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-battle-purple"})}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"relative mb-6",children:[l.jsxs("div",{className:"hidden md:grid md:grid-cols-3 md:gap-3",children:[x[1]&&l.jsxs("div",{className:"bg-card border border-gray-400/30 rounded-lg p-3 text-center transition-all duration-300 hover:shadow-lg",children:[l.jsx("div",{className:"flex justify-center mb-2",children:l.jsx("div",{className:"bg-gray-400/20 rounded-full p-2",children:p(1)})}),l.jsx("h3",{className:"font-bold text-sm text-gray-400 truncate px-1",children:x[1].full_name}),l.jsx("div",{className:"mt-2",children:l.jsx(or,{className:`${m(x[1].group_name||"")} py-0 px-2 text-xs`,children:((k=x[1].score)==null?void 0:k.toLocaleString())||"0"})}),l.jsx("div",{className:"mt-2 text-2xl font-bold text-gray-400",children:"2"})]}),x[0]&&l.jsxs("div",{className:"bg-card border-2 border-yellow-500/50 rounded-lg p-4 text-center transition-all duration-300 hover:shadow-lg shadow-lg shadow-yellow-500/20 -mt-2",children:[l.jsx("div",{className:"flex justify-center mb-2",children:l.jsx("div",{className:"bg-yellow-500/20 rounded-full p-2",children:p(0)})}),l.jsx("h3",{className:"font-bold text-base text-yellow-500 truncate px-1",children:x[0].full_name}),l.jsx("div",{className:"mt-2",children:l.jsx(or,{className:`${m(x[0].group_name||"")} py-0 px-2 text-xs font-bold`,children:((b=x[0].score)==null?void 0:b.toLocaleString())||"0"})}),l.jsx("div",{className:"mt-2 text-3xl font-bold text-yellow-500",children:"1"})]}),x[2]&&l.jsxs("div",{className:"bg-card border border-amber-700/30 rounded-lg p-3 text-center transition-all duration-300 hover:shadow-lg",children:[l.jsx("div",{className:"flex justify-center mb-2",children:l.jsx("div",{className:"bg-amber-700/20 rounded-full p-2",children:p(2)})}),l.jsx("h3",{className:"font-bold text-sm text-amber-700 truncate px-1",children:x[2].full_name}),l.jsx("div",{className:"mt-2",children:l.jsx(or,{className:`${m(x[2].group_name||"")} py-0 px-2 text-xs`,children:((N=x[2].score)==null?void 0:N.toLocaleString())||"0"})}),l.jsx("div",{className:"mt-2 text-2xl font-bold text-amber-700",children:"3"})]})]}),l.jsxs("div",{className:"md:hidden flex justify-center items-end h-48 space-x-2 px-4",children:[x[1]&&l.jsxs("div",{className:"flex flex-col items-center w-24",children:[l.jsxs("div",{className:"bg-card border border-gray-400/30 rounded-t-lg p-3 text-center transition-all duration-300 hover:shadow-lg flex-1 flex flex-col justify-between w-full",children:[l.jsxs("div",{children:[l.jsx("div",{className:"flex justify-center mb-1",children:l.jsx("div",{className:"bg-gray-400/20 rounded-full p-1",children:p(1)})}),l.jsx("h3",{className:"font-bold text-xs text-gray-400 truncate",children:x[1].full_name})]}),l.jsx("div",{className:"mt-2",children:l.jsx(or,{className:`${m(x[1].group_name||"")} py-0 px-1 text-xs whitespace-nowrap`,children:((A=x[1].score)==null?void 0:A.toLocaleString())||"0"})})]}),l.jsx("div",{className:"bg-gray-400 text-white text-xs font-bold py-1 px-2 rounded-b-lg w-full text-center",children:"2nd"})]}),x[0]&&l.jsxs("div",{className:"flex flex-col items-center w-28",children:[l.jsxs("div",{className:"bg-card border-2 border-yellow-500/50 rounded-t-lg p-4 text-center transition-all duration-300 hover:shadow-lg shadow-lg shadow-yellow-500/20 flex-1 flex flex-col justify-between w-full",children:[l.jsxs("div",{children:[l.jsx("div",{className:"flex justify-center mb-1",children:l.jsx("div",{className:"bg-yellow-500/20 rounded-full p-1",children:p(0)})}),l.jsx("h3",{className:"font-bold text-sm text-yellow-500 truncate",children:x[0].full_name})]}),l.jsx("div",{className:"mt-2",children:l.jsx(or,{className:`${m(x[0].group_name||"")} py-0 px-1 text-xs font-bold whitespace-nowrap`,children:((O=x[0].score)==null?void 0:O.toLocaleString())||"0"})})]}),l.jsx("div",{className:"bg-yellow-500 text-white text-xs font-bold py-1 px-2 rounded-b-lg w-full text-center",children:"1st"})]}),x[2]&&l.jsxs("div",{className:"flex flex-col items-center w-20",children:[l.jsxs("div",{className:"bg-card border border-amber-700/30 rounded-t-lg p-2 text-center transition-all duration-300 hover:shadow-lg flex-1 flex flex-col justify-between w-full",children:[l.jsxs("div",{children:[l.jsx("div",{className:"flex justify-center mb-1",children:l.jsx("div",{className:"bg-amber-700/20 rounded-full p-1",children:p(2)})}),l.jsx("h3",{className:"font-bold text-xs text-amber-700 truncate",children:x[2].full_name})]}),l.jsx("div",{className:"mt-1",children:l.jsx(or,{className:`${m(x[2].group_name||"")} py-0 px-1 text-xs whitespace-nowrap`,children:((V=x[2].score)==null?void 0:V.toLocaleString())||"0"})})]}),l.jsx("div",{className:"bg-amber-700 text-white text-xs font-bold py-1 px-2 rounded-b-lg w-full text-center",children:"3rd"})]})]})]}),l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 mb-6",children:[l.jsx(_s,{children:l.jsxs(bs,{className:"flex items-center",children:[l.jsx(cl,{className:"w-5 h-5 mr-2 text-battle-purple"}),d==="en"?"Top Players":"Meilleurs Joueurs"]})}),l.jsxs(ln,{className:"p-0",children:[l.jsx("div",{className:"divide-y divide-border",children:y.map((C,B)=>{const G=B+3,X=u&&C.email===u.email;return l.jsx("div",{className:`p-4 transition-all duration-300 hover:bg-card/80 ${X?"bg-primary/5 border-l-2 border-primary":""}`,children:l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full text-sm font-bold border ${g(G)}`,children:G+1}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("h3",{className:`font-medium truncate ${X?"text-primary":""}`,children:[C.full_name,X&&l.jsx("span",{className:"ml-2 text-xs bg-primary/20 px-1.5 py-0.5 rounded",children:d==="en"?"You":"Vous"})]}),l.jsx(or,{className:`${m(C.group_name||"")} py-0 px-1.5 text-xs mt-1`,children:C.group_name})]}),l.jsx("div",{className:"text-right",children:l.jsx("div",{className:`font-bold ${X?"text-primary":""}`,children:C.score!==null&&C.score!==void 0?C.score.toLocaleString():"0"})})]})},C.id)})}),y.length===0&&l.jsx("div",{className:"p-8 text-center text-muted-foreground",children:d==="en"?"No players found in this group":"Aucun joueur trouvé dans ce groupe"})]})]}),u&&v&&w>0&&l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-primary/50",children:[l.jsx(_s,{children:l.jsxs(bs,{className:"flex items-center",children:[l.jsx(B1,{className:"w-5 h-5 mr-2 text-battle-purple"}),d==="en"?"Your Position":"Votre Position"]})}),l.jsxs(ln,{className:"p-4",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsxs("div",{className:"flex items-center justify-center w-10 h-10 rounded-full bg-primary/20 font-bold text-primary border border-primary/30",children:["#",w]}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("h3",{className:"font-bold text-primary truncate",children:[v.full_name,l.jsx("span",{className:"ml-2 text-xs bg-primary/20 px-2 py-1 rounded",children:d==="en"?"You":"Vous"})]}),l.jsx(or,{className:`${m(v.group_name||"")} py-0 px-1.5 text-xs mt-1`,children:v.group_name})]}),l.jsx("div",{className:"text-right",children:l.jsx("div",{className:"text-xl font-bold text-primary",children:v.score!==null&&v.score!==void 0?v.score.toLocaleString():"0"})})]}),w>10&&l.jsx("div",{className:"mt-3 pt-3 border-t border-border",children:l.jsx("p",{className:"text-center text-xs text-muted-foreground",children:d==="en"?`${w-10} positions away from top 10`:`${w-10} positions avant d'atteindre le top 10`})})]})]})]})]})})]})},y6=({videoId:e,onVideoComplete:t,onVideoReset:r,isCompleted:n,isAdmin:s})=>{var C,B,G,X;const[a,i]=_.useState(!1),[o,c]=_.useState(0),[u,f]=_.useState(0),[d,h]=_.useState(!1),p=_.useRef(null),g=_.useRef(null),m=_.useRef(null),[x,y]=_.useState(!1),w=_.useRef(0);_.useEffect(()=>{if(window.YT)v();else{const z=document.createElement("script");z.src="https://www.youtube.com/iframe_api",document.head.appendChild(z),window.onYouTubeIframeAPIReady=()=>{v()}}return()=>{m.current&&clearInterval(m.current),p.current&&p.current.destroy()}},[e]);const v=()=>{if(g.current){if(h(!1),y(!1),p.current){const z=p.current.getCurrentTime();f(Math.max(.1,z))}else f(.1);c(0),p.current=new window.YT.Player(g.current,{videoId:e,playerVars:{rel:0,modestbranding:1,controls:0,disablekb:1,enablejsapi:1,fs:0},events:{onReady:S,onStateChange:E}})}},S=z=>{if(console.log("Player is ready"),h(!1),p.current){const q=p.current.getCurrentTime();f(Math.max(.1,q))}else f(.1);c(0),setTimeout(()=>{y(!0)},1e3)},E=z=>{z.data===window.YT.PlayerState.PLAYING?(i(!0),k()):z.data===window.YT.PlayerState.PAUSED?(i(!1),m.current&&clearInterval(m.current)):z.data===window.YT.PlayerState.ENDED&&b()},k=()=>{m.current&&clearInterval(m.current),m.current=setInterval(()=>{if(p.current){const z=p.current.getCurrentTime(),q=p.current.getDuration();z>0&&!d&&(console.log("Video started at",z),h(!0)),x&&z>u+2&&d?z-u>10?(console.log("Unauthorized seeking detected, seeking back",{currentTime:z,maxWatched:u,difference:z-u}),p.current.seekTo(u,!0)):(console.log("Small jump or buffering, updating maxWatched",{currentTime:z,maxWatched:u}),f(Math.max(u,z)),c(z/q*100)):(f(Math.max(u,z)),c(z/q*100))}},100)},b=()=>{m.current&&clearInterval(m.current),i(!1),h(!1),y(!1),c(100),t()},N=()=>{p.current&&(a?p.current.pauseVideo():p.current.playVideo())},A=()=>{if(!p.current)return;const z=Date.now();if(z-w.current<300){console.log("Skip back ignored due to rate limiting");return}w.current=z;const q=p.current.getCurrentTime(),K=Math.max(0,q-5);console.log("Skip back triggered",{currentTime:q,newTime:K,hasStarted:d}),d||q>5?(console.log("Performing skip back to",K),p.current.seekTo(K,!0)):(console.log("Pausing at beginning to prevent looping"),p.current.pauseVideo(),i(!1))},O=z=>{const q=Math.floor(z/60),K=Math.floor(z%60);return`${q}:${K<10?"0":""}${K}`},V=o>=95||n;return l.jsx("div",{className:"w-full",children:l.jsxs("div",{className:"relative aspect-video rounded-lg overflow-hidden bg-black mb-4",children:[l.jsx("div",{ref:g,className:"absolute inset-0 w-full h-full"}),l.jsx("div",{className:"absolute bottom-0 left-0 right-0 w-full px-2 py-1",children:l.jsxs("div",{className:"bg-black/70 text-white rounded-t-lg p-2 shadow-lg backdrop-blur-sm mx-2",children:[l.jsxs("div",{className:"w-full mb-2",children:[l.jsx("div",{className:"w-full h-1 bg-gray-600 rounded-lg overflow-hidden",children:l.jsx("div",{className:"h-full bg-red-500 transition-all duration-300",style:{width:`${o}%`}})}),l.jsxs("div",{className:"flex justify-between text-xs text-gray-300 mt-1",children:[l.jsx("span",{children:p.current?O(((B=(C=p.current).getCurrentTime)==null?void 0:B.call(C))||0):"0:00"}),l.jsx("span",{children:p.current?O(((X=(G=p.current).getDuration)==null?void 0:X.call(G))||0):"0:00"})]})]}),l.jsx("div",{className:"flex items-center justify-center mb-2",children:l.jsx("div",{className:`flex items-center px-2 py-1 rounded-full text-xs font-medium ${n?"bg-green-500/20 text-green-400 border border-green-500/30":V?"bg-yellow-500/20 text-yellow-400 border border-yellow-500/30":"bg-blue-500/20 text-blue-400 border border-blue-500/30"}`,children:n?l.jsxs(l.Fragment,{children:[l.jsx(Rc,{className:"w-3 h-3 mr-1"}),"Completed"]}):V?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-yellow-400 mr-1"}),"Almost Completed (",Math.round(o),"%)"]}):l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-400 mr-1 animate-pulse"}),Math.round(o),"% Watched"]})})}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-1",children:[l.jsx(fe,{size:"sm",variant:"ghost",onClick:N,className:"text-white hover:text-white hover:bg-white/20 h-8 w-8 p-0",children:a?l.jsx(TP,{className:"w-4 h-4"}):l.jsx(Ob,{className:"w-4 h-4"})}),l.jsx(fe,{size:"sm",variant:"ghost",onClick:z=>{z.preventDefault(),z.stopPropagation(),A()},className:"text-white hover:text-white hover:bg-white/20 h-8 w-8 p-0",children:l.jsx(PP,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"flex items-center gap-1",children:[n&&l.jsxs("div",{className:"flex items-center text-green-400 text-sm",children:[l.jsx(Rc,{className:"w-4 h-4 mr-1"}),l.jsx("span",{children:"Completed"})]}),(n||s)&&l.jsx(fe,{size:"sm",variant:"ghost",onClick:r,className:"text-white hover:text-white hover:bg-white/20 h-8 w-8 p-0",children:l.jsx(CP,{className:"w-4 h-4"})})]})]})]})})]})})},OE=(e,t)=>{try{const r=`quiz_completed_${e}`,n=`quiz_score_${e}`;localStorage.setItem(r,"true"),localStorage.setItem(n,t.toString())}catch(r){console.error("Error saving quiz data to localStorage:",r)}},IE=e=>{try{const t=`quiz_completed_${e}`,r=`quiz_score_${e}`;localStorage.removeItem(t),localStorage.removeItem(r)}catch(t){console.error("Error clearing quiz data from localStorage:",t)}},Iw=(e,t)=>{try{return t!==null?(OE(e,t),!0):(IE(e),!1)}catch(r){return console.error("Error syncing quiz data with database:",r),!1}},_6=()=>{dr();const{toast:e}=Xr(),{user:t}=mn(),{isAdmin:r}=Kr(),{t:n,language:s}=Js();yg();const a="tCDvOQI3pco",[i,o]=_.useState(!1),[c,u]=_.useState(!1),[f,d]=_.useState(0),[h,p]=_.useState(null),[g,m]=_.useState(!1),[x,y]=_.useState(0),[w,v]=_.useState(!1),[S,E]=_.useState(!1),[k,b]=_.useState(!1);_.useEffect(()=>(b(!1),(async()=>{t&&setTimeout(async()=>{try{const{data:X,error:z}=await ge.from("quiz_scores").select("score").eq("player_id",t.id).limit(1);if(z){console.error("Error checking quiz completion:",z),b(!0);return}if(X&&X.length>0){const q=X[0].score;v(!0),y(q),Iw(t.id,q)}else v(!1),y(0),Iw(t.id,null)}catch(X){console.error("Failed to check quiz completion:",X)}finally{b(!0)}},100)})(),()=>{}),[t,s]),_.useEffect(()=>{w&&!S&&(async X=>{if(t)try{const{data:z,error:q}=await ge.from("quiz_scores").select("id").eq("player_id",t.id).limit(1);if(q)throw new Error(`Failed to check existing scores: ${q.message}`);let K;if(z&&z.length>0){console.log("Updating existing quiz score for player",t.id);const{error:F}=await ge.from("quiz_scores").update({score:X,total_questions:6,quiz_title:"CSS Battle Quiz",completed_at:new Date().toISOString()}).eq("player_id",t.id);K=F}else{console.log("Inserting new quiz score for player",t.id);const{error:F}=await ge.from("quiz_scores").insert({player_id:t.id,score:X,total_questions:6,quiz_title:"CSS Battle Quiz"});K=F}if(K)throw new Error(`Database operation failed: ${K.message}`);OE(t.id,X),E(!0),e({title:s==="en"?"Success":"Succès",description:s==="en"?"Quiz completed successfully! Your score has been saved.":"Quiz terminé avec succès ! Votre score a été enregistré."})}catch(z){console.error("Failed to save quiz score",z);const q=z instanceof Error?z.message:"Unknown error occurred";IE(t.id),e({title:s==="en"?"Error":"Erreur",description:s==="en"?`Failed to save quiz score: ${q}. Please try again.`:`Échec de l'enregistrement du score du quiz : ${q}. Veuillez réessayer.`,variant:"destructive"})}})(x)},[w,S,t,x,e,s]);const N=[{id:1,question:s==="en"?"What is the main purpose of CSS Battle?":"Quel est le but principal de CSS Battle ?",options:s==="en"?["To compete in JavaScript coding challenges","To improve CSS skills through visual challenges","To learn HTML structure","To practice database queries"]:["Participer à des défis de codage JavaScript","Améliorer les compétences CSS grâce à des défis visuels","Apprendre la structure HTML","Pratiquer les requêtes de base de données"],correctAnswer:1,explanation:s==="en"?"CSS Battle is a platform designed to help developers improve their CSS skills through fun, visual challenges.":"CSS Battle est une plateforme conçue pour aider les développeurs à améliorer leurs compétences CSS grâce à des défis visuels amusants."},{id:2,question:s==="en"?"How are scores calculated in CSS Battle?":"Comment les scores sont-ils calculés dans CSS Battle ?",options:s==="en"?["Based on lines of code written","Based on accuracy and code efficiency","Based on time spent","Based on number of attempts"]:["Basé sur le nombre de lignes de code écrites","Basé sur la précision et l'efficacité du code","Basé sur le temps passé","Basé sur le nombre de tentatives"],correctAnswer:1,explanation:s==="en"?"Scores are calculated based on how closely your CSS matches the target image, with efficiency measured by code length.":"Les scores sont calculés en fonction de la ressemblance entre votre CSS et l'image cible, avec une efficacité mesurée par la longueur du code."},{id:3,question:s==="en"?"Which CSS property is most important in CSS Battle?":"Quelle propriété CSS est la plus importante dans CSS Battle ?",options:s==="en"?["background-color","position","clip-path","All of the above"]:["background-color","position","clip-path","Toutes les réponses ci-dessus"],correctAnswer:3,explanation:s==="en"?"CSS Battle challenges often require a combination of properties, including positioning, background colors, and clip-path for complex shapes.":"Les défis CSS Battle nécessitent souvent une combinaison de propriétés, notamment le positionnement, les couleurs d'arrière-plan et clip-path pour les formes complexes."},{id:4,question:s==="en"?"What does CSS stand for?":"Que signifie CSS ?",options:s==="en"?["Computer Style Sheets","Creative Style System","Cascading Style Sheets","Colorful Style Sheets"]:["Computer Style Sheets","Creative Style System","Cascading Style Sheets","Colorful Style Sheets"],correctAnswer:2,explanation:s==="en"?"CSS stands for Cascading Style Sheets, which is used to style and layout web pages.":"CSS signifie Cascading Style Sheets, utilisé pour styliser et mettre en page les pages web."},{id:5,question:s==="en"?"Which CSS property is used to change the text color?":"Quelle propriété CSS est utilisée pour changer la couleur du texte ?",options:s==="en"?["font-color","text-color","color","text-style"]:["font-color","text-color","color","text-style"],correctAnswer:2,explanation:s==="en"?"The 'color' property is used to set the color of text in CSS.":"La propriété 'color' est utilisée pour définir la couleur du texte en CSS."},{id:6,question:s==="en"?"What is the CSS Grid 'fr' unit used for?":"À quoi sert l'unité CSS Grid 'fr' ?",options:s==="en"?["To set font size","To represent a fraction of available space","To create flexible borders","To define frame rates"]:["Pour définir la taille de la police","Pour représenter une fraction de l'espace disponible","Pour créer des bordures flexibles","Pour définir les fréquences d'images"],correctAnswer:1,explanation:s==="en"?"The 'fr' unit in CSS Grid represents a fraction of the available space in the grid container.":"L'unité 'fr' dans CSS Grid représente une fraction de l'espace disponible dans le conteneur de la grille."}];_.useEffect(()=>(u(!1),(async()=>{t&&setTimeout(async()=>{try{const{data:X,error:z}=await ge.from("players").select("video_completed").eq("id",t.id).limit(1);if(z){console.error("Error checking video completion:",z),u(!0);return}X&&X.length>0&&X[0].video_completed?o(!0):o(!1)}catch(X){console.error("Failed to check video completion:",X)}finally{u(!0)}},100)})(),()=>{}),[t,s]);const A=async()=>{if(t)try{const{error:G}=await ge.from("players").update({video_completed:!0,updated_at:new Date().toISOString()}).eq("id",t.id);G?console.error("Failed to save video completion:",G):console.log("Video completion saved for user",t.id)}catch(G){console.error("Failed to save video completion:",G)}},O=async()=>{o(!0),await A(),e({title:s==="en"?"Video Completed!":"Vidéo terminée !",description:s==="en"?"You can now take the quiz below":"Vous pouvez maintenant passer le quiz ci-dessous",duration:3e3})},V=async()=>{o(!1),t&&await ge.from("players").update({video_completed:!1,updated_at:new Date().toISOString()}).eq("id",t.id)},C=G=>{if(w){e({title:s==="en"?"Quiz Already Completed":"Quiz déjà terminé",description:s==="en"?"You have already completed this quiz.":"Vous avez déjà terminé ce quiz.",variant:"destructive"});return}p(G)},B=()=>{if(w){e({title:s==="en"?"Quiz Already Completed":"Quiz déjà terminé",description:s==="en"?"You have already completed this quiz.":"Vous avez déjà terminé ce quiz.",variant:"destructive"});return}if(h===null){e({title:s==="en"?"No Answer Selected":"Aucune réponse sélectionnée",description:s==="en"?"Please select an answer before submitting":"Veuillez sélectionner une réponse avant de soumettre",variant:"destructive"});return}const G=N[f];h===G.correctAnswer&&y(z=>z+1),m(!0),setTimeout(()=>{f<N.length-1?(d(z=>z+1),p(null),m(!1)):v(!0)},2e3)};return l.jsxs("div",{className:"min-h-screen bg-background overflow-hidden relative",children:[l.jsx(Tt,{}),l.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[l.jsxs("div",{className:"hidden sm:block",children:[l.jsx(Ie,{color:"purple",size:150,top:"10%",left:"5%",delay:0}),l.jsx(Ie,{color:"pink",size:100,top:"70%",left:"85%",delay:1,rotation:!0}),l.jsx(Ie,{color:"yellow",size:70,top:"40%",left:"80%",delay:.5}),l.jsx(Ie,{color:"purple",size:80,top:"85%",left:"15%",delay:1.5})]}),l.jsxs("div",{className:"sm:hidden",children:[l.jsx(Ie,{color:"purple",size:100,top:"15%",left:"80%",delay:0}),l.jsx(Ie,{color:"pink",size:70,top:"75%",left:"15%",delay:1,rotation:!0})]})]}),l.jsx("main",{className:"relative z-10 container mx-auto px-4 py-8 mt-16",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"text-center mb-12",children:[l.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent mb-4",children:n("learning.title")}),l.jsx("p",{className:"text-muted-foreground",children:n("learning.subtitle")})]}),l.jsxs(Pe,{className:"mb-8 bg-card/50 backdrop-blur-sm border-primary/20",children:[l.jsx(_s,{children:l.jsxs(bs,{className:"flex items-center gap-2",children:[i&&l.jsx(Rc,{className:"text-green-500"}),s==="en"?"CSS Battle Tutorial":"Tutoriel CSS Battle"]})}),l.jsx(ln,{children:l.jsx(y6,{videoId:a,onVideoComplete:O,onVideoReset:V,isCompleted:i,isAdmin:r})})]}),i?w?l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-primary/20",children:[l.jsx(_s,{children:l.jsxs(bs,{className:"flex items-center gap-2",children:[l.jsx(Fa,{className:"text-yellow-500"}),s==="en"?"Quiz Completed!":"Quiz terminé !"]})}),l.jsxs(ln,{className:"text-center",children:[l.jsx("p",{className:"text-2xl font-bold mb-4",children:s==="en"?"Your Score:":"Votre score :"}),l.jsxs("p",{className:"text-4xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent mb-4",children:[x," / ",N.length]}),l.jsx("p",{className:"text-muted-foreground",children:s==="en"?"You can only take this quiz once. Your score has been saved.":"Vous ne pouvez passer ce quiz qu'une seule fois. Votre score a été enregistré."})]})]}):l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-primary/20",children:[l.jsx(_s,{children:l.jsxs(bs,{children:["Quiz"," -"," ","Question"," ",f+1,"/",N.length]})}),l.jsxs(ln,{children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold mb-4",children:N[f].question}),l.jsx("div",{className:"space-y-3",children:N[f].options.map((G,X)=>l.jsx("button",{onClick:()=>C(X),disabled:g,className:`w-full p-4 text-left rounded-lg border-2 transition-all ${h===X?"border-primary bg-primary/10":"border-border hover:border-primary/50"} ${g?"cursor-not-allowed opacity-50":"cursor-pointer"}`,children:G},X))})]}),g&&l.jsxs("div",{className:`p-4 rounded-lg mb-4 ${h===N[f].correctAnswer?"bg-green-500/10 border border-green-500":"bg-red-500/10 border border-red-500"}`,children:[l.jsx("div",{className:"flex items-center gap-2 mb-2",children:h===N[f].correctAnswer?l.jsxs(l.Fragment,{children:[l.jsx(Rc,{className:"text-green-500"}),l.jsx("span",{className:"font-semibold text-green-500",children:s==="en"?"Correct!":"Correct !"})]}):l.jsxs(l.Fragment,{children:[l.jsx(gP,{className:"text-red-500"}),l.jsx("span",{className:"font-semibold text-red-500",children:"Incorrect"})]})}),l.jsx("p",{className:"text-sm",children:N[f].explanation})]}),l.jsx(fe,{onClick:B,disabled:h===null||g,className:"w-full",children:f<N.length-1?s==="en"?"Next Question":"Question suivante":s==="en"?"Finish Quiz":"Terminer le quiz"})]})]}):l.jsx(Pe,{className:"bg-card/50 backdrop-blur-sm border-primary/20",children:l.jsxs(ln,{className:"py-12 text-center",children:[l.jsx(dd,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),l.jsx("h3",{className:"text-xl font-semibold mb-2",children:s==="en"?"Complete the Video First":"Terminez d'abord la vidéo"}),l.jsx("p",{className:"text-muted-foreground",children:s==="en"?"Please watch the complete tutorial video before taking the quiz":"Veuillez regarder la vidéo complète avant de passer le quiz"})]})})]})})]})},b6=()=>{dr();const{toast:e}=Xr();mn();const{t,language:r}=Js(),[n,s]=_.useState([]),[a,i]=_.useState(!0);return _.useEffect(()=>{(async()=>{try{i(!0);const{data:c,error:u}=await ge.from("quiz_scores").select(`
            *,
            players (
              full_name,
              email,
              group_name
            )
          `).order("completed_at",{ascending:!1});if(u)throw u;s(c||[])}catch(c){console.error("Failed to fetch quiz scores:",c),e({title:r==="en"?"Error":"Erreur",description:r==="en"?"Failed to load quiz scores":"Échec du chargement des scores du quiz",variant:"destructive"})}finally{i(!1)}})()},[r,e]),a?l.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:l.jsx("div",{className:"animate-pulse text-foreground",children:"Loading..."})}):l.jsxs("div",{className:"min-h-screen bg-background overflow-hidden relative",children:[l.jsx(Tt,{}),l.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[l.jsxs("div",{className:"hidden sm:block",children:[l.jsx(Ie,{color:"purple",size:150,top:"10%",left:"5%",delay:0}),l.jsx(Ie,{color:"pink",size:100,top:"70%",left:"85%",delay:1,rotation:!0}),l.jsx(Ie,{color:"yellow",size:70,top:"40%",left:"80%",delay:.5}),l.jsx(Ie,{color:"purple",size:80,top:"85%",left:"15%",delay:1.5})]}),l.jsxs("div",{className:"sm:hidden",children:[l.jsx(Ie,{color:"purple",size:100,top:"15%",left:"80%",delay:0}),l.jsx(Ie,{color:"pink",size:70,top:"75%",left:"15%",delay:1,rotation:!0})]})]}),l.jsx("main",{className:"relative z-10 container mx-auto px-4 py-8 mt-16",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"text-center mb-12",children:[l.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent mb-4",children:r==="en"?"Quiz Scores":"Scores du Quiz"}),l.jsx("p",{className:"text-muted-foreground",children:r==="en"?"View all player quiz scores":"Voir tous les scores du quiz des joueurs"})]}),l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-primary/20",children:[l.jsx(_s,{children:l.jsxs(bs,{className:"flex items-center gap-2",children:[l.jsx(Fa,{className:"text-yellow-500"}),r==="en"?"Player Quiz Scores":"Scores du Quiz des Joueurs"]})}),l.jsx(ln,{children:l.jsx("div",{className:"space-y-4",children:n.length===0?l.jsx("p",{className:"text-center py-8 text-muted-foreground",children:r==="en"?"No quiz scores available yet":"Aucun score de quiz disponible pour le moment"}):n.map(o=>{var c,u,f;return l.jsx("div",{className:"p-4 bg-background/50 rounded-lg border border-primary/20",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("p",{className:"font-semibold text-foreground",children:((c=o.players)==null?void 0:c.full_name)||"Unknown Player"}),l.jsx("p",{className:"text-sm text-muted-foreground",children:((u=o.players)==null?void 0:u.email)||"No email"}),((f=o.players)==null?void 0:f.group_name)&&l.jsx(or,{variant:"secondary",className:"mt-1",children:o.players.group_name})]}),l.jsxs("div",{className:"flex flex-col items-start sm:items-end gap-2",children:[l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"text-2xl font-bold text-primary",children:[o.score,"/",o.total_questions]}),l.jsxs("p",{className:"text-sm text-muted-foreground flex items-center gap-1",children:[l.jsx(Vx,{className:"w-4 h-4"}),new Date(o.completed_at).toLocaleDateString()]})]}),l.jsx(or,{variant:"outline",className:"text-xs",children:o.quiz_title})]})]})},o.id)})})})]})]})})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Td={};Td.version="0.18.5";var DE=1252,S6=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],_g={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},bg=function(e){S6.indexOf(e)!=-1&&(DE=_g[0]=e)};function k6(){bg(1252)}var qn=function(e){bg(e)};function Sg(){qn(1200),k6()}function Dw(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function E6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function LE(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Wl=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?E6(e.slice(2)):t==254&&r==255?LE(e.slice(2)):t==65279?e.slice(1):e},af=function(t){return String.fromCharCode(t)},Lw=function(t){return String.fromCharCode(t)},ma,wa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function zc(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),i=(r&3)<<4|n>>4,s=e.charCodeAt(u++),o=(n&15)<<2|s>>6,c=s&63,isNaN(n)?o=c=64:isNaN(s)&&(c=64),t+=wa.charAt(a)+wa.charAt(i)+wa.charAt(o)+wa.charAt(c);return t}function dn(e){var t="",r=0,n=0,s=0,a=0,i=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=wa.indexOf(e.charAt(u++)),i=wa.indexOf(e.charAt(u++)),r=a<<2|i>>4,t+=String.fromCharCode(r),o=wa.indexOf(e.charAt(u++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=wa.indexOf(e.charAt(u++)),s=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(s));return t}var Ge=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Qs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Da(e){return Ge?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Mw(e){return Ge?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var nn=function(t){return Ge?Qs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function E0(e){if(typeof ArrayBuffer>"u")return nn(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Ka(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function T6(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function kg(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return kg(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var er=Ge?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Qs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),s=0;for(t=0,r=0;t<e.length;r+=s,++t)if(s=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function N6(e){for(var t=[],r=0,n=e.length+250,s=Da(e.length+255),a=0;a<e.length;++a){var i=e.charCodeAt(a);if(i<128)s[r++]=i;else if(i<2048)s[r++]=192|i>>6&31,s[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++a)&1023;s[r++]=240|i>>8&7,s[r++]=128|i>>2&63,s[r++]=128|o>>6&15|(i&3)<<4,s[r++]=128|o&63}else s[r++]=224|i>>12&15,s[r++]=128|i>>6&63,s[r++]=128|i&63;r>n&&(t.push(s.slice(0,r)),r=0,s=Da(65535),n=65530)}return t.push(s.slice(0,r)),er(t)}var Fr=/\u0000/g,Vl=/[\u0001-\u0006]/g;function Bo(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Kn(e,t){var r=""+e;return r.length>=t?r:At("0",t-r.length)+r}function Eg(e,t){var r=""+e;return r.length>=t?r:At(" ",t-r.length)+r}function Nd(e,t){var r=""+e;return r.length>=t?r:r+At(" ",t-r.length)}function C6(e,t){var r=""+Math.round(e);return r.length>=t?r:At("0",t-r.length)+r}function A6(e,t){var r=""+e;return r.length>=t?r:At("0",t-r.length)+r}var Bw=Math.pow(2,32);function lo(e,t){if(e>Bw||e<-Bw)return C6(e,t);var r=Math.round(e);return A6(r,t)}function Cd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Uw=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],$h=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function j6(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var Ae={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},$w={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},P6={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ad(e,t,r){for(var n=e<0?-1:1,s=e*n,a=0,i=1,o=0,c=1,u=0,f=0,d=Math.floor(s);u<t&&(d=Math.floor(s),o=d*i+a,f=d*u+c,!(s-d<5e-8));)s=1/(s-d),a=i,i=o,c=u,u=f;if(f>t&&(u>t?(f=c,o=a):(f=u,o=i)),!r)return[0,n*o,f];var h=Math.floor(n*o/f);return[h,n*o-h*f,f]}function pi(e,t,r){if(e>2958465||e<0)return null;var n=e|0,s=Math.floor(86400*(e-n)),a=0,i=[],o={D:n,T:s,u:86400*(e-n)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++s==86400&&(o.T=s=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],a=c.getDay(),n<60&&(a=(a+6)%7),r&&(a=L6(c,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=s%60,s=Math.floor(s/60),o.M=s%60,s=Math.floor(s/60),o.H=s,o.q=a,o}var ME=new Date(1899,11,31,0,0,0),R6=ME.getTime(),F6=new Date(1900,2,1,0,0,0);function BE(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=F6&&(r+=24*60*60*1e3),(r-(R6+(e.getTimezoneOffset()-ME.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Tg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function O6(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function I6(e){var t=e<0?12:11,r=Tg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function D6(e){var t=Tg(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Wc(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=I6(e):t===10?r=e.toFixed(10).substr(0,12):r=D6(e),Tg(O6(r.toUpperCase()))}function Pi(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Wc(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Rn(14,BE(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function L6(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function M6(e,t,r,n){var s="",a=0,i=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return $h[r.m-1][1];case 5:return $h[r.m-1][0];default:return $h[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return Uw[r.q][0];default:return Uw[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Kn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,a=Math.round(i*(r.S+r.u)),a>=60*i&&(a=0),t==="s"?a===0?"0":""+a/i:(s=Kn(a,2+n),t==="ss"?s.substr(0,2):"."+s.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var f=u>0?Kn(c,u):"";return f}function ya(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var UE=/%/g;function B6(e,t,r){var n=t.replace(UE,""),s=t.length-n.length;return Us(e,n,r*Math.pow(10,2*s))+At("%",s)}function U6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Us(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function $E(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+$E(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,s)+"."+r.substr(2+s),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var zE=/# (\?+)( ?)\/( ?)(\d+)/;function $6(e,t,r){var n=parseInt(e[4],10),s=Math.round(t*n),a=Math.floor(s/n),i=s-a*n,o=n;return r+(a===0?"":""+a)+" "+(i===0?At(" ",e[1].length+1+e[4].length):Eg(i,e[1].length)+e[2]+"/"+e[3]+Kn(o,e[4].length))}function z6(e,t,r){return r+(t===0?"":""+t)+At(" ",e[1].length+2+e[4].length)}var WE=/^#*0*\.([0#]+)/,VE=/\).*[0#]/,HE=/\(###\) ###\\?-####/;function jr(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function zw(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ww(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function W6(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function V6(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function vn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(VE)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?vn("n",n,r):"("+vn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return U6(e,t,r);if(t.indexOf("%")!==-1)return B6(e,t,r);if(t.indexOf("E")!==-1)return $E(t,r);if(t.charCodeAt(0)===36)return"$"+vn(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+lo(c,t.length);if(t.match(/^[#?]+$/))return s=lo(r,0),s==="0"&&(s=""),s.length>t.length?s:jr(t.substr(0,t.length-s.length))+s;if(a=t.match(zE))return $6(a,c,u);if(t.match(/^#+0+$/))return u+lo(c,t.length-t.indexOf("0"));if(a=t.match(WE))return s=zw(r,a[1].length).replace(/^([^\.]+)$/,"$1."+jr(a[1])).replace(/\.$/,"."+jr(a[1])).replace(/\.(\d*)$/,function(g,m){return"."+m+At("0",jr(a[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+zw(c,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+ya(lo(c,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+vn(e,t,-r):ya(""+(Math.floor(r)+W6(r,a[1].length)))+"."+Kn(Ww(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return vn(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Bo(vn(e,t.replace(/[\\-]/g,""),r)),i=0,Bo(Bo(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(t.match(HE))return s=vn(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=Ad(c,Math.pow(10,i)-1,!1),s=""+u,f=Us("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=Nd(o[2],i),f.length<a[4].length&&(f=jr(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=Ad(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Eg(o[1],i)+a[2]+"/"+a[3]+Nd(o[2],i):At(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=lo(r,0),t.length<=s.length?s:jr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,h=t.length-s.length-d;return jr(t.substr(0,d)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return i=Ww(r,a[1].length),r<0?"-"+vn(e,t,-r):ya(V6(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Kn(0,3-g.length):"")+g})+"."+Kn(i,a[1].length);switch(t){case"###,##0.00":return vn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=ya(lo(c,0));return p!=="0"?u+p:"";case"###,###.00":return vn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return vn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function H6(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Us(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function G6(e,t,r){var n=t.replace(UE,""),s=t.length-n.length;return Us(e,n,r*Math.pow(10,2*s))+At("%",s)}function GE(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+GE(e,-t);var s=e.indexOf(".");s===-1&&(s=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%s;if(a<0&&(a+=s),r=(t/Math.pow(10,a)).toPrecision(n+1+(s+a)%s),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+a):r+="E+"+(i-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(s+a)%s)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function cs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(VE)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?cs("n",n,r):"("+cs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return H6(e,t,r);if(t.indexOf("%")!==-1)return G6(e,t,r);if(t.indexOf("E")!==-1)return GE(t,r);if(t.charCodeAt(0)===36)return"$"+cs(e,t.substr(t.charAt(1)==" "?2:1),r);var s,a,i,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Kn(c,t.length);if(t.match(/^[#?]+$/))return s=""+r,r===0&&(s=""),s.length>t.length?s:jr(t.substr(0,t.length-s.length))+s;if(a=t.match(zE))return z6(a,c,u);if(t.match(/^#+0+$/))return u+Kn(c,t.length-t.indexOf("0"));if(a=t.match(WE))return s=(""+r).replace(/^([^\.]+)$/,"$1."+jr(a[1])).replace(/\.$/,"."+jr(a[1])),s=s.replace(/\.(\d*)$/,function(g,m){return"."+m+At("0",jr(a[1]).length-m.length)}),t.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+ya(""+c);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+cs(e,t,-r):ya(""+r)+"."+At("0",a[1].length);if(a=t.match(/^#,#*,#0/))return cs(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return s=Bo(cs(e,t.replace(/[\\-]/g,""),r)),i=0,Bo(Bo(t.replace(/\\/g,"")).replace(/[0#]/g,function(g){return i<s.length?s.charAt(i++):g==="0"?"0":""}));if(t.match(HE))return s=cs(e,"##########",r),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(a[4].length,7),o=Ad(c,Math.pow(10,i)-1,!1),s=""+u,f=Us("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),s+=f+a[2]+"/"+a[3],f=Nd(o[2],i),f.length<a[4].length&&(f=jr(a[4].substr(a[4].length-f.length))+f),s+=f,s;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(a[1].length,a[4].length),7),o=Ad(c,Math.pow(10,i)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Eg(o[1],i)+a[2]+"/"+a[3]+Nd(o[2],i):At(" ",2*i+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return s=""+r,t.length<=s.length?s:jr(t.substr(0,t.length-s.length))+s;if(a=t.match(/^([#0]+)\.([#0]+)$/)){s=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),i=s.indexOf(".");var d=t.indexOf(".")-i,h=t.length-s.length-d;return jr(t.substr(0,d)+s+t.substr(t.length-h))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+cs(e,t,-r):ya(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(g){return"00,"+(g.length<3?Kn(0,3-g.length):"")+g})+"."+Kn(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=ya(""+c);return p!=="0"?u+p:"";default:if(t.match(/\.[0#?]*$/))return cs(e,t.slice(0,t.lastIndexOf(".")),r)+jr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Us(e,t,r){return(r|0)===r?cs(e,t,r):vn(e,t,r)}function q6(e){for(var t=[],r=!1,n=0,s=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(s,n-s),s=n+1}if(t[t.length]=e.substr(s),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var qE=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ml(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Cd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(qE))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function K6(e,t,r,n){for(var s=[],a="",i=0,o="",c="t",u,f,d,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!Cd(e,i))throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"G",v:"General"},i+=7;break;case'"':for(a="";(d=e.charCodeAt(++i))!==34&&i<e.length;)a+=String.fromCharCode(d);s[s.length]={t:"t",v:a},++i;break;case"\\":var p=e.charAt(++i),g=p==="("||p===")"?p:"t";s[s.length]={t:g,v:p},++i;break;case"_":s[s.length]={t:"t",v:" "},i+=2;break;case"@":s[s.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(u==null&&(u=pi(t,r,e.charAt(i+1)==="2"),u==null))return"";s[s.length]={t:"X",v:e.substr(i,2)},c=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=pi(t,r),u==null))return"";for(a=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)a+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),s[s.length]={t:o,v:a},c=o;break;case"A":case"a":case"上":var m={t:o,v:o};if(u==null&&(u=pi(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(u!=null&&(m.v=u.H>=12?"下午":"上午"),m.t="T",i+=5,h="h"):(m.t="t",++i),u==null&&m.t==="T")return"";s[s.length]=m,c=o;break;case"[":for(a=o;e.charAt(i++)!=="]"&&i<e.length;)a+=e.charAt(i);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(qE)){if(u==null&&(u=pi(t,r),u==null))return"";s[s.length]={t:"Z",v:a.toLowerCase()},c=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",ml(e)||(s[s.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++i<e.length&&(o=e.charAt(i))==="0";)a+=o;s[s.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)a+=o;s[s.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++i)===o;)a+=o;s[s.length]={t:o,v:a},c=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":s[s.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)a+=e.charAt(i);s[s.length]={t:"D",v:a};break;case" ":s[s.length]={t:o,v:o},++i;break;case"$":s[s.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);s[s.length]={t:"t",v:o},++i;break}var x=0,y=0,w;for(i=s.length-1,c="t";i>=0;--i)switch(s[i].t){case"h":case"H":s[i].t=h,c="h",x<1&&(x=1);break;case"s":(w=s[i].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":c=s[i].t;break;case"m":c==="s"&&(s[i].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&s[i].v.match(/[Hh]/)&&(x=1),x<2&&s[i].v.match(/[Mm]/)&&(x=2),x<3&&s[i].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var v="",S;for(i=0;i<s.length;++i)switch(s[i].t){case"t":case"T":case" ":case"D":break;case"X":s[i].v="",s[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[i].v=M6(s[i].t.charCodeAt(0),s[i].v,u,y),s[i].t="t";break;case"n":case"?":for(S=i+1;s[S]!=null&&((o=s[S].t)==="?"||o==="D"||(o===" "||o==="t")&&s[S+1]!=null&&(s[S+1].t==="?"||s[S+1].t==="t"&&s[S+1].v==="/")||s[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(s[S].v==="/"||s[S].v===" "&&s[S+1]!=null&&s[S+1].t=="?"));)s[i].v+=s[S].v,s[S]={v:"",t:";"},++S;v+=s[i].v,i=S-1;break;case"G":s[i].t="t",s[i].v=Pi(t,r);break}var E="",k,b;if(v.length>0){v.charCodeAt(0)==40?(k=t<0&&v.charCodeAt(0)===45?-t:t,b=Us("n",v,k)):(k=t<0&&n>1?-t:t,b=Us("n",v,k),k<0&&s[0]&&s[0].t=="t"&&(b=b.substr(1),s[0].v="-"+s[0].v)),S=b.length-1;var N=s.length;for(i=0;i<s.length;++i)if(s[i]!=null&&s[i].t!="t"&&s[i].v.indexOf(".")>-1){N=i;break}var A=s.length;if(N===s.length&&b.indexOf("E")===-1){for(i=s.length-1;i>=0;--i)s[i]==null||"n?".indexOf(s[i].t)===-1||(S>=s[i].v.length-1?(S-=s[i].v.length,s[i].v=b.substr(S+1,s[i].v.length)):S<0?s[i].v="":(s[i].v=b.substr(0,S+1),S=-1),s[i].t="t",A=i);S>=0&&A<s.length&&(s[A].v=b.substr(0,S+1)+s[A].v)}else if(N!==s.length&&b.indexOf("E")===-1){for(S=b.indexOf(".")-1,i=N;i>=0;--i)if(!(s[i]==null||"n?".indexOf(s[i].t)===-1)){for(f=s[i].v.indexOf(".")>-1&&i===N?s[i].v.indexOf(".")-1:s[i].v.length-1,E=s[i].v.substr(f+1);f>=0;--f)S>=0&&(s[i].v.charAt(f)==="0"||s[i].v.charAt(f)==="#")&&(E=b.charAt(S--)+E);s[i].v=E,s[i].t="t",A=i}for(S>=0&&A<s.length&&(s[A].v=b.substr(0,S+1)+s[A].v),S=b.indexOf(".")+1,i=N;i<s.length;++i)if(!(s[i]==null||"n?(".indexOf(s[i].t)===-1&&i!==N)){for(f=s[i].v.indexOf(".")>-1&&i===N?s[i].v.indexOf(".")+1:0,E=s[i].v.substr(0,f);f<s[i].v.length;++f)S<b.length&&(E+=b.charAt(S++));s[i].v=E,s[i].t="t",A=i}}}for(i=0;i<s.length;++i)s[i]!=null&&"n?".indexOf(s[i].t)>-1&&(k=n>1&&t<0&&i>0&&s[i-1].v==="-"?-t:t,s[i].v=Us(s[i].t,s[i].v,k),s[i].t="t");var O="";for(i=0;i!==s.length;++i)s[i]!=null&&(O+=s[i].v);return O}var Vw=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Hw(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function X6(e,t){var r=q6(e),n=r.length,s=r[n-1].indexOf("@");if(n<4&&s>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||s>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=s>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=s>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=s>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(Vw),o=r[1].match(Vw);return Hw(t,i)?[n,r[0]]:Hw(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,a]}function Rn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Ae)[e],n==null&&(n=r.table&&r.table[$w[e]]||Ae[$w[e]]),n==null&&(n=P6[e]||"General");break}if(Cd(n,0))return Pi(t,r);t instanceof Date&&(t=BE(t,r.date1904));var s=X6(n,t);if(Cd(s[1]))return Pi(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return K6(s[1],t,r,s[0])}function $s(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Ae[r]==null){t<0&&(t=r);continue}if(Ae[r]==e){t=r;break}}t<0&&(t=391)}return Ae[t]=e,t}function T0(e){for(var t=0;t!=392;++t)e[t]!==void 0&&$s(e[t],t)}function xl(){Ae=j6()}var Y6={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},KE=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function J6(e){var t=typeof e=="number"?Ae[e]:e;return t=t.replace(KE,"(\\d+)"),new RegExp("^"+t+"$")}function Q6(e,t,r){var n=-1,s=-1,a=-1,i=-1,o=-1,c=-1;(t.match(KE)||[]).forEach(function(d,h){var p=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":a=p;break;case"h":i=p;break;case"s":c=p;break;case"m":i>=0?o=p:s=p;break}}),c>=0&&o==-1&&s>=0&&(o=s,s=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return i==-1&&o==-1&&c==-1?u:n==-1&&s==-1&&a==-1?f:u+"T"+f}var Z6=function(){var e={};e.version="1.2.0";function t(){for(var b=0,N=new Array(256),A=0;A!=256;++A)b=A,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,N[A]=b;return typeof Int32Array<"u"?new Int32Array(N):N}var r=t();function n(b){var N=0,A=0,O=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(O=0;O!=256;++O)V[O]=b[O];for(O=0;O!=256;++O)for(A=b[O],N=256+O;N<4096;N+=256)A=V[N]=A>>>8^b[A&255];var C=[];for(O=1;O!=16;++O)C[O-1]=typeof Int32Array<"u"?V.subarray(O*256,O*256+256):V.slice(O*256,O*256+256);return C}var s=n(r),a=s[0],i=s[1],o=s[2],c=s[3],u=s[4],f=s[5],d=s[6],h=s[7],p=s[8],g=s[9],m=s[10],x=s[11],y=s[12],w=s[13],v=s[14];function S(b,N){for(var A=N^-1,O=0,V=b.length;O<V;)A=A>>>8^r[(A^b.charCodeAt(O++))&255];return~A}function E(b,N){for(var A=N^-1,O=b.length-15,V=0;V<O;)A=v[b[V++]^A&255]^w[b[V++]^A>>8&255]^y[b[V++]^A>>16&255]^x[b[V++]^A>>>24]^m[b[V++]]^g[b[V++]]^p[b[V++]]^h[b[V++]]^d[b[V++]]^f[b[V++]]^u[b[V++]]^c[b[V++]]^o[b[V++]]^i[b[V++]]^a[b[V++]]^r[b[V++]];for(O+=15;V<O;)A=A>>>8^r[(A^b[V++])&255];return~A}function k(b,N){for(var A=N^-1,O=0,V=b.length,C=0,B=0;O<V;)C=b.charCodeAt(O++),C<128?A=A>>>8^r[(A^C)&255]:C<2048?(A=A>>>8^r[(A^(192|C>>6&31))&255],A=A>>>8^r[(A^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,B=b.charCodeAt(O++)&1023,A=A>>>8^r[(A^(240|C>>8&7))&255],A=A>>>8^r[(A^(128|C>>2&63))&255],A=A>>>8^r[(A^(128|B>>6&15|(C&3)<<4))&255],A=A>>>8^r[(A^(128|B&63))&255]):(A=A>>>8^r[(A^(224|C>>12&15))&255],A=A>>>8^r[(A^(128|C>>6&63))&255],A=A>>>8^r[(A^(128|C&63))&255]);return~A}return e.table=r,e.bstr=S,e.buf=E,e.str=k,e}(),Ee=function(){var t={};t.version="1.2.1";function r(T,D){for(var P=T.split("/"),R=D.split("/"),L=0,M=0,Z=Math.min(P.length,R.length);L<Z;++L){if(M=P[L].length-R[L].length)return M;if(P[L]!=R[L])return P[L]<R[L]?-1:1}return P.length-R.length}function n(T){if(T.charAt(T.length-1)=="/")return T.slice(0,-1).indexOf("/")===-1?T:n(T.slice(0,-1));var D=T.lastIndexOf("/");return D===-1?T:T.slice(0,D+1)}function s(T){if(T.charAt(T.length-1)=="/")return s(T.slice(0,-1));var D=T.lastIndexOf("/");return D===-1?T:T.slice(D+1)}function a(T,D){typeof D=="string"&&(D=new Date(D));var P=D.getHours();P=P<<6|D.getMinutes(),P=P<<5|D.getSeconds()>>>1,T.write_shift(2,P);var R=D.getFullYear()-1980;R=R<<4|D.getMonth()+1,R=R<<5|D.getDate(),T.write_shift(2,R)}function i(T){var D=T.read_shift(2)&65535,P=T.read_shift(2)&65535,R=new Date,L=P&31;P>>>=5;var M=P&15;P>>>=4,R.setMilliseconds(0),R.setFullYear(P+1980),R.setMonth(M-1),R.setDate(L);var Z=D&31;D>>>=5;var le=D&63;return D>>>=6,R.setHours(D),R.setMinutes(le),R.setSeconds(Z<<1),R}function o(T){lr(T,0);for(var D={},P=0;T.l<=T.length-4;){var R=T.read_shift(2),L=T.read_shift(2),M=T.l+L,Z={};switch(R){case 21589:P=T.read_shift(1),P&1&&(Z.mtime=T.read_shift(4)),L>5&&(P&2&&(Z.atime=T.read_shift(4)),P&4&&(Z.ctime=T.read_shift(4))),Z.mtime&&(Z.mt=new Date(Z.mtime*1e3));break}T.l=M,D[R]=Z}return D}var c;function u(){return c||(c={})}function f(T,D){if(T[0]==80&&T[1]==75)return Au(T,D);if((T[0]|32)==109&&(T[1]|32)==105)return Cr(T,D);if(T.length<512)throw new Error("CFB file size "+T.length+" < 512");var P=3,R=512,L=0,M=0,Z=0,le=0,Q=0,ee=[],re=T.slice(0,512);lr(re,0);var he=d(re);switch(P=he[0],P){case 3:R=512;break;case 4:R=4096;break;case 0:if(he[1]==0)return Au(T,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+P)}R!==512&&(re=T.slice(0,R),lr(re,28));var ye=T.slice(0,R);h(re,P);var be=re.read_shift(4,"i");if(P===3&&be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+be);re.l+=4,Z=re.read_shift(4,"i"),re.l+=4,re.chk("00100000","Mini Stream Cutoff Size: "),le=re.read_shift(4,"i"),L=re.read_shift(4,"i"),Q=re.read_shift(4,"i"),M=re.read_shift(4,"i");for(var me=-1,_e=0;_e<109&&(me=re.read_shift(4,"i"),!(me<0));++_e)ee[_e]=me;var Ue=p(T,R);x(Q,M,Ue,R,ee);var wt=w(Ue,Z,ee,R);wt[Z].name="!Directory",L>0&&le!==B&&(wt[le].name="!MiniFAT"),wt[ee[0]].name="!FAT",wt.fat_addrs=ee,wt.ssz=R;var yt={},pr=[],yl=[],_l=[];v(Z,wt,Ue,pr,L,yt,yl,le),g(yl,_l,pr),pr.shift();var bl={FileIndex:yl,FullPaths:_l};return D&&D.raw&&(bl.raw={header:ye,sectors:Ue}),bl}function d(T){if(T[T.l]==80&&T[T.l+1]==75)return[0,0];T.chk(G,"Header Signature: "),T.l+=16;var D=T.read_shift(2,"u");return[T.read_shift(2,"u"),D]}function h(T,D){var P=9;switch(T.l+=2,P=T.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+P);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+P);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+P)}T.chk("0600","Mini Sector Shift: "),T.chk("000000000000","Reserved: ")}function p(T,D){for(var P=Math.ceil(T.length/D)-1,R=[],L=1;L<P;++L)R[L-1]=T.slice(L*D,(L+1)*D);return R[P-1]=T.slice(P*D),R}function g(T,D,P){for(var R=0,L=0,M=0,Z=0,le=0,Q=P.length,ee=[],re=[];R<Q;++R)ee[R]=re[R]=R,D[R]=P[R];for(;le<re.length;++le)R=re[le],L=T[R].L,M=T[R].R,Z=T[R].C,ee[R]===R&&(L!==-1&&ee[L]!==L&&(ee[R]=ee[L]),M!==-1&&ee[M]!==M&&(ee[R]=ee[M])),Z!==-1&&(ee[Z]=R),L!==-1&&R!=ee[R]&&(ee[L]=ee[R],re.lastIndexOf(L)<le&&re.push(L)),M!==-1&&R!=ee[R]&&(ee[M]=ee[R],re.lastIndexOf(M)<le&&re.push(M));for(R=1;R<Q;++R)ee[R]===R&&(M!==-1&&ee[M]!==M?ee[R]=ee[M]:L!==-1&&ee[L]!==L&&(ee[R]=ee[L]));for(R=1;R<Q;++R)if(T[R].type!==0){if(le=R,le!=ee[le])do le=ee[le],D[R]=D[le]+"/"+D[R];while(le!==0&&ee[le]!==-1&&le!=ee[le]);ee[R]=-1}for(D[0]+="/",R=1;R<Q;++R)T[R].type!==2&&(D[R]+="/")}function m(T,D,P){for(var R=T.start,L=T.size,M=[],Z=R;P&&L>0&&Z>=0;)M.push(D.slice(Z*C,Z*C+C)),L-=C,Z=ci(P,Z*4);return M.length===0?ie(0):er(M).slice(0,T.size)}function x(T,D,P,R,L){var M=B;if(T===B){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(T!==-1){var Z=P[T],le=(R>>>2)-1;if(!Z)return;for(var Q=0;Q<le&&(M=ci(Z,Q*4))!==B;++Q)L.push(M);x(ci(Z,R-4),D-1,P,R,L)}}function y(T,D,P,R,L){var M=[],Z=[];L||(L=[]);var le=R-1,Q=0,ee=0;for(Q=D;Q>=0;){L[Q]=!0,M[M.length]=Q,Z.push(T[Q]);var re=P[Math.floor(Q*4/R)];if(ee=Q*4&le,R<4+ee)throw new Error("FAT boundary crossed: "+Q+" 4 "+R);if(!T[re])break;Q=ci(T[re],ee)}return{nodes:M,data:ny([Z])}}function w(T,D,P,R){var L=T.length,M=[],Z=[],le=[],Q=[],ee=R-1,re=0,he=0,ye=0,be=0;for(re=0;re<L;++re)if(le=[],ye=re+D,ye>=L&&(ye-=L),!Z[ye]){Q=[];var me=[];for(he=ye;he>=0;){me[he]=!0,Z[he]=!0,le[le.length]=he,Q.push(T[he]);var _e=P[Math.floor(he*4/R)];if(be=he*4&ee,R<4+be)throw new Error("FAT boundary crossed: "+he+" 4 "+R);if(!T[_e]||(he=ci(T[_e],be),me[he]))break}M[ye]={nodes:le,data:ny([Q])}}return M}function v(T,D,P,R,L,M,Z,le){for(var Q=0,ee=R.length?2:0,re=D[T].data,he=0,ye=0,be;he<re.length;he+=128){var me=re.slice(he,he+128);lr(me,64),ye=me.read_shift(2),be=Fg(me,0,ye-ee),R.push(be);var _e={name:be,type:me.read_shift(1),color:me.read_shift(1),L:me.read_shift(4,"i"),R:me.read_shift(4,"i"),C:me.read_shift(4,"i"),clsid:me.read_shift(16),state:me.read_shift(4,"i"),start:0,size:0},Ue=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);Ue!==0&&(_e.ct=S(me,me.l-8));var wt=me.read_shift(2)+me.read_shift(2)+me.read_shift(2)+me.read_shift(2);wt!==0&&(_e.mt=S(me,me.l-8)),_e.start=me.read_shift(4,"i"),_e.size=me.read_shift(4,"i"),_e.size<0&&_e.start<0&&(_e.size=_e.type=0,_e.start=B,_e.name=""),_e.type===5?(Q=_e.start,L>0&&Q!==B&&(D[Q].name="!StreamData")):_e.size>=4096?(_e.storage="fat",D[_e.start]===void 0&&(D[_e.start]=y(P,_e.start,D.fat_addrs,D.ssz)),D[_e.start].name=_e.name,_e.content=D[_e.start].data.slice(0,_e.size)):(_e.storage="minifat",_e.size<0?_e.size=0:Q!==B&&_e.start!==B&&D[Q]&&(_e.content=m(_e,D[Q].data,(D[le]||{}).data))),_e.content&&lr(_e.content,0),M[be]=_e,Z.push(_e)}}function S(T,D){return new Date((tn(T,D+4)/1e7*Math.pow(2,32)+tn(T,D)/1e7-11644473600)*1e3)}function E(T,D){return u(),f(c.readFileSync(T),D)}function k(T,D){var P=D&&D.type;switch(P||Ge&&Buffer.isBuffer(T)&&(P="buffer"),P||"base64"){case"file":return E(T,D);case"base64":return f(nn(dn(T)),D);case"binary":return f(nn(T),D)}return f(T,D)}function b(T,D){var P=D||{},R=P.root||"Root Entry";if(T.FullPaths||(T.FullPaths=[]),T.FileIndex||(T.FileIndex=[]),T.FullPaths.length!==T.FileIndex.length)throw new Error("inconsistent CFB structure");T.FullPaths.length===0&&(T.FullPaths[0]=R+"/",T.FileIndex[0]={name:R,type:5}),P.CLSID&&(T.FileIndex[0].clsid=P.CLSID),N(T)}function N(T){var D="Sh33tJ5";if(!Ee.find(T,"/"+D)){var P=ie(4);P[0]=55,P[1]=P[3]=50,P[2]=54,T.FileIndex.push({name:D,type:2,content:P,size:4,L:69,R:69,C:69}),T.FullPaths.push(T.FullPaths[0]+D),A(T)}}function A(T,D){b(T);for(var P=!1,R=!1,L=T.FullPaths.length-1;L>=0;--L){var M=T.FileIndex[L];switch(M.type){case 0:R?P=!0:(T.FileIndex.pop(),T.FullPaths.pop());break;case 1:case 2:case 5:R=!0,isNaN(M.R*M.L*M.C)&&(P=!0),M.R>-1&&M.L>-1&&M.R==M.L&&(P=!0);break;default:P=!0;break}}if(!(!P&&!D)){var Z=new Date(1987,1,19),le=0,Q=Object.create?Object.create(null):{},ee=[];for(L=0;L<T.FullPaths.length;++L)Q[T.FullPaths[L]]=!0,T.FileIndex[L].type!==0&&ee.push([T.FullPaths[L],T.FileIndex[L]]);for(L=0;L<ee.length;++L){var re=n(ee[L][0]);R=Q[re],R||(ee.push([re,{name:s(re).replace("/",""),type:1,clsid:z,ct:Z,mt:Z,content:null}]),Q[re]=!0)}for(ee.sort(function(be,me){return r(be[0],me[0])}),T.FullPaths=[],T.FileIndex=[],L=0;L<ee.length;++L)T.FullPaths[L]=ee[L][0],T.FileIndex[L]=ee[L][1];for(L=0;L<ee.length;++L){var he=T.FileIndex[L],ye=T.FullPaths[L];if(he.name=s(ye).replace("/",""),he.L=he.R=he.C=-(he.color=1),he.size=he.content?he.content.length:0,he.start=0,he.clsid=he.clsid||z,L===0)he.C=ee.length>1?1:-1,he.size=0,he.type=5;else if(ye.slice(-1)=="/"){for(le=L+1;le<ee.length&&n(T.FullPaths[le])!=ye;++le);for(he.C=le>=ee.length?-1:le,le=L+1;le<ee.length&&n(T.FullPaths[le])!=n(ye);++le);he.R=le>=ee.length?-1:le,he.type=1}else n(T.FullPaths[L+1]||"")==n(ye)&&(he.R=L+1),he.type=2}}}function O(T,D){var P=D||{};if(P.fileType=="mad")return Pu(T,P);switch(A(T),P.fileType){case"zip":return ju(T,P)}var R=function(be){for(var me=0,_e=0,Ue=0;Ue<be.FileIndex.length;++Ue){var wt=be.FileIndex[Ue];if(wt.content){var yt=wt.content.length;yt>0&&(yt<4096?me+=yt+63>>6:_e+=yt+511>>9)}}for(var pr=be.FullPaths.length+3>>2,yl=me+7>>3,_l=me+127>>7,bl=yl+_e+pr+_l,ei=bl+127>>7,z0=ei<=109?0:Math.ceil((ei-109)/127);bl+ei+z0+127>>7>ei;)z0=++ei<=109?0:Math.ceil((ei-109)/127);var As=[1,z0,ei,_l,pr,_e,me,0];return be.FileIndex[0].size=me<<6,As[7]=(be.FileIndex[0].start=As[0]+As[1]+As[2]+As[3]+As[4]+As[5])+(As[6]+7>>3),As}(T),L=ie(R[7]<<9),M=0,Z=0;{for(M=0;M<8;++M)L.write_shift(1,X[M]);for(M=0;M<8;++M)L.write_shift(2,0);for(L.write_shift(2,62),L.write_shift(2,3),L.write_shift(2,65534),L.write_shift(2,9),L.write_shift(2,6),M=0;M<3;++M)L.write_shift(2,0);for(L.write_shift(4,0),L.write_shift(4,R[2]),L.write_shift(4,R[0]+R[1]+R[2]+R[3]-1),L.write_shift(4,0),L.write_shift(4,4096),L.write_shift(4,R[3]?R[0]+R[1]+R[2]-1:B),L.write_shift(4,R[3]),L.write_shift(-4,R[1]?R[0]-1:B),L.write_shift(4,R[1]),M=0;M<109;++M)L.write_shift(-4,M<R[2]?R[1]+M:-1)}if(R[1])for(Z=0;Z<R[1];++Z){for(;M<236+Z*127;++M)L.write_shift(-4,M<R[2]?R[1]+M:-1);L.write_shift(-4,Z===R[1]-1?B:Z+1)}var le=function(be){for(Z+=be;M<Z-1;++M)L.write_shift(-4,M+1);be&&(++M,L.write_shift(-4,B))};for(Z=M=0,Z+=R[1];M<Z;++M)L.write_shift(-4,q.DIFSECT);for(Z+=R[2];M<Z;++M)L.write_shift(-4,q.FATSECT);le(R[3]),le(R[4]);for(var Q=0,ee=0,re=T.FileIndex[0];Q<T.FileIndex.length;++Q)re=T.FileIndex[Q],re.content&&(ee=re.content.length,!(ee<4096)&&(re.start=Z,le(ee+511>>9)));for(le(R[6]+7>>3);L.l&511;)L.write_shift(-4,q.ENDOFCHAIN);for(Z=M=0,Q=0;Q<T.FileIndex.length;++Q)re=T.FileIndex[Q],re.content&&(ee=re.content.length,!(!ee||ee>=4096)&&(re.start=Z,le(ee+63>>6)));for(;L.l&511;)L.write_shift(-4,q.ENDOFCHAIN);for(M=0;M<R[4]<<2;++M){var he=T.FullPaths[M];if(!he||he.length===0){for(Q=0;Q<17;++Q)L.write_shift(4,0);for(Q=0;Q<3;++Q)L.write_shift(4,-1);for(Q=0;Q<12;++Q)L.write_shift(4,0);continue}re=T.FileIndex[M],M===0&&(re.start=re.size?re.start-1:B);var ye=M===0&&P.root||re.name;if(ee=2*(ye.length+1),L.write_shift(64,ye,"utf16le"),L.write_shift(2,ee),L.write_shift(1,re.type),L.write_shift(1,re.color),L.write_shift(-4,re.L),L.write_shift(-4,re.R),L.write_shift(-4,re.C),re.clsid)L.write_shift(16,re.clsid,"hex");else for(Q=0;Q<4;++Q)L.write_shift(4,0);L.write_shift(4,re.state||0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,0),L.write_shift(4,re.start),L.write_shift(4,re.size),L.write_shift(4,0)}for(M=1;M<T.FileIndex.length;++M)if(re=T.FileIndex[M],re.size>=4096)if(L.l=re.start+1<<9,Ge&&Buffer.isBuffer(re.content))re.content.copy(L,L.l,0,re.size),L.l+=re.size+511&-512;else{for(Q=0;Q<re.size;++Q)L.write_shift(1,re.content[Q]);for(;Q&511;++Q)L.write_shift(1,0)}for(M=1;M<T.FileIndex.length;++M)if(re=T.FileIndex[M],re.size>0&&re.size<4096)if(Ge&&Buffer.isBuffer(re.content))re.content.copy(L,L.l,0,re.size),L.l+=re.size+63&-64;else{for(Q=0;Q<re.size;++Q)L.write_shift(1,re.content[Q]);for(;Q&63;++Q)L.write_shift(1,0)}if(Ge)L.l=L.length;else for(;L.l<L.length;)L.write_shift(1,0);return L}function V(T,D){var P=T.FullPaths.map(function(Q){return Q.toUpperCase()}),R=P.map(function(Q){var ee=Q.split("/");return ee[ee.length-(Q.slice(-1)=="/"?2:1)]}),L=!1;D.charCodeAt(0)===47?(L=!0,D=P[0].slice(0,-1)+D):L=D.indexOf("/")!==-1;var M=D.toUpperCase(),Z=L===!0?P.indexOf(M):R.indexOf(M);if(Z!==-1)return T.FileIndex[Z];var le=!M.match(Vl);for(M=M.replace(Fr,""),le&&(M=M.replace(Vl,"!")),Z=0;Z<P.length;++Z)if((le?P[Z].replace(Vl,"!"):P[Z]).replace(Fr,"")==M||(le?R[Z].replace(Vl,"!"):R[Z]).replace(Fr,"")==M)return T.FileIndex[Z];return null}var C=64,B=-2,G="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],z="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:B,FREESECT:-1,HEADER_SIGNATURE:G,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function K(T,D,P){u();var R=O(T,P);c.writeFileSync(D,R)}function F(T){for(var D=new Array(T.length),P=0;P<T.length;++P)D[P]=String.fromCharCode(T[P]);return D.join("")}function ne(T,D){var P=O(T,D);switch(D&&D.type||"buffer"){case"file":return u(),c.writeFileSync(D.filename,P),P;case"binary":return typeof P=="string"?P:F(P);case"base64":return zc(typeof P=="string"?P:F(P));case"buffer":if(Ge)return Buffer.isBuffer(P)?P:Qs(P);case"array":return typeof P=="string"?nn(P):P}return P}var Y;function j(T){try{var D=T.InflateRaw,P=new D;if(P._processChunk(new Uint8Array([3,0]),P._finishFlushFlag),P.bytesRead)Y=T;else throw new Error("zlib does not expose bytesRead")}catch(R){console.error("cannot use native zlib: "+(R.message||R))}}function H(T,D){if(!Y)return Nu(T,D);var P=Y.InflateRaw,R=new P,L=R._processChunk(T.slice(T.l),R._finishFlushFlag);return T.l+=R.bytesRead,L}function U(T){return Y?Y.deflateRawSync(T):De(T)}var W=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],te=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function oe(T){var D=(T<<1|T<<11)&139536|(T<<5|T<<15)&558144;return(D>>16|D>>8|D)&255}for(var ae=typeof Uint8Array<"u",se=ae?new Uint8Array(256):[],de=0;de<256;++de)se[de]=oe(de);function I(T,D){var P=se[T&255];return D<=8?P>>>8-D:(P=P<<8|se[T>>8&255],D<=16?P>>>16-D:(P=P<<8|se[T>>16&255],P>>>24-D))}function Be(T,D){var P=D&7,R=D>>>3;return(T[R]|(P<=6?0:T[R+1]<<8))>>>P&3}function Re(T,D){var P=D&7,R=D>>>3;return(T[R]|(P<=5?0:T[R+1]<<8))>>>P&7}function Ve(T,D){var P=D&7,R=D>>>3;return(T[R]|(P<=4?0:T[R+1]<<8))>>>P&15}function Oe(T,D){var P=D&7,R=D>>>3;return(T[R]|(P<=3?0:T[R+1]<<8))>>>P&31}function xe(T,D){var P=D&7,R=D>>>3;return(T[R]|(P<=1?0:T[R+1]<<8))>>>P&127}function it(T,D,P){var R=D&7,L=D>>>3,M=(1<<P)-1,Z=T[L]>>>R;return P<8-R||(Z|=T[L+1]<<8-R,P<16-R)||(Z|=T[L+2]<<16-R,P<24-R)||(Z|=T[L+3]<<24-R),Z&M}function Rt(T,D,P){var R=D&7,L=D>>>3;return R<=5?T[L]|=(P&7)<<R:(T[L]|=P<<R&255,T[L+1]=(P&7)>>8-R),D+3}function Yr(T,D,P){var R=D&7,L=D>>>3;return P=(P&1)<<R,T[L]|=P,D+1}function On(T,D,P){var R=D&7,L=D>>>3;return P<<=R,T[L]|=P&255,P>>>=8,T[L+1]=P,D+8}function ta(T,D,P){var R=D&7,L=D>>>3;return P<<=R,T[L]|=P&255,P>>>=8,T[L+1]=P&255,T[L+2]=P>>>8,D+16}function as(T,D){var P=T.length,R=2*P>D?2*P:D+5,L=0;if(P>=D)return T;if(Ge){var M=Mw(R);if(T.copy)T.copy(M);else for(;L<T.length;++L)M[L]=T[L];return M}else if(ae){var Z=new Uint8Array(R);if(Z.set)Z.set(T);else for(;L<P;++L)Z[L]=T[L];return Z}return T.length=R,T}function Nr(T){for(var D=new Array(T),P=0;P<T;++P)D[P]=0;return D}function In(T,D,P){var R=1,L=0,M=0,Z=0,le=0,Q=T.length,ee=ae?new Uint16Array(32):Nr(32);for(M=0;M<32;++M)ee[M]=0;for(M=Q;M<P;++M)T[M]=0;Q=T.length;var re=ae?new Uint16Array(Q):Nr(Q);for(M=0;M<Q;++M)ee[L=T[M]]++,R<L&&(R=L),re[M]=0;for(ee[0]=0,M=1;M<=R;++M)ee[M+16]=le=le+ee[M-1]<<1;for(M=0;M<Q;++M)le=T[M],le!=0&&(re[M]=ee[le+16]++);var he=0;for(M=0;M<Q;++M)if(he=T[M],he!=0)for(le=I(re[M],R)>>R-he,Z=(1<<R+4-he)-1;Z>=0;--Z)D[le|Z<<he]=he&15|M<<4;return R}var is=ae?new Uint16Array(512):Nr(512),Ja=ae?new Uint16Array(32):Nr(32);if(!ae){for(var sr=0;sr<512;++sr)is[sr]=0;for(sr=0;sr<32;++sr)Ja[sr]=0}(function(){for(var T=[],D=0;D<32;D++)T.push(5);In(T,Ja,32);var P=[];for(D=0;D<=143;D++)P.push(8);for(;D<=255;D++)P.push(9);for(;D<=279;D++)P.push(7);for(;D<=287;D++)P.push(8);In(P,is,288)})();var xn=function(){for(var D=ae?new Uint8Array(32768):[],P=0,R=0;P<te.length-1;++P)for(;R<te[P+1];++R)D[R]=P;for(;R<32768;++R)D[R]=29;var L=ae?new Uint8Array(259):[];for(P=0,R=0;P<J.length-1;++P)for(;R<J[P+1];++R)L[R]=P;function M(le,Q){for(var ee=0;ee<le.length;){var re=Math.min(65535,le.length-ee),he=ee+re==le.length;for(Q.write_shift(1,+he),Q.write_shift(2,re),Q.write_shift(2,~re&65535);re-- >0;)Q[Q.l++]=le[ee++]}return Q.l}function Z(le,Q){for(var ee=0,re=0,he=ae?new Uint16Array(32768):[];re<le.length;){var ye=Math.min(65535,le.length-re);if(ye<10){for(ee=Rt(Q,ee,+(re+ye==le.length)),ee&7&&(ee+=8-(ee&7)),Q.l=ee/8|0,Q.write_shift(2,ye),Q.write_shift(2,~ye&65535);ye-- >0;)Q[Q.l++]=le[re++];ee=Q.l*8;continue}ee=Rt(Q,ee,+(re+ye==le.length)+2);for(var be=0;ye-- >0;){var me=le[re];be=(be<<5^me)&32767;var _e=-1,Ue=0;if((_e=he[be])&&(_e|=re&-32768,_e>re&&(_e-=32768),_e<re))for(;le[_e+Ue]==le[re+Ue]&&Ue<250;)++Ue;if(Ue>2){me=L[Ue],me<=22?ee=On(Q,ee,se[me+1]>>1)-1:(On(Q,ee,3),ee+=5,On(Q,ee,se[me-23]>>5),ee+=3);var wt=me<8?0:me-4>>2;wt>0&&(ta(Q,ee,Ue-J[me]),ee+=wt),me=D[re-_e],ee=On(Q,ee,se[me]>>3),ee-=3;var yt=me<4?0:me-2>>1;yt>0&&(ta(Q,ee,re-_e-te[me]),ee+=yt);for(var pr=0;pr<Ue;++pr)he[be]=re&32767,be=(be<<5^le[re])&32767,++re;ye-=Ue-1}else me<=143?me=me+48:ee=Yr(Q,ee,1),ee=On(Q,ee,se[me]),he[be]=re&32767,++re}ee=On(Q,ee,0)-1}return Q.l=(ee+7)/8|0,Q.l}return function(Q,ee){return Q.length<8?M(Q,ee):Z(Q,ee)}}();function De(T){var D=ie(50+Math.floor(T.length*1.1)),P=xn(T,D);return D.slice(0,P)}var vt=ae?new Uint16Array(32768):Nr(32768),Lr=ae?new Uint16Array(32768):Nr(32768),Ft=ae?new Uint16Array(128):Nr(128),Cs=1,Tu=1;function L0(T,D){var P=Oe(T,D)+257;D+=5;var R=Oe(T,D)+1;D+=5;var L=Ve(T,D)+4;D+=4;for(var M=0,Z=ae?new Uint8Array(19):Nr(19),le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Q=1,ee=ae?new Uint8Array(8):Nr(8),re=ae?new Uint8Array(8):Nr(8),he=Z.length,ye=0;ye<L;++ye)Z[W[ye]]=M=Re(T,D),Q<M&&(Q=M),ee[M]++,D+=3;var be=0;for(ee[0]=0,ye=1;ye<=Q;++ye)re[ye]=be=be+ee[ye-1]<<1;for(ye=0;ye<he;++ye)(be=Z[ye])!=0&&(le[ye]=re[be]++);var me=0;for(ye=0;ye<he;++ye)if(me=Z[ye],me!=0){be=se[le[ye]]>>8-me;for(var _e=(1<<7-me)-1;_e>=0;--_e)Ft[be|_e<<me]=me&7|ye<<3}var Ue=[];for(Q=1;Ue.length<P+R;)switch(be=Ft[xe(T,D)],D+=be&7,be>>>=3){case 16:for(M=3+Be(T,D),D+=2,be=Ue[Ue.length-1];M-- >0;)Ue.push(be);break;case 17:for(M=3+Re(T,D),D+=3;M-- >0;)Ue.push(0);break;case 18:for(M=11+xe(T,D),D+=7;M-- >0;)Ue.push(0);break;default:Ue.push(be),Q<be&&(Q=be);break}var wt=Ue.slice(0,P),yt=Ue.slice(P);for(ye=P;ye<286;++ye)wt[ye]=0;for(ye=R;ye<30;++ye)yt[ye]=0;return Cs=In(wt,vt,286),Tu=In(yt,Lr,30),D}function M0(T,D){if(T[0]==3&&!(T[1]&3))return[Da(D),2];for(var P=0,R=0,L=Mw(D||1<<18),M=0,Z=L.length>>>0,le=0,Q=0;!(R&1);){if(R=Re(T,P),P+=3,R>>>1)R>>1==1?(le=9,Q=5):(P=L0(T,P),le=Cs,Q=Tu);else{P&7&&(P+=8-(P&7));var ee=T[P>>>3]|T[(P>>>3)+1]<<8;if(P+=32,ee>0)for(!D&&Z<M+ee&&(L=as(L,M+ee),Z=L.length);ee-- >0;)L[M++]=T[P>>>3],P+=8;continue}for(;;){!D&&Z<M+32767&&(L=as(L,M+32767),Z=L.length);var re=it(T,P,le),he=R>>>1==1?is[re]:vt[re];if(P+=he&15,he>>>=4,!(he>>>8&255))L[M++]=he;else{if(he==256)break;he-=257;var ye=he<8?0:he-4>>2;ye>5&&(ye=0);var be=M+J[he];ye>0&&(be+=it(T,P,ye),P+=ye),re=it(T,P,Q),he=R>>>1==1?Ja[re]:Lr[re],P+=he&15,he>>>=4;var me=he<4?0:he-2>>1,_e=te[he];for(me>0&&(_e+=it(T,P,me),P+=me),!D&&Z<be&&(L=as(L,be+100),Z=L.length);M<be;)L[M]=L[M-_e],++M}}}return D?[L,P+7>>>3]:[L.slice(0,M),P+7>>>3]}function Nu(T,D){var P=T.slice(T.l||0),R=M0(P,D);return T.l+=R[1],R[0]}function Cu(T,D){if(T)typeof console<"u"&&console.error(D);else throw new Error(D)}function Au(T,D){var P=T;lr(P,0);var R=[],L=[],M={FileIndex:R,FullPaths:L};b(M,{root:D.root});for(var Z=P.length-4;(P[Z]!=80||P[Z+1]!=75||P[Z+2]!=5||P[Z+3]!=6)&&Z>=0;)--Z;P.l=Z+4,P.l+=4;var le=P.read_shift(2);P.l+=6;var Q=P.read_shift(4);for(P.l=Q,Z=0;Z<le;++Z){P.l+=20;var ee=P.read_shift(4),re=P.read_shift(4),he=P.read_shift(2),ye=P.read_shift(2),be=P.read_shift(2);P.l+=8;var me=P.read_shift(4),_e=o(P.slice(P.l+he,P.l+he+ye));P.l+=he+ye+be;var Ue=P.l;P.l=me+4,Qa(P,ee,re,M,_e),P.l=Ue}return M}function Qa(T,D,P,R,L){T.l+=2;var M=T.read_shift(2),Z=T.read_shift(2),le=i(T);if(M&8257)throw new Error("Unsupported ZIP encryption");for(var Q=T.read_shift(4),ee=T.read_shift(4),re=T.read_shift(4),he=T.read_shift(2),ye=T.read_shift(2),be="",me=0;me<he;++me)be+=String.fromCharCode(T[T.l++]);if(ye){var _e=o(T.slice(T.l,T.l+ye));(_e[21589]||{}).mt&&(le=_e[21589].mt),((L||{})[21589]||{}).mt&&(le=L[21589].mt)}T.l+=ye;var Ue=T.slice(T.l,T.l+ee);switch(Z){case 8:Ue=H(T,re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Z)}var wt=!1;M&8&&(Q=T.read_shift(4),Q==134695760&&(Q=T.read_shift(4),wt=!0),ee=T.read_shift(4),re=T.read_shift(4)),ee!=D&&Cu(wt,"Bad compressed size: "+D+" != "+ee),re!=P&&Cu(wt,"Bad uncompressed size: "+P+" != "+re),wl(R,be,Ue,{unsafe:!0,mt:le})}function ju(T,D){var P=D||{},R=[],L=[],M=ie(1),Z=P.compression?8:0,le=0,Q=0,ee=0,re=0,he=0,ye=T.FullPaths[0],be=ye,me=T.FileIndex[0],_e=[],Ue=0;for(Q=1;Q<T.FullPaths.length;++Q)if(be=T.FullPaths[Q].slice(ye.length),me=T.FileIndex[Q],!(!me.size||!me.content||be=="Sh33tJ5")){var wt=re,yt=ie(be.length);for(ee=0;ee<be.length;++ee)yt.write_shift(1,be.charCodeAt(ee)&127);yt=yt.slice(0,yt.l),_e[he]=Z6.buf(me.content,0);var pr=me.content;Z==8&&(pr=U(pr)),M=ie(30),M.write_shift(4,67324752),M.write_shift(2,20),M.write_shift(2,le),M.write_shift(2,Z),me.mt?a(M,me.mt):M.write_shift(4,0),M.write_shift(-4,_e[he]),M.write_shift(4,pr.length),M.write_shift(4,me.content.length),M.write_shift(2,yt.length),M.write_shift(2,0),re+=M.length,R.push(M),re+=yt.length,R.push(yt),re+=pr.length,R.push(pr),M=ie(46),M.write_shift(4,33639248),M.write_shift(2,0),M.write_shift(2,20),M.write_shift(2,le),M.write_shift(2,Z),M.write_shift(4,0),M.write_shift(-4,_e[he]),M.write_shift(4,pr.length),M.write_shift(4,me.content.length),M.write_shift(2,yt.length),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(4,0),M.write_shift(4,wt),Ue+=M.l,L.push(M),Ue+=yt.length,L.push(yt),++he}return M=ie(22),M.write_shift(4,101010256),M.write_shift(2,0),M.write_shift(2,0),M.write_shift(2,he),M.write_shift(2,he),M.write_shift(4,Ue),M.write_shift(4,re),M.write_shift(2,0),er([er(R),er(L),M])}var Za={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ue(T,D){if(T.ctype)return T.ctype;var P=T.name||"",R=P.match(/\.([^\.]+)$/);return R&&Za[R[1]]||D&&(R=(P=D).match(/[\.\\]([^\.\\])+$/),R&&Za[R[1]])?Za[R[1]]:"application/octet-stream"}function ke(T){for(var D=zc(T),P=[],R=0;R<D.length;R+=76)P.push(D.slice(R,R+76));return P.join(`\r
`)+`\r
`}function lt(T){var D=T.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ee){var re=ee.charCodeAt(0).toString(16).toUpperCase();return"="+(re.length==1?"0"+re:re)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var P=[],R=D.split(`\r
`),L=0;L<R.length;++L){var M=R[L];if(M.length==0){P.push("");continue}for(var Z=0;Z<M.length;){var le=76,Q=M.slice(Z,Z+le);Q.charAt(le-1)=="="?le--:Q.charAt(le-2)=="="?le-=2:Q.charAt(le-3)=="="&&(le-=3),Q=M.slice(Z,Z+le),Z+=le,Z<M.length&&(Q+="="),P.push(Q)}}return P.join(`\r
`)}function Dn(T){for(var D=[],P=0;P<T.length;++P){for(var R=T[P];P<=T.length&&R.charAt(R.length-1)=="=";)R=R.slice(0,R.length-1)+T[++P];D.push(R)}for(var L=0;L<D.length;++L)D[L]=D[L].replace(/[=][0-9A-Fa-f]{2}/g,function(M){return String.fromCharCode(parseInt(M.slice(1),16))});return nn(D.join(`\r
`))}function hr(T,D,P){for(var R="",L="",M="",Z,le=0;le<10;++le){var Q=D[le];if(!Q||Q.match(/^\s*$/))break;var ee=Q.match(/^(.*?):\s*([^\s].*)$/);if(ee)switch(ee[1].toLowerCase()){case"content-location":R=ee[2].trim();break;case"content-type":M=ee[2].trim();break;case"content-transfer-encoding":L=ee[2].trim();break}}switch(++le,L.toLowerCase()){case"base64":Z=nn(dn(D.slice(le).join("")));break;case"quoted-printable":Z=Dn(D.slice(le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+L)}var re=wl(T,R.slice(P.length),Z,{unsafe:!0});M&&(re.ctype=M)}function Cr(T,D){if(F(T.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var P=D&&D.root||"",R=(Ge&&Buffer.isBuffer(T)?T.toString("binary"):F(T)).split(`\r
`),L=0,M="";for(L=0;L<R.length;++L)if(M=R[L],!!/^Content-Location:/i.test(M)&&(M=M.slice(M.indexOf("file")),P||(P=M.slice(0,M.lastIndexOf("/")+1)),M.slice(0,P.length)!=P))for(;P.length>0&&(P=P.slice(0,P.length-1),P=P.slice(0,P.lastIndexOf("/")+1),M.slice(0,P.length)!=P););var Z=(R[1]||"").match(/boundary="(.*?)"/);if(!Z)throw new Error("MAD cannot find boundary");var le="--"+(Z[1]||""),Q=[],ee=[],re={FileIndex:Q,FullPaths:ee};b(re);var he,ye=0;for(L=0;L<R.length;++L){var be=R[L];be!==le&&be!==le+"--"||(ye++&&hr(re,R.slice(he,L),P),he=L)}return re}function Pu(T,D){var P=D||{},R=P.boundary||"SheetJS";R="------="+R;for(var L=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+R.slice(2)+'"',"","",""],M=T.FullPaths[0],Z=M,le=T.FileIndex[0],Q=1;Q<T.FullPaths.length;++Q)if(Z=T.FullPaths[Q].slice(M.length),le=T.FileIndex[Q],!(!le.size||!le.content||Z=="Sh33tJ5")){Z=Z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ue){return"_x"+Ue.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ue){return"_u"+Ue.charCodeAt(0).toString(16)+"_"});for(var ee=le.content,re=Ge&&Buffer.isBuffer(ee)?ee.toString("binary"):F(ee),he=0,ye=Math.min(1024,re.length),be=0,me=0;me<=ye;++me)(be=re.charCodeAt(me))>=32&&be<128&&++he;var _e=he>=ye*4/5;L.push(R),L.push("Content-Location: "+(P.root||"file:///C:/SheetJS/")+Z),L.push("Content-Transfer-Encoding: "+(_e?"quoted-printable":"base64")),L.push("Content-Type: "+ue(le,Z)),L.push(""),L.push(_e?lt(re):ke(re))}return L.push(R+`--\r
`),L.join(`\r
`)}function B0(T){var D={};return b(D,T),D}function wl(T,D,P,R){var L=R&&R.unsafe;L||b(T);var M=!L&&Ee.find(T,D);if(!M){var Z=T.FullPaths[0];D.slice(0,Z.length)==Z?Z=D:(Z.slice(-1)!="/"&&(Z+="/"),Z=(Z+D).replace("//","/")),M={name:s(D),type:2},T.FileIndex.push(M),T.FullPaths.push(Z),L||Ee.utils.cfb_gc(T)}return M.content=P,M.size=P?P.length:0,R&&(R.CLSID&&(M.clsid=R.CLSID),R.mt&&(M.mt=R.mt),R.ct&&(M.ct=R.ct)),M}function Ji(T,D){b(T);var P=Ee.find(T,D);if(P){for(var R=0;R<T.FileIndex.length;++R)if(T.FileIndex[R]==P)return T.FileIndex.splice(R,1),T.FullPaths.splice(R,1),!0}return!1}function U0(T,D,P){b(T);var R=Ee.find(T,D);if(R){for(var L=0;L<T.FileIndex.length;++L)if(T.FileIndex[L]==R)return T.FileIndex[L].name=s(P),T.FullPaths[L]=P,!0}return!1}function $0(T){A(T,!0)}return t.find=V,t.read=k,t.parse=f,t.write=ne,t.writeFile=K,t.utils={cfb_new:B0,cfb_add:wl,cfb_del:Ji,cfb_mov:U0,cfb_gc:$0,ReadShift:ac,CheckField:xT,prep_blob:lr,bconcat:er,use_zlib:j,_deflateRaw:De,_inflateRaw:Nu,consts:q},t}();function eL(e){return typeof e=="string"?E0(e):Array.isArray(e)?T6(e):e}function gu(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=E0(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?vs(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var s=new Blob([eL(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,e);if(typeof saveAs<"u")return saveAs(s,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var i=document.createElement("a");if(i.download!=null)return i.download=e,i.href=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Ka(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function tL(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Pt(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Gw(e,t){for(var r=[],n=Pt(e),s=0;s!==n.length;++s)r[e[n[s]][t]]==null&&(r[e[n[s]][t]]=n[s]);return r}function N0(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function C0(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function rL(e){for(var t=[],r=Pt(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var jd=new Date(1899,11,30,0,0,0);function Yt(e,t){var r=e.getTime(),n=jd.getTime()+(e.getTimezoneOffset()-jd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var XE=new Date,nL=jd.getTime()+(XE.getTimezoneOffset()-jd.getTimezoneOffset())*6e4,qw=XE.getTimezoneOffset();function A0(e){var t=new Date;return t.setTime(e*24*60*60*1e3+nL),t.getTimezoneOffset()!==qw&&t.setTime(t.getTime()+(t.getTimezoneOffset()-qw)*6e4),t}function sL(e){var t=0,r=0,n=!1,s=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!s)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var a=1;a!=s.length;++a)if(s[a]){switch(r=1,a>3&&(n=!0),s[a].slice(s[a].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+s[a].slice(s[a].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(s[a],10)}return t}var Kw=new Date("2017-02-19T19:06:09.000Z"),YE=isNaN(Kw.getFullYear())?new Date("2/19/17"):Kw,aL=YE.getFullYear()==2017;function mt(e,t){var r=new Date(e);if(aL)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(YE.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var s=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ri(e,t){if(Ge&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return vs(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return vs(LE(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return vs(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return vs(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(a){return r[a]||a})}catch{}for(var n=[],s=0;s!=e.length;++s)n.push(String.fromCharCode(e[s]));return n.join("")}function xt(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=xt(e[r]));return t}function At(e,t){for(var r="";r.length<t;)r+=e;return r}function Qn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(s,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var iL=["january","february","march","april","may","june","july","august","september","october","november","december"];function el(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),s=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&iL.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(s>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var oL=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,s){if(e||typeof n=="string")return r.split(n);for(var a=r.split(n),i=[a[0]],o=1;o<a.length;++o)i.push(s),i.push(a[o]);return i}}();function JE(e){return e?e.content&&e.type?Ri(e.content,!0):e.data?Wl(e.data):e.asNodeBuffer&&Ge?Wl(e.asNodeBuffer().toString("binary")):e.asBinary?Wl(e.asBinary()):e._data&&e._data.getContent?Wl(Ri(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function QE(e){if(!e)return null;if(e.data)return Dw(e.data);if(e.asNodeBuffer&&Ge)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?Dw(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function lL(e){return e&&e.name.slice(-4)===".bin"?QE(e):JE(e)}function _n(e,t){for(var r=e.FullPaths||Pt(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),s=n.replace(/\\/g,"/"),a=0;a<r.length;++a){var i=r[a].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||s==i)return e.files?e.files[r[a]]:e.FileIndex[a]}return null}function Ng(e,t){var r=_n(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Ut(e,t,r){if(!r)return lL(Ng(e,t));if(!t)return null;try{return Ut(e,t)}catch{return null}}function sn(e,t,r){if(!r)return JE(Ng(e,t));if(!t)return null;try{return sn(e,t)}catch{return null}}function cL(e,t,r){return QE(Ng(e,t))}function Xw(e){for(var t=e.FullPaths||Pt(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function We(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Ge?n=Qs(r):n=N6(r),Ee.utils.cfb_add(e,t,n)}Ee.utils.cfb_add(e,t,r)}else e.file(t,r)}function Cg(){return Ee.utils.cfb_new()}function ZE(e,t){switch(t.type){case"base64":return Ee.read(e,{type:"base64"});case"binary":return Ee.read(e,{type:"binary"});case"buffer":case"array":return Ee.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Hl(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var s=n.shift();s===".."?r.pop():s!=="."&&r.push(s)}return r.join("/")}var Mt=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,uL=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Yw=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,fL=/<[^>]*>/g,Tr=Mt.match(Yw)?Yw:fL,dL=/<\w*:/,hL=/<(\/?)\w+:/;function Fe(e,t,r){for(var n={},s=0,a=0;s!==e.length&&!((a=e.charCodeAt(s))===32||a===10||a===13);++s);if(t||(n[0]=e.slice(0,s)),s===e.length)return n;var i=e.match(uL),o=0,c="",u=0,f="",d="",h=1;if(i)for(u=0;u!=i.length;++u){for(d=i[u],a=0;a!=d.length&&d.charCodeAt(a)!==61;++a);for(f=d.slice(0,a).trim();d.charCodeAt(a+1)==32;)++a;for(h=(s=d.charCodeAt(a+1))==34||s==39?1:0,c=d.slice(a+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=c,n[f.toLowerCase()]=c;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[p]&&f.slice(o-3,o)=="ext")continue;n[p]=c,n[p.toLowerCase()]=c}}return n}function Ts(e){return e.replace(hL,"<$1")}var eT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ag=N0(eT),Qe=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var s=n+"",a=s.indexOf("<![CDATA[");if(a==-1)return s.replace(e,function(o,c){return eT[o]||String.fromCharCode(parseInt(c,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,c){return String.fromCharCode(parseInt(c,16))});var i=s.indexOf("]]>");return r(s.slice(0,a))+s.slice(a+9,i)+r(s.slice(i+3))}}(),jg=/[&<>'"]/g,pL=/[\u0000-\u0008\u000b-\u001f]/g;function st(e){var t=e+"";return t.replace(jg,function(r){return Ag[r]}).replace(pL,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Jw(e){return st(e).replace(/ /g,"_x0020_")}var tT=/[\u0000-\u001f]/g;function Pg(e){var t=e+"";return t.replace(jg,function(r){return Ag[r]}).replace(/\n/g,"<br/>").replace(tT,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function mL(e){var t=e+"";return t.replace(jg,function(r){return Ag[r]}).replace(tT,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var Qw=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function xL(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function ht(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function zh(e){for(var t="",r=0,n=0,s=0,a=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(s=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=s&63,t+=String.fromCharCode(i);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(s&63)<<6|a&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(s&63)<<12|(a&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Zw(e){var t=Da(2*e.length),r,n,s=1,a=0,i=0,o;for(n=0;n<e.length;n+=s)s=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),s=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),s=3):(s=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[a++]=i&255,t[a++]=i>>>8,i=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function ey(e){return Qs(e,"binary").toString("utf8")}var of="foo bar bazâð£",ot=Ge&&(ey(of)==zh(of)&&ey||Zw(of)==zh(of)&&Zw)||zh,vs=Ge?function(e){return Qs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,s=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,s=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(s>>18&7))),t.push(String.fromCharCode(144+(s>>12&63))),t.push(String.fromCharCode(128+(s>>6&63))),t.push(String.fromCharCode(128+(s&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Vc=function(){var e={};return function(r,n){var s=r+"|"+(n||"");return e[s]?e[s]:e[s]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),rT=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<e.length;++s)n=n.replace(e[s][0],e[s][1]);return n}}(),gL=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),vL=/<\/?(?:vt:)?variant>/g,wL=/<(?:vt:)([^>]*)>([\s\S]*)</;function ty(e,t){var r=Fe(e),n=e.match(gL(r.baseType))||[],s=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return s}return n.forEach(function(a){var i=a.replace(vL,"").match(wL);i&&s.push({v:ot(i[2]),t:i[1]})}),s}var nT=/(^\s|\s$|\n)/;function cr(e,t){return"<"+e+(t.match(nT)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Hc(e){return Pt(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function ve(e,t,r){return"<"+e+(r!=null?Hc(r):"")+(t!=null?(t.match(nT)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Am(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function yL(e,t){switch(typeof e){case"string":var r=ve("vt:lpwstr",st(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return ve((e|0)==e?"vt:i4":"vt:r8",st(String(e)));case"boolean":return ve("vt:bool",e?"true":"false")}if(e instanceof Date)return ve("vt:filetime",Am(e));throw new Error("Unable to serialize "+e)}function Rg(e){if(Ge&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return ot(Ka(kg(e)));throw new Error("Bad input format: expected Buffer or string")}var Gc=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Kt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Hi=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],en={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function _L(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),s=e[t+6]&15,a=5;a>=0;--a)s=s*256+e[t+a];return n==2047?s==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,s+=Math.pow(2,52)),r*Math.pow(2,n-52)*s)}function bL(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,s=0,a=0,i=n?-t:t;isFinite(i)?i==0?s=a=0:(s=Math.floor(Math.log(i)/Math.LN2),a=i*Math.pow(2,52-s),s<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?s=-1022:(a-=Math.pow(2,52),s+=1023)):(s=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(s&15)<<4|a&15,e[r+7]=s>>4|n}var ry=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var s=0,a=e[0][n].length;s<a;s+=r)t.push.apply(t,e[0][n].slice(s,s+r));return t},ny=Ge?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Qs(t)})):ry(e)}:ry,sy=function(e,t,r){for(var n=[],s=t;s<r;s+=2)n.push(String.fromCharCode(Ls(e,s)));return n.join("").replace(Fr,"")},Fg=Ge?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Fr,""):sy(e,t,r)}:sy,ay=function(e,t,r){for(var n=[],s=t;s<t+r;++s)n.push(("0"+e[s].toString(16)).slice(-2));return n.join("")},sT=Ge?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):ay(e,t,r)}:ay,iy=function(e,t,r){for(var n=[],s=t;s<r;s++)n.push(String.fromCharCode(po(e,s)));return n.join("")},vu=Ge?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):iy(t,r,n)}:iy,aT=function(e,t){var r=tn(e,t);return r>0?vu(e,t+4,t+4+r-1):""},iT=aT,oT=function(e,t){var r=tn(e,t);return r>0?vu(e,t+4,t+4+r-1):""},lT=oT,cT=function(e,t){var r=2*tn(e,t);return r>0?vu(e,t+4,t+4+r-1):""},uT=cT,fT=function(t,r){var n=tn(t,r);return n>0?Fg(t,r+4,r+4+n):""},dT=fT,hT=function(e,t){var r=tn(e,t);return r>0?vu(e,t+4,t+4+r):""},pT=hT,mT=function(e,t){return _L(e,t)},Pd=mT,Og=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Ge&&(iT=function(t,r){if(!Buffer.isBuffer(t))return aT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},lT=function(t,r){if(!Buffer.isBuffer(t))return oT(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},uT=function(t,r){if(!Buffer.isBuffer(t))return cT(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},dT=function(t,r){if(!Buffer.isBuffer(t))return fT(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},pT=function(t,r){if(!Buffer.isBuffer(t))return hT(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Pd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):mT(t,r)},Og=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var po=function(e,t){return e[t]},Ls=function(e,t){return e[t+1]*256+e[t]},SL=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},tn=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},ci=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},kL=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ac(e,t){var r="",n,s,a=[],i,o,c,u;switch(t){case"dbcs":if(u=this.l,Ge&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(Ls(this,u)),u+=2;e*=2;break;case"utf8":r=vu(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Fg(this,this.l,this.l+e);break;case"wstr":return ac.call(this,e,"dbcs");case"lpstr-ansi":r=iT(this,this.l),e=4+tn(this,this.l);break;case"lpstr-cp":r=lT(this,this.l),e=4+tn(this,this.l);break;case"lpwstr":r=uT(this,this.l),e=4+2*tn(this,this.l);break;case"lpp4":e=4+tn(this,this.l),r=dT(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+tn(this,this.l),r=pT(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=po(this,this.l+e++))!==0;)a.push(af(i));r=a.join("");break;case"_wstr":for(e=0,r="";(i=Ls(this,this.l+e))!==0;)a.push(af(i)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=po(this,u),this.l=u+1,o=ac.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(af(Ls(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return i=po(this,u),this.l=u+1,o=ac.call(this,e-c,i?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(af(po(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=po(this,this.l),this.l++,n;case 2:return n=(t==="i"?SL:Ls)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?ci:kL)(this,this.l),this.l+=4,n):(s=tn(this,this.l),this.l+=4,s);case 8:case-8:if(t==="f")return e==8?s=Pd(this,this.l):s=Pd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;e=8;case 16:r=sT(this,this.l,e);break}}return this.l+=e,r}var EL=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},TL=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},NL=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function CL(e,t,r){var n=0,s=0;if(r==="dbcs"){for(s=0;s!=t.length;++s)NL(this,t.charCodeAt(s),this.l+2*s);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=t.length;++s)this[this.l+s]=t.charCodeAt(s)&255;n=t.length}else if(r==="hex"){for(;s<e;++s)this[this.l++]=parseInt(t.slice(2*s,2*s+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(s=0;s<Math.min(t.length,e);++s){var i=t.charCodeAt(s);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,EL(this,t,this.l);break;case 8:if(n=8,r==="f"){bL(this,t,this.l);break}case 16:break;case-4:n=4,TL(this,t,this.l);break}return this.l+=n,this}function xT(e,t){var r=sT(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function lr(e,t){e.l=t,e.read_shift=ac,e.chk=xT,e.write_shift=CL}function Er(e,t){e.l+=t}function ie(e){var t=Da(e);return lr(t,0),t}function Zs(e,t,r){if(e){var n,s,a;lr(e,e.l||0);for(var i=e.length,o=0,c=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Qc[o]||Qc[65535];for(n=e.read_shift(1),a=n&127,s=1;s<4&&n&128;++s)a+=((n=e.read_shift(1))&127)<<7*s;c=e.l+a;var f=u.f&&u.f(e,a,r);if(e.l=c,t(f,u,o))return}}}function Gr(){var e=[],t=Ge?256:2048,r=function(u){var f=ie(u);return lr(f,0),f},n=r(t),s=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(s(),n=r(Math.max(u+1,t)))},i=function(){return s(),er(e)},o=function(u){s(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:i,_bufs:e}}function ce(e,t,r,n){var s=+t,a;if(!isNaN(s)){n||(n=Qc[s].p||(r||[]).length||0),a=1+(s>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var i=e.next(a);s<=127?i.write_shift(1,s):(i.write_shift(1,(s&127)+128),i.write_shift(1,s>>7));for(var o=0;o!=4;++o)if(n>=128)i.write_shift(1,(n&127)+128),n>>=7;else{i.write_shift(1,n);break}n>0&&Og(r)&&e.push(r)}}function ic(e,t,r){var n=xt(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function oy(e,t,r){var n=xt(e);return n.s=ic(n.s,t.s,r),n.e=ic(n.e,t.s,r),n}function oc(e,t){if(e.cRel&&e.c<0)for(e=xt(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=xt(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=je(e);return!e.cRel&&e.cRel!=null&&(r=PL(r)),!e.rRel&&e.rRel!=null&&(r=AL(r)),r}function Wh(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+bt(e.s.c)+":"+(e.e.cRel?"":"$")+bt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Dt(e.s.r)+":"+(e.e.rRel?"":"$")+Dt(e.e.r):oc(e.s,t.biff)+":"+oc(e.e,t.biff)}function Ig(e){return parseInt(jL(e),10)-1}function Dt(e){return""+(e+1)}function AL(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function jL(e){return e.replace(/\$(\d+)$/,"$1")}function Dg(e){for(var t=RL(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function bt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function PL(e){return e.replace(/^([A-Z])/,"$$$1")}function RL(e){return e.replace(/^\$([A-Z])/,"$1")}function FL(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function St(e){for(var t=0,r=0,n=0;n<e.length;++n){var s=e.charCodeAt(n);s>=48&&s<=57?t=10*t+(s-48):s>=65&&s<=90&&(r=26*r+(s-64))}return{c:r-1,r:t-1}}function je(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function qr(e){var t=e.indexOf(":");return t==-1?{s:St(e),e:St(e)}:{s:St(e.slice(0,t)),e:St(e.slice(t+1))}}function $e(e,t){return typeof t>"u"||typeof t=="number"?$e(e.s,e.e):(typeof e!="string"&&(e=je(e)),typeof t!="string"&&(t=je(t)),e==t?e:e+":"+t)}function Ze(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,s=0,a=e.length;for(r=0;n<a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.s.c=--r,r=0;n<a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;if(t.s.r=--r,n===a||s!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((s=e.charCodeAt(n)-64)<1||s>26);++n)r=26*r+s;for(t.e.c=--r,r=0;n!=a&&!((s=e.charCodeAt(n)-48)<0||s>9);++n)r=10*r+s;return t.e.r=--r,t}function ly(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Rn(e.z,r?Yt(t):t)}catch{}try{return e.w=Rn((e.XF||{}).numFmtId||(r?14:0),r?Yt(t):t)}catch{return""+t}}function Xs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ea[e.v]||e.v:t==null?ly(e,e.v):ly(e,t))}function Xa(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function gT(e,t,r){var n=r||{},s=e?Array.isArray(e):n.dense,a=e||(s?[]:{}),i=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?St(n.origin):n.origin;i=c.r,o=c.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=Ze(a["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),i==-1&&(u.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var p={v:t[d][h]},g=i+d,m=o+h;if(u.s.r>g&&(u.s.r=g),u.s.c>m&&(u.s.c=m),u.e.r<g&&(u.e.r=g),u.e.c<m&&(u.e.c=m),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))p=t[d][h];else if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||Ae[14],n.cellDates?(p.t="d",p.w=Rn(p.z,Yt(p.v))):(p.t="n",p.v=Yt(p.v),p.w=Rn(p.z,p.v))):p.t="s";if(s)a[g]||(a[g]=[]),a[g][m]&&a[g][m].z&&(p.z=a[g][m].z),a[g][m]=p;else{var x=je({c:m,r:g});a[x]&&a[x].z&&(p.z=a[x].z),a[x]=p}}}return u.s.c<1e7&&(a["!ref"]=$e(u)),a}function gl(e,t){return gT(null,e,t)}function OL(e){return e.read_shift(4,"i")}function Zn(e,t){return t||(t=ie(4)),t.write_shift(4,e),t}function Sr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function tr(e,t){var r=!1;return t==null&&(r=!0,t=ie(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function IL(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function DL(e,t){return t||(t=ie(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Lg(e,t){var r=e.l,n=e.read_shift(1),s=Sr(e),a=[],i={t:s,h:s};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)a.push(IL(e));i.r=a}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}function LL(e,t){var r=!1;return t==null&&(r=!0,t=ie(15+4*e.t.length)),t.write_shift(1,0),tr(e.t,t),r?t.slice(0,t.l):t}var ML=Lg;function BL(e,t){var r=!1;return t==null&&(r=!0,t=ie(23+4*e.t.length)),t.write_shift(1,1),tr(e.t,t),t.write_shift(4,1),DL({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function Fn(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Gi(e,t){return t==null&&(t=ie(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function qi(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ki(e,t){return t==null&&(t=ie(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var UL=Sr,vT=tr;function Mg(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Rd(e,t){var r=!1;return t==null&&(r=!0,t=ie(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var $L=Sr,jm=Mg,Bg=Rd;function Ug(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var s=n===0?Pd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):ci(t,0)>>2;return r?s/100:s}function wT(e,t){t==null&&(t=ie(4));var r=0,n=0,s=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:s==(s|0)&&s>=-(1<<29)&&s<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?s:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function yT(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function zL(e,t){return t||(t=ie(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Xi=yT,vl=zL;function br(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Fi(e,t){return(t||ie(8)).write_shift(8,e,"f")}function WL(e){var t={},r=e.read_shift(1),n=r>>>1,s=e.read_shift(1),a=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=s;var u=gi[s];u&&(t.rgb=Kc(u));break;case 2:t.rgb=Kc([i,o,c]);break;case 3:t.theme=s;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function Fd(e,t){if(t||(t=ie(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function VL(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function HL(e,t){t||(t=ie(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function _T(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function GL(e){return _T(e,1)}function qL(e){return _T(e,2)}var $g=2,Br=3,lf=11,cy=12,Od=19,cf=64,KL=65,XL=71,YL=4108,JL=4126,Qt=80,bT=81,QL=[Qt,bT],Pm={1:{n:"CodePage",t:$g},2:{n:"Category",t:Qt},3:{n:"PresentationFormat",t:Qt},4:{n:"ByteCount",t:Br},5:{n:"LineCount",t:Br},6:{n:"ParagraphCount",t:Br},7:{n:"SlideCount",t:Br},8:{n:"NoteCount",t:Br},9:{n:"HiddenCount",t:Br},10:{n:"MultimediaClipCount",t:Br},11:{n:"ScaleCrop",t:lf},12:{n:"HeadingPairs",t:YL},13:{n:"TitlesOfParts",t:JL},14:{n:"Manager",t:Qt},15:{n:"Company",t:Qt},16:{n:"LinksUpToDate",t:lf},17:{n:"CharacterCount",t:Br},19:{n:"SharedDoc",t:lf},22:{n:"HyperlinksChanged",t:lf},23:{n:"AppVersion",t:Br,p:"version"},24:{n:"DigSig",t:KL},26:{n:"ContentType",t:Qt},27:{n:"ContentStatus",t:Qt},28:{n:"Language",t:Qt},29:{n:"Version",t:Qt},255:{},2147483648:{n:"Locale",t:Od},2147483651:{n:"Behavior",t:Od},1919054434:{}},Rm={1:{n:"CodePage",t:$g},2:{n:"Title",t:Qt},3:{n:"Subject",t:Qt},4:{n:"Author",t:Qt},5:{n:"Keywords",t:Qt},6:{n:"Comments",t:Qt},7:{n:"Template",t:Qt},8:{n:"LastAuthor",t:Qt},9:{n:"RevNumber",t:Qt},10:{n:"EditTime",t:cf},11:{n:"LastPrinted",t:cf},12:{n:"CreatedDate",t:cf},13:{n:"ModifiedDate",t:cf},14:{n:"PageCount",t:Br},15:{n:"WordCount",t:Br},16:{n:"CharCount",t:Br},17:{n:"Thumbnail",t:XL},18:{n:"Application",t:Qt},19:{n:"DocSecurity",t:Br},255:{},2147483648:{n:"Locale",t:Od},2147483651:{n:"Behavior",t:Od},1919054434:{}},uy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},ZL=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function eM(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var tM=eM([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),gi=xt(tM),ea={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ST={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Fm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},uf={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function zg(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function rM(e){var t=zg();if(!e||!e.match)return t;var r={};if((e.match(Tr)||[]).forEach(function(n){var s=Fe(n);switch(s[0].replace(dL,"<")){case"<?xml":break;case"<Types":t.xmlns=s["xmlns"+(s[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[s.Extension]=s.ContentType;break;case"<Override":t[Fm[s.ContentType]]!==void 0&&t[Fm[s.ContentType]].push(s.PartName);break}}),t.xmlns!==Kt.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function kT(e,t){var r=rL(Fm),n=[],s;n[n.length]=Mt,n[n.length]=ve("Types",null,{xmlns:Kt.CT,"xmlns:xsd":Kt.xsd,"xmlns:xsi":Kt.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ve("Default",null,{Extension:c[0],ContentType:c[1]})}));var a=function(c){e[c]&&e[c].length>0&&(s=e[c][0],n[n.length]=ve("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:uf[c][t.bookType]||uf[c].xlsx}))},i=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ve("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:uf[c][t.bookType]||uf[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=ve("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return a("workbooks"),i("sheets"),i("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),i("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var qe={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function qc(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function lc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Tr)||[]).forEach(function(s){var a=Fe(s);if(a[0]==="<Relationship"){var i={};i.Type=a.Type,i.Target=a.Target,i.Id=a.Id,a.TargetMode&&(i.TargetMode=a.TargetMode);var o=a.TargetMode==="External"?a.Target:Hl(a.Target,t);r[o]=i,n[a.Id]=i}}),r["!id"]=n,r}function Uo(e){var t=[Mt,ve("Relationships",null,{xmlns:Kt.RELS})];return Pt(e["!id"]).forEach(function(r){t[t.length]=ve("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function nt(e,t,r,n,s,a){if(s||(s={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,s.Id="rId"+t,s.Type=n,s.Target=r,[qe.HLINK,qe.XPATH,qe.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),e["!id"][s.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][s.Id]=s,e[("/"+s.Target).replace("//","/")]=s,t}var nM="application/vnd.oasis.opendocument.spreadsheet";function sM(e,t){for(var r=Rg(e),n,s;n=Gc.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(s=Fe(n[0],!1),s.path=="/"&&s.type!==nM)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function aM(e){var t=[Mt];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function fy(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function iM(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function oM(e){var t=[Mt];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(fy(e[r][0],e[r][1])),t.push(iM("",e[r][0]));return t.push(fy("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function ET(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Td.version+"</meta:generator></office:meta></office:document-meta>"}var Cn=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],lM=function(){for(var e=new Array(Cn.length),t=0;t<Cn.length;++t){var r=Cn[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function TT(e){var t={};e=ot(e);for(var r=0;r<Cn.length;++r){var n=Cn[r],s=e.match(lM[r]);s!=null&&s.length>0&&(t[n[1]]=Qe(s[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=mt(t[n[1]]))}return t}function Vh(e,t,r,n,s){s[e]!=null||t==null||t===""||(s[e]=t,t=st(t),n[n.length]=r?ve(e,t,r):cr(e,t))}function NT(e,t){var r=t||{},n=[Mt,ve("cp:coreProperties",null,{"xmlns:cp":Kt.CORE_PROPS,"xmlns:dc":Kt.dc,"xmlns:dcterms":Kt.dcterms,"xmlns:dcmitype":Kt.dcmitype,"xmlns:xsi":Kt.xsi})],s={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Vh("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Am(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s),e.ModifiedDate!=null&&Vh("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Am(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,s));for(var a=0;a!=Cn.length;++a){var i=Cn[a],o=r.Props&&r.Props[i[1]]!=null?r.Props[i[1]]:e?e[i[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Vh(i[0],o,null,n,s)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var vi=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],CT=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function AT(e,t,r,n){var s=[];if(typeof e=="string")s=ty(e,n);else for(var a=0;a<e.length;++a)s=s.concat(e[a].map(function(f){return{v:f}}));var i=typeof t=="string"?ty(t,n).map(function(f){return f.v}):t,o=0,c=0;if(i.length>0)for(var u=0;u!==s.length;u+=2){switch(c=+s[u+1].v,s[u].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=c,r.SheetNames=i.slice(o,o+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=c,r.DefinedNames=i.slice(o,o+c);break;case"Charts":case"Diagramme":r.Chartsheets=c,r.ChartNames=i.slice(o,o+c);break}o+=c}}function cM(e,t,r){var n={};return t||(t={}),e=ot(e),vi.forEach(function(s){var a=(e.match(Vc(s[0]))||[])[1];switch(s[2]){case"string":a&&(t[s[1]]=Qe(a));break;case"bool":t[s[1]]=a==="true";break;case"raw":var i=e.match(new RegExp("<"+s[0]+"[^>]*>([\\s\\S]*?)</"+s[0]+">"));i&&i.length>0&&(n[s[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&AT(n.HeadingPairs,n.TitlesOfParts,t,r),t}function jT(e){var t=[],r=ve;return e||(e={}),e.Application="SheetJS",t[t.length]=Mt,t[t.length]=ve("Properties",null,{xmlns:Kt.EXT_PROPS,"xmlns:vt":Kt.vt}),vi.forEach(function(n){if(e[n[1]]!==void 0){var s;switch(n[2]){case"string":s=st(String(e[n[1]]));break;case"bool":s=e[n[1]]?"true":"false";break}s!==void 0&&(t[t.length]=r(n[0],s))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+st(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var uM=/<[^>]+>[^<]*/g;function fM(e,t){var r={},n="",s=e.match(uM);if(s)for(var a=0;a!=s.length;++a){var i=s[a],o=Fe(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=Qe(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var c=i.split(">"),u=c[0].slice(4),f=c[1];switch(u){case"lpstr":case"bstr":case"lpwstr":r[n]=Qe(f);break;case"bool":r[n]=ht(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=mt(f);break;case"cy":case"error":r[n]=Qe(f);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,u,c)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}function PT(e){var t=[Mt,ve("Properties",null,{xmlns:Kt.CUST_PROPS,"xmlns:vt":Kt.vt})];if(!e)return t.join("");var r=1;return Pt(e).forEach(function(s){++r,t[t.length]=ve("property",yL(e[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:st(s)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Om={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Hh;function dM(e,t,r){Hh||(Hh=N0(Om)),t=Hh[t]||t,e[t]=r}function hM(e,t){var r=[];return Pt(Om).map(function(n){for(var s=0;s<Cn.length;++s)if(Cn[s][1]==n)return Cn[s];for(s=0;s<vi.length;++s)if(vi[s][1]==n)return vi[s];throw n}).forEach(function(n){if(e[n[1]]!=null){var s=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),r.push(cr(Om[n[1]]||n[1],s))}}),ve("DocumentProperties",r.join(""),{xmlns:en.o})}function pM(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",s=[];return e&&Pt(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var i=0;i<Cn.length;++i)if(a==Cn[i][1])return;for(i=0;i<vi.length;++i)if(a==vi[i][1])return;for(i=0;i<r.length;++i)if(a==r[i])return;var o=e[a],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),s.push(ve(Jw(a),o,{"dt:dt":c}))}}),t&&Pt(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var i=t[a],o="string";typeof i=="number"?(o="float",i=String(i)):i===!0||i===!1?(o="boolean",i=i?"1":"0"):i instanceof Date?(o="dateTime.tz",i=i.toISOString()):i=String(i),s.push(ve(Jw(a),i,{"dt:dt":o}))}}),"<"+n+' xmlns="'+en.o+'">'+s.join("")+"</"+n+">"}function Wg(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function mM(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),s=(r-n)/Math.pow(2,32);n*=1e7,s*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),s+=a);var i=ie(8);return i.write_shift(4,n),i.write_shift(4,s),i}function RT(e,t,r){var n=e.l,s=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return s}function FT(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function OT(e,t,r){return t===31?FT(e):RT(e,t,r)}function Im(e,t,r){return OT(e,t,r===!1?0:4)}function xM(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return OT(e,t,0)}function gM(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var s=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Fr,""),e.l-s&2&&(e.l+=2)}return r}function vM(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Fr,"");return r}function wM(e){var t=e.l,r=Id(e,bT);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Id(e,Br);return[r,n]}function yM(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(wM(e));return r}function dy(e,t){for(var r=e.read_shift(4),n={},s=0;s!=r;++s){var a=e.read_shift(4),i=e.read_shift(4);n[a]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Fr,"").replace(Vl,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function IT(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function _M(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Id(e,t,r){var n=e.read_shift(2),s,a=r||{};if(e.l+=2,t!==cy&&n!==t&&QL.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===cy?n:t){case 2:return s=e.read_shift(2,"i"),a.raw||(e.l+=2),s;case 3:return s=e.read_shift(4,"i"),s;case 11:return e.read_shift(4)!==0;case 19:return s=e.read_shift(4),s;case 30:return RT(e,n,4).replace(Fr,"");case 31:return FT(e);case 64:return Wg(e);case 65:return IT(e);case 71:return _M(e);case 80:return Im(e,n,!a.raw).replace(Fr,"");case 81:return xM(e,n).replace(Fr,"");case 4108:return yM(e);case 4126:case 4127:return n==4127?gM(e):vM(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function hy(e,t){var r=ie(4),n=ie(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=ie(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=mM(t);break;case 31:case 80:for(n=ie(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return er([r,n])}function py(e,t){var r=e.l,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0,o=0,c=-1,u={};for(i=0;i!=s;++i){var f=e.read_shift(4),d=e.read_shift(4);a[i]=[f,d+r]}a.sort(function(w,v){return w[1]-v[1]});var h={};for(i=0;i!=s;++i){if(e.l!==a[i][1]){var p=!0;if(i>0&&t)switch(t[a[i-1][0]].t){case 2:e.l+2===a[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break;case 4108:e.l<=a[i][1]&&(e.l=a[i][1],p=!1);break}if((!t||i==0)&&e.l<=a[i][1]&&(p=!1,e.l=a[i][1]),p)throw new Error("Read Error: Expected address "+a[i][1]+" at "+e.l+" :"+i)}if(t){var g=t[a[i][0]];if(h[g.n]=Id(e,g.t,{raw:!0}),g.p==="version"&&(h[g.n]=String(h[g.n]>>16)+"."+("0000"+String(h[g.n]&65535)).slice(-4)),g.n=="CodePage")switch(h[g.n]){case 0:h[g.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:qn(o=h[g.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[g.n])}}else if(a[i][0]===1){if(o=h.CodePage=Id(e,$g),qn(o),c!==-1){var m=e.l;e.l=a[c][1],u=dy(e,o),e.l=m}}else if(a[i][0]===0){if(o===0){c=i,e.l=a[i+1][1];continue}u=dy(e,o)}else{var x=u[a[i][0]],y;switch(e[e.l]){case 65:e.l+=4,y=IT(e);break;case 30:e.l+=4,y=Im(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,y=Im(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,y=e.read_shift(4,"i");break;case 19:e.l+=4,y=e.read_shift(4);break;case 5:e.l+=4,y=e.read_shift(8,"f");break;case 11:e.l+=4,y=Ot(e,4);break;case 64:e.l+=4,y=mt(Wg(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[x]=y}}return e.l=r+n,h}var DT=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function bM(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function my(e,t,r){var n=ie(8),s=[],a=[],i=8,o=0,c=ie(8),u=ie(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),a.push(c),s.push(u),i+=8+c.length,!t){u=ie(8),u.write_shift(4,0),s.unshift(u);var f=[ie(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(c=ie(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=er(f),a.unshift(c),i+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(DT.indexOf(e[o][0])>-1||CT.indexOf(e[o][0])>-1)&&e[o][1]!=null){var h=e[o][1],p=0;if(t){p=+t[e[o][0]];var g=r[p];if(g.p=="version"&&typeof h=="string"){var m=h.split(".");h=(+m[0]<<16)+(+m[1]||0)}c=hy(g.t,h)}else{var x=bM(h);x==-1&&(x=31,h=String(h)),c=hy(x,h)}a.push(c),u=ie(8),u.write_shift(4,t?p:2+o),s.push(u),i+=8+c.length}var y=8*(a.length+1);for(o=0;o<a.length;++o)s[o].write_shift(4,y),y+=a[o].length;return n.write_shift(4,i),n.write_shift(4,a.length),er([n].concat(s).concat(a))}function xy(e,t,r){var n=e.content;if(!n)return{};lr(n,0);var s,a,i,o,c=0;n.chk("feff","Byte Order: "),n.read_shift(2);var u=n.read_shift(4),f=n.read_shift(16);if(f!==Ee.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(s=n.read_shift(4),s!==1&&s!==2)throw new Error("Unrecognized #Sets: "+s);if(a=n.read_shift(16),o=n.read_shift(4),s===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);s===2&&(i=n.read_shift(16),c=n.read_shift(4));var d=py(n,t),h={SystemIdentifier:u};for(var p in d)h[p]=d[p];if(h.FMTID=a,s===1)return h;if(c-n.l==2&&(n.l+=2),n.l!==c)throw new Error("Length mismatch 2: "+n.l+" !== "+c);var g;try{g=py(n,null)}catch{}for(p in g)h[p]=g[p];return h.FMTID=[a,i],h}function gy(e,t,r,n,s,a){var i=ie(s?68:48),o=[i];i.write_shift(2,65534),i.write_shift(2,0),i.write_shift(4,842412599),i.write_shift(16,Ee.utils.consts.HEADER_CLSID,"hex"),i.write_shift(4,s?2:1),i.write_shift(16,t,"hex"),i.write_shift(4,s?68:48);var c=my(e,r,n);if(o.push(c),s){var u=my(s,null,null);i.write_shift(16,a,"hex"),i.write_shift(4,68+c.length),o.push(u)}return er(o)}function ia(e,t){return e.read_shift(t),null}function SM(e,t){t||(t=ie(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function kM(e,t,r){for(var n=[],s=e.l+t;e.l<s;)n.push(r(e,s-e.l));if(s!==e.l)throw new Error("Slurp error");return n}function Ot(e,t){return e.read_shift(t)===1}function Pr(e,t){return t||(t=ie(2)),t.write_shift(2,+!!e),t}function $t(e){return e.read_shift(2,"u")}function bn(e,t){return t||(t=ie(2)),t.write_shift(2,e),t}function LT(e,t){return kM(e,t,$t)}function EM(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function MT(e,t,r){return r||(r=ie(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function wu(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),s="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(s="dbcs-cont")}else r.biff==12&&(s="wstr");r.biff>=2&&r.biff<=5&&(s="cpstr");var i=n?e.read_shift(n,s):"";return i}function TM(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,s=r&8,a=1+(r&1),i=0,o,c={};s&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var u=a==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,u);return s&&(e.l+=4*i),n&&(e.l+=o),c.t=f,s||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function NM(e){var t=e.t||"",r=ie(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=ie(2*t.length);n.write_shift(2*t.length,t,"utf16le");var s=[r,n];return er(s)}function Oi(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var s=e.read_shift(1);return s===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function yu(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Oi(e,n,r)}function Yi(e,t,r){if(r.biff>5)return yu(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function BT(e,t,r){return r||(r=ie(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function CM(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function AM(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var s=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Fr,"");return n&&(e.l+=24),s}function jM(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var s=e.read_shift(4);if(s===0)return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(a>>1,"utf16le").replace(Fr,"");return r+i}function PM(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return AM(e);case"0303000000000000c000000000000046":return jM(e);default:throw new Error("Unsupported Moniker "+r)}}function ff(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Fr,""):"";return r}function vy(e,t){t||(t=ie(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function RM(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var s=e.read_shift(2);e.l+=2;var a,i,o,c,u="",f,d;s&16&&(a=ff(e,r-e.l)),s&128&&(i=ff(e,r-e.l)),(s&257)===257&&(o=ff(e,r-e.l)),(s&257)===1&&(c=PM(e,r-e.l)),s&8&&(u=ff(e,r-e.l)),s&32&&(f=e.read_shift(16)),s&64&&(d=Wg(e)),e.l=r;var h=i||o||c||"";h&&u&&(h+="#"+u),h||(h="#"+u),s&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return f&&(p.guid=f),d&&(p.time=d),a&&(p.Tooltip=a),p}function FM(e){var t=ie(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var s=n.indexOf("#"),a=s>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var i=[8,6815827,6619237,4849780,83];for(r=0;r<i.length;++r)t.write_shift(4,i[r]);if(a==28)n=n.slice(1),vy(n,t);else if(a&2){for(i="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));var o=s>-1?n.slice(0,s):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&vy(s>-1?n.slice(s+1):"",t)}else{for(i="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<i.length;++r)t.write_shift(1,parseInt(i[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function UT(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),s=e.read_shift(1);return[t,r,n,s]}function $T(e,t){var r=UT(e);return r[3]=0,r}function Ns(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Ii(e,t,r,n){return n||(n=ie(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function OM(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function IM(e,t,r){return t===0?"":Yi(e,t,r)}function DM(e,t,r){var n=r.biff>8?4:2,s=e.read_shift(n),a=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[s,a,i]}function zT(e){var t=e.read_shift(2),r=Ug(e);return[t,r]}function LM(e,t,r){e.l+=4,t-=4;var n=e.l+t,s=wu(e,t,r),a=e.read_shift(2);if(n-=e.l,a!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+a);return e.l+=a,s}function j0(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);return{s:{c:n,r:t},e:{c:s,r}}}function WT(e,t){return t||(t=ie(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function VT(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),s=e.read_shift(1);return{s:{c:n,r:t},e:{c:s,r}}}var MM=VT;function HT(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function BM(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function UM(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function gr(e){e.l+=2,e.l+=e.read_shift(2)}var $M={0:gr,4:gr,5:gr,6:gr,7:UM,8:gr,9:gr,10:gr,11:gr,12:gr,13:BM,14:gr,15:gr,16:gr,17:gr,18:gr,19:gr,20:gr,21:HT};function zM(e,t){for(var r=e.l+t,n=[];e.l<r;){var s=e.read_shift(2);e.l-=2;try{n.push($M[s](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function df(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Vg(e,t,r){var n=1536,s=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,s=8;break;case"biff4":n=4,s=6;break;case"biff3":n=3,s=6;break;case"biff2":n=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=ie(s);return a.write_shift(2,n),a.write_shift(2,t),s>4&&a.write_shift(2,29282),s>6&&a.write_shift(2,1997),s>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function WM(e,t){return t===0||e.read_shift(2),1200}function VM(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,s=Yi(e,0,r);return e.read_shift(t+n-e.l),s}function HM(e,t){var r=!t||t.biff==8,n=ie(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function GM(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function qM(e,t,r){var n=e.read_shift(4),s=e.read_shift(1)&3,a=e.read_shift(1);switch(a){case 0:a="Worksheet";break;case 1:a="Macrosheet";break;case 2:a="Chartsheet";break;case 6:a="VBAModule";break}var i=wu(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:s,dt:a,name:i}}function KM(e,t){var r=!t||t.biff>=8?2:1,n=ie(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var s=n.slice(0,n.l);return s.l=n.l,s}function XM(e,t){for(var r=e.l+t,n=e.read_shift(4),s=e.read_shift(4),a=[],i=0;i!=s&&e.l<r;++i)a.push(TM(e));return a.Count=n,a.Unique=s,a}function YM(e,t){var r=ie(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],s=0;s<e.length;++s)n[s]=NM(e[s]);var a=er([r].concat(n));return a.parts=[r.length].concat(n.map(function(i){return i.length})),a}function JM(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function QM(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function ZM(e){var t=OM(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function eB(e){return e.read_shift(2),e.read_shift(4)}function wy(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var s=e.read_shift(2);r&&r.biff==2&&(n=1-(s>>15),s&=32767);var a={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[a,s]}function tB(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,r],Dim:[n,s],Flags:a,CurTab:i,FirstTab:o,Selected:c,TabRatio:u}}function rB(){var e=ie(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function nB(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function sB(e){var t=ie(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function aB(){}function iB(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=wu(e,0,r),n}function oB(e,t){var r=e.name||"Arial",n=t&&t.biff==5,s=n?15+r.length:16+2*r.length,a=ie(s);return a.write_shift(2,(e.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function lB(e){var t=Ns(e);return t.isst=e.read_shift(4),t}function cB(e,t,r,n){var s=ie(10);return Ii(e,t,n,s),s.write_shift(4,r),s}function uB(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,s=Ns(e);r.biff==2&&e.l++;var a=yu(e,n-e.l,r);return s.val=a,s}function fB(e,t,r,n,s){var a=!s||s.biff==8,i=ie(8+ +a+(1+a)*r.length);return Ii(e,t,n,i),i.write_shift(2,r.length),a&&i.write_shift(1,1),i.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),i}function dB(e,t,r){var n=e.read_shift(2),s=Yi(e,0,r);return[n,s]}function hB(e,t,r,n){var s=r&&r.biff==5;n||(n=ie(s?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(s?1:2,t.length),s||n.write_shift(1,1),n.write_shift((s?1:2)*t.length,t,s?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}var pB=Yi;function yy(e,t,r){var n=e.l+t,s=r.biff==8||!r.biff?4:2,a=e.read_shift(s),i=e.read_shift(s),o=e.read_shift(2),c=e.read_shift(2);return e.l=n,{s:{r:a,c:o},e:{r:i,c}}}function mB(e,t){var r=t.biff==8||!t.biff?4:2,n=ie(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function xB(e){var t=e.read_shift(2),r=e.read_shift(2),n=zT(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function gB(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(zT(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulRK length mismatch");return{r:n,c:s,C:i,rkrec:a}}function vB(e,t){for(var r=e.l+t-2,n=e.read_shift(2),s=e.read_shift(2),a=[];e.l<r;)a.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(a.length!=i-s+1)throw new Error("MulBlank length mismatch");return{r:n,c:s,C:i,ixfe:a}}function wB(e,t,r,n){var s={},a=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(2);return s.patternType=ZL[o>>26],n.cellStyles&&(s.alc=a&7,s.fWrap=a>>3&1,s.alcV=a>>4&7,s.fJustLast=a>>7&1,s.trot=a>>8&255,s.cIndent=a>>16&15,s.fShrinkToFit=a>>20&1,s.iReadOrder=a>>22&2,s.fAtrNum=a>>26&1,s.fAtrFnt=a>>27&1,s.fAtrAlc=a>>28&1,s.fAtrBdr=a>>29&1,s.fAtrPat=a>>30&1,s.fAtrProt=a>>31&1,s.dgLeft=i&15,s.dgRight=i>>4&15,s.dgTop=i>>8&15,s.dgBottom=i>>12&15,s.icvLeft=i>>16&127,s.icvRight=i>>23&127,s.grbitDiag=i>>30&3,s.icvTop=o&127,s.icvBottom=o>>7&127,s.icvDiag=o>>14&127,s.dgDiag=o>>21&15,s.icvFore=c&127,s.icvBack=c>>7&127,s.fsxButton=c>>14&1),s}function yB(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=wB(e,t,n.fStyle,r),n}function _y(e,t,r,n){var s=r&&r.biff==5;n||(n=ie(s?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&s&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),s||n.write_shift(4,0),n.write_shift(2,0),n}function _B(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function bB(e){var t=ie(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function by(e,t,r){var n=Ns(e);(r.biff==2||t==9)&&++e.l;var s=EM(e);return n.val=s,n.t=s===!0||s===!1?"b":"e",n}function SB(e,t,r,n,s,a){var i=ie(8);return Ii(e,t,n,i),MT(r,a,i),i}function kB(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ns(e),s=br(e);return n.val=s,n}function EB(e,t,r,n){var s=ie(14);return Ii(e,t,n,s),Fi(r,s),s}var Sy=IM;function TB(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(2);if(r.sbcch=a,a==1025||a==14849)return[a,s];if(a<1||a>255)throw new Error("Unexpected SupBook type: "+a);for(var i=Oi(e,a),o=[];n>e.l;)o.push(yu(e));return[a,s,i,o]}function ky(e,t,r){var n=e.read_shift(2),s,a={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(s=LM(e,t-2,r)),a.body=s||e.read_shift(t-2),typeof s=="string"&&(a.Name=s),a}var NB=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Ey(e,t,r){var n=e.l+t,s=e.read_shift(2),a=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),c=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),c=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var u=Oi(e,i,r);s&32&&(u=NB[u.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:z$(e,f,r,o);return{chKey:a,Name:u,itab:c,rgce:d}}function GT(e,t,r){if(r.biff<8)return CB(e,t,r);for(var n=[],s=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(DM(e,r.biff>8?12:6,r));if(e.l!=s)throw new Error("Bad ExternSheet: "+e.l+" != "+s);return n}function CB(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=wu(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function AB(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),s=e.read_shift(2),a=Oi(e,n,r),i=Oi(e,s,r);return[a,i]}function jB(e,t,r){var n=VT(e);e.l++;var s=e.read_shift(1);return t-=8,[W$(e,t,r),s,n]}function Ty(e,t,r){var n=MM(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,U$(e,t,r)]}function PB(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function RB(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),o=Yi(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:s},o,i,a]}}function FB(e,t,r){return RB(e,t,r)}function OB(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(j0(e));return r}function IB(e){var t=ie(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)WT(e[r],t);return t}function DB(e,t,r){if(r&&r.biff<8)return MB(e,t,r);var n=HT(e),s=zM(e,t-22,n[1]);return{cmo:n,ft:s}}var LB={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var s=e.read_shift(1);return e.l+=s,e.l=r,{fmt:n}}};function MB(e,t,r){e.l+=4;var n=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((LB[n]||Er)(e,t,r)),{cmo:[s,n,a],ft:i}}function BB(e,t,r){var n=e.l,s="";try{e.l+=4;var a=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(a)==-1?e.l+=6:i=CM(e,6,r);var o=e.read_shift(2);e.read_shift(2),$t(e,2);var c=e.read_shift(2);e.l+=c;for(var u=1;u<e.lens.length-1;++u){if(e.l-n!=e.lens[u])throw new Error("TxO: bad continue record");var f=e[e.l],d=Oi(e,e.lens[u+1]-e.lens[u]-1);if(s+=d,s.length>=(f?o:2*o))break}if(s.length!==o&&s.length!==o*2)throw new Error("cchText: "+o+" != "+s.length);return e.l=n+t,{t:s}}catch{return e.l=n+t,{t:s}}}function UB(e,t){var r=j0(e);e.l+=16;var n=RM(e,t-24);return[r,n]}function $B(e){var t=ie(24),r=St(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)t.write_shift(1,parseInt(n[s],16));return er([t,FM(e[1])])}function zB(e,t){e.read_shift(2);var r=j0(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Fr,""),[r,n]}function WB(e){var t=e[1].Tooltip,r=ie(10+2*(t.length+1));r.write_shift(2,2048);var n=St(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var s=0;s<t.length;++s)r.write_shift(2,t.charCodeAt(s));return r.write_shift(2,0),r}function VB(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=uy[r]||r,r=e.read_shift(2),t[1]=uy[r]||r,t}function HB(e){return e||(e=ie(4)),e.write_shift(2,1),e.write_shift(2,1),e}function GB(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push($T(e));return r}function qB(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push($T(e));return r}function KB(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function qT(e,t,r){if(!r.cellStyles)return Er(e,t);var n=r&&r.biff>=12?4:2,s=e.read_shift(n),a=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s,e:a,w:i,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function XB(e,t){var r=ie(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function YB(e,t){var r={};return t<32||(e.l+=16,r.header=br(e),r.footer=br(e),e.l+=2),r}function JB(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var s=e.read_shift(1);return e.l+=3,s&16&&(n.area=!0),n}function QB(e){for(var t=ie(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var ZB=Ns,e7=LT,t7=yu;function r7(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,s}function n7(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ns(e);++e.l;var s=Yi(e,t-7,r);return n.t="str",n.val=s,n}function s7(e){var t=Ns(e);++e.l;var r=br(e);return t.t="n",t.val=r,t}function a7(e,t,r){var n=ie(15);return ku(n,e,t),n.write_shift(8,r,"f"),n}function i7(e){var t=Ns(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function o7(e,t,r){var n=ie(9);return ku(n,e,t),n.write_shift(2,r),n}function l7(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function c7(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function u7(e,t,r){var n=e.l+t,s=Ns(e),a=e.read_shift(2),i=Oi(e,a,r);return e.l=n,s.t="str",s.val=i,s}var f7=[2,3,48,49,131,139,140,245],Dm=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=N0({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],f=Da(1);switch(c.type){case"base64":f=nn(dn(o));break;case"binary":f=nn(o);break;case"buffer":case"array":f=o;break}lr(f,0);var d=f.read_shift(1),h=!!(d&136),p=!1,g=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:g=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,x=521;d==2&&(m=f.read_shift(2)),f.l+=3,d!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(x=f.read_shift(2));var y=f.read_shift(2),w=c.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=e[f[f.l]]),f.l+=1,f.l+=2),g&&(f.l+=36);for(var v=[],S={},E=Math.min(f.length,d==2?521:x-10-(p?264:0)),k=g?32:11;f.l<E&&f[f.l]!=13;)switch(S={},S.name=ma.utils.decode(w,f.slice(f.l,f.l+k)).replace(/[\u0000\r\n].*$/g,""),f.l+=k,S.type=String.fromCharCode(f.read_shift(1)),d!=2&&!g&&(S.offset=f.read_shift(4)),S.len=f.read_shift(1),d==2&&(S.offset=f.read_shift(2)),S.dec=f.read_shift(1),S.name.length&&v.push(S),d!=2&&(f.l+=g?13:14),S.type){case"B":(!p||S.len!=8)&&c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+S.name+":"+S.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+S.type)}if(f[f.l]!==13&&(f.l=x-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=x;var b=0,N=0;for(u[0]=[],N=0;N!=v.length;++N)u[0][N]=v[N].name;for(;m-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,u[++b]=[],N=0,N=0;N!=v.length;++N){var A=f.slice(f.l,f.l+v[N].len);f.l+=v[N].len,lr(A,0);var O=ma.utils.decode(w,A);switch(v[N].type){case"C":O.trim().length&&(u[b][N]=O.replace(/\s+$/,""));break;case"D":O.length===8?u[b][N]=new Date(+O.slice(0,4),+O.slice(4,6)-1,+O.slice(6,8)):u[b][N]=O;break;case"F":u[b][N]=parseFloat(O.trim());break;case"+":case"I":u[b][N]=g?A.read_shift(-4,"i")^2147483648:A.read_shift(4,"i");break;case"L":switch(O.trim().toUpperCase()){case"Y":case"T":u[b][N]=!0;break;case"N":case"F":u[b][N]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+O+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[b][N]="##MEMO##"+(g?parseInt(O.trim(),10):A.read_shift(4));break;case"N":O=O.replace(/\u0000/g,"").trim(),O&&O!="."&&(u[b][N]=+O||0);break;case"@":u[b][N]=new Date(A.read_shift(-8,"f")-621356832e5);break;case"T":u[b][N]=new Date((A.read_shift(4)-2440588)*864e5+A.read_shift(4));break;case"Y":u[b][N]=A.read_shift(4,"i")/1e4+A.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[b][N]=-A.read_shift(-8,"f");break;case"B":if(p&&v[N].len==8){u[b][N]=A.read_shift(8,"f");break}case"G":case"P":A.l+=v[N].len;break;case"0":if(v[N].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+v[N].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=v,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var f=gl(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function s(o,c){try{return Xa(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,c){var u=c||{};if(+u.codepage>=0&&qn(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Gr(),d=Md(o,{header:1,raw:!0,cellDates:!0}),h=d[0],p=d.slice(1),g=o["!cols"]||[],m=0,x=0,y=0,w=1;for(m=0;m<h.length;++m){if(((g[m]||{}).DBF||{}).name){h[m]=g[m].DBF.name,++y;continue}if(h[m]!=null){if(++y,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(x=0;x<1024;++x)if(h.indexOf(h[m]+"_"+x)==-1){h[m]+="_"+x;break}}}}var v=Ze(o["!ref"]),S=[],E=[],k=[];for(m=0;m<=v.e.c-v.s.c;++m){var b="",N="",A=0,O=[];for(x=0;x<p.length;++x)p[x][m]!=null&&O.push(p[x][m]);if(O.length==0||h[m]==null){S[m]="?";continue}for(x=0;x<O.length;++x){switch(typeof O[x]){case"number":N="B";break;case"string":N="C";break;case"boolean":N="L";break;case"object":N=O[x]instanceof Date?"D":"C";break;default:N="C"}A=Math.max(A,String(O[x]).length),b=b&&b!=N?"C":N}A>250&&(A=250),N=((g[m]||{}).DBF||{}).type,N=="C"&&g[m].DBF.len>A&&(A=g[m].DBF.len),b=="B"&&N=="N"&&(b="N",k[m]=g[m].DBF.dec,A=g[m].DBF.len),E[m]=b=="C"||N=="N"?A:a[b]||0,w+=E[m],S[m]=b}var V=f.next(32);for(V.write_shift(4,318902576),V.write_shift(4,p.length),V.write_shift(2,296+32*y),V.write_shift(2,w),m=0;m<4;++m)V.write_shift(4,0);for(V.write_shift(4,0|(+t[DE]||3)<<8),m=0,x=0;m<h.length;++m)if(h[m]!=null){var C=f.next(32),B=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,B,"sbcs"),C.write_shift(1,S[m]=="?"?"C":S[m],"sbcs"),C.write_shift(4,x),C.write_shift(1,E[m]||a[S[m]]||0),C.write_shift(1,k[m]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),x+=E[m]||a[S[m]]||0}var G=f.next(264);for(G.write_shift(4,13),m=0;m<65;++m)G.write_shift(4,0);for(m=0;m<p.length;++m){var X=f.next(w);for(X.write_shift(1,0),x=0;x<h.length;++x)if(h[x]!=null)switch(S[x]){case"L":X.write_shift(1,p[m][x]==null?63:p[m][x]?84:70);break;case"B":X.write_shift(8,p[m][x]||0,"f");break;case"N":var z="0";for(typeof p[m][x]=="number"&&(z=p[m][x].toFixed(k[x]||0)),y=0;y<E[x]-z.length;++y)X.write_shift(1,32);X.write_shift(1,z,"sbcs");break;case"D":p[m][x]?(X.write_shift(4,("0000"+p[m][x].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(p[m][x].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+p[m][x].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var q=String(p[m][x]!=null?p[m][x]:"").slice(0,E[x]);for(X.write_shift(1,q,"sbcs"),y=0;y<E[x]-q.length;++y)X.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:s,to_sheet:n,from_sheet:i}}(),KT=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Pt(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var g=e[p];return typeof g=="number"?Lw(g):g},n=function(h,p,g){var m=p.charCodeAt(0)-32<<4|g.charCodeAt(0)-48;return m==59?h:Lw(m)};e["|"]=254;function s(h,p){switch(p.type){case"base64":return a(dn(h),p);case"binary":return a(h,p);case"buffer":return a(Ge&&Buffer.isBuffer(h)?h.toString("binary"):Ka(h),p);case"array":return a(Ri(h),p)}throw new Error("Unrecognized type "+p.type)}function a(h,p){var g=h.split(/[\n\r]+/),m=-1,x=-1,y=0,w=0,v=[],S=[],E=null,k={},b=[],N=[],A=[],O=0,V;for(+p.codepage>=0&&qn(+p.codepage);y!==g.length;++y){O=0;var C=g[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),B=C.replace(/;;/g,"\0").split(";").map(function(W){return W.replace(/\u0000/g,";")}),G=B[0],X;if(C.length>0)switch(G){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":B[1].charAt(0)=="P"&&S.push(C.slice(3).replace(/;;/g,";"));break;case"C":var z=!1,q=!1,K=!1,F=!1,ne=-1,Y=-1;for(w=1;w<B.length;++w)switch(B[w].charAt(0)){case"A":break;case"X":x=parseInt(B[w].slice(1))-1,q=!0;break;case"Y":for(m=parseInt(B[w].slice(1))-1,q||(x=0),V=v.length;V<=m;++V)v[V]=[];break;case"K":X=B[w].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(Qn(X))?isNaN(el(X).getDate())||(X=mt(X)):(X=Qn(X),E!==null&&ml(E)&&(X=A0(X))),z=!0;break;case"E":F=!0;var j=$o(B[w].slice(1),{r:m,c:x});v[m][x]=[v[m][x],j];break;case"S":K=!0,v[m][x]=[v[m][x],"S5S"];break;case"G":break;case"R":ne=parseInt(B[w].slice(1))-1;break;case"C":Y=parseInt(B[w].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}if(z&&(v[m][x]&&v[m][x].length==2?v[m][x][0]=X:v[m][x]=X,E=null),K){if(F)throw new Error("SYLK shared formula cannot have own formula");var H=ne>-1&&v[ne][Y];if(!H||!H[1])throw new Error("SYLK shared formula cannot find base");v[m][x][1]=dN(H[1],{r:m-ne,c:x-Y})}break;case"F":var U=0;for(w=1;w<B.length;++w)switch(B[w].charAt(0)){case"X":x=parseInt(B[w].slice(1))-1,++U;break;case"Y":for(m=parseInt(B[w].slice(1))-1,V=v.length;V<=m;++V)v[V]=[];break;case"M":O=parseInt(B[w].slice(1))/20;break;case"F":break;case"G":break;case"P":E=S[parseInt(B[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(A=B[w].slice(1).split(" "),V=parseInt(A[0],10);V<=parseInt(A[1],10);++V)O=parseInt(A[2],10),N[V-1]=O===0?{hidden:!0}:{wch:O},La(N[V-1]);break;case"C":x=parseInt(B[w].slice(1))-1,N[x]||(N[x]={});break;case"R":m=parseInt(B[w].slice(1))-1,b[m]||(b[m]={}),O>0?(b[m].hpt=O,b[m].hpx=rl(O)):O===0&&(b[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}U<1&&(E=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+C)}}return b.length>0&&(k["!rows"]=b),N.length>0&&(k["!cols"]=N),p&&p.sheetRows&&(v=v.slice(0,p.sheetRows)),[v,k]}function i(h,p){var g=s(h,p),m=g[0],x=g[1],y=gl(m,p);return Pt(x).forEach(function(w){y[w]=x[w]}),y}function o(h,p){return Xa(i(h,p),p)}function c(h,p,g,m){var x="C;Y"+(g+1)+";X"+(m+1)+";K";switch(h.t){case"n":x+=h.v||0,h.f&&!h.F&&(x+=";E"+Yg(h.f,{r:g,c:m}));break;case"b":x+=h.v?"TRUE":"FALSE";break;case"e":x+=h.w||h.v;break;case"d":x+='"'+(h.w||h.v)+'"';break;case"s":x+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return x}function u(h,p){p.forEach(function(g,m){var x="F;W"+(m+1)+" "+(m+1)+" ";g.hidden?x+="0":(typeof g.width=="number"&&!g.wpx&&(g.wpx=Xc(g.width)),typeof g.wpx=="number"&&!g.wch&&(g.wch=Yc(g.wpx)),typeof g.wch=="number"&&(x+=Math.round(g.wch))),x.charAt(x.length-1)!=" "&&h.push(x)})}function f(h,p){p.forEach(function(g,m){var x="F;";g.hidden?x+="M0;":g.hpt?x+="M"+20*g.hpt+";":g.hpx&&(x+="M"+20*Jc(g.hpx)+";"),x.length>2&&h.push(x+"R"+(m+1))})}function d(h,p){var g=["ID;PWXL;N;E"],m=[],x=Ze(h["!ref"]),y,w=Array.isArray(h),v=`\r
`;g.push("P;PGeneral"),g.push("F;P0;DG0G8;M255"),h["!cols"]&&u(g,h["!cols"]),h["!rows"]&&f(g,h["!rows"]),g.push("B;Y"+(x.e.r-x.s.r+1)+";X"+(x.e.c-x.s.c+1)+";D"+[x.s.c,x.s.r,x.e.c,x.e.r].join(" "));for(var S=x.s.r;S<=x.e.r;++S)for(var E=x.s.c;E<=x.e.c;++E){var k=je({r:S,c:E});y=w?(h[S]||[])[E]:h[k],!(!y||y.v==null&&(!y.f||y.F))&&m.push(c(y,h,S,E))}return g.join(v)+v+m.join(v)+v+"E"+v}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),XT=function(){function e(a,i){switch(i.type){case"base64":return t(dn(a),i);case"binary":return t(a,i);case"buffer":return t(Ge&&Buffer.isBuffer(a)?a.toString("binary"):Ka(a),i);case"array":return t(Ri(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){for(var o=a.split(`
`),c=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++c]=[],u=0;continue}if(!(c<0)){var h=o[f].trim().split(","),p=h[0],g=h[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+p){case-1:if(m==="BOT"){d[++c]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[c][u]=!0:m==="FALSE"?d[c][u]=!1:isNaN(Qn(g))?isNaN(el(g).getDate())?d[c][u]=g:d[c][u]=mt(g):d[c][u]=Qn(g),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[c][u++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(a,i){return gl(e(a,i),i)}function n(a,i){return Xa(r(a,i),i)}var s=function(){var a=function(c,u,f,d,h){c.push(u),c.push(f+","+d),c.push('"'+h.replace(/"/g,'""')+'"')},i=function(c,u,f,d){c.push(u+","+f),c.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var u=[],f=Ze(c["!ref"]),d,h=Array.isArray(c);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,f.e.r-f.s.r+1,""),a(u,"TUPLES",0,f.e.c-f.s.c+1,""),a(u,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){i(u,-1,0,"BOT");for(var g=f.s.c;g<=f.e.c;++g){var m=je({r:p,c:g});if(d=h?(c[p]||[])[g]:c[m],!d){i(u,1,0,"");continue}switch(d.t){case"n":var x=d.w;!x&&d.v!=null&&(x=d.v),x==null?d.f&&!d.F?i(u,1,0,"="+d.f):i(u,1,0,""):i(u,0,x,"V");break;case"b":i(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Rn(d.z||Ae[14],Yt(mt(d.v)))),i(u,0,d.w,"V");break;default:i(u,1,0,"")}}}i(u,-1,0,"EOD");var y=`\r
`,w=u.join(y);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:s}}(),YT=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var p=d.split(`
`),g=-1,m=-1,x=0,y=[];x!==p.length;++x){var w=p[x].trim().split(":");if(w[0]==="cell"){var v=St(w[1]);if(y.length<=v.r)for(g=y.length;g<=v.r;++g)y[g]||(y[g]=[]);switch(g=v.r,m=v.c,w[2]){case"t":y[g][m]=e(w[3]);break;case"v":y[g][m]=+w[3];break;case"vtf":var S=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[g][m]=!!+w[4];break;default:y[g][m]=+w[4];break}w[2]=="vtf"&&(y[g][m]=[y[g][m],S])}}}return h&&h.sheetRows&&(y=y.slice(0,h.sheetRows)),y}function n(d,h){return gl(r(d,h),h)}function s(d,h){return Xa(n(d,h),h)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var h=[],p=[],g,m="",x=qr(d["!ref"]),y=Array.isArray(d),w=x.s.r;w<=x.e.r;++w)for(var v=x.s.c;v<=x.e.c;++v)if(m=je({r:w,c:v}),g=y?(d[w]||[])[v]:d[m],!(!g||g.v==null||g.t==="z")){switch(p=["cell",m,"t"],g.t){case"s":case"str":p.push(t(g.v));break;case"n":g.f?(p[2]="vtf",p[3]="n",p[4]=g.v,p[5]=t(g.f)):(p[2]="v",p[3]=g.v);break;case"b":p[2]="vt"+(g.f?"f":"c"),p[3]="nl",p[4]=g.v?"1":"0",p[5]=t(g.f||(g.v?"TRUE":"FALSE"));break;case"d":var S=Yt(mt(g.v));p[2]="vtc",p[3]="nd",p[4]=""+S,p[5]=g.w||Rn(g.z||Ae[14],S);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(x.e.c-x.s.c+1)+":r:"+(x.e.r-x.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[a,i,o,i,u(d),c].join(`
`)}return{to_workbook:s,to_sheet:n,from_sheet:f}}(),tl=function(){function e(f,d,h,p,g){g.raw?d[h][p]=f:f===""||(f==="TRUE"?d[h][p]=!0:f==="FALSE"?d[h][p]=!1:isNaN(Qn(f))?isNaN(el(f).getDate())?d[h][p]=f:d[h][p]=mt(f):d[h][p]=Qn(f))}function t(f,d){var h=d||{},p=[];if(!f||f.length===0)return p;for(var g=f.split(/[\r\n]/),m=g.length-1;m>=0&&g[m].length===0;)--m;for(var x=10,y=0,w=0;w<=m;++w)y=g[w].indexOf(" "),y==-1?y=g[w].length:y++,x=Math.max(x,y);for(w=0;w<=m;++w){p[w]=[];var v=0;for(e(g[w].slice(0,x).trim(),p,w,v,h),v=1;v<=(g[w].length-x)/10+1;++v)e(g[w].slice(x+(v-1)*10,x+v*10).trim(),p,w,v,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function s(f){for(var d={},h=!1,p=0,g=0;p<f.length;++p)(g=f.charCodeAt(p))==34?h=!h:!h&&g in r&&(d[g]=(d[g]||0)+1);g=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&g.push([d[p],p]);if(!g.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&g.push([d[p],p])}return g.sort(function(m,x){return m[0]-x[0]||n[m[1]]-n[x[1]]}),r[g.pop()[1]]||44}function a(f,d){var h=d||{},p="",g=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=s(f.slice(0,1024)):h&&h.FS?p=h.FS:p=s(f.slice(0,1024));var x=0,y=0,w=0,v=0,S=0,E=p.charCodeAt(0),k=!1,b=0,N=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var A=h.dateNF!=null?J6(h.dateNF):null;function O(){var V=f.slice(v,S),C={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)C.t="z";else if(h.raw)C.t="s",C.v=V;else if(V.trim().length===0)C.t="s",C.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(C.t="s",C.v=V.slice(2,-1).replace(/""/g,'"')):TU(V)?(C.t="n",C.f=V.slice(1)):(C.t="s",C.v=V);else if(V=="TRUE")C.t="b",C.v=!0;else if(V=="FALSE")C.t="b",C.v=!1;else if(!isNaN(w=Qn(V)))C.t="n",h.cellText!==!1&&(C.w=V),C.v=w;else if(!isNaN(el(V).getDate())||A&&V.match(A)){C.z=h.dateNF||Ae[14];var B=0;A&&V.match(A)&&(V=Q6(V,h.dateNF,V.match(A)||[]),B=1),h.cellDates?(C.t="d",C.v=mt(V,B)):(C.t="n",C.v=Yt(mt(V,B))),h.cellText!==!1&&(C.w=Rn(C.z,C.v instanceof Date?Yt(C.v):C.v)),h.cellNF||delete C.z}else C.t="s",C.v=V;if(C.t=="z"||(h.dense?(g[x]||(g[x]=[]),g[x][y]=C):g[je({c:y,r:x})]=C),v=S+1,N=f.charCodeAt(v),m.e.c<y&&(m.e.c=y),m.e.r<x&&(m.e.r=x),b==E)++y;else if(y=0,++x,h.sheetRows&&h.sheetRows<=x)return!0}e:for(;S<f.length;++S)switch(b=f.charCodeAt(S)){case 34:N===34&&(k=!k);break;case E:case 10:case 13:if(!k&&O())break e;break}return S-v>0&&O(),g["!ref"]=$e(m),g}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,d):gl(t(f,d),d)}function o(f,d){var h="",p=d.type=="string"?[0,0,0,0]:sv(f,d);switch(d.type){case"base64":h=dn(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):d.codepage&&typeof ma<"u"?h=ma.utils.decode(d.codepage,f):h=Ge&&Buffer.isBuffer(f)?f.toString("binary"):Ka(f);break;case"array":h=Ri(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=ot(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=ot(h):d.type=="binary"&&typeof ma<"u"&&d.codepage&&(h=ma.utils.decode(d.codepage,ma.utils.encode(28591,h))),h.slice(0,19)=="socialcalc:version:"?YT.to_sheet(d.type=="string"?h:ot(h),d):i(h,d)}function c(f,d){return Xa(o(f,d),d)}function u(f){for(var d=[],h=Ze(f["!ref"]),p,g=Array.isArray(f),m=h.s.r;m<=h.e.r;++m){for(var x=[],y=h.s.c;y<=h.e.c;++y){var w=je({r:m,c:y});if(p=g?(f[m]||[])[y]:f[w],!p||p.v==null){x.push("          ");continue}for(var v=(p.w||(Xs(p),p.w)||"").slice(0,10);v.length<10;)v+=" ";x.push(v+(y===0?" ":""))}d.push(x.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}();function d7(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var s=KT.to_workbook(e,r);return r.WTF=n,s}catch(a){if(r.WTF=n,!a.message.match(/SYLK bad record ID/)&&n)throw a;return tl.to_workbook(e,t)}}var wi=function(){function e(j,H,U){if(j){lr(j,j.l||0);for(var W=U.Enum||ne;j.l<j.length;){var J=j.read_shift(2),te=W[J]||W[65535],oe=j.read_shift(2),ae=j.l+oe,se=te.f&&te.f(j,oe,U);if(j.l=ae,H(se,te,J))return}}}function t(j,H){switch(H.type){case"base64":return r(nn(dn(j)),H);case"binary":return r(nn(j),H);case"buffer":case"array":return r(j,H)}throw"Unsupported type "+H.type}function r(j,H){if(!j)return j;var U=H||{},W=U.dense?[]:{},J="Sheet1",te="",oe=0,ae={},se=[],de=[],I={s:{r:0,c:0},e:{r:0,c:0}},Be=U.sheetRows||0;if(j[2]==0&&(j[3]==8||j[3]==9)&&j.length>=16&&j[14]==5&&j[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(j[2]==2)U.Enum=ne,e(j,function(xe,it,Rt){switch(Rt){case 0:U.vers=xe,xe>=4096&&(U.qpro=!0);break;case 6:I=xe;break;case 204:xe&&(te=xe);break;case 222:te=xe;break;case 15:case 51:U.qpro||(xe[1].v=xe[1].v.slice(1));case 13:case 14:case 16:Rt==14&&(xe[2]&112)==112&&(xe[2]&15)>1&&(xe[2]&15)<15&&(xe[1].z=U.dateNF||Ae[14],U.cellDates&&(xe[1].t="d",xe[1].v=A0(xe[1].v))),U.qpro&&xe[3]>oe&&(W["!ref"]=$e(I),ae[J]=W,se.push(J),W=U.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},oe=xe[3],J=te||"Sheet"+(oe+1),te="");var Yr=U.dense?(W[xe[0].r]||[])[xe[0].c]:W[je(xe[0])];if(Yr){Yr.t=xe[1].t,Yr.v=xe[1].v,xe[1].z!=null&&(Yr.z=xe[1].z),xe[1].f!=null&&(Yr.f=xe[1].f);break}U.dense?(W[xe[0].r]||(W[xe[0].r]=[]),W[xe[0].r][xe[0].c]=xe[1]):W[je(xe[0])]=xe[1];break}},U);else if(j[2]==26||j[2]==14)U.Enum=Y,j[2]==14&&(U.qpro=!0,j.l=0),e(j,function(xe,it,Rt){switch(Rt){case 204:J=xe;break;case 22:xe[1].v=xe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(xe[3]>oe&&(W["!ref"]=$e(I),ae[J]=W,se.push(J),W=U.dense?[]:{},I={s:{r:0,c:0},e:{r:0,c:0}},oe=xe[3],J="Sheet"+(oe+1)),Be>0&&xe[0].r>=Be)break;U.dense?(W[xe[0].r]||(W[xe[0].r]=[]),W[xe[0].r][xe[0].c]=xe[1]):W[je(xe[0])]=xe[1],I.e.c<xe[0].c&&(I.e.c=xe[0].c),I.e.r<xe[0].r&&(I.e.r=xe[0].r);break;case 27:xe[14e3]&&(de[xe[14e3][0]]=xe[14e3][1]);break;case 1537:de[xe[0]]=xe[1],xe[0]==oe&&(J=xe[1]);break}},U);else throw new Error("Unrecognized LOTUS BOF "+j[2]);if(W["!ref"]=$e(I),ae[te||J]=W,se.push(te||J),!de.length)return{SheetNames:se,Sheets:ae};for(var Re={},Ve=[],Oe=0;Oe<de.length;++Oe)ae[se[Oe]]?(Ve.push(de[Oe]||se[Oe]),Re[de[Oe]]=ae[de[Oe]]||ae[se[Oe]]):(Ve.push(de[Oe]),Re[de[Oe]]={"!ref":"A1"});return{SheetNames:Ve,Sheets:Re}}function n(j,H){var U=H||{};if(+U.codepage>=0&&qn(+U.codepage),U.type=="string")throw new Error("Cannot write WK1 to JS string");var W=Gr(),J=Ze(j["!ref"]),te=Array.isArray(j),oe=[];we(W,0,a(1030)),we(W,6,c(J));for(var ae=Math.min(J.e.r,8191),se=J.s.r;se<=ae;++se)for(var de=Dt(se),I=J.s.c;I<=J.e.c;++I){se===J.s.r&&(oe[I]=bt(I));var Be=oe[I]+de,Re=te?(j[se]||[])[I]:j[Be];if(!(!Re||Re.t=="z"))if(Re.t=="n")(Re.v|0)==Re.v&&Re.v>=-32768&&Re.v<=32767?we(W,13,p(se,I,Re.v)):we(W,14,m(se,I,Re.v));else{var Ve=Xs(Re);we(W,15,d(se,I,Ve.slice(0,239)))}}return we(W,1),W.end()}function s(j,H){var U=H||{};if(+U.codepage>=0&&qn(+U.codepage),U.type=="string")throw new Error("Cannot write WK3 to JS string");var W=Gr();we(W,0,i(j));for(var J=0,te=0;J<j.SheetNames.length;++J)(j.Sheets[j.SheetNames[J]]||{})["!ref"]&&we(W,27,F(j.SheetNames[J],te++));var oe=0;for(J=0;J<j.SheetNames.length;++J){var ae=j.Sheets[j.SheetNames[J]];if(!(!ae||!ae["!ref"])){for(var se=Ze(ae["!ref"]),de=Array.isArray(ae),I=[],Be=Math.min(se.e.r,8191),Re=se.s.r;Re<=Be;++Re)for(var Ve=Dt(Re),Oe=se.s.c;Oe<=se.e.c;++Oe){Re===se.s.r&&(I[Oe]=bt(Oe));var xe=I[Oe]+Ve,it=de?(ae[Re]||[])[Oe]:ae[xe];if(!(!it||it.t=="z"))if(it.t=="n")we(W,23,O(Re,Oe,oe,it.v));else{var Rt=Xs(it);we(W,22,b(Re,Oe,oe,Rt.slice(0,239)))}}++oe}}return we(W,1),W.end()}function a(j){var H=ie(2);return H.write_shift(2,j),H}function i(j){var H=ie(26);H.write_shift(2,4096),H.write_shift(2,4),H.write_shift(4,0);for(var U=0,W=0,J=0,te=0;te<j.SheetNames.length;++te){var oe=j.SheetNames[te],ae=j.Sheets[oe];if(!(!ae||!ae["!ref"])){++J;var se=qr(ae["!ref"]);U<se.e.r&&(U=se.e.r),W<se.e.c&&(W=se.e.c)}}return U>8191&&(U=8191),H.write_shift(2,U),H.write_shift(1,J),H.write_shift(1,W),H.write_shift(2,0),H.write_shift(2,0),H.write_shift(1,1),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(4,0),H}function o(j,H,U){var W={s:{c:0,r:0},e:{c:0,r:0}};return H==8&&U.qpro?(W.s.c=j.read_shift(1),j.l++,W.s.r=j.read_shift(2),W.e.c=j.read_shift(1),j.l++,W.e.r=j.read_shift(2),W):(W.s.c=j.read_shift(2),W.s.r=j.read_shift(2),H==12&&U.qpro&&(j.l+=2),W.e.c=j.read_shift(2),W.e.r=j.read_shift(2),H==12&&U.qpro&&(j.l+=2),W.s.c==65535&&(W.s.c=W.e.c=W.s.r=W.e.r=0),W)}function c(j){var H=ie(8);return H.write_shift(2,j.s.c),H.write_shift(2,j.s.r),H.write_shift(2,j.e.c),H.write_shift(2,j.e.r),H}function u(j,H,U){var W=[{c:0,r:0},{t:"n",v:0},0,0];return U.qpro&&U.vers!=20768?(W[0].c=j.read_shift(1),W[3]=j.read_shift(1),W[0].r=j.read_shift(2),j.l+=2):(W[2]=j.read_shift(1),W[0].c=j.read_shift(2),W[0].r=j.read_shift(2)),W}function f(j,H,U){var W=j.l+H,J=u(j,H,U);if(J[1].t="s",U.vers==20768){j.l++;var te=j.read_shift(1);return J[1].v=j.read_shift(te,"utf8"),J}return U.qpro&&j.l++,J[1].v=j.read_shift(W-j.l,"cstr"),J}function d(j,H,U){var W=ie(7+U.length);W.write_shift(1,255),W.write_shift(2,H),W.write_shift(2,j),W.write_shift(1,39);for(var J=0;J<W.length;++J){var te=U.charCodeAt(J);W.write_shift(1,te>=128?95:te)}return W.write_shift(1,0),W}function h(j,H,U){var W=u(j,H,U);return W[1].v=j.read_shift(2,"i"),W}function p(j,H,U){var W=ie(7);return W.write_shift(1,255),W.write_shift(2,H),W.write_shift(2,j),W.write_shift(2,U,"i"),W}function g(j,H,U){var W=u(j,H,U);return W[1].v=j.read_shift(8,"f"),W}function m(j,H,U){var W=ie(13);return W.write_shift(1,255),W.write_shift(2,H),W.write_shift(2,j),W.write_shift(8,U,"f"),W}function x(j,H,U){var W=j.l+H,J=u(j,H,U);if(J[1].v=j.read_shift(8,"f"),U.qpro)j.l=W;else{var te=j.read_shift(2);S(j.slice(j.l,j.l+te),J),j.l+=te}return J}function y(j,H,U){var W=H&32768;return H&=-32769,H=(W?j:0)+(H>=8192?H-16384:H),(W?"":"$")+(U?bt(H):Dt(H))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},v=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function S(j,H){lr(j,0);for(var U=[],W=0,J="",te="",oe="",ae="";j.l<j.length;){var se=j[j.l++];switch(se){case 0:U.push(j.read_shift(8,"f"));break;case 1:te=y(H[0].c,j.read_shift(2),!0),J=y(H[0].r,j.read_shift(2),!1),U.push(te+J);break;case 2:{var de=y(H[0].c,j.read_shift(2),!0),I=y(H[0].r,j.read_shift(2),!1);te=y(H[0].c,j.read_shift(2),!0),J=y(H[0].r,j.read_shift(2),!1),U.push(de+I+":"+te+J)}break;case 3:if(j.l<j.length){console.error("WK1 premature formula end");return}break;case 4:U.push("("+U.pop()+")");break;case 5:U.push(j.read_shift(2));break;case 6:{for(var Be="";se=j[j.l++];)Be+=String.fromCharCode(se);U.push('"'+Be.replace(/"/g,'""')+'"')}break;case 8:U.push("-"+U.pop());break;case 23:U.push("+"+U.pop());break;case 22:U.push("NOT("+U.pop()+")");break;case 20:case 21:ae=U.pop(),oe=U.pop(),U.push(["AND","OR"][se-20]+"("+oe+","+ae+")");break;default:if(se<32&&v[se])ae=U.pop(),oe=U.pop(),U.push(oe+v[se]+ae);else if(w[se]){if(W=w[se][1],W==69&&(W=j[j.l++]),W>U.length){console.error("WK1 bad formula parse 0x"+se.toString(16)+":|"+U.join("|")+"|");return}var Re=U.slice(-W);U.length-=W,U.push(w[se][0]+"("+Re.join(",")+")")}else return se<=7?console.error("WK1 invalid opcode "+se.toString(16)):se<=24?console.error("WK1 unsupported op "+se.toString(16)):se<=30?console.error("WK1 invalid opcode "+se.toString(16)):se<=115?console.error("WK1 unsupported function opcode "+se.toString(16)):console.error("WK1 unrecognized opcode "+se.toString(16))}}U.length==1?H[1].f=""+U[0]:console.error("WK1 bad formula parse |"+U.join("|")+"|")}function E(j){var H=[{c:0,r:0},{t:"n",v:0},0];return H[0].r=j.read_shift(2),H[3]=j[j.l++],H[0].c=j[j.l++],H}function k(j,H){var U=E(j);return U[1].t="s",U[1].v=j.read_shift(H-4,"cstr"),U}function b(j,H,U,W){var J=ie(6+W.length);J.write_shift(2,j),J.write_shift(1,U),J.write_shift(1,H),J.write_shift(1,39);for(var te=0;te<W.length;++te){var oe=W.charCodeAt(te);J.write_shift(1,oe>=128?95:oe)}return J.write_shift(1,0),J}function N(j,H){var U=E(j);U[1].v=j.read_shift(2);var W=U[1].v>>1;if(U[1].v&1)switch(W&7){case 0:W=(W>>3)*5e3;break;case 1:W=(W>>3)*500;break;case 2:W=(W>>3)/20;break;case 3:W=(W>>3)/200;break;case 4:W=(W>>3)/2e3;break;case 5:W=(W>>3)/2e4;break;case 6:W=(W>>3)/16;break;case 7:W=(W>>3)/64;break}return U[1].v=W,U}function A(j,H){var U=E(j),W=j.read_shift(4),J=j.read_shift(4),te=j.read_shift(2);if(te==65535)return W===0&&J===3221225472?(U[1].t="e",U[1].v=15):W===0&&J===3489660928?(U[1].t="e",U[1].v=42):U[1].v=0,U;var oe=te&32768;return te=(te&32767)-16446,U[1].v=(1-oe*2)*(J*Math.pow(2,te+32)+W*Math.pow(2,te)),U}function O(j,H,U,W){var J=ie(14);if(J.write_shift(2,j),J.write_shift(1,U),J.write_shift(1,H),W==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var te=0,oe=0,ae=0,se=0;return W<0&&(te=1,W=-W),oe=Math.log2(W)|0,W/=Math.pow(2,oe-31),se=W>>>0,se&2147483648||(W/=2,++oe,se=W>>>0),W-=se,se|=2147483648,se>>>=0,W*=Math.pow(2,32),ae=W>>>0,J.write_shift(4,ae),J.write_shift(4,se),oe+=16383+(te?32768:0),J.write_shift(2,oe),J}function V(j,H){var U=A(j);return j.l+=H-14,U}function C(j,H){var U=E(j),W=j.read_shift(4);return U[1].v=W>>6,U}function B(j,H){var U=E(j),W=j.read_shift(8,"f");return U[1].v=W,U}function G(j,H){var U=B(j);return j.l+=H-10,U}function X(j,H){return j[j.l+H-1]==0?j.read_shift(H,"cstr"):""}function z(j,H){var U=j[j.l++];U>H-1&&(U=H-1);for(var W="";W.length<U;)W+=String.fromCharCode(j[j.l++]);return W}function q(j,H,U){if(!(!U.qpro||H<21)){var W=j.read_shift(1);j.l+=17,j.l+=1,j.l+=2;var J=j.read_shift(H-21,"cstr");return[W,J]}}function K(j,H){for(var U={},W=j.l+H;j.l<W;){var J=j.read_shift(2);if(J==14e3){for(U[J]=[0,""],U[J][0]=j.read_shift(2);j[j.l];)U[J][1]+=String.fromCharCode(j[j.l]),j.l++;j.l++}}return U}function F(j,H){var U=ie(5+j.length);U.write_shift(2,14e3),U.write_shift(2,H);for(var W=0;W<j.length;++W){var J=j.charCodeAt(W);U[U.l++]=J>127?95:J}return U[U.l++]=0,U}var ne={0:{n:"BOF",f:$t},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:g},15:{n:"LABEL",f},16:{n:"FORMULA",f:x},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:z},65535:{n:""}},Y={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:k},23:{n:"NUMBER17",f:A},24:{n:"NUMBER18",f:N},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:K},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:B},40:{n:"FORMULA28",f:G},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:s,to_workbook:t}}();function h7(e){var t={},r=e.match(Tr),n=0,s=!1;if(r)for(;n!=r.length;++n){var a=Fe(r[n]);switch(a[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!a.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(a.val=="1")break;t.cp=_g[parseInt(a.val,10)];break;case"<outline":if(!a.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=a.val;break;case"<sz":t.sz=a.val;break;case"<strike":if(!a.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!a.val)break;switch(a.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(a.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(a.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":a.rgb&&(t.color=a.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=a.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=a.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a[0].charCodeAt(1)!==47&&!s)throw new Error("Unrecognized rich format "+a[0])}}return t}var p7=function(){var e=Vc("t"),t=Vc("rPr");function r(a){var i=a.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:Qe(i[1])},c=a.match(t);return c&&(o.s=h7(c[1])),o}var n=/<(?:\w+:)?r>/g,s=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(s).map(r).filter(function(o){return o.v})}}(),m7=function(){var t=/(\r\n|\n)/g;function r(s,a,i){var o=[];s.u&&o.push("text-decoration: underline;"),s.uval&&o.push("text-underline-style:"+s.uval+";"),s.sz&&o.push("font-size:"+s.sz+"pt;"),s.outline&&o.push("text-effect: outline;"),s.shadow&&o.push("text-shadow: auto;"),a.push('<span style="'+o.join("")+'">'),s.b&&(a.push("<b>"),i.push("</b>")),s.i&&(a.push("<i>"),i.push("</i>")),s.strike&&(a.push("<s>"),i.push("</s>"));var c=s.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(a.push("<"+c+">"),i.push("</"+c+">")),i.push("</span>"),s}function n(s){var a=[[],s.v,[]];return s.v?(s.s&&r(s.s,a[0],a[2]),a[0].join("")+a[1].replace(t,"<br/>")+a[2].join("")):""}return function(a){return a.map(n).join("")}}(),x7=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,g7=/<(?:\w+:)?r>/,v7=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Hg(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Qe(ot(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=ot(e),r&&(n.h=Pg(n.t))):e.match(g7)&&(n.r=ot(e),n.t=Qe(ot((e.replace(v7,"").match(x7)||[]).join("").replace(Tr,""))),r&&(n.h=m7(p7(n.r)))),n):{t:""}}var w7=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,y7=/<(?:\w+:)?(?:si|sstItem)>/g,_7=/<\/(?:\w+:)?(?:si|sstItem)>/;function b7(e,t){var r=[],n="";if(!e)return r;var s=e.match(w7);if(s){n=s[2].replace(y7,"").split(_7);for(var a=0;a!=n.length;++a){var i=Hg(n[a].trim(),t);i!=null&&(r[r.length]=i)}s=Fe(s[1]),r.Count=s.count,r.Unique=s.uniqueCount}return r}var S7=/^\s|\s$|[\t\n\r]/;function JT(e,t){if(!t.bookSST)return"";var r=[Mt];r[r.length]=ve("sst",null,{xmlns:Hi[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var s=e[n],a="<si>";s.r?a+=s.r:(a+="<t",s.t||(s.t=""),s.t.match(S7)&&(a+=' xml:space="preserve"'),a+=">"+st(s.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function k7(e){return[e.read_shift(4),e.read_shift(4)]}function E7(e,t){var r=[],n=!1;return Zs(e,function(a,i,o){switch(o){case 159:r.Count=a[0],r.Unique=a[1];break;case 19:r.push(a);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function T7(e,t){return t||(t=ie(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var N7=LL;function C7(e){var t=Gr();ce(t,159,T7(e));for(var r=0;r<e.length;++r)ce(t,19,N7(e[r]));return ce(t,160),t.end()}function QT(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function zs(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function A7(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=zs(e,4),t.U=zs(e,4),t.W=zs(e,4),t}function j7(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},s=e.read_shift(4),a=[];s-- >0;)a.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=a,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function P7(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(j7(e));return t}function R7(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function F7(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=zs(e,4),t.U=zs(e,4),t.W=zs(e,4),t}function O7(e){var t=F7(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function ZT(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var s=!1;switch(n.AlgID){case 26126:case 26127:case 26128:s=n.Flags==36;break;case 26625:s=n.Flags==4;break;case 0:s=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!s)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function eN(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function I7(e){var t=zs(e);switch(t.Minor){case 2:return[t.Minor,D7(e)];case 3:return[t.Minor,L7()];case 4:return[t.Minor,M7(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function D7(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=ZT(e,r),s=eN(e,e.length-e.l);return{t:"Std",h:n,v:s}}function L7(){throw new Error("File is password-protected: ECMA-376 Extensible")}function M7(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Tr,function(a){var i=Fe(a);switch(Ts(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function B7(e,t){var r={},n=r.EncryptionVersionInfo=zs(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var s=e.read_shift(4);return t-=4,r.EncryptionHeader=ZT(e,s),t-=s,r.EncryptionVerifier=eN(e,t),r}function U7(e){var t={},r=t.EncryptionVersionInfo=zs(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function Gg(e){var t=0,r,n=QT(e),s=n.length+1,a,i,o,c,u;for(r=Da(s),r[0]=n.length,a=1;a!=s;++a)r[a]=n[a-1];for(a=s-1;a>=0;--a)i=r[a],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^i;return t^52811}var tN=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},s=function(i,o){return n(i^o)},a=function(i){for(var o=t[i.length-1],c=104,u=i.length-1;u>=0;--u)for(var f=i[u],d=0;d!=7;++d)f&64&&(o^=r[c]),f*=2,--c;return o};return function(i){for(var o=QT(i),c=a(o),u=o.length,f=Da(16),d=0;d!=16;++d)f[d]=0;var h,p,g;for((u&1)===1&&(h=c>>8,f[u]=s(e[0],h),--u,h=c&255,p=o[o.length-1],f[u]=s(p,h));u>0;)--u,h=c>>8,f[u]=s(o[u],h),--u,h=c&255,f[u]=s(o[u],h);for(u=15,g=15-o.length;g>0;)h=c>>8,f[u]=s(e[g],h),--u,--g,h=c&255,f[u]=s(o[u],h),--u,--g;return f}}(),$7=function(e,t,r,n,s){s||(s=t),n||(n=tN(e));var a,i;for(a=0;a!=t.length;++a)i=t[a],i^=n[r],i=(i>>5|i<<3)&255,s[a]=i,++r;return[s,r,n]},z7=function(e){var t=0,r=tN(e);return function(n){var s=$7("",n,t,r);return t=s[1],s[0]}};function W7(e,t,r,n){var s={key:$t(e),verificationBytes:$t(e)};return r.password&&(s.verifier=Gg(r.password)),n.valid=s.verificationBytes===s.verifier,n.valid&&(n.insitu=z7(r.password)),s}function V7(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=U7(e):n.Data=B7(e,t),n}function H7(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?V7(e,t-2,n):W7(e,r.biff>=8?t:t-2,r,n),n}var rN=function(){function e(s,a){switch(a.type){case"base64":return t(dn(s),a);case"binary":return t(s,a);case"buffer":return t(Ge&&Buffer.isBuffer(s)?s.toString("binary"):Ka(s),a);case"array":return t(Ri(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){var i=a||{},o=i.dense?[]:{},c=s.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,p=0,g,m=-1;g=h.exec(f);){switch(g[0]){case"\\cell":var x=f.slice(p,h.lastIndex-g[0].length);if(x[0]==" "&&(x=x.slice(1)),++m,x.length){var y={v:x,t:"s"};Array.isArray(o)?o[d][m]=y:o[je({r:d,c:m})]=y}break}p=h.lastIndex}m>u.e.c&&(u.e.c=m)}),o["!ref"]=$e(u),o}function r(s,a){return Xa(e(s,a),a)}function n(s){for(var a=["{\\rtf1\\ansi"],i=Ze(s["!ref"]),o,c=Array.isArray(s),u=i.s.r;u<=i.e.r;++u){a.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=je({r:u,c:f});o=c?(s[u]||[])[f]:s[d],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Xs(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function G7(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function Kc(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function q7(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,s=Math.max(t,r,n),a=Math.min(t,r,n),i=s-a;if(i===0)return[0,0,t];var o=0,c=0,u=s+a;switch(c=i/(u>1?2-u:u),s){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,c,u/2]}function K7(e){var t=e[0],r=e[1],n=e[2],s=r*2*(n<.5?n:1-n),a=n-s/2,i=[a,a,a],o=6*t,c;if(r!==0)switch(o|0){case 0:case 6:c=s*o,i[0]+=s,i[1]+=c;break;case 1:c=s*(2-o),i[0]+=c,i[1]+=s;break;case 2:c=s*(o-2),i[1]+=s,i[2]+=c;break;case 3:c=s*(4-o),i[1]+=c,i[2]+=s;break;case 4:c=s*(o-4),i[2]+=s,i[0]+=c;break;case 5:c=s*(6-o),i[2]+=c,i[0]+=s;break}for(var u=0;u!=3;++u)i[u]=Math.round(i[u]*255);return i}function Dd(e,t){if(t===0)return e;var r=q7(G7(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),Kc(K7(r))}var nN=6,X7=15,Y7=1,_r=nN;function Xc(e){return Math.floor((e+Math.round(128/_r)/256)*_r)}function Yc(e){return Math.floor((e-5)/_r*100+.5)/100}function Ld(e){return Math.round((e*_r+5)/_r*256)/256}function Gh(e){return Ld(Yc(Xc(e)))}function qg(e){var t=Math.abs(e-Gh(e)),r=_r;if(t>.005)for(_r=Y7;_r<X7;++_r)Math.abs(e-Gh(e))<=t&&(t=Math.abs(e-Gh(e)),r=_r);_r=r}function La(e){e.width?(e.wpx=Xc(e.width),e.wch=Yc(e.wpx),e.MDW=_r):e.wpx?(e.wch=Yc(e.wpx),e.width=Ld(e.wch),e.MDW=_r):typeof e.wch=="number"&&(e.width=Ld(e.wch),e.wpx=Xc(e.width),e.MDW=_r),e.customWidth&&delete e.customWidth}var J7=96,sN=J7;function Jc(e){return e*96/sN}function rl(e){return e*sN/96}var Q7={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function Z7(e,t,r,n){t.Borders=[];var s={},a=!1;(e[0].match(Tr)||[]).forEach(function(i){var o=Fe(i);switch(Ts(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":s={},o.diagonalUp&&(s.diagonalUp=ht(o.diagonalUp)),o.diagonalDown&&(s.diagonalDown=ht(o.diagonalDown)),t.Borders.push(s);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in borders")}})}function e9(e,t,r,n){t.Fills=[];var s={},a=!1;(e[0].match(Tr)||[]).forEach(function(i){var o=Fe(i);switch(Ts(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":s={},t.Fills.push(s);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(s),s={};break;case"<patternFill":case"<patternFill>":o.patternType&&(s.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":s.bgColor||(s.bgColor={}),o.indexed&&(s.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(s.bgColor.theme=parseInt(o.theme,10)),o.tint&&(s.bgColor.tint=parseFloat(o.tint)),o.rgb&&(s.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":s.fgColor||(s.fgColor={}),o.theme&&(s.fgColor.theme=parseInt(o.theme,10)),o.tint&&(s.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(s.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fills")}})}function t9(e,t,r,n){t.Fonts=[];var s={},a=!1;(e[0].match(Tr)||[]).forEach(function(i){var o=Fe(i);switch(Ts(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(s),s={};break;case"<name":o.val&&(s.name=ot(o.val));break;case"<name/>":case"</name>":break;case"<b":s.bold=o.val?ht(o.val):1;break;case"<b/>":s.bold=1;break;case"<i":s.italic=o.val?ht(o.val):1;break;case"<i/>":s.italic=1;break;case"<u":switch(o.val){case"none":s.underline=0;break;case"single":s.underline=1;break;case"double":s.underline=2;break;case"singleAccounting":s.underline=33;break;case"doubleAccounting":s.underline=34;break}break;case"<u/>":s.underline=1;break;case"<strike":s.strike=o.val?ht(o.val):1;break;case"<strike/>":s.strike=1;break;case"<outline":s.outline=o.val?ht(o.val):1;break;case"<outline/>":s.outline=1;break;case"<shadow":s.shadow=o.val?ht(o.val):1;break;case"<shadow/>":s.shadow=1;break;case"<condense":s.condense=o.val?ht(o.val):1;break;case"<condense/>":s.condense=1;break;case"<extend":s.extend=o.val?ht(o.val):1;break;case"<extend/>":s.extend=1;break;case"<sz":o.val&&(s.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(s.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(s.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(s.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=_g[parseInt(o.val,10)];break;case"<color":if(s.color||(s.color={}),o.auto&&(s.color.auto=ht(o.auto)),o.rgb)s.color.rgb=o.rgb.slice(-6);else if(o.indexed){s.color.index=parseInt(o.indexed,10);var c=gi[s.color.index];s.color.index==81&&(c=gi[1]),c||(c=gi[1]),s.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else o.theme&&(s.color.theme=parseInt(o.theme,10),o.tint&&(s.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(s.color.rgb=Dd(r.themeElements.clrScheme[s.color.theme].rgb,s.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(n&&n.WTF&&!a)throw new Error("unrecognized "+o[0]+" in fonts")}})}function r9(e,t,r){t.NumberFmt=[];for(var n=Pt(Ae),s=0;s<n.length;++s)t.NumberFmt[n[s]]=Ae[n[s]];var a=e[0].match(Tr);if(a)for(s=0;s<a.length;++s){var i=Fe(a[s]);switch(Ts(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Qe(ot(i.formatCode)),c=parseInt(i.numFmtId,10);if(t.NumberFmt[c]=o,c>0){if(c>392){for(c=392;c>60&&t.NumberFmt[c]!=null;--c);t.NumberFmt[c]=o}$s(o,c)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}function n9(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=ve("numFmt",null,{numFmtId:n,formatCode:st(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=ve("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var hf=["numFmtId","fillId","fontId","borderId","xfId"],pf=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function s9(e,t,r){t.CellXf=[];var n,s=!1;(e[0].match(Tr)||[]).forEach(function(a){var i=Fe(a),o=0;switch(Ts(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<hf.length;++o)n[hf[o]]&&(n[hf[o]]=parseInt(n[hf[o]],10));for(o=0;o<pf.length;++o)n[pf[o]]&&(n[pf[o]]=ht(n[pf[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};i.vertical&&(c.vertical=i.vertical),i.horizontal&&(c.horizontal=i.horizontal),i.textRotation!=null&&(c.textRotation=i.textRotation),i.indent&&(c.indent=i.indent),i.wrapText&&(c.wrapText=ht(i.wrapText)),n.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}function a9(e){var t=[];return t[t.length]=ve("cellXfs",null),e.forEach(function(r){t[t.length]=ve("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=ve("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var i9=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,s=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,c,u){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&r9(d,f,u),(d=o.match(s))&&t9(d,f,c,u),(d=o.match(n))&&e9(d,f,c,u),(d=o.match(a))&&Z7(d,f,c,u),(d=o.match(r))&&s9(d,f,u),f}}();function aN(e,t){var r=[Mt,ve("styleSheet",null,{xmlns:Hi[0],"xmlns:vt":Kt.vt})],n;return e.SSF&&(n=n9(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=a9(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function o9(e,t){var r=e.read_shift(2),n=Sr(e);return[r,n]}function l9(e,t,r){r||(r=ie(6+4*t.length)),r.write_shift(2,e),tr(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function c9(e,t,r){var n={};n.sz=e.read_shift(2)/20;var s=VL(e);s.fItalic&&(n.italic=1),s.fCondense&&(n.condense=1),s.fExtend&&(n.extend=1),s.fShadow&&(n.shadow=1),s.fOutline&&(n.outline=1),s.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=WL(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Sr(e),n}function u9(e,t){t||(t=ie(25+4*32)),t.write_shift(2,e.sz*20),HL(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Fd(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),tr(e.name,t),t.length>t.l?t.slice(0,t.l):t}var f9=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],qh,d9=Er;function Ny(e,t){t||(t=ie(4*3+8*7+16*1)),qh||(qh=N0(f9));var r=qh[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Fd({auto:1},t),Fd({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function h9(e,t){var r=e.l+t,n=e.read_shift(2),s=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:s}}function iN(e,t,r){r||(r=ie(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Il(e,t){return t||(t=ie(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var p9=Er;function m9(e,t){return t||(t=ie(51)),t.write_shift(1,0),Il(null,t),Il(null,t),Il(null,t),Il(null,t),Il(null,t),t.length>t.l?t.slice(0,t.l):t}function x9(e,t){return t||(t=ie(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),Rd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function g9(e,t,r){var n=ie(2052);return n.write_shift(4,e),Rd(t,n),Rd(r,n),n.length>n.l?n.slice(0,n.l):n}function v9(e,t,r){var n={};n.NumberFmt=[];for(var s in Ae)n.NumberFmt[s]=Ae[s];n.CellXf=[],n.Fonts=[];var a=[],i=!1;return Zs(e,function(c,u,f){switch(f){case 44:n.NumberFmt[c[0]]=c[1],$s(c[1],c[0]);break;case 43:n.Fonts.push(c),c.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(c.color.rgb=Dd(t.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:a[a.length-1]==617&&n.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:a.push(f),i=!0;break;case 38:a.pop(),i=!1;break;default:if(u.T>0)a.push(f);else if(u.T<0)a.pop();else if(!i||r.WTF&&a[a.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}function w9(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&++r}),r!=0&&(ce(e,615,Zn(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&ce(e,44,l9(s,t[s]))}),ce(e,616))}}function y9(e){var t=1;ce(e,611,Zn(t)),ce(e,43,u9({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),ce(e,612)}function _9(e){var t=2;ce(e,603,Zn(t)),ce(e,45,Ny({patternType:"none"})),ce(e,45,Ny({patternType:"gray125"})),ce(e,604)}function b9(e){var t=1;ce(e,613,Zn(t)),ce(e,46,m9()),ce(e,614)}function S9(e){var t=1;ce(e,626,Zn(t)),ce(e,47,iN({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),ce(e,627)}function k9(e,t){ce(e,617,Zn(t.length)),t.forEach(function(r){ce(e,47,iN(r,0))}),ce(e,618)}function E9(e){var t=1;ce(e,619,Zn(t)),ce(e,48,x9({xfId:0,builtinId:0,name:"Normal"})),ce(e,620)}function T9(e){var t=0;ce(e,505,Zn(t)),ce(e,506)}function N9(e){var t=0;ce(e,508,g9(t,"TableStyleMedium9","PivotStyleMedium4")),ce(e,509)}function C9(e,t){var r=Gr();return ce(r,278),w9(r,e.SSF),y9(r),_9(r),b9(r),S9(r),k9(r,t.cellXfs),E9(r),T9(r),N9(r),ce(r,279),r.end()}var A9=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function j9(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Tr)||[]).forEach(function(s){var a=Fe(s);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":a[0].charAt(1)==="/"?(t.themeElements.clrScheme[A9.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function P9(){}function R9(){}var F9=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,O9=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,I9=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function D9(e,t,r){t.themeElements={};var n;[["clrScheme",F9,j9],["fontScheme",O9,P9],["fmtScheme",I9,R9]].forEach(function(s){if(!(n=e.match(s[1])))throw new Error(s[0]+" not found in themeElements");s[2](n,t,r)})}var L9=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function oN(e,t){(!e||e.length===0)&&(e=Kg());var r,n={};if(!(r=e.match(L9)))throw new Error("themeElements not found in theme");return D9(r[0],n,t),n.raw=e,n}function Kg(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Mt];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function M9(e,t,r){var n=e.l+t,s=e.read_shift(4);if(s!==124226){if(!r.cellStyles){e.l=n;return}var a=e.slice(e.l);e.l=n;var i;try{i=ZE(a,{type:"array"})}catch{return}var o=sn(i,"theme/theme/theme1.xml",!0);if(o)return oN(o,r)}}function B9(e){return e.read_shift(4)}function U9(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=$9(e,4);break;case 2:t.xclrValue=UT(e);break;case 3:t.xclrValue=B9(e);break;case 4:e.l+=4;break}return e.l+=8,t}function $9(e,t){return Er(e,t)}function z9(e,t){return Er(e,t)}function W9(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=U9(e);break;case 6:n[1]=z9(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function V9(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var s=e.read_shift(2),a=[];s-- >0;)a.push(W9(e,r-e.l));return{ixfe:n,ext:a}}function H9(e,t){t.forEach(function(r){switch(r[0]){}})}function G9(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Sr(e)}}function q9(e){var t=ie(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),tr(e.name,t),t.slice(0,t.l)}function K9(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function X9(e){var t=ie(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function Y9(e,t){var r=ie(8+2*t.length);return r.write_shift(4,e),tr(t,r),r.slice(0,r.l)}function J9(e){return e.l+=4,e.read_shift(4)!=0}function Q9(e,t){var r=ie(8);return r.write_shift(4,e),r.write_shift(4,1),r}function Z9(e,t,r){var n={Types:[],Cell:[],Value:[]},s=r||{},a=[],i=!1,o=2;return Zs(e,function(c,u,f){switch(f){case 335:n.Types.push({name:c.name});break;case 51:c.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=c?1:0;break;case 338:o=2;break;case 35:a.push(f),i=!0;break;case 36:a.pop(),i=!1;break;default:if(!u.T){if(!i||s.WTF&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function eU(){var e=Gr();return ce(e,332),ce(e,334,Zn(1)),ce(e,335,q9({name:"XLDAPR",version:12e4,flags:3496657072})),ce(e,336),ce(e,339,Y9(1,"XLDAPR")),ce(e,52),ce(e,35,Zn(514)),ce(e,4096,Zn(0)),ce(e,4097,bn(1)),ce(e,36),ce(e,53),ce(e,340),ce(e,337,Q9(1)),ce(e,51,X9([[1,0]])),ce(e,338),ce(e,333),e.end()}function tU(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var s=!1,a=2,i;return e.replace(Tr,function(o){var c=Fe(o);switch(Ts(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<n.Types.length;++u)n.Types[u].name==c.name&&(i=n.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":a==1?n.Cell.push({type:n.Types[c.t-1].name,index:+c.v}):a==0&&n.Value.push({type:n.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":a=1;break;case"</cellMetadata>":a=2;break;case"<valueMetadata":a=0;break;case"</valueMetadata>":a=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+c.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return o}),n}function lN(){var e=[Mt];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function rU(e){var t=[];if(!e)return t;var r=1;return(e.match(Tr)||[]).forEach(function(n){var s=Fe(n);switch(s[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete s[0],s.i?r=s.i:s.i=r,t.push(s);break}}),t}function nU(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=je(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function sU(e,t,r){var n=[];return Zs(e,function(a,i,o){switch(o){case 63:n.push(a);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function aU(e,t,r,n){if(!e)return e;var s=n||{},a=!1;Zs(e,function(o,c,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:a=!0;break;case 36:a=!1;break;default:if(!c.T){if(!a||s.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},s)}function iU(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var No=1024;function cN(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),s=[ve("xml",null,{"xmlns:v":en.v,"xmlns:o":en.o,"xmlns:x":en.x,"xmlns:mv":en.mv}).replace(/\/>/,">"),ve("o:shapelayout",ve("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),ve("v:shapetype",[ve("v:stroke",null,{joinstyle:"miter"}),ve("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];No<e*1e3;)No+=1e3;return t.forEach(function(a){var i=St(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?ve("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=ve("v:fill",c,o),f={on:"t",obscured:"t"};++No,s=s.concat(["<v:shape"+Hc({id:"_x0000_s"+No,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,ve("v:shadow",null,f),ve("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",cr("x:Anchor",[i.c+1,0,i.r+1,0,i.c+3,20,i.r+5,20].join(",")),cr("x:AutoFill","False"),cr("x:Row",String(i.r)),cr("x:Column",String(i.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function Cy(e,t,r,n){var s=Array.isArray(e),a;t.forEach(function(i){var o=St(i.ref);if(s?(e[o.r]||(e[o.r]=[]),a=e[o.r][o.c]):a=e[i.ref],!a){a={t:"z"},s?e[o.r][o.c]=a:e[i.ref]=a;var c=Ze(e["!ref"]||"BDWGO1000001:A1");c.s.r>o.r&&(c.s.r=o.r),c.e.r<o.r&&(c.e.r=o.r),c.s.c>o.c&&(c.s.c=o.c),c.e.c<o.c&&(c.e.c=o.c);var u=$e(c);u!==e["!ref"]&&(e["!ref"]=u)}a.c||(a.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=a.c.length-1;d>=0;--d){if(!r&&a.c[d].T)return;r&&!a.c[d].T&&a.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}a.c.push(f)})}function oU(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],s=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);s&&s[1]&&s[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var a=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return a&&a[1]&&a[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var c=Fe(o[0]),u={author:c.authorId&&r[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},f=St(c.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&Hg(d[1])||{r:"",t:"",h:""};u.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),u.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=h.h),n.push(u)}}}}),n}function uN(e){var t=[Mt,ve("comments",null,{xmlns:Hi[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(s){var a=st(s.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),s.T&&s.ID&&r.indexOf("tc="+s.ID)==-1&&(r.push("tc="+s.ID),t.push("<author>tc="+s.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var s=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?s=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(s=r.indexOf(st(c.a))),a.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+s+'"><text>'),a.length<=1)t.push(cr("t",st(a[0]||"")));else{for(var i=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)i+=`Reply:
    `+a[o]+`
`;t.push(cr("t",st(i)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function lU(e,t){var r=[],n=!1,s={},a=0;return e.replace(Tr,function(o,c){var u=Fe(o);switch(Ts(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":s={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":s.t!=null&&r.push(s);break;case"<text>":case"<text":a=c+o.length;break;case"</text>":s.t=e.slice(a,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),r}function cU(e,t,r){var n=[Mt,ve("ThreadedComments",null,{xmlns:Kt.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(s){var a="";(s[1]||[]).forEach(function(i,o){if(!i.T){delete i.ID;return}i.a&&t.indexOf(i.a)==-1&&t.push(i.a);var c={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=c.id:c.parentId=a,i.ID=c.id,i.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(i.a)).slice(-12)+"}"),n.push(ve("threadedComment",cr("text",i.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function uU(e,t){var r=[],n=!1;return e.replace(Tr,function(a){var i=Fe(a);switch(Ts(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return a}),r}function fU(e){var t=[Mt,ve("personList",null,{xmlns:Kt.TCMNT,"xmlns:x":Hi[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(ve("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function dU(e){var t={};t.iauthor=e.read_shift(4);var r=Xi(e);return t.rfx=r.s,t.ref=je(r.s),e.l+=16,t}function hU(e,t){return t==null&&(t=ie(36)),t.write_shift(4,e[1].iauthor),vl(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var pU=Sr;function mU(e){return tr(e.slice(0,54))}function xU(e,t){var r=[],n=[],s={},a=!1;return Zs(e,function(o,c,u){switch(u){case 632:n.push(o);break;case 635:s=o;break;case 637:s.t=o.t,s.h=o.h,s.r=o.r;break;case 636:if(s.author=n[s.iauthor],delete s.iauthor,t.sheetRows&&s.rfx&&t.sheetRows<=s.rfx.r)break;s.t||(s.t=""),delete s.rfx,r.push(s);break;case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!a||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),r}function gU(e){var t=Gr(),r=[];return ce(t,628),ce(t,630),e.forEach(function(n){n[1].forEach(function(s){r.indexOf(s.a)>-1||(r.push(s.a.slice(0,54)),ce(t,632,mU(s.a)))})}),ce(t,631),ce(t,633),e.forEach(function(n){n[1].forEach(function(s){s.iauthor=r.indexOf(s.a);var a={s:St(n[0]),e:St(n[0])};ce(t,635,hU([a,s])),s.t&&s.t.length>0&&ce(t,637,BL(s)),ce(t,636),delete s.iauthor})}),ce(t,634),ce(t,629),t.end()}var vU="application/vnd.ms-office.vbaProject";function wU(e){var t=Ee.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var s=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ee.utils.cfb_add(t,s,e.FileIndex[n].content)}}),Ee.write(t)}function yU(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var s=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Ee.utils.cfb_add(e,s,t.FileIndex[n].content)}})}var fN=["xlsb","xlsm","xlam","biff8","xla"];function _U(){return{"!type":"dialog"}}function bU(){return{"!type":"dialog"}}function SU(){return{"!type":"macro"}}function kU(){return{"!type":"macro"}}var $o=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,s,a,i){var o=!1,c=!1;a.length==0?c=!0:a.charAt(0)=="["&&(c=!0,a=a.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,c?u+=t.r:--u,s+(o?"":"$")+bt(f)+(c?"":"$")+Dt(u)}return function(s,a){return t=a,s.replace(e,r)}}(),Xg=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Yg=function(){return function(t,r){return t.replace(Xg,function(n,s,a,i,o,c){var u=Dg(i)-(a?0:r.c),f=Ig(c)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",h=u==0?"":a?u+1:"["+u+"]";return s+"R"+d+"C"+h})}}();function dN(e,t){return e.replace(Xg,function(r,n,s,a,i,o){return n+(s=="$"?s+a:bt(Dg(a)+t.c))+(i=="$"?i+o:Dt(Ig(o)+t.r))})}function EU(e,t,r){var n=qr(t),s=n.s,a=St(r),i={r:a.r-s.r,c:a.c-s.c};return dN(e,i)}function TU(e){return e.length!=1}function Ay(e){return e.replace(/_xlfn\./g,"")}function Bt(e){e.l+=1}function Ma(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function hN(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return pN(e);r.biff==12&&(n=4)}var s=e.read_shift(n),a=e.read_shift(n),i=Ma(e),o=Ma(e);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function pN(e){var t=Ma(e),r=Ma(e),n=e.read_shift(1),s=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:s,cRel:r[1],rRel:r[2]}}}function NU(e,t,r){if(r.biff<8)return pN(e);var n=e.read_shift(r.biff==12?4:2),s=e.read_shift(r.biff==12?4:2),a=Ma(e),i=Ma(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:i[0],cRel:i[1],rRel:i[2]}}}function mN(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return CU(e);var n=e.read_shift(r&&r.biff==12?4:2),s=Ma(e);return{r:n,c:s[0],cRel:s[1],rRel:s[2]}}function CU(e){var t=Ma(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function AU(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function jU(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return PU(e);var s=e.read_shift(n>=12?4:2),a=e.read_shift(2),i=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;s>524287;)s-=1048576;if(i==1)for(;a>8191;)a=a-16384;return{r:s,c:a,cRel:i,rRel:o}}function PU(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,s=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),s==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:s,rRel:n}}function RU(e,t,r){var n=(e[e.l++]&96)>>5,s=hN(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,s]}function FU(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var i=hN(e,a,r);return[n,s,i]}function OU(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function IU(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,s]}function DU(e,t,r){var n=(e[e.l++]&96)>>5,s=NU(e,t-1,r);return[n,s]}function LU(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function jy(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function MU(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),s=[],a=0;a<=n;++a)s.push(e.read_shift(r&&r.biff==2?1:2));return s}function BU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function UU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function $U(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function zU(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function xN(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function WU(e){return e.read_shift(2),xN(e)}function VU(e){return e.read_shift(2),xN(e)}function HU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=mN(e,0,r);return[n,s]}function GU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=jU(e,0,r);return[n,s]}function qU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=mN(e,0,r);return[n,s,a]}function KU(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var s=e.read_shift(r&&r.biff<=3?1:2);return[J$[s],wN[s],n]}function XU(e,t,r){var n=e[e.l++],s=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:YU(e);return[s,(a[0]===0?wN:Y$)[a[1]]]}function YU(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function JU(e,t,r){e.l+=r&&r.biff==2?3:4}function QU(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function ZU(e){return e.l++,ea[e.read_shift(1)]}function e$(e){return e.l++,e.read_shift(2)}function t$(e){return e.l++,e.read_shift(1)!==0}function r$(e){return e.l++,br(e)}function n$(e,t,r){return e.l++,wu(e,t-1,r)}function s$(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ot(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ea[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=br(e);break;case 2:r[1]=Yi(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function a$(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),s=[],a=0;a!=n;++a)s.push((r.biff==12?Xi:j0)(e));return s}function i$(e,t,r){var n=0,s=0;r.biff==12?(n=e.read_shift(4),s=e.read_shift(4)):(s=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--s==0&&(s=256));for(var a=0,i=[];a!=n&&(i[a]=[]);++a)for(var o=0;o!=s;++o)i[a][o]=s$(e,r.biff);return i}function o$(e,t,r){var n=e.read_shift(1)>>>5&3,s=!r||r.biff>=8?4:2,a=e.read_shift(s);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function l$(e,t,r){if(r.biff==5)return c$(e);var n=e.read_shift(1)>>>5&3,s=e.read_shift(2),a=e.read_shift(4);return[n,s,a]}function c$(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function u$(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function f$(e,t,r){var n=e.read_shift(1)>>>5&3,s=e.read_shift(r&&r.biff==2?1:2);return[n,s]}function d$(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function h$(e,t,r){var n=(e[e.l++]&96)>>5,s=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,s]}var p$=Er,m$=Er,x$=Er;function _u(e,t,r){return e.l+=2,[AU(e)]}function Jg(e){return e.l+=6,[]}var g$=_u,v$=Jg,w$=Jg,y$=_u;function gN(e){return e.l+=2,[$t(e),e.read_shift(2)&1]}var _$=_u,b$=gN,S$=Jg,k$=_u,E$=_u,T$=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function N$(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),s=e.read_shift(2),a=e.read_shift(2),i=T$[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:s,C:a}}function C$(e){return e.l+=2,[e.read_shift(4)]}function A$(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function j$(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function P$(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function R$(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function F$(e){return e.l+=4,[0,0]}var Py={1:{n:"PtgExp",f:QU},2:{n:"PtgTbl",f:x$},3:{n:"PtgAdd",f:Bt},4:{n:"PtgSub",f:Bt},5:{n:"PtgMul",f:Bt},6:{n:"PtgDiv",f:Bt},7:{n:"PtgPower",f:Bt},8:{n:"PtgConcat",f:Bt},9:{n:"PtgLt",f:Bt},10:{n:"PtgLe",f:Bt},11:{n:"PtgEq",f:Bt},12:{n:"PtgGe",f:Bt},13:{n:"PtgGt",f:Bt},14:{n:"PtgNe",f:Bt},15:{n:"PtgIsect",f:Bt},16:{n:"PtgUnion",f:Bt},17:{n:"PtgRange",f:Bt},18:{n:"PtgUplus",f:Bt},19:{n:"PtgUminus",f:Bt},20:{n:"PtgPercent",f:Bt},21:{n:"PtgParen",f:Bt},22:{n:"PtgMissArg",f:Bt},23:{n:"PtgStr",f:n$},26:{n:"PtgSheet",f:A$},27:{n:"PtgEndSheet",f:j$},28:{n:"PtgErr",f:ZU},29:{n:"PtgBool",f:t$},30:{n:"PtgInt",f:e$},31:{n:"PtgNum",f:r$},32:{n:"PtgArray",f:LU},33:{n:"PtgFunc",f:KU},34:{n:"PtgFuncVar",f:XU},35:{n:"PtgName",f:o$},36:{n:"PtgRef",f:HU},37:{n:"PtgArea",f:RU},38:{n:"PtgMemArea",f:u$},39:{n:"PtgMemErr",f:p$},40:{n:"PtgMemNoMem",f:m$},41:{n:"PtgMemFunc",f:f$},42:{n:"PtgRefErr",f:d$},43:{n:"PtgAreaErr",f:OU},44:{n:"PtgRefN",f:GU},45:{n:"PtgAreaN",f:DU},46:{n:"PtgMemAreaN",f:P$},47:{n:"PtgMemNoMemN",f:R$},57:{n:"PtgNameX",f:l$},58:{n:"PtgRef3d",f:qU},59:{n:"PtgArea3d",f:FU},60:{n:"PtgRefErr3d",f:h$},61:{n:"PtgAreaErr3d",f:IU},255:{}},O$={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},I$={1:{n:"PtgElfLel",f:gN},2:{n:"PtgElfRw",f:k$},3:{n:"PtgElfCol",f:g$},6:{n:"PtgElfRwV",f:E$},7:{n:"PtgElfColV",f:y$},10:{n:"PtgElfRadical",f:_$},11:{n:"PtgElfRadicalS",f:S$},13:{n:"PtgElfColS",f:v$},15:{n:"PtgElfColSV",f:w$},16:{n:"PtgElfRadicalLel",f:b$},25:{n:"PtgList",f:N$},29:{n:"PtgSxName",f:C$},255:{}},D$={0:{n:"PtgAttrNoop",f:F$},1:{n:"PtgAttrSemi",f:zU},2:{n:"PtgAttrIf",f:UU},4:{n:"PtgAttrChoose",f:MU},8:{n:"PtgAttrGoto",f:BU},16:{n:"PtgAttrSum",f:JU},32:{n:"PtgAttrBaxcel",f:jy},33:{n:"PtgAttrBaxcel",f:jy},64:{n:"PtgAttrSpace",f:WU},65:{n:"PtgAttrSpaceSemi",f:VU},128:{n:"PtgAttrIfError",f:$U},255:{}};function bu(e,t,r,n){if(n.biff<8)return Er(e,t);for(var s=e.l+t,a=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=i$(e,0,n),a.push(r[i][1]);break;case"PtgMemArea":r[i][2]=a$(e,r[i][1],n),a.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),a.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=s-e.l,t!==0&&a.push(Er(e,t)),a}function Su(e,t,r){for(var n=e.l+t,s,a,i=[];n!=e.l;)t=n-e.l,a=e[e.l],s=Py[a]||Py[O$[a]],(a===24||a===25)&&(s=(a===24?I$:D$)[e[e.l+1]]),!s||!s.f?Er(e,t):i.push([s.n,s.f(e,t,r)]);return i}function L$(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],s=[],a=0;a<n.length;++a){var i=n[a];if(i)switch(i[0]){case 2:s.push('"'+i[1].replace(/"/g,'""')+'"');break;default:s.push(i[1])}else s.push("")}t.push(s.join(","))}return t.join(";")}var M$={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function B$(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function vN(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var s="";if(r.biff>8)switch(e[n[0]][0]){case 357:return s=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return s=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?s:s+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(s=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?s:s+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Ry(e,t,r){var n=vN(e,t,r);return n=="#REF"?n:B$(n,r)}function wr(e,t,r,n,s){var a=s&&s.biff||8,i={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,u,f,d=0,h=0,p,g="";if(!e[0]||!e[0][0])return"";for(var m=-1,x="",y=0,w=e[0].length;y<w;++y){var v=e[0][y];switch(v[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:x=At(" ",e[0][m][1][1]);break;case 1:x=At("\r",e[0][m][1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+x,m=-1}o.push(u+M$[v[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=ic(v[1][1],i,s),o.push(oc(f,a));break;case"PtgRefN":f=r?ic(v[1][1],r,s):v[1][1],o.push(oc(f,a));break;case"PtgRef3d":d=v[1][1],f=ic(v[1][2],i,s),g=Ry(n,d,s),o.push(g+"!"+oc(f,a));break;case"PtgFunc":case"PtgFuncVar":var S=v[1][0],E=v[1][1];S||(S=0),S&=127;var k=S==0?[]:o.slice(-S);o.length-=S,E==="User"&&(E=k.shift()),o.push(E+"("+k.join(",")+")");break;case"PtgBool":o.push(v[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(v[1]);break;case"PtgNum":o.push(String(v[1]));break;case"PtgStr":o.push('"'+v[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(v[1]);break;case"PtgAreaN":p=oy(v[1][1],r?{s:r}:i,s),o.push(Wh(p,s));break;case"PtgArea":p=oy(v[1][1],i,s),o.push(Wh(p,s));break;case"PtgArea3d":d=v[1][1],p=v[1][2],g=Ry(n,d,s),o.push(g+"!"+Wh(p,s));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=v[1][2];var b=(n.names||[])[h-1]||(n[0]||[])[h],N=b?b.Name:"SH33TJSNAME"+String(h);N&&N.slice(0,6)=="_xlfn."&&!s.xlfn&&(N=N.slice(6)),o.push(N);break;case"PtgNameX":var A=v[1][1];h=v[1][2];var O;if(s.biff<=5)A<0&&(A=-A),n[A]&&(O=n[A][h]);else{var V="";if(((n[A]||[])[0]||[])[0]==14849||(((n[A]||[])[0]||[])[0]==1025?n[A][h]&&n[A][h].itab>0&&(V=n.SheetNames[n[A][h].itab-1]+"!"):V=n.SheetNames[h-1]+"!"),n[A]&&n[A][h])V+=n[A][h].Name;else if(n[0]&&n[0][h])V+=n[0][h].Name;else{var C=(vN(n,A,s)||"").split(";;");C[h-1]?V=C[h-1]:V+="SH33TJSERRX"}o.push(V);break}O||(O={Name:"SH33TJSERRY"}),o.push(O.Name);break;case"PtgParen":var B="(",G=")";if(m>=0){switch(x="",e[0][m][1][0]){case 2:B=At(" ",e[0][m][1][1])+B;break;case 3:B=At("\r",e[0][m][1][1])+B;break;case 4:G=At(" ",e[0][m][1][1])+G;break;case 5:G=At("\r",e[0][m][1][1])+G;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(B+o.pop()+G);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:v[1][1],r:v[1][0]};var X={c:r.c,r:r.r};if(n.sharedf[je(f)]){var z=n.sharedf[je(f)];o.push(wr(z,i,X,n,s))}else{var q=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(wr(u[1],i,X,n,s)),q=!0;break}q||o.push(v[1])}break;case"PtgArray":o.push("{"+L$(v[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+v[1].idx+"[#"+v[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(v));default:throw new Error("Unrecognized Formula Token: "+String(v))}var K=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&m>=0&&K.indexOf(e[0][y][0])==-1){v=e[0][m];var F=!0;switch(v[1][0]){case 4:F=!1;case 0:x=At(" ",v[1][1]);break;case 5:F=!1;case 1:x=At("\r",v[1][1]);break;default:if(x="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+v[1][0])}o.push((F?x:"")+o.pop()+(F?"":x)),m=-1}}if(o.length>1&&s.WTF)throw new Error("bad formula stack");return o[0]}function U$(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Er(e,t-2)];var o=Su(e,i,r);return t!==i+s&&(a=bu(e,t-i-s,o,r)),e.l=n,[o,a]}function $$(e,t,r){var n=e.l+t,s=r.biff==2?1:2,a,i=e.read_shift(s);if(i==65535)return[[],Er(e,t-2)];var o=Su(e,i,r);return t!==i+s&&(a=bu(e,t-i-s,o,r)),e.l=n,[o,a]}function z$(e,t,r,n){var s=e.l+t,a=Su(e,n,r),i;return s!==e.l&&(i=bu(e,s-e.l,a,r)),[a,i]}function W$(e,t,r){var n=e.l+t,s,a=e.read_shift(2),i=Su(e,a,r);return a==65535?[[],Er(e,t-2)]:(t!==a+2&&(s=bu(e,n-a-2,i,r)),[i,s])}function V$(e){var t;if(Ls(e,e.l+6)!==65535)return[br(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function H$(e){if(e==null){var t=ie(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Fi(e);return Fi(0)}function Kh(e,t,r){var n=e.l+t,s=Ns(e);r.biff==2&&++e.l;var a=V$(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=$$(e,n-e.l,r);return{cell:s,val:a[0],formula:o,shared:i>>3&1,tt:a[1]}}function G$(e,t,r,n,s){var a=Ii(t,r,s),i=H$(e.v),o=ie(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=ie(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var d=er([a,i,o,u]);return d}function P0(e,t,r){var n=e.read_shift(4),s=Su(e,n,r),a=e.read_shift(4),i=a>0?bu(e,a,s,r):null;return[s,i]}var q$=P0,R0=P0,K$=P0,X$=P0,Y$={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},wN={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},J$={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Fy(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Q$(e){var t="of:="+e.replace(Xg,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Xh(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function Z$(e){return e.replace(/\./,"!")}var cc={},zo={},uc=typeof Map<"u";function Qg(e,t,r){var n=0,s=e.length;if(r){if(uc?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=uc?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<s;++n)if(e[n].t===t)return e.Count++,n;return e[s]={t},e.Count++,e.Unique++,r&&(uc?(r.has(t)||r.set(t,[]),r.get(t).push(s)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(s))),s}function F0(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(_r=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Yc(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Ld(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function yi(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Ya(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],s=60,a=e.length;if(n==null&&r.ssf){for(;s<392;++s)if(r.ssf[s]==null){$s(t.z,s),r.ssf[s]=t.z,r.revssf[t.z]=n=s;break}}for(s=0;s!=a;++s)if(e[s].numFmtId===n)return s;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function yN(e,t,r,n,s,a){try{n.cellNF&&(e.z=Ae[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=mt(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Ae[t]==null&&$s(Y6[t]||"General",t),e.t==="e")e.w=e.w||ea[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wc(e.v);else if(e.t==="d"){var i=Yt(e.v);(i|0)===i?e.w=i.toString(10):e.w=Wc(i)}else{if(e.v===void 0)return"";e.w=Pi(e.v,zo)}else e.t==="d"?e.w=Rn(t,Yt(e.v),zo):e.w=Rn(t,e.v,zo)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=a.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Dd(s.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=s.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Dd(s.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=s.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&a.Fills)throw o}}}function ez(e,t,r){if(e&&e["!ref"]){var n=Ze(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function tz(e,t){var r=Ze(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=$e(r))}var rz=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,nz=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,sz=/<(?:\w:)?hyperlink [^>]*>/mg,az=/"(\w*:\w*)"/,iz=/<(?:\w:)?col\b[^>]*[\/]?>/g,oz=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,lz=/<(?:\w:)?pageMargins[^>]*\/>/g,_N=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,cz=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,uz=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function fz(e,t,r,n,s,a,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",f="",d=e.match(nz);d?(u=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):u=f=e;var h=u.match(_N);h?Zg(h[0],o,s,r):(h=u.match(cz))&&hz(h[0],h[1]||"",o,s,r);var p=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var g=u.slice(p,p+50).match(az);g&&tz(o,g[1])}var m=u.match(uz);m&&m[1]&&Tz(m[1],s);var x=[];if(t.cellStyles){var y=u.match(iz);y&&_z(x,y)}d&&Az(d[1],o,t,c,a,i);var w=f.match(oz);w&&(o["!autofilter"]=Sz(w[0]));var v=[],S=f.match(rz);if(S)for(p=0;p!=S.length;++p)v[p]=Ze(S[p].slice(S[p].indexOf('"')+1));var E=f.match(sz);E&&vz(o,E,n);var k=f.match(lz);if(k&&(o["!margins"]=wz(Fe(k[0]))),!o["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(o["!ref"]=$e(c)),t.sheetRows>0&&o["!ref"]){var b=Ze(o["!ref"]);t.sheetRows<=+b.e.r&&(b.e.r=t.sheetRows-1,b.e.r>c.e.r&&(b.e.r=c.e.r),b.e.r<b.s.r&&(b.s.r=b.e.r),b.e.c>c.e.c&&(b.e.c=c.e.c),b.e.c<b.s.c&&(b.s.c=b.e.c),o["!fullref"]=o["!ref"],o["!ref"]=$e(b))}return x.length>0&&(o["!cols"]=x),v.length>0&&(o["!merges"]=v),o}function dz(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+$e(e[r])+'"/>';return t+"</mergeCells>"}function Zg(e,t,r,n){var s=Fe(e);r.Sheets[n]||(r.Sheets[n]={}),s.codeName&&(r.Sheets[n].CodeName=Qe(ot(s.codeName)))}function hz(e,t,r,n,s){Zg(e.slice(0,e.indexOf(">")),r,n,s)}function pz(e,t,r,n,s){var a=!1,i={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}a=!0,i.codeName=vs(st(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+ve("outlinePr",null,u)}!a&&!o||(s[s.length]=ve("sheetPr",o,i))}var mz=["objects","scenarios","selectLockedCells","selectUnlockedCells"],xz=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function gz(e){var t={sheet:1};return mz.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),xz.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=Gg(e.password).toString(16).toUpperCase()),ve("sheetProtection",null,t)}function vz(e,t,r){for(var n=Array.isArray(e),s=0;s!=t.length;++s){var a=Fe(ot(t[s]),!0);if(!a.ref)return;var i=((r||{})["!id"]||[])[a.id];i?(a.Target=i.Target,a.location&&(a.Target+="#"+Qe(a.location))):(a.Target="#"+Qe(a.location),i={Target:a.Target,TargetMode:"Internal"}),a.Rel=i,a.tooltip&&(a.Tooltip=a.tooltip,delete a.tooltip);for(var o=Ze(a.ref),c=o.s.r;c<=o.e.r;++c)for(var u=o.s.c;u<=o.e.c;++u){var f=je({c:u,r:c});n?(e[c]||(e[c]=[]),e[c][u]||(e[c][u]={t:"z",v:void 0}),e[c][u].l=a):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=a)}}}function wz(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function yz(e){return yi(e),ve("pageMargins",null,e)}function _z(e,t){for(var r=!1,n=0;n!=t.length;++n){var s=Fe(t[n],!0);s.hidden&&(s.hidden=ht(s.hidden));var a=parseInt(s.min,10)-1,i=parseInt(s.max,10)-1;for(s.outlineLevel&&(s.level=+s.outlineLevel||0),delete s.min,delete s.max,s.width=+s.width,!r&&s.width&&(r=!0,qg(s.width)),La(s);a<=i;)e[a++]=xt(s)}}function bz(e,t){for(var r=["<cols>"],n,s=0;s!=t.length;++s)(n=t[s])&&(r[r.length]=ve("col",null,F0(s,n)));return r[r.length]="</cols>",r.join("")}function Sz(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function kz(e,t,r,n){var s=typeof e.ref=="string"?e.ref:$e(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,i=qr(s);i.s.r==i.e.r&&(i.e.r=qr(t["!ref"]).e.r,s=$e(i));for(var o=0;o<a.length;++o){var c=a[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),ve("autoFilter",null,{ref:s})}var Ez=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Tz(e,t){t.Views||(t.Views=[{}]),(e.match(Ez)||[]).forEach(function(r,n){var s=Fe(r);t.Views[n]||(t.Views[n]={}),+s.zoomScale&&(t.Views[n].zoom=+s.zoomScale),ht(s.rightToLeft)&&(t.Views[n].RTL=!0)})}function Nz(e,t,r,n){var s={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),ve("sheetViews",ve("sheetView",null,s),{})}function Cz(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var s="",a=e.t,i=e.v;if(e.t!=="z")switch(e.t){case"b":s=e.v?"1":"0";break;case"n":s=""+e.v;break;case"e":s=ea[e.v];break;case"d":n&&n.cellDates?s=mt(e.v,-1).toISOString():(e=xt(e),e.t="n",s=""+(e.v=Yt(mt(e.v)))),typeof e.z>"u"&&(e.z=Ae[14]);break;default:s=e.v;break}var o=cr("v",st(s)),c={r:t},u=Ya(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=cr("v",""+Qg(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=a&&(e.t=a,e.v=i),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=ve("f",st(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),ve("c",o,c)}var Az=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,s=/ref=["']([^"']*)["']/,a=Vc("v"),i=Vc("f");return function(c,u,f,d,h,p){for(var g=0,m="",x=[],y=[],w=0,v=0,S=0,E="",k,b,N=0,A=0,O,V,C=0,B=0,G=Array.isArray(p.CellXf),X,z=[],q=[],K=Array.isArray(u),F=[],ne={},Y=!1,j=!!f.sheetStubs,H=c.split(t),U=0,W=H.length;U!=W;++U){m=H[U].trim();var J=m.length;if(J!==0){var te=0;e:for(g=0;g<J;++g)switch(m[g]){case">":if(m[g-1]!="/"){++g;break e}if(f&&f.cellStyles){if(b=Fe(m.slice(te,g),!0),N=b.r!=null?parseInt(b.r,10):N+1,A=-1,f.sheetRows&&f.sheetRows<N)continue;ne={},Y=!1,b.ht&&(Y=!0,ne.hpt=parseFloat(b.ht),ne.hpx=rl(ne.hpt)),b.hidden=="1"&&(Y=!0,ne.hidden=!0),b.outlineLevel!=null&&(Y=!0,ne.level=+b.outlineLevel),Y&&(F[N-1]=ne)}break;case"<":te=g;break}if(te>=g)break;if(b=Fe(m.slice(te,g),!0),N=b.r!=null?parseInt(b.r,10):N+1,A=-1,!(f.sheetRows&&f.sheetRows<N)){d.s.r>N-1&&(d.s.r=N-1),d.e.r<N-1&&(d.e.r=N-1),f&&f.cellStyles&&(ne={},Y=!1,b.ht&&(Y=!0,ne.hpt=parseFloat(b.ht),ne.hpx=rl(ne.hpt)),b.hidden=="1"&&(Y=!0,ne.hidden=!0),b.outlineLevel!=null&&(Y=!0,ne.level=+b.outlineLevel),Y&&(F[N-1]=ne)),x=m.slice(g).split(e);for(var oe=0;oe!=x.length&&x[oe].trim().charAt(0)=="<";++oe);for(x=x.slice(oe),g=0;g!=x.length;++g)if(m=x[g].trim(),m.length!==0){if(y=m.match(r),w=g,v=0,S=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,y!=null&&y.length===2){for(w=0,E=y[1],v=0;v!=E.length&&!((S=E.charCodeAt(v)-64)<1||S>26);++v)w=26*w+S;--w,A=w}else++A;for(v=0;v!=m.length&&m.charCodeAt(v)!==62;++v);if(++v,b=Fe(m.slice(0,v),!0),b.r||(b.r=je({r:N-1,c:A})),E=m.slice(v),k={t:""},(y=E.match(a))!=null&&y[1]!==""&&(k.v=Qe(y[1])),f.cellFormula){if((y=E.match(i))!=null&&y[1]!==""){if(k.f=Qe(ot(y[1])).replace(/\r\n/g,`
`),f.xlfn||(k.f=Ay(k.f)),y[0].indexOf('t="array"')>-1)k.F=(E.match(s)||[])[1],k.F.indexOf(":")>-1&&z.push([Ze(k.F),k.F]);else if(y[0].indexOf('t="shared"')>-1){V=Fe(y[0]);var ae=Qe(ot(y[1]));f.xlfn||(ae=Ay(ae)),q[parseInt(V.si,10)]=[V,ae,b.r]}}else(y=E.match(/<f[^>]*\/>/))&&(V=Fe(y[0]),q[V.si]&&(k.f=EU(q[V.si][1],q[V.si][2],b.r)));var se=St(b.r);for(v=0;v<z.length;++v)se.r>=z[v][0].s.r&&se.r<=z[v][0].e.r&&se.c>=z[v][0].s.c&&se.c<=z[v][0].e.c&&(k.F=z[v][1])}if(b.t==null&&k.v===void 0)if(k.f||k.F)k.v=0,k.t="n";else if(j)k.t="z";else continue;else k.t=b.t||"n";switch(d.s.c>A&&(d.s.c=A),d.e.c<A&&(d.e.c=A),k.t){case"n":if(k.v==""||k.v==null){if(!j)continue;k.t="z"}else k.v=parseFloat(k.v);break;case"s":if(typeof k.v>"u"){if(!j)continue;k.t="z"}else O=cc[parseInt(k.v,10)],k.v=O.t,k.r=O.r,f.cellHTML&&(k.h=O.h);break;case"str":k.t="s",k.v=k.v!=null?ot(k.v):"",f.cellHTML&&(k.h=Pg(k.v));break;case"inlineStr":y=E.match(n),k.t="s",y!=null&&(O=Hg(y[1]))?(k.v=O.t,f.cellHTML&&(k.h=O.h)):k.v="";break;case"b":k.v=ht(k.v);break;case"d":f.cellDates?k.v=mt(k.v,1):(k.v=Yt(mt(k.v,1)),k.t="n");break;case"e":(!f||f.cellText!==!1)&&(k.w=k.v),k.v=ST[k.v];break}if(C=B=0,X=null,G&&b.s!==void 0&&(X=p.CellXf[b.s],X!=null&&(X.numFmtId!=null&&(C=X.numFmtId),f.cellStyles&&X.fillId!=null&&(B=X.fillId))),yN(k,C,B,f,h,p),f.cellDates&&G&&k.t=="n"&&ml(Ae[C])&&(k.t="d",k.v=A0(k.v)),b.cm&&f.xlmeta){var de=(f.xlmeta.Cell||[])[+b.cm-1];de&&de.type=="XLDAPR"&&(k.D=!0)}if(K){var I=St(b.r);u[I.r]||(u[I.r]=[]),u[I.r][I.c]=k}else u[b.r]=k}}}}F.length>0&&(u["!rows"]=F)}}();function jz(e,t,r,n){var s=[],a=[],i=Ze(e["!ref"]),o="",c,u="",f=[],d=0,h=0,p=e["!rows"],g=Array.isArray(e),m={r:u},x,y=-1;for(h=i.s.c;h<=i.e.c;++h)f[h]=bt(h);for(d=i.s.r;d<=i.e.r;++d){for(a=[],u=Dt(d),h=i.s.c;h<=i.e.c;++h){c=f[h]+u;var w=g?(e[d]||[])[h]:e[c];w!==void 0&&(o=Cz(w,c,e,t))!=null&&a.push(o)}(a.length>0||p&&p[d])&&(m={r:u},p&&p[d]&&(x=p[d],x.hidden&&(m.hidden=1),y=-1,x.hpx?y=Jc(x.hpx):x.hpt&&(y=x.hpt),y>-1&&(m.ht=y,m.customHeight=1),x.level&&(m.outlineLevel=x.level)),s[s.length]=ve("row",a.join(""),m))}if(p)for(;d<p.length;++d)p&&p[d]&&(m={r:d+1},x=p[d],x.hidden&&(m.hidden=1),y=-1,x.hpx?y=Jc(x.hpx):x.hpt&&(y=x.hpt),y>-1&&(m.ht=y,m.customHeight=1),x.level&&(m.outlineLevel=x.level),s[s.length]=ve("row","",m));return s.join("")}function bN(e,t,r,n){var s=[Mt,ve("worksheet",null,{xmlns:Hi[0],"xmlns:r":Kt.r})],a=r.SheetNames[e],i=0,o="",c=r.Sheets[a];c==null&&(c={});var u=c["!ref"]||"A1",f=Ze(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=$e(f)}n||(n={}),c["!comments"]=[];var d=[];pz(c,r,e,t,s),s[s.length]=ve("dimension",null,{ref:u}),s[s.length]=Nz(c,t,e,r),t.sheetFormat&&(s[s.length]=ve("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(s[s.length]=bz(c,c["!cols"])),s[i=s.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=jz(c,t),o.length>0&&(s[s.length]=o)),s.length>i+1&&(s[s.length]="</sheetData>",s[i]=s[i].replace("/>",">")),c["!protect"]&&(s[s.length]=gz(c["!protect"])),c["!autofilter"]!=null&&(s[s.length]=kz(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(s[s.length]=dz(c["!merges"]));var h=-1,p,g=-1;return c["!links"].length>0&&(s[s.length]="<hyperlinks>",c["!links"].forEach(function(m){m[1].Target&&(p={ref:m[0]},m[1].Target.charAt(0)!="#"&&(g=nt(n,-1,st(m[1].Target).replace(/#.*$/,""),qe.HLINK),p["r:id"]="rId"+g),(h=m[1].Target.indexOf("#"))>-1&&(p.location=st(m[1].Target.slice(h+1))),m[1].Tooltip&&(p.tooltip=st(m[1].Tooltip)),s[s.length]=ve("hyperlink",null,p))}),s[s.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(s[s.length]=yz(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(s[s.length]=cr("ignoredErrors",ve("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(g=nt(n,-1,"../drawings/drawing"+(e+1)+".xml",qe.DRAW),s[s.length]=ve("drawing",null,{"r:id":"rId"+g}),c["!drawing"]=d),c["!comments"].length>0&&(g=nt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",qe.VML),s[s.length]=ve("legacyDrawing",null,{"r:id":"rId"+g}),c["!legacy"]=g),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function Pz(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var s=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=s/20),r}function Rz(e,t,r){var n=ie(145),s=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;s.hpx?a=Jc(s.hpx)*20:s.hpt&&(a=s.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var i=0;s.level&&(i|=s.level),s.hidden&&(i|=16),(s.hpx||s.hpt)&&(i|=32),n.write_shift(1,i),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,h=-1,p=f<<10;p<f+1<<10;++p){u.c=p;var g=Array.isArray(r)?(r[u.r]||[])[u.c]:r[je(u)];g&&(d<0&&(d=p),h=p)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,h))}var m=n.l;return n.l=c,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function Fz(e,t,r,n){var s=Rz(n,r,t);(s.length>17||(t["!rows"]||[])[n])&&ce(e,0,s)}var Oz=Xi,Iz=vl;function Dz(){}function Lz(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=UL(e),r}function Mz(e,t,r){r==null&&(r=ie(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var s=1;s<3;++s)r.write_shift(1,0);return Fd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),vT(e,r),r.slice(0,r.l)}function Bz(e){var t=Fn(e);return[t]}function Uz(e,t,r){return r==null&&(r=ie(8)),Gi(t,r)}function $z(e){var t=qi(e);return[t]}function zz(e,t,r){return r==null&&(r=ie(4)),Ki(t,r)}function Wz(e){var t=Fn(e),r=e.read_shift(1);return[t,r,"b"]}function Vz(e,t,r){return r==null&&(r=ie(9)),Gi(t,r),r.write_shift(1,e.v?1:0),r}function Hz(e){var t=qi(e),r=e.read_shift(1);return[t,r,"b"]}function Gz(e,t,r){return r==null&&(r=ie(5)),Ki(t,r),r.write_shift(1,e.v?1:0),r}function qz(e){var t=Fn(e),r=e.read_shift(1);return[t,r,"e"]}function Kz(e,t,r){return r==null&&(r=ie(9)),Gi(t,r),r.write_shift(1,e.v),r}function Xz(e){var t=qi(e),r=e.read_shift(1);return[t,r,"e"]}function Yz(e,t,r){return r==null&&(r=ie(8)),Ki(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function Jz(e){var t=Fn(e),r=e.read_shift(4);return[t,r,"s"]}function Qz(e,t,r){return r==null&&(r=ie(12)),Gi(t,r),r.write_shift(4,t.v),r}function Zz(e){var t=qi(e),r=e.read_shift(4);return[t,r,"s"]}function eW(e,t,r){return r==null&&(r=ie(8)),Ki(t,r),r.write_shift(4,t.v),r}function tW(e){var t=Fn(e),r=br(e);return[t,r,"n"]}function rW(e,t,r){return r==null&&(r=ie(16)),Gi(t,r),Fi(e.v,r),r}function SN(e){var t=qi(e),r=br(e);return[t,r,"n"]}function nW(e,t,r){return r==null&&(r=ie(12)),Ki(t,r),Fi(e.v,r),r}function sW(e){var t=Fn(e),r=Ug(e);return[t,r,"n"]}function aW(e,t,r){return r==null&&(r=ie(12)),Gi(t,r),wT(e.v,r),r}function iW(e){var t=qi(e),r=Ug(e);return[t,r,"n"]}function oW(e,t,r){return r==null&&(r=ie(8)),Ki(t,r),wT(e.v,r),r}function lW(e){var t=Fn(e),r=Lg(e);return[t,r,"is"]}function cW(e){var t=Fn(e),r=Sr(e);return[t,r,"str"]}function uW(e,t,r){return r==null&&(r=ie(12+4*e.v.length)),Gi(t,r),tr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function fW(e){var t=qi(e),r=Sr(e);return[t,r,"str"]}function dW(e,t,r){return r==null&&(r=ie(8+4*e.v.length)),Ki(t,r),tr(e.v,r),r.length>r.l?r.slice(0,r.l):r}function hW(e,t,r){var n=e.l+t,s=Fn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"b"];if(r.cellFormula){e.l+=2;var o=R0(e,n-e.l,r);i[3]=wr(o,null,s,r.supbooks,r)}else e.l=n;return i}function pW(e,t,r){var n=e.l+t,s=Fn(e);s.r=r["!row"];var a=e.read_shift(1),i=[s,a,"e"];if(r.cellFormula){e.l+=2;var o=R0(e,n-e.l,r);i[3]=wr(o,null,s,r.supbooks,r)}else e.l=n;return i}function mW(e,t,r){var n=e.l+t,s=Fn(e);s.r=r["!row"];var a=br(e),i=[s,a,"n"];if(r.cellFormula){e.l+=2;var o=R0(e,n-e.l,r);i[3]=wr(o,null,s,r.supbooks,r)}else e.l=n;return i}function xW(e,t,r){var n=e.l+t,s=Fn(e);s.r=r["!row"];var a=Sr(e),i=[s,a,"str"];if(r.cellFormula){e.l+=2;var o=R0(e,n-e.l,r);i[3]=wr(o,null,s,r.supbooks,r)}else e.l=n;return i}var gW=Xi,vW=vl;function wW(e,t){return t==null&&(t=ie(4)),t.write_shift(4,e),t}function yW(e,t){var r=e.l+t,n=Xi(e),s=Mg(e),a=Sr(e),i=Sr(e),o=Sr(e);e.l=r;var c={rfx:n,relId:s,loc:a,display:o};return i&&(c.Tooltip=i),c}function _W(e,t){var r=ie(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));vl({s:St(e[0]),e:St(e[0])},r),Bg("rId"+t,r);var n=e[1].Target.indexOf("#"),s=n==-1?"":e[1].Target.slice(n+1);return tr(s||"",r),tr(e[1].Tooltip||"",r),tr("",r),r.slice(0,r.l)}function bW(){}function SW(e,t,r){var n=e.l+t,s=yT(e),a=e.read_shift(1),i=[s];if(i[2]=a,r.cellFormula){var o=q$(e,n-e.l,r);i[1]=o}else e.l=n;return i}function kW(e,t,r){var n=e.l+t,s=Xi(e),a=[s];if(r.cellFormula){var i=X$(e,n-e.l,r);a[1]=i,e.l=n}else e.l=n;return a}function EW(e,t,r){r==null&&(r=ie(18));var n=F0(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var s=0;return t.hidden&&(s|=1),typeof n.width=="number"&&(s|=2),t.level&&(s|=t.level<<8),r.write_shift(2,s),r}var kN=["left","right","top","bottom","header","footer"];function TW(e){var t={};return kN.forEach(function(r){t[r]=br(e)}),t}function NW(e,t){return t==null&&(t=ie(6*8)),yi(e),kN.forEach(function(r){Fi(e[r],t)}),t}function CW(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function AW(e,t,r){r==null&&(r=ie(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function jW(e){var t=ie(24);return t.write_shift(4,4),t.write_shift(4,1),vl(e,t),t}function PW(e,t){return t==null&&(t=ie(16*4+2)),t.write_shift(2,e.password?Gg(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function RW(){}function FW(){}function OW(e,t,r,n,s,a,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var c=o.dense?[]:{},u,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,p,g,m,x,y,w,v,S,E,k=[];o.biff=12,o["!row"]=0;var b=0,N=!1,A=[],O={},V=o.supbooks||s.supbooks||[[]];if(V.sharedf=O,V.arrayf=A,V.SheetNames=s.SheetNames||s.Sheets.map(function(K){return K.name}),!o.supbooks&&(o.supbooks=V,s.Names))for(var C=0;C<s.Names.length;++C)V[0][C+1]=s.Names[C];var B=[],G=[],X=!1;Qc[16]={n:"BrtShortReal",f:SN};var z;if(Zs(e,function(F,ne,Y){if(!h)switch(Y){case 148:u=F;break;case 0:p=F,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),S=Dt(x=p.r),o["!row"]=p.r,(F.hidden||F.hpt||F.level!=null)&&(F.hpt&&(F.hpx=rl(F.hpt)),G[F.r]=F);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(g={t:F[2]},F[2]){case"n":g.v=F[1];break;case"s":v=cc[F[1]],g.v=v.t,g.r=v.r;break;case"b":g.v=!!F[1];break;case"e":g.v=F[1],o.cellText!==!1&&(g.w=ea[g.v]);break;case"str":g.t="s",g.v=F[1];break;case"is":g.t="s",g.v=F[1].t;break}if((m=i.CellXf[F[0].iStyleRef])&&yN(g,m.numFmtId,null,o,a,i),y=F[0].c==-1?y+1:F[0].c,o.dense?(c[x]||(c[x]=[]),c[x][y]=g):c[bt(y)+S]=g,o.cellFormula){for(N=!1,b=0;b<A.length;++b){var j=A[b];p.r>=j[0].s.r&&p.r<=j[0].e.r&&y>=j[0].s.c&&y<=j[0].e.c&&(g.F=$e(j[0]),N=!0)}!N&&F.length>3&&(g.f=F[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>y&&(f.s.c=y),f.e.r<p.r&&(f.e.r=p.r),f.e.c<y&&(f.e.c=y),o.cellDates&&m&&g.t=="n"&&ml(Ae[m.numFmtId])){var H=pi(g.v);H&&(g.t="d",g.v=new Date(H.y,H.m-1,H.d,H.H,H.M,H.S,H.u))}z&&(z.type=="XLDAPR"&&(g.D=!0),z=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;g={t:"z",v:void 0},y=F[0].c==-1?y+1:F[0].c,o.dense?(c[x]||(c[x]=[]),c[x][y]=g):c[bt(y)+S]=g,f.s.r>p.r&&(f.s.r=p.r),f.s.c>y&&(f.s.c=y),f.e.r<p.r&&(f.e.r=p.r),f.e.c<y&&(f.e.c=y),z&&(z.type=="XLDAPR"&&(g.D=!0),z=void 0);break;case 176:k.push(F);break;case 49:z=((o.xlmeta||{}).Cell||[])[F-1];break;case 494:var U=n["!id"][F.relId];for(U?(F.Target=U.Target,F.loc&&(F.Target+="#"+F.loc),F.Rel=U):F.relId==""&&(F.Target="#"+F.loc),x=F.rfx.s.r;x<=F.rfx.e.r;++x)for(y=F.rfx.s.c;y<=F.rfx.e.c;++y)o.dense?(c[x]||(c[x]=[]),c[x][y]||(c[x][y]={t:"z",v:void 0}),c[x][y].l=F):(w=je({c:y,r:x}),c[w]||(c[w]={t:"z",v:void 0}),c[w].l=F);break;case 426:if(!o.cellFormula)break;A.push(F),E=o.dense?c[x][y]:c[bt(y)+S],E.f=wr(F[1],f,{r:p.r,c:y},V,o),E.F=$e(F[0]);break;case 427:if(!o.cellFormula)break;O[je(F[0].s)]=F[1],E=o.dense?c[x][y]:c[bt(y)+S],E.f=wr(F[1],f,{r:p.r,c:y},V,o);break;case 60:if(!o.cellStyles)break;for(;F.e>=F.s;)B[F.e--]={width:F.w/256,hidden:!!(F.flags&1),level:F.level},X||(X=!0,qg(F.w/256)),La(B[F.e+1]);break;case 161:c["!autofilter"]={ref:$e(F)};break;case 476:c["!margins"]=F;break;case 147:s.Sheets[r]||(s.Sheets[r]={}),F.name&&(s.Sheets[r].CodeName=F.name),(F.above||F.left)&&(c["!outline"]={above:F.above,left:F.left});break;case 137:s.Views||(s.Views=[{}]),s.Views[0]||(s.Views[0]={}),F.RTL&&(s.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!ne.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+Y.toString(16))}}},o),delete o.supbooks,delete o["!row"],!c["!ref"]&&(f.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(c["!ref"]=$e(u||f)),o.sheetRows&&c["!ref"]){var q=Ze(c["!ref"]);o.sheetRows<=+q.e.r&&(q.e.r=o.sheetRows-1,q.e.r>f.e.r&&(q.e.r=f.e.r),q.e.r<q.s.r&&(q.s.r=q.e.r),q.e.c>f.e.c&&(q.e.c=f.e.c),q.e.c<q.s.c&&(q.s.c=q.e.c),c["!fullref"]=c["!ref"],c["!ref"]=$e(q))}return k.length>0&&(c["!merges"]=k),B.length>0&&(c["!cols"]=B),G.length>0&&(c["!rows"]=G),c}function IW(e,t,r,n,s,a,i){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=xt(t),t.z=t.z||Ae[14],t.v=Yt(mt(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=Ya(s.cellXfs,t,s),t.l&&a["!links"].push([je(c),t.l]),t.c&&a["!comments"].push([je(c),t.c]),t.t){case"s":case"str":return s.bookSST?(o=Qg(s.Strings,t.v,s.revStrings),c.t="s",c.v=o,i?ce(e,18,eW(t,c)):ce(e,7,Qz(t,c))):(c.t="str",i?ce(e,17,dW(t,c)):ce(e,6,uW(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?i?ce(e,13,oW(t,c)):ce(e,2,aW(t,c)):i?ce(e,16,nW(t,c)):ce(e,5,rW(t,c)),!0;case"b":return c.t="b",i?ce(e,15,Gz(t,c)):ce(e,4,Vz(t,c)),!0;case"e":return c.t="e",i?ce(e,14,Yz(t,c)):ce(e,3,Kz(t,c)),!0}return i?ce(e,12,zz(t,c)):ce(e,1,Uz(t,c)),!0}function DW(e,t,r,n){var s=Ze(t["!ref"]||"A1"),a,i="",o=[];ce(e,145);var c=Array.isArray(t),u=s.e.r;t["!rows"]&&(u=Math.max(s.e.r,t["!rows"].length-1));for(var f=s.s.r;f<=u;++f){i=Dt(f),Fz(e,t,s,f);var d=!1;if(f<=s.e.r)for(var h=s.s.c;h<=s.e.c;++h){f===s.s.r&&(o[h]=bt(h)),a=o[h]+i;var p=c?(t[f]||[])[h]:t[a];if(!p){d=!1;continue}d=IW(e,p,f,h,n,t,d)}}ce(e,146)}function LW(e,t){!t||!t["!merges"]||(ce(e,177,wW(t["!merges"].length)),t["!merges"].forEach(function(r){ce(e,176,vW(r))}),ce(e,178))}function MW(e,t){!t||!t["!cols"]||(ce(e,390),t["!cols"].forEach(function(r,n){r&&ce(e,60,EW(n,r))}),ce(e,391))}function BW(e,t){!t||!t["!ref"]||(ce(e,648),ce(e,649,jW(Ze(t["!ref"]))),ce(e,650))}function UW(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var s=nt(r,-1,n[1].Target.replace(/#.*$/,""),qe.HLINK);ce(e,494,_W(n,s))}}),delete t["!links"]}function $W(e,t,r,n){if(t["!comments"].length>0){var s=nt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",qe.VML);ce(e,551,Bg("rId"+s)),t["!legacy"]=s}}function zW(e,t,r,n){if(t["!autofilter"]){var s=t["!autofilter"],a=typeof s.ref=="string"?s.ref:$e(s.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,o=qr(a);o.s.r==o.e.r&&(o.e.r=qr(t["!ref"]).e.r,a=$e(o));for(var c=0;c<i.length;++c){var u=i[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),ce(e,161,vl(Ze(a))),ce(e,162)}}function WW(e,t,r){ce(e,133),ce(e,137,AW(t,r)),ce(e,138),ce(e,134)}function VW(e,t){t["!protect"]&&ce(e,535,PW(t["!protect"]))}function HW(e,t,r,n){var s=Gr(),a=r.SheetNames[e],i=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=Ze(i["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return i["!links"]=[],i["!comments"]=[],ce(s,129),(r.vbaraw||i["!outline"])&&ce(s,147,Mz(o,i["!outline"])),ce(s,148,Iz(c)),WW(s,i,r.Workbook),MW(s,i),DW(s,i,e,t),VW(s,i),zW(s,i,r,e),LW(s,i),UW(s,i,n),i["!margins"]&&ce(s,476,NW(i["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&BW(s,i),$W(s,i,e,n),ce(s,130),s.end()}function GW(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(a){var i=a.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var s=Qe((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(a){n=a.replace(/<.*?>/g,"")}),[t,s,n]}function qW(e,t,r,n,s,a){var i=a||{"!type":"chart"};if(!e)return a;var o=0,c=0,u="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=GW(d);f.s.r=f.s.c=0,f.e.c=o,u=bt(o),h[0].forEach(function(p,g){i[u+Dt(g)]={t:"n",v:p,z:h[1]},c=g}),f.e.r<c&&(f.e.r=c),++o}),o>0&&(i["!ref"]=$e(f)),i}function KW(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(_N);return o&&Zg(o[0],a,s,r),(i=e.match(/drawing r:id="(.*?)"/))&&(a["!rel"]=i[1]),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}function XW(e,t){e.l+=10;var r=Sr(e);return{name:r}}function YW(e,t,r,n,s){if(!e)return e;n||(n={"!id":{}});var a={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Zs(e,function(c,u,f){switch(f){case 550:a["!rel"]=c;break;case 651:s.Sheets[r]||(s.Sheets[r]={}),c.name&&(s.Sheets[r].CodeName=c.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][a["!rel"]]&&(a["!drawel"]=n["!id"][a["!rel"]]),a}var ev=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],JW=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],QW=[],ZW=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Oy(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],s=0;s!=t.length;++s){var a=t[s];if(n[a[0]]==null)n[a[0]]=a[1];else switch(a[2]){case"bool":typeof n[a[0]]=="string"&&(n[a[0]]=ht(n[a[0]]));break;case"int":typeof n[a[0]]=="string"&&(n[a[0]]=parseInt(n[a[0]],10));break}}}function Iy(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=ht(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function EN(e){Iy(e.WBProps,ev),Iy(e.CalcPr,ZW),Oy(e.WBView,JW),Oy(e.Sheets,QW),zo.date1904=ht(e.WBProps.date1904)}function eV(e){return!e.Workbook||!e.Workbook.WBProps?"false":ht(e.Workbook.WBProps.date1904)?"true":"false"}var tV="][*?/\\".split("");function TN(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return tV.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function rV(e,t,r){e.forEach(function(n,s){TN(n);for(var a=0;a<s;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var i=t&&t[s]&&t[s].CodeName||n;if(i.charCodeAt(0)==95&&i.length>22)throw new Error("Bad Code Name: Worksheet"+i)}})}function nV(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];rV(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)ez(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var sV=/<\w+:workbook/;function aV(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,s="xmlns",a={},i=0;if(e.replace(Tr,function(c,u){var f=Fe(c);switch(Ts(f[0])){case"<?xml":break;case"<workbook":c.match(sV)&&(s="xmlns"+c.match(/<(\w+):/)[1]),r.xmlns=f[s];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":ev.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=ht(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=ot(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=Qe(ot(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":a={},a.Name=ot(f.name),f.comment&&(a.Comment=f.comment),f.localSheetId&&(a.Sheet=+f.localSheetId),ht(f.hidden||"0")&&(a.Hidden=!0),i=u+c.length;break;case"</definedName>":a.Ref=Qe(ot(e.slice(i,u))),r.Names.push(a);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return c}),Hi.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return EN(r),r}function NN(e){var t=[Mt];t[t.length]=ve("workbook",null,{xmlns:Hi[0],"xmlns:r":Kt.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(ev.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=ve("workbookPr",null,n);var s=e.Workbook&&e.Workbook.Sheets||[],a=0;if(s&&s[0]&&s[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!s[a]||!s[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var i={name:st(e.SheetNames[a].slice(0,31))};if(i.sheetId=""+(a+1),i["r:id"]="rId"+(a+1),s[a])switch(s[a].Hidden){case 1:i.state="hidden";break;case 2:i.state="veryHidden";break}t[t.length]=ve("sheet",null,i)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=ve("definedName",st(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function iV(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=jm(e),r.name=Sr(e),r}function oV(e,t){return t||(t=ie(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Bg(e.strRelID,t),tr(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function lV(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var s=t>8?Sr(e):"";return s.length>0&&(r.CodeName=s),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function cV(e,t){t||(t=ie(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),vT(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function uV(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function fV(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var s=e.read_shift(4),a=$L(e),i=K$(e,0,r),o=Mg(e);e.l=n;var c={Name:a,Ptg:i};return s<268435455&&(c.Sheet=s),o&&(c.Comment=o),c}function dV(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],s=!1;t||(t={}),t.biff=12;var a=[],i=[[]];return i.SheetNames=[],i.XTI=[],Qc[16]={n:"BrtFRTArchID$",f:uV},Zs(e,function(c,u,f){switch(f){case 156:i.SheetNames.push(c.name),r.Sheets.push(c);break;case 153:r.WBProps=c;break;case 39:c.Sheet!=null&&(t.SID=c.Sheet),c.Ref=wr(c.Ptg,null,null,i,t),delete t.SID,delete c.Ptg,a.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,c]):i[0]=[f,c],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(c),i.XTI=i.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),s=!0;break;case 36:n.pop(),s=!1;break;case 37:n.push(f),s=!0;break;case 38:n.pop(),s=!1;break;case 16:break;default:if(!u.T){if(!s||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),EN(r),r.Names=a,r.supbooks=i,r}function hV(e,t){ce(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,s={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};ce(e,156,oV(s))}ce(e,144)}function pV(e,t){t||(t=ie(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return tr("SheetJS",t),tr(Td.version,t),tr(Td.version,t),tr("7262",t),t.length>t.l?t.slice(0,t.l):t}function mV(e,t){t||(t=ie(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function xV(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,s=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&s==-1?s=n:r[n].Hidden==1&&a==-1&&(a=n);a>s||(ce(e,135),ce(e,158,mV(s)),ce(e,136))}}function gV(e,t){var r=Gr();return ce(r,131),ce(r,128,pV()),ce(r,153,cV(e.Workbook&&e.Workbook.WBProps||null)),xV(r,e),hV(r,e),ce(r,132),r.end()}function vV(e,t,r){return t.slice(-4)===".bin"?dV(e,r):aV(e,r)}function wV(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?OW(e,n,r,s,a,i,o):fz(e,n,r,s,a,i,o)}function yV(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?YW(e,n,r,s,a):KW(e,n,r,s,a)}function _V(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?SU():kU()}function bV(e,t,r,n,s,a,i,o){return t.slice(-4)===".bin"?_U():bU()}function SV(e,t,r,n){return t.slice(-4)===".bin"?v9(e,r,n):i9(e,r,n)}function kV(e,t,r){return oN(e,r)}function EV(e,t,r){return t.slice(-4)===".bin"?E7(e,r):b7(e,r)}function TV(e,t,r){return t.slice(-4)===".bin"?xU(e,r):oU(e,r)}function NV(e,t,r){return t.slice(-4)===".bin"?sU(e):rU(e)}function CV(e,t,r,n){return r.slice(-4)===".bin"?aU(e,t,r,n):void 0}function AV(e,t,r){return t.slice(-4)===".bin"?Z9(e,t,r):tU(e,t,r)}function jV(e,t,r){return(t.slice(-4)===".bin"?gV:NN)(e)}function PV(e,t,r,n,s){return(t.slice(-4)===".bin"?HW:bN)(e,r,n,s)}function RV(e,t,r){return(t.slice(-4)===".bin"?C9:aN)(e,r)}function FV(e,t,r){return(t.slice(-4)===".bin"?C7:JT)(e,r)}function OV(e,t,r){return(t.slice(-4)===".bin"?gU:uN)(e)}function IV(e){return(e.slice(-4)===".bin"?eU:lN)()}var CN=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,AN=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Mn(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var s=e.match(CN),a,i,o,c;if(s)for(c=0;c!=s.length;++c)a=s[c].match(AN),(i=a[1].indexOf(":"))===-1?n[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?o="xmlns"+a[1].slice(6):o=a[1].slice(i+1),n[o]=a[2].slice(1,a[2].length-1));return n}function DV(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(CN),s,a,i,o;if(n)for(o=0;o!=n.length;++o)s=n[o].match(AN),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?i="xmlns"+s[1].slice(6):i=s[1].slice(a+1),r[i]=s[2].slice(1,s[2].length-1));return r}var fc;function LV(e,t){var r=fc[e]||Qe(e);return r==="General"?Pi(t):Rn(r,t)}function MV(e,t,r,n){var s=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":s=ht(n);break;case"i2":case"int":s=parseInt(n,10);break;case"r4":case"float":s=parseFloat(n);break;case"date":case"dateTime.tz":s=mt(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Qe(t)]=s}function BV(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ea[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wc(e.v):e.w=Pi(e.v):e.w=LV(t||"General",e.v)}catch(a){if(r.WTF)throw a}try{var n=fc[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ml(n)){var s=pi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}catch(a){if(r.WTF)throw a}}}function UV(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=Q7[n.Pattern]||n.Pattern)}e[t.ID]=t}function $V(e,t,r,n,s,a,i,o,c,u){var f="General",d=n.StyleID,h={};u=u||{};var p=[],g=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);a[d]!==void 0&&(a[d].nf&&(f=a[d].nf),a[d].Interior&&p.push(a[d].Interior),!!a[d].Parent);)d=a[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=ht(e);break;case"String":n.t="s",n.r=Qw(Qe(e)),n.v=e.indexOf("<")>-1?Qe(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(mt(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=Qe(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=ST[e],u.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Qw(t||e));break}if(BV(n,f,u),u.cellFormula!==!1)if(n.Formula){var m=Qe(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=$o(m,s),delete n.Formula,n.ArrayRange=="RC"?n.F=$o("RC:RC",s):n.ArrayRange&&(n.F=$o(n.ArrayRange,s),c.push([Ze(n.F),n.F]))}else for(g=0;g<c.length;++g)s.r>=c[g][0].s.r&&s.r<=c[g][0].e.r&&s.c>=c[g][0].s.c&&s.c<=c[g][0].e.c&&(n.F=c[g][1]);u.cellStyles&&(p.forEach(function(x){!h.patternType&&x.patternType&&(h.patternType=x.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function zV(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Yh(e,t){var r=t||{};xl();var n=Wl(Rg(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=ot(n));var s=n.slice(0,1024).toLowerCase(),a=!1;if(s=s.replace(/".*?"/g,""),(s.indexOf(">")&1023)>Math.min(s.indexOf(",")&1023,s.indexOf(";")&1023)){var i=xt(r);return i.type="string",tl.to_workbook(n,i)}if(s.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(it){s.indexOf("<"+it)>=0&&(a=!0)}),a)return NH(n,r);fc={"General Number":"General","General Date":Ae[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ae[15],"Short Date":Ae[14],"Long Time":Ae[19],"Medium Time":Ae[18],"Short Time":Ae[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ae[2],Standard:Ae[4],Percent:Ae[10],Scientific:Ae[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,c=[],u,f={},d=[],h=r.dense?[]:{},p="",g={},m={},x=Mn('<Data ss:Type="String">'),y=0,w=0,v=0,S={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},k={},b="",N=0,A=[],O={},V={},C=0,B=[],G=[],X={},z=[],q,K=!1,F=[],ne=[],Y={},j=0,H=0,U={Sheets:[],WBProps:{date1904:!1}},W={};Gc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var J="";o=Gc.exec(n);)switch(o[3]=(J=o[3]).toLowerCase()){case"data":if(J=="data"){if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break}if(c[c.length-1][1])break;o[1]==="/"?$V(n.slice(y,o.index),b,x,c[c.length-1][0]=="comment"?X:g,{c:w,r:v},E,z[w],m,F,r):(b="",x=Mn(o[0]),y=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(G.length>0&&(g.c=G),(!r.sheetRows||r.sheetRows>v)&&g.v!==void 0&&(r.dense?(h[v]||(h[v]=[]),h[v][w]=g):h[bt(w)+Dt(v)]=g),g.HRef&&(g.l={Target:Qe(g.HRef)},g.HRefScreenTip&&(g.l.Tooltip=g.HRefScreenTip),delete g.HRef,delete g.HRefScreenTip),(g.MergeAcross||g.MergeDown)&&(j=w+(parseInt(g.MergeAcross,10)|0),H=v+(parseInt(g.MergeDown,10)|0),A.push({s:{c:w,r:v},e:{c:j,r:H}})),!r.sheetStubs)g.MergeAcross?w=j+1:++w;else if(g.MergeAcross||g.MergeDown){for(var te=w;te<=j;++te)for(var oe=v;oe<=H;++oe)(te>w||oe>v)&&(r.dense?(h[oe]||(h[oe]=[]),h[oe][te]={t:"z"}):h[bt(te)+Dt(oe)]={t:"z"});w=j+1}else++w;else g=DV(o[0]),g.Index&&(w=+g.Index-1),w<S.s.c&&(S.s.c=w),w>S.e.c&&(S.e.c=w),o[0].slice(-2)==="/>"&&++w,G=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(v<S.s.r&&(S.s.r=v),v>S.e.r&&(S.e.r=v),o[0].slice(-2)==="/>"&&(m=Mn(o[0]),m.Index&&(v=+m.Index-1)),w=0,++v):(m=Mn(o[0]),m.Index&&(v=+m.Index-1),Y={},(m.AutoFitHeight=="0"||m.Height)&&(Y.hpx=parseInt(m.Height,10),Y.hpt=Jc(Y.hpx),ne[v]=Y),m.Hidden=="1"&&(Y.hidden=!0,ne[v]=Y));break;case"worksheet":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));d.push(p),S.s.r<=S.e.r&&S.s.c<=S.e.c&&(h["!ref"]=$e(S),r.sheetRows&&r.sheetRows<=S.e.r&&(h["!fullref"]=h["!ref"],S.e.r=r.sheetRows-1,h["!ref"]=$e(S))),A.length&&(h["!merges"]=A),z.length>0&&(h["!cols"]=z),ne.length>0&&(h["!rows"]=ne),f[p]=h}else S={s:{r:2e6,c:2e6},e:{r:0,c:0}},v=w=0,c.push([o[3],!1]),u=Mn(o[0]),p=Qe(u.Name),h=r.dense?[]:{},A=[],F=[],ne=[],W={name:p,Hidden:0},U.Sheets.push(W);break;case"table":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;c.push([o[3],!1]),z=[],K=!1}break;case"style":o[1]==="/"?UV(E,k,r):k=Mn(o[0]);break;case"numberformat":k.nf=Qe(Mn(o[0]).Format||"General"),fc[k.nf]&&(k.nf=fc[k.nf]);for(var ae=0;ae!=392&&Ae[ae]!=k.nf;++ae);if(ae==392){for(ae=57;ae!=392;++ae)if(Ae[ae]==null){$s(k.nf,ae);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(q=Mn(o[0]),q.Hidden&&(q.hidden=!0,delete q.Hidden),q.Width&&(q.wpx=parseInt(q.Width,10)),!K&&q.wpx>10){K=!0,_r=nN;for(var se=0;se<z.length;++se)z[se]&&La(z[se])}K&&La(q),z[q.Index-1||z.length]=q;for(var de=0;de<+q.Span;++de)z[z.length]=xt(q);break;case"namedrange":if(o[1]==="/")break;U.Names||(U.Names=[]);var I=Fe(o[0]),Be={Name:I.Name,Ref:$o(I.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(Be.Sheet=U.Sheets.length-1),U.Names.push(Be);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?b+=n.slice(N,o.index):N=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=Mn(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?dM(O,J,n.slice(C,o.index)):C=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else c.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));zV(X),G.push(X)}else c.push([o[3],!1]),u=Mn(o[0]),X={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Re=Mn(o[0]);h["!autofilter"]={ref:$o(Re.Range).replace(/\$/g,"")},c.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=c.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&c.push([o[3],!0]);break;case"null":break;default:if(c.length==0&&o[3]=="document"||c.length==0&&o[3]=="uof")return Uy(n,r);var Ve=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ve=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ve=!1}break;case"excelworkbook":switch(o[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ve=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:Ve=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(C,o.index)){case"SheetHidden":W.Hidden=1;break;case"SheetVeryHidden":W.Hidden=2;break}else C=o.index+o[0].length;break;case"header":h["!margins"]||yi(h["!margins"]={},"xlml"),isNaN(+Fe(o[0]).Margin)||(h["!margins"].header=+Fe(o[0]).Margin);break;case"footer":h["!margins"]||yi(h["!margins"]={},"xlml"),isNaN(+Fe(o[0]).Margin)||(h["!margins"].footer=+Fe(o[0]).Margin);break;case"pagemargins":var Oe=Fe(o[0]);h["!margins"]||yi(h["!margins"]={},"xlml"),isNaN(+Oe.Top)||(h["!margins"].top=+Oe.Top),isNaN(+Oe.Left)||(h["!margins"].left=+Oe.Left),isNaN(+Oe.Right)||(h["!margins"].right=+Oe.Right),isNaN(+Oe.Bottom)||(h["!margins"].bottom=+Oe.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ve=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ve=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ve=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ve=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ve=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ve=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ve=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ve=!1}break;case"smarttags":break;default:Ve=!1;break}if(Ve||o[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?MV(V,J,B,n.slice(C,o.index)):(B=o,C=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+c.join("|")}var xe={};return!r.bookSheets&&!r.bookProps&&(xe.Sheets=f),xe.SheetNames=d,xe.Workbook=U,xe.SSF=xt(Ae),xe.Props=O,xe.Custprops=V,xe}function Lm(e,t){switch(rv(t=t||{}),t.type||"base64"){case"base64":return Yh(dn(e),t);case"binary":case"buffer":case"file":return Yh(e,t);case"array":return Yh(Ka(e),t)}}function WV(e,t){var r=[];return e.Props&&r.push(hM(e.Props,t)),e.Custprops&&r.push(pM(e.Props,e.Custprops)),r.join("")}function VV(){return""}function HV(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,s){var a=[];a.push(ve("NumberFormat",null,{"ss:Format":st(Ae[n.numFmtId])}));var i={"ss:ID":"s"+(21+s)};r.push(ve("Style",a.join(""),i))}),ve("Styles",r.join(""))}function jN(e){return ve("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Yg(e.Ref,{r:0,c:0})})}function GV(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var s=t[n];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||r.push(jN(s)))}return ve("Names",r.join(""))}function qV(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var s=n.Workbook.Names,a=[],i=0;i<s.length;++i){var o=s[i];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(jN(o)))}return a.join("")}function KV(e,t,r,n){if(!e)return"";var s=[];if(e["!margins"]&&(s.push("<PageSetup>"),e["!margins"].header&&s.push(ve("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&s.push(ve("Footer",null,{"x:Margin":e["!margins"].footer})),s.push(ve("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),s.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)s.push(ve("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&s.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),e["!protect"]&&(s.push(cr("ProtectContents","True")),e["!protect"].objects&&s.push(cr("ProtectObjects","True")),e["!protect"].scenarios&&s.push(cr("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?s.push(cr("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&s.push(cr("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(i){e["!protect"][i[0]]&&s.push("<"+i[1]+"/>")})),s.length==0?"":ve("WorksheetOptions",s.join(""),{xmlns:en.x})}function XV(e){return e.map(function(t){var r=xL(t.t||""),n=ve("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return ve("Comment",n,{"ss:Author":t.a})}).join("")}function YV(e,t,r,n,s,a,i){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+st(Yg(e.f,i))),e.F&&e.F.slice(0,t.length)==t){var c=St(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==i.r?"":"["+(c.r-i.r)+"]")+"C"+(c.c==i.c?"":"["+(c.c-i.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=st(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=st(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=i.c||u[f].s.r!=i.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",h="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",h=String(e.v);break;case"b":d="Boolean",h=e.v?"1":"0";break;case"e":d="Error",h=ea[e.v];break;case"d":d="DateTime",h=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Ae[14]);break;case"s":d="String",h=mL(e.v||"");break}var p=Ya(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+p),o["ss:Index"]=i.c+1;var g=e.v!=null?h:"",m=e.t=="z"?"":'<Data ss:Type="'+d+'">'+g+"</Data>";return(e.c||[]).length>0&&(m+=XV(e.c)),ve("Cell",m,o)}function JV(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=rl(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function QV(e,t,r,n){if(!e["!ref"])return"";var s=Ze(e["!ref"]),a=e["!merges"]||[],i=0,o=[];e["!cols"]&&e["!cols"].forEach(function(x,y){La(x);var w=!!x.width,v=F0(y,x),S={"ss:Index":y+1};w&&(S["ss:Width"]=Xc(v.width)),x.hidden&&(S["ss:Hidden"]="1"),o.push(ve("Column",null,S))});for(var c=Array.isArray(e),u=s.s.r;u<=s.e.r;++u){for(var f=[JV(u,(e["!rows"]||[])[u])],d=s.s.c;d<=s.e.c;++d){var h=!1;for(i=0;i!=a.length;++i)if(!(a[i].s.c>d)&&!(a[i].s.r>u)&&!(a[i].e.c<d)&&!(a[i].e.r<u)){(a[i].s.c!=d||a[i].s.r!=u)&&(h=!0);break}if(!h){var p={r:u,c:d},g=je(p),m=c?(e[u]||[])[d]:e[g];f.push(YV(m,g,e,t,r,n,p))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function ZV(e,t,r){var n=[],s=r.SheetNames[e],a=r.Sheets[s],i=a?qV(a,t,e,r):"";return i.length>0&&n.push("<Names>"+i+"</Names>"),i=a?QV(a,t,e,r):"",i.length>0&&n.push("<Table>"+i+"</Table>"),n.push(KV(a,t,e,r)),n.join("")}function eH(e,t){t||(t={}),e.SSF||(e.SSF=xt(Ae)),e.SSF&&(xl(),T0(e.SSF),t.revssf=C0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Ya(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(WV(e,t)),r.push(VV()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(ve("Worksheet",ZV(n,t,e),{"ss:Name":st(e.SheetNames[n])}));return r[2]=HV(e,t),r[3]=GV(e),Mt+ve("Workbook",r.join(""),{xmlns:en.ss,"xmlns:o":en.o,"xmlns:x":en.x,"xmlns:ss":en.ss,"xmlns:dt":en.dt,"xmlns:html":en.html})}function tH(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=GL(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=qL(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var rH=[60,1084,2066,2165,2175];function nH(e,t,r,n,s){var a=n,i=[],o=r.slice(r.l,r.l+a);if(s&&s.enc&&s.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:s.enc.insitu(o)}i.push(o),r.l+=a;for(var c=Ls(r,r.l),u=Mm[c],f=0;u!=null&&rH.indexOf(c)>-1;)a=Ls(r,r.l+2),f=r.l+4,c==2066?f+=4:(c==2165||c==2175)&&(f+=12),o=r.slice(f,r.l+4+a),i.push(o),r.l+=4+a,u=Mm[c=Ls(r,r.l)];var d=er(i);lr(d,0);var h=0;d.lens=[];for(var p=0;p<i.length;++p)d.lens.push(h),h+=i[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,s)}function ls(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Ae[n])}catch(a){if(t.WTF)throw a}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ea[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Wc(e.v):e.w=Pi(e.v):e.w=Rn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(a){if(t.WTF)throw a}if(t.cellDates&&n&&e.t=="n"&&ml(Ae[n]||String(n))){var s=pi(e.v);s&&(e.t="d",e.v=new Date(s.y,s.m-1,s.d,s.H,s.M,s.S,s.u))}}}function mf(e,t,r){return{v:e,ixfe:t,t:r}}function sH(e,t){var r={opts:{}},n={},s=t.dense?[]:{},a={},i={},o=null,c=[],u="",f={},d,h="",p,g,m,x,y={},w=[],v,S,E=[],k=[],b={Sheets:[],WBProps:{date1904:!1},Views:[{}]},N={},A=function(De){return De<8?gi[De]:De<64&&k[De-8]||gi[De]},O=function(De,vt,Lr){var Ft=vt.XF.data;if(!(!Ft||!Ft.patternType||!Lr||!Lr.cellStyles)){vt.s={},vt.s.patternType=Ft.patternType;var Cs;(Cs=Kc(A(Ft.icvFore)))&&(vt.s.fgColor={rgb:Cs}),(Cs=Kc(A(Ft.icvBack)))&&(vt.s.bgColor={rgb:Cs})}},V=function(De,vt,Lr){if(!(Y>1)&&!(Lr.sheetRows&&De.r>=Lr.sheetRows)){if(Lr.cellStyles&&vt.XF&&vt.XF.data&&O(De,vt,Lr),delete vt.ixfe,delete vt.XF,d=De,h=je(De),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),De.r<i.s.r&&(i.s.r=De.r),De.c<i.s.c&&(i.s.c=De.c),De.r+1>i.e.r&&(i.e.r=De.r+1),De.c+1>i.e.c&&(i.e.c=De.c+1),Lr.cellFormula&&vt.f){for(var Ft=0;Ft<w.length;++Ft)if(!(w[Ft][0].s.c>De.c||w[Ft][0].s.r>De.r)&&!(w[Ft][0].e.c<De.c||w[Ft][0].e.r<De.r)){vt.F=$e(w[Ft][0]),(w[Ft][0].s.c!=De.c||w[Ft][0].s.r!=De.r)&&delete vt.f,vt.f&&(vt.f=""+wr(w[Ft][1],i,De,F,C));break}}Lr.dense?(s[De.r]||(s[De.r]=[]),s[De.r][De.c]=vt):s[h]=vt}},C={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(C.password=t.password);var B,G=[],X=[],z=[],q=[],K=!1,F=[];F.SheetNames=C.snames,F.sharedf=C.sharedf,F.arrayf=C.arrayf,F.names=[],F.XTI=[];var ne=0,Y=0,j=0,H=[],U=[],W;C.codepage=1200,qn(1200);for(var J=!1;e.l<e.length-1;){var te=e.l,oe=e.read_shift(2);if(oe===0&&ne===10)break;var ae=e.l===e.length?0:e.read_shift(2),se=Mm[oe];if(se&&se.f){if(t.bookSheets&&ne===133&&oe!==133)break;if(ne=oe,se.r===2||se.r==12){var de=e.read_shift(2);if(ae-=2,!C.enc&&de!==oe&&((de&255)<<8|de>>8)!==oe)throw new Error("rt mismatch: "+de+"!="+oe);se.r==12&&(e.l+=10,ae-=10)}var I={};if(oe===10?I=se.f(e,ae,C):I=nH(oe,se,e,ae,C),Y==0&&[9,521,1033,2057].indexOf(ne)===-1)continue;switch(oe){case 34:r.opts.Date1904=b.WBProps.date1904=I;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(C.enc||(e.l=0),C.enc=I,!t.password)throw new Error("File is password-protected");if(I.valid==null)throw new Error("Encryption scheme unsupported");if(!I.valid)throw new Error("Password is incorrect");break;case 92:C.lastuser=I;break;case 66:var Be=Number(I);switch(Be){case 21010:Be=1200;break;case 32768:Be=1e4;break;case 32769:Be=1252;break}qn(C.codepage=Be),J=!0;break;case 317:C.rrtabid=I;break;case 25:C.winlocked=I;break;case 439:r.opts.RefreshAll=I;break;case 12:r.opts.CalcCount=I;break;case 16:r.opts.CalcDelta=I;break;case 17:r.opts.CalcIter=I;break;case 13:r.opts.CalcMode=I;break;case 14:r.opts.CalcPrecision=I;break;case 95:r.opts.CalcSaveRecalc=I;break;case 15:C.CalcRefMode=I;break;case 2211:r.opts.FullCalc=I;break;case 129:I.fDialog&&(s["!type"]="dialog"),I.fBelow||((s["!outline"]||(s["!outline"]={})).above=!0),I.fRight||((s["!outline"]||(s["!outline"]={})).left=!0);break;case 224:E.push(I);break;case 430:F.push([I]),F[F.length-1].XTI=[];break;case 35:case 547:F[F.length-1].push(I);break;case 24:case 536:W={Name:I.Name,Ref:wr(I.rgce,i,null,F,C)},I.itab>0&&(W.Sheet=I.itab-1),F.names.push(W),F[0]||(F[0]=[],F[0].XTI=[]),F[F.length-1].push(I),I.Name=="_xlnm._FilterDatabase"&&I.itab>0&&I.rgce&&I.rgce[0]&&I.rgce[0][0]&&I.rgce[0][0][0]=="PtgArea3d"&&(U[I.itab-1]={ref:$e(I.rgce[0][0][1][2])});break;case 22:C.ExternCount=I;break;case 23:F.length==0&&(F[0]=[],F[0].XTI=[]),F[F.length-1].XTI=F[F.length-1].XTI.concat(I),F.XTI=F.XTI.concat(I);break;case 2196:if(C.biff<8)break;W!=null&&(W.Comment=I[1]);break;case 18:s["!protect"]=I;break;case 19:I!==0&&C.WTF&&console.error("Password verifier: "+I);break;case 133:a[I.pos]=I,C.snames.push(I.name);break;case 10:{if(--Y)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,s["!ref"]=$e(i),t.sheetRows&&t.sheetRows<=i.e.r){var Re=i.e.r;i.e.r=t.sheetRows-1,s["!fullref"]=s["!ref"],s["!ref"]=$e(i),i.e.r=Re}i.e.r++,i.e.c++}G.length>0&&(s["!merges"]=G),X.length>0&&(s["!objects"]=X),z.length>0&&(s["!cols"]=z),q.length>0&&(s["!rows"]=q),b.Sheets.push(N)}u===""?f=s:n[u]=s,s=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(C.biff===8&&(C.biff={9:2,521:3,1033:4}[oe]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[I.BIFFVer]||8),C.biffguess=I.BIFFVer==0,I.BIFFVer==0&&I.dt==4096&&(C.biff=5,J=!0,qn(C.codepage=28591)),C.biff==8&&I.BIFFVer==0&&I.dt==16&&(C.biff=2),Y++)break;if(s=t.dense?[]:{},C.biff<8&&!J&&(J=!0,qn(C.codepage=t.codepage||1252)),C.biff<5||I.BIFFVer==0&&I.dt==4096){u===""&&(u="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var Ve={pos:e.l-ae,name:u};a[Ve.pos]=Ve,C.snames.push(u)}else u=(a[te]||{name:""}).name;I.dt==32&&(s["!type"]="chart"),I.dt==64&&(s["!type"]="macro"),G=[],X=[],C.arrayf=w=[],z=[],q=[],K=!1,N={Hidden:(a[te]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:s["!type"]=="chart"&&(t.dense?(s[I.r]||[])[I.c]:s[je({c:I.c,r:I.r})])&&++I.c,v={ixfe:I.ixfe,XF:E[I.ixfe]||{},v:I.val,t:"n"},j>0&&(v.z=H[v.ixfe>>8&63]),ls(v,t,r.opts.Date1904),V({c:I.c,r:I.r},v,t);break;case 5:case 517:v={ixfe:I.ixfe,XF:E[I.ixfe],v:I.val,t:I.t},j>0&&(v.z=H[v.ixfe>>8&63]),ls(v,t,r.opts.Date1904),V({c:I.c,r:I.r},v,t);break;case 638:v={ixfe:I.ixfe,XF:E[I.ixfe],v:I.rknum,t:"n"},j>0&&(v.z=H[v.ixfe>>8&63]),ls(v,t,r.opts.Date1904),V({c:I.c,r:I.r},v,t);break;case 189:for(var Oe=I.c;Oe<=I.C;++Oe){var xe=I.rkrec[Oe-I.c][0];v={ixfe:xe,XF:E[xe],v:I.rkrec[Oe-I.c][1],t:"n"},j>0&&(v.z=H[v.ixfe>>8&63]),ls(v,t,r.opts.Date1904),V({c:Oe,r:I.r},v,t)}break;case 6:case 518:case 1030:{if(I.val=="String"){o=I;break}if(v=mf(I.val,I.cell.ixfe,I.tt),v.XF=E[v.ixfe],t.cellFormula){var it=I.formula;if(it&&it[0]&&it[0][0]&&it[0][0][0]=="PtgExp"){var Rt=it[0][0][1][0],Yr=it[0][0][1][1],On=je({r:Rt,c:Yr});y[On]?v.f=""+wr(I.formula,i,I.cell,F,C):v.F=((t.dense?(s[Rt]||[])[Yr]:s[On])||{}).F}else v.f=""+wr(I.formula,i,I.cell,F,C)}j>0&&(v.z=H[v.ixfe>>8&63]),ls(v,t,r.opts.Date1904),V(I.cell,v,t),o=I}break;case 7:case 519:if(o)o.val=I,v=mf(I,o.cell.ixfe,"s"),v.XF=E[v.ixfe],t.cellFormula&&(v.f=""+wr(o.formula,i,o.cell,F,C)),j>0&&(v.z=H[v.ixfe>>8&63]),ls(v,t,r.opts.Date1904),V(o.cell,v,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{w.push(I);var ta=je(I[0].s);if(p=t.dense?(s[I[0].s.r]||[])[I[0].s.c]:s[ta],t.cellFormula&&p){if(!o||!ta||!p)break;p.f=""+wr(I[1],i,I[0],F,C),p.F=$e(I[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;y[je(o.cell)]=I[0],p=t.dense?(s[o.cell.r]||[])[o.cell.c]:s[je(o.cell)],(p||{}).f=""+wr(I[0],i,d,F,C)}}break;case 253:v=mf(c[I.isst].t,I.ixfe,"s"),c[I.isst].h&&(v.h=c[I.isst].h),v.XF=E[v.ixfe],j>0&&(v.z=H[v.ixfe>>8&63]),ls(v,t,r.opts.Date1904),V({c:I.c,r:I.r},v,t);break;case 513:t.sheetStubs&&(v={ixfe:I.ixfe,XF:E[I.ixfe],t:"z"},j>0&&(v.z=H[v.ixfe>>8&63]),ls(v,t,r.opts.Date1904),V({c:I.c,r:I.r},v,t));break;case 190:if(t.sheetStubs)for(var as=I.c;as<=I.C;++as){var Nr=I.ixfe[as-I.c];v={ixfe:Nr,XF:E[Nr],t:"z"},j>0&&(v.z=H[v.ixfe>>8&63]),ls(v,t,r.opts.Date1904),V({c:as,r:I.r},v,t)}break;case 214:case 516:case 4:v=mf(I.val,I.ixfe,"s"),v.XF=E[v.ixfe],j>0&&(v.z=H[v.ixfe>>8&63]),ls(v,t,r.opts.Date1904),V({c:I.c,r:I.r},v,t);break;case 0:case 512:Y===1&&(i=I);break;case 252:c=I;break;case 1054:if(C.biff==4){H[j++]=I[1];for(var In=0;In<j+163&&Ae[In]!=I[1];++In);In>=163&&$s(I[1],j+163)}else $s(I[1],I[0]);break;case 30:{H[j++]=I;for(var is=0;is<j+163&&Ae[is]!=I;++is);is>=163&&$s(I,j+163)}break;case 229:G=G.concat(I);break;case 93:X[I.cmo[0]]=C.lastobj=I;break;case 438:C.lastobj.TxO=I;break;case 127:C.lastobj.ImData=I;break;case 440:for(x=I[0].s.r;x<=I[0].e.r;++x)for(m=I[0].s.c;m<=I[0].e.c;++m)p=t.dense?(s[x]||[])[m]:s[je({c:m,r:x})],p&&(p.l=I[1]);break;case 2048:for(x=I[0].s.r;x<=I[0].e.r;++x)for(m=I[0].s.c;m<=I[0].e.c;++m)p=t.dense?(s[x]||[])[m]:s[je({c:m,r:x})],p&&p.l&&(p.l.Tooltip=I[1]);break;case 28:{if(C.biff<=5&&C.biff>=2)break;p=t.dense?(s[I[0].r]||[])[I[0].c]:s[je(I[0])];var Ja=X[I[2]];p||(t.dense?(s[I[0].r]||(s[I[0].r]=[]),p=s[I[0].r][I[0].c]={t:"z"}):p=s[je(I[0])]={t:"z"},i.e.r=Math.max(i.e.r,I[0].r),i.s.r=Math.min(i.s.r,I[0].r),i.e.c=Math.max(i.e.c,I[0].c),i.s.c=Math.min(i.s.c,I[0].c)),p.c||(p.c=[]),g={a:I[1],t:Ja.TxO.t},p.c.push(g)}break;case 2173:H9(E[I.ixfe],I.ext);break;case 125:{if(!C.cellStyles)break;for(;I.e>=I.s;)z[I.e--]={width:I.w/256,level:I.level||0,hidden:!!(I.flags&1)},K||(K=!0,qg(I.w/256)),La(z[I.e+1])}break;case 520:{var sr={};I.level!=null&&(q[I.r]=sr,sr.level=I.level),I.hidden&&(q[I.r]=sr,sr.hidden=!0),I.hpt&&(q[I.r]=sr,sr.hpt=I.hpt,sr.hpx=rl(I.hpt))}break;case 38:case 39:case 40:case 41:s["!margins"]||yi(s["!margins"]={}),s["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[oe]]=I;break;case 161:s["!margins"]||yi(s["!margins"]={}),s["!margins"].header=I.header,s["!margins"].footer=I.footer;break;case 574:I.RTL&&(b.Views[0].RTL=!0);break;case 146:k=I;break;case 2198:B=I;break;case 140:S=I;break;case 442:u?N.CodeName=I||N.name:b.WBProps.CodeName=I||"ThisWorkbook";break}}else se||console.error("Missing Info for XLS Record 0x"+oe.toString(16)),e.l+=ae}return r.SheetNames=Pt(a).sort(function(xn,De){return Number(xn)-Number(De)}).map(function(xn){return a[xn].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&U.forEach(function(xn,De){r.Sheets[r.SheetNames[De]]["!autofilter"]=xn}),r.Strings=c,r.SSF=xt(Ae),C.enc&&(r.Encryption=C.enc),B&&(r.Themes=B),r.Metadata={},S!==void 0&&(r.Metadata.Country=S),F.names.length>0&&(b.Names=F.names),r.Workbook=b,r}var dc={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function aH(e,t,r){var n=Ee.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var s=xy(n,Pm,dc.DSI);for(var a in s)t[a]=s[a]}catch(u){if(r.WTF)throw u}var i=Ee.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=xy(i,Rm,dc.SI);for(var c in o)t[c]==null&&(t[c]=o[c])}catch(u){if(r.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(AT(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function iH(e,t){var r=[],n=[],s=[],a=0,i,o=Gw(Pm,"n"),c=Gw(Rm,"n");if(e.Props)for(i=Pt(e.Props),a=0;a<i.length;++a)(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Props[i[a]]]);if(e.Custprops)for(i=Pt(e.Custprops),a=0;a<i.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},i[a])||(Object.prototype.hasOwnProperty.call(o,i[a])?r:Object.prototype.hasOwnProperty.call(c,i[a])?n:s).push([i[a],e.Custprops[i[a]]]);var u=[];for(a=0;a<s.length;++a)DT.indexOf(s[a][0])>-1||CT.indexOf(s[a][0])>-1||s[a][1]!=null&&u.push(s[a]);n.length&&Ee.utils.cfb_add(t,"/SummaryInformation",gy(n,dc.SI,c,Rm)),(r.length||u.length)&&Ee.utils.cfb_add(t,"/DocumentSummaryInformation",gy(r,dc.DSI,o,Pm,u.length?u:null,dc.UDI))}function PN(e,t){t||(t={}),rv(t),Sg(),t.codepage&&bg(t.codepage);var r,n;if(e.FullPaths){if(Ee.find(e,"/encryption"))throw new Error("File is password-protected");r=Ee.find(e,"!CompObj"),n=Ee.find(e,"/Workbook")||Ee.find(e,"/Book")}else{switch(t.type){case"base64":e=nn(dn(e));break;case"binary":e=nn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}lr(e,0),n={content:e}}var s,a;if(r&&tH(r),t.bookProps&&!t.bookSheets)s={};else{var i=Ge?"buffer":"array";if(n&&n.content)s=sH(n.content,t);else if((a=Ee.find(e,"PerfectOffice_MAIN"))&&a.content)s=wi.to_workbook(a.content,(t.type=i,t));else if((a=Ee.find(e,"NativeContent_MAIN"))&&a.content)s=wi.to_workbook(a.content,(t.type=i,t));else throw(a=Ee.find(e,"MN0"))&&a.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ee.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(s.vbaraw=wU(e))}var o={};return e.FullPaths&&aH(e,o,t),s.Props=s.Custprops=o,t.bookFiles&&(s.cfb=e),s}function oH(e,t){var r=t||{},n=Ee.utils.cfb_new({root:"R"}),s="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":s="/Workbook",r.biff=8;break;case"biff5":s="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Ee.utils.cfb_add(n,s,RN(e,r)),r.biff==8&&(e.Props||e.Custprops)&&iH(e,n),r.biff==8&&e.vbaraw&&yU(n,Ee.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Qc={0:{f:Pz},1:{f:Bz},2:{f:sW},3:{f:qz},4:{f:Wz},5:{f:tW},6:{f:cW},7:{f:Jz},8:{f:xW},9:{f:mW},10:{f:hW},11:{f:pW},12:{f:$z},13:{f:iW},14:{f:Xz},15:{f:Hz},16:{f:SN},17:{f:fW},18:{f:Zz},19:{f:Lg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:fV},40:{},42:{},43:{f:c9},44:{f:o9},45:{f:d9},46:{f:p9},47:{f:h9},48:{},49:{f:OL},50:{},51:{f:K9},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:qT},62:{f:lW},63:{f:nU},64:{f:RW},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Er,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:CW},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Lz},148:{f:Oz,p:16},151:{f:bW},152:{},153:{f:lV},154:{},155:{},156:{f:iV},157:{},158:{},159:{T:1,f:k7},160:{T:-1},161:{T:1,f:Xi},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:gW},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:G9},336:{T:-1},337:{f:J9,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:jm},357:{},358:{},359:{},360:{T:1},361:{},362:{f:GT},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:SW},427:{f:kW},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:TW},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Dz},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:yW},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:jm},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:pU},633:{T:1},634:{T:-1},635:{T:1,f:dU},636:{T:-1},637:{f:ML},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:XW},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:FW},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Mm={6:{f:Kh},10:{f:ia},12:{f:$t},13:{f:$t},14:{f:Ot},15:{f:Ot},16:{f:br},17:{f:Ot},18:{f:Ot},19:{f:$t},20:{f:Sy},21:{f:Sy},23:{f:GT},24:{f:Ey},25:{f:Ot},26:{},27:{},28:{f:FB},29:{},34:{f:Ot},35:{f:ky},38:{f:br},39:{f:br},40:{f:br},41:{f:br},42:{f:Ot},43:{f:Ot},47:{f:H7},49:{f:iB},51:{f:$t},60:{},61:{f:tB},64:{f:Ot},65:{f:aB},66:{f:$t},77:{},80:{},81:{},82:{},85:{f:$t},89:{},90:{},91:{},92:{f:VM},93:{f:DB},94:{},95:{f:Ot},96:{},97:{},99:{f:Ot},125:{f:qT},128:{f:_B},129:{f:GM},130:{f:$t},131:{f:Ot},132:{f:Ot},133:{f:qM},134:{},140:{f:VB},141:{f:$t},144:{},146:{f:qB},151:{},152:{},153:{},154:{},155:{},156:{f:$t},157:{},158:{},160:{f:e7},161:{f:YB},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:gB},190:{f:vB},193:{f:ia},197:{},198:{},199:{},200:{},201:{},202:{f:Ot},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:$t},220:{},221:{f:Ot},222:{},224:{f:yB},225:{f:WM},226:{f:ia},227:{},229:{f:OB},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:XM},253:{f:lB},255:{f:JM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:LT},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ot},353:{f:ia},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:TB},431:{f:Ot},432:{},433:{},434:{},437:{},438:{f:BB},439:{f:Ot},440:{f:UB},441:{},442:{f:yu},443:{},444:{f:$t},445:{},446:{},448:{f:ia},449:{f:eB,r:2},450:{f:ia},512:{f:yy},513:{f:ZB},515:{f:kB},516:{f:uB},517:{f:by},519:{f:t7},520:{f:QM},523:{},545:{f:Ty},549:{f:wy},566:{},574:{f:nB},638:{f:xB},659:{},1048:{},1054:{f:dB},1084:{},1212:{f:jB},2048:{f:zB},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:df},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ia},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:KB,r:12},2173:{f:V9,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ot,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:AB,r:12},2197:{},2198:{f:M9,r:12},2199:{},2200:{},2201:{},2202:{f:PB,r:12},2203:{f:ia},2204:{},2205:{},2206:{},2207:{},2211:{f:ZM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:$t},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:JB},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:GB},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:yy},1:{},2:{f:i7},3:{f:s7},4:{f:n7},5:{f:by},7:{f:l7},8:{},9:{f:df},11:{},22:{f:$t},30:{f:pB},31:{},32:{},33:{f:Ty},36:{},37:{f:wy},50:{f:c7},62:{},52:{},67:{},68:{f:$t},69:{},86:{},126:{},127:{f:r7},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:u7},223:{},234:{},354:{},421:{},518:{f:Kh},521:{f:df},536:{f:Ey},547:{f:ky},561:{},579:{},1030:{f:Kh},1033:{f:df},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function we(e,t,r,n){var s=t;if(!isNaN(s)){var a=n||(r||[]).length||0,i=e.next(4);i.write_shift(2,s),i.write_shift(2,a),a>0&&Og(r)&&e.push(r)}}function lH(e,t,r,n){var s=(r||[]).length||0;if(s<=8224)return we(e,t,r,s);var a=t;if(!isNaN(a)){for(var i=r.parts||[],o=0,c=0,u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,a),f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<s;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(i[o]||8224)<=8224;)u+=i[o]||8224,o++;f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function ku(e,t,r){return e||(e=ie(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function cH(e,t,r,n){var s=ie(9);return ku(s,e,t),MT(r,n||"b",s),s}function uH(e,t,r){var n=ie(8+2*r.length);return ku(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function fH(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var s=t.t=="d"?Yt(mt(t.v)):t.v;s==(s|0)&&s>=0&&s<65536?we(e,2,o7(r,n,s)):we(e,3,a7(r,n,s));return;case"b":case"e":we(e,5,cH(r,n,t.v,t.t));return;case"s":case"str":we(e,4,uH(r,n,(t.v||"").slice(0,255)));return}we(e,1,ku(null,r,n))}function dH(e,t,r,n){var s=Array.isArray(t),a=Ze(t["!ref"]||"A1"),i,o="",c=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),i=$e(a)}for(var u=a.s.r;u<=a.e.r;++u){o=Dt(u);for(var f=a.s.c;f<=a.e.c;++f){u===a.s.r&&(c[f]=bt(f)),i=c[f]+o;var d=s?(t[u]||[])[f]:t[i];d&&fH(e,d,u,f)}}}function hH(e,t){for(var r=t||{},n=Gr(),s=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(s=a);if(s==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return we(n,r.biff==4?1033:r.biff==3?521:9,Vg(e,16,r)),dH(n,e.Sheets[e.SheetNames[s]],s,r),we(n,10),n.end()}function pH(e,t,r){we(e,49,oB({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function mH(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var s=n[0];s<=n[1];++s)t[s]!=null&&we(e,1054,hB(s,t[s],r))})}function xH(e,t){var r=ie(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),we(e,2151,r),r=ie(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),WT(Ze(t["!ref"]||"A1"),r),r.write_shift(4,4),we(e,2152,r)}function gH(e,t){for(var r=0;r<16;++r)we(e,224,_y({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){we(e,224,_y(n,0,t))})}function vH(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];we(e,440,$B(n)),n[1].Tooltip&&we(e,2048,WB(n))}delete t["!links"]}function wH(e,t){if(t){var r=0;t.forEach(function(n,s){++r<=256&&n&&we(e,125,XB(F0(s,n),s))})}}function yH(e,t,r,n,s){var a=16+Ya(s.cellXfs,t,s);if(t.v==null&&!t.bf){we(e,513,Ii(r,n,a));return}if(t.bf)we(e,6,G$(t,r,n,s,a));else switch(t.t){case"d":case"n":var i=t.t=="d"?Yt(mt(t.v)):t.v;we(e,515,EB(r,n,i,a));break;case"b":case"e":we(e,517,SB(r,n,t.v,a,s,t.t));break;case"s":case"str":if(s.bookSST){var o=Qg(s.Strings,t.v,s.revStrings);we(e,253,cB(r,n,o,a))}else we(e,516,fB(r,n,(t.v||"").slice(0,255),a,s));break;default:we(e,513,Ii(r,n,a))}}function _H(e,t,r){var n=Gr(),s=r.SheetNames[e],a=r.Sheets[s]||{},i=(r||{}).Workbook||{},o=(i.Sheets||[])[e]||{},c=Array.isArray(a),u=t.biff==8,f,d="",h=[],p=Ze(a["!ref"]||"A1"),g=u?65536:16384;if(p.e.c>255||p.e.r>=g){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");p.e.c=Math.min(p.e.c,255),p.e.r=Math.min(p.e.c,g-1)}we(n,2057,Vg(r,16,t)),we(n,13,bn(1)),we(n,12,bn(100)),we(n,15,Pr(!0)),we(n,17,Pr(!1)),we(n,16,Fi(.001)),we(n,95,Pr(!0)),we(n,42,Pr(!1)),we(n,43,Pr(!1)),we(n,130,bn(1)),we(n,128,bB()),we(n,131,Pr(!1)),we(n,132,Pr(!1)),u&&wH(n,a["!cols"]),we(n,512,mB(p,t)),u&&(a["!links"]=[]);for(var m=p.s.r;m<=p.e.r;++m){d=Dt(m);for(var x=p.s.c;x<=p.e.c;++x){m===p.s.r&&(h[x]=bt(x)),f=h[x]+d;var y=c?(a[m]||[])[x]:a[f];y&&(yH(n,y,m,x,t),u&&y.l&&a["!links"].push([f,y.l]))}}var w=o.CodeName||o.name||s;return u&&we(n,574,sB((i.Views||[])[0])),u&&(a["!merges"]||[]).length&&we(n,229,IB(a["!merges"])),u&&vH(n,a),we(n,442,BT(w)),u&&xH(n,a),we(n,10),n.end()}function bH(e,t,r){var n=Gr(),s=(e||{}).Workbook||{},a=s.Sheets||[],i=s.WBProps||{},o=r.biff==8,c=r.biff==5;if(we(n,2057,Vg(e,5,r)),r.bookType=="xla"&&we(n,135),we(n,225,o?bn(1200):null),we(n,193,SM(2)),c&&we(n,191),c&&we(n,192),we(n,226),we(n,92,HM("SheetJS",r)),we(n,66,bn(o?1200:1252)),o&&we(n,353,bn(0)),o&&we(n,448),we(n,317,QB(e.SheetNames.length)),o&&e.vbaraw&&we(n,211),o&&e.vbaraw){var u=i.CodeName||"ThisWorkbook";we(n,442,BT(u))}we(n,156,bn(17)),we(n,25,Pr(!1)),we(n,18,Pr(!1)),we(n,19,bn(0)),o&&we(n,431,Pr(!1)),o&&we(n,444,bn(0)),we(n,61,rB()),we(n,64,Pr(!1)),we(n,141,bn(0)),we(n,34,Pr(eV(e)=="true")),we(n,14,Pr(!0)),o&&we(n,439,Pr(!1)),we(n,218,bn(0)),pH(n,e,r),mH(n,e.SSF,r),gH(n,r),o&&we(n,352,Pr(!1));var f=n.end(),d=Gr();o&&we(d,140,HB()),o&&r.Strings&&lH(d,252,YM(r.Strings)),we(d,10);var h=d.end(),p=Gr(),g=0,m=0;for(m=0;m<e.SheetNames.length;++m)g+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var x=f.length+g+h.length;for(m=0;m<e.SheetNames.length;++m){var y=a[m]||{};we(p,133,KM({pos:x,hs:y.Hidden||0,dt:0,name:e.SheetNames[m]},r)),x+=t[m].length}var w=p.end();if(g!=w.length)throw new Error("BS8 "+g+" != "+w.length);var v=[];return f.length&&v.push(f),w.length&&v.push(w),h.length&&v.push(h),er(v)}function SH(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=xt(Ae)),e&&e.SSF&&(xl(),T0(e.SSF),r.revssf=C0(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,nv(r),r.cellXfs=[],Ya(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var s=0;s<e.SheetNames.length;++s)n[n.length]=_H(s,r,e);return n.unshift(bH(e,n,r)),er(n)}function RN(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var s=qr(n["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return SH(e,t);case 4:case 3:case 2:return hH(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function Dy(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var s=e.match(/<table/i);if(!s)throw new Error("Invalid HTML: could not find <table>");var a=e.match(/<\/table/i),i=s.index,o=a&&a.index||e.length,c=oL(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,f=0,d=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},g=[];for(i=0;i<c.length;++i){var m=c[i].trim(),x=m.slice(0,3).toLowerCase();if(x=="<tr"){if(++u,r.sheetRows&&r.sheetRows<=u){--u;break}f=0;continue}if(!(x!="<td"&&x!="<th")){var y=m.split(/<\/t[dh]>/i);for(o=0;o<y.length;++o){var w=y[o].trim();if(w.match(/<t[dh]/i)){for(var v=w,S=0;v.charAt(0)=="<"&&(S=v.indexOf(">"))>-1;)v=v.slice(S+1);for(var E=0;E<g.length;++E){var k=g[E];k.s.c==f&&k.s.r<u&&u<=k.e.r&&(f=k.e.c+1,E=-1)}var b=Fe(w.slice(0,w.indexOf(">")));h=b.colspan?+b.colspan:1,((d=+b.rowspan)>1||h>1)&&g.push({s:{r:u,c:f},e:{r:u+(d||1)-1,c:f+h-1}});var N=b.t||b["data-t"]||"";if(!v.length){f+=h;continue}if(v=rT(v),p.s.r>u&&(p.s.r=u),p.e.r<u&&(p.e.r=u),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!v.length){f+=h;continue}var A={t:"s",v};r.raw||!v.trim().length||N=="s"||(v==="TRUE"?A={t:"b",v:!0}:v==="FALSE"?A={t:"b",v:!1}:isNaN(Qn(v))?isNaN(el(v).getDate())||(A={t:"d",v:mt(v)},r.cellDates||(A={t:"n",v:Yt(A.v)}),A.z=r.dateNF||Ae[14]):A={t:"n",v:Qn(v)}),r.dense?(n[u]||(n[u]=[]),n[u][f]=A):n[je({r:u,c:f})]=A,f+=h}}}}return n["!ref"]=$e(p),g.length&&(n["!merges"]=g),n}function kH(e,t,r,n){for(var s=e["!merges"]||[],a=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,c=0,u=0;u<s.length;++u)if(!(s[u].s.r>r||s[u].s.c>i)&&!(s[u].e.r<r||s[u].e.c<i)){if(s[u].s.r<r||s[u].s.c<i){o=-1;break}o=s[u].e.r-s[u].s.r+1,c=s[u].e.c-s[u].s.c+1;break}if(!(o<0)){var f=je({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],h=d&&d.v!=null&&(d.h||Pg(d.w||(Xs(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),c>1&&(p.colspan=c),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+f,a.push(ve("td",h,p))}}var g="<tr>";return g+a.join("")+"</tr>"}var EH='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',TH="</body></html>";function NH(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Xa(Dy(r[0],t),t);var n=iv();return r.forEach(function(s,a){ov(n,Dy(s,t),"Sheet"+(a+1))}),n}function CH(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function FN(e,t){var r=t||{},n=r.header!=null?r.header:EH,s=r.footer!=null?r.footer:TH,a=[n],i=qr(e["!ref"]);r.dense=Array.isArray(e),a.push(CH(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)a.push(kH(e,i,o,r));return a.push("</table>"+s),a.join("")}function ON(e,t,r){var n=r||{},s=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var i=typeof n.origin=="string"?St(n.origin):n.origin;s=i.r,a=i.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:s,c:a}};if(e["!ref"]){var f=qr(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),s==-1&&(u.e.r=s=f.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),g=0,m=0,x=0,y=0,w=0,v=0;for(e["!cols"]||(e["!cols"]=[]);g<o.length&&m<c;++g){var S=o[g];if(Ly(S)){if(n.display)continue;p[m]={hidden:!0}}var E=S.children;for(x=y=0;x<E.length;++x){var k=E[x];if(!(n.display&&Ly(k))){var b=k.hasAttribute("data-v")?k.getAttribute("data-v"):k.hasAttribute("v")?k.getAttribute("v"):rT(k.innerHTML),N=k.getAttribute("data-z")||k.getAttribute("z");for(h=0;h<d.length;++h){var A=d[h];A.s.c==y+a&&A.s.r<m+s&&m+s<=A.e.r&&(y=A.e.c+1-a,h=-1)}v=+k.getAttribute("colspan")||1,((w=+k.getAttribute("rowspan")||1)>1||v>1)&&d.push({s:{r:m+s,c:y+a},e:{r:m+s+(w||1)-1,c:y+a+(v||1)-1}});var O={t:"s",v:b},V=k.getAttribute("data-t")||k.getAttribute("t")||"";b!=null&&(b.length==0?O.t=V||"z":n.raw||b.trim().length==0||V=="s"||(b==="TRUE"?O={t:"b",v:!0}:b==="FALSE"?O={t:"b",v:!1}:isNaN(Qn(b))?isNaN(el(b).getDate())||(O={t:"d",v:mt(b)},n.cellDates||(O={t:"n",v:Yt(O.v)}),O.z=n.dateNF||Ae[14]):O={t:"n",v:Qn(b)})),O.z===void 0&&N!=null&&(O.z=N);var C="",B=k.getElementsByTagName("A");if(B&&B.length)for(var G=0;G<B.length&&!(B[G].hasAttribute("href")&&(C=B[G].getAttribute("href"),C.charAt(0)!="#"));++G);C&&C.charAt(0)!="#"&&(O.l={Target:C}),n.dense?(e[m+s]||(e[m+s]=[]),e[m+s][y+a]=O):e[je({c:y+a,r:m+s})]=O,u.e.c<y+a&&(u.e.c=y+a),y+=v}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,m-1+s),e["!ref"]=$e(u),m>=c&&(e["!fullref"]=$e((u.e.r=o.length-g+m-1+s,u))),e}function IN(e,t){var r=t||{},n=r.dense?[]:{};return ON(n,e,t)}function AH(e,t){return Xa(IN(e,t),t)}function Ly(e){var t="",r=jH(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function jH(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function PH(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=Qe(t.replace(/<[^>]*>/g,""));return[r]}var My={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function DN(e,t){var r=t||{},n=Rg(e),s=[],a,i,o={name:""},c="",u=0,f,d,h={},p=[],g=r.dense?[]:{},m,x,y={value:""},w="",v=0,S=[],E=-1,k=-1,b={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,A={},O=[],V={},C=0,B=0,G=[],X=1,z=1,q=[],K={Names:[]},F={},ne=["",""],Y=[],j={},H="",U=0,W=!1,J=!1,te=0;for(Gc.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Gc.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"工作表":m[1]==="/"?(b.e.c>=b.s.c&&b.e.r>=b.s.r?g["!ref"]=$e(b):g["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=b.e.r&&(g["!fullref"]=g["!ref"],b.e.r=r.sheetRows-1,g["!ref"]=$e(b)),O.length&&(g["!merges"]=O),G.length&&(g["!rows"]=G),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),h[f.name]=g,J=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=Fe(m[0],!1),E=k=-1,b.s.r=b.s.c=1e7,b.e.r=b.e.c=0,g=r.dense?[]:{},O=[],G=[],J=!0);break;case"table-row-group":m[1]==="/"?--N:++N;break;case"table-row":case"行":if(m[1]==="/"){E+=X,X=1;break}if(d=Fe(m[0],!1),d.行号?E=d.行号-1:E==-1&&(E=0),X=+d["number-rows-repeated"]||1,X<10)for(te=0;te<X;++te)N>0&&(G[E+te]={level:N});k=-1;break;case"covered-table-cell":m[1]!=="/"&&++k,r.sheetStubs&&(r.dense?(g[E]||(g[E]=[]),g[E][k]={t:"z"}):g[je({r:E,c:k})]={t:"z"}),w="",S=[];break;case"table-cell":case"数据":if(m[0].charAt(m[0].length-2)==="/")++k,y=Fe(m[0],!1),z=parseInt(y["number-columns-repeated"]||"1",10),x={t:"z",v:null},y.formula&&r.cellFormula!=!1&&(x.f=Fy(Qe(y.formula))),(y.数据类型||y["value-type"])=="string"&&(x.t="s",x.v=Qe(y["string-value"]||""),r.dense?(g[E]||(g[E]=[]),g[E][k]=x):g[je({r:E,c:k})]=x),k+=z-1;else if(m[1]!=="/"){++k,w="",v=0,S=[],z=1;var oe=X?E+X-1:E;if(k>b.e.c&&(b.e.c=k),k<b.s.c&&(b.s.c=k),E<b.s.r&&(b.s.r=E),oe>b.e.r&&(b.e.r=oe),y=Fe(m[0],!1),Y=[],j={},x={t:y.数据类型||y["value-type"],v:null},r.cellFormula)if(y.formula&&(y.formula=Qe(y.formula)),y["number-matrix-columns-spanned"]&&y["number-matrix-rows-spanned"]&&(C=parseInt(y["number-matrix-rows-spanned"],10)||0,B=parseInt(y["number-matrix-columns-spanned"],10)||0,V={s:{r:E,c:k},e:{r:E+C-1,c:k+B-1}},x.F=$e(V),q.push([V,x.F])),y.formula)x.f=Fy(y.formula);else for(te=0;te<q.length;++te)E>=q[te][0].s.r&&E<=q[te][0].e.r&&k>=q[te][0].s.c&&k<=q[te][0].e.c&&(x.F=q[te][1]);switch((y["number-columns-spanned"]||y["number-rows-spanned"])&&(C=parseInt(y["number-rows-spanned"],10)||0,B=parseInt(y["number-columns-spanned"],10)||0,V={s:{r:E,c:k},e:{r:E+C-1,c:k+B-1}},O.push(V)),y["number-columns-repeated"]&&(z=parseInt(y["number-columns-repeated"],10)),x.t){case"boolean":x.t="b",x.v=ht(y["boolean-value"]);break;case"float":x.t="n",x.v=parseFloat(y.value);break;case"percentage":x.t="n",x.v=parseFloat(y.value);break;case"currency":x.t="n",x.v=parseFloat(y.value);break;case"date":x.t="d",x.v=mt(y["date-value"]),r.cellDates||(x.t="n",x.v=Yt(x.v)),x.z="m/d/yy";break;case"time":x.t="n",x.v=sL(y["time-value"])/86400,r.cellDates&&(x.t="d",x.v=A0(x.v)),x.z="HH:MM:SS";break;case"number":x.t="n",x.v=parseFloat(y.数据数值);break;default:if(x.t==="string"||x.t==="text"||!x.t)x.t="s",y["string-value"]!=null&&(w=Qe(y["string-value"]),S=[]);else throw new Error("Unsupported value type "+x.t)}}else{if(W=!1,x.t==="s"&&(x.v=w||"",S.length&&(x.R=S),W=v==0),F.Target&&(x.l=F),Y.length>0&&(x.c=Y,Y=[]),w&&r.cellText!==!1&&(x.w=w),W&&(x.t="z",delete x.v),(!W||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var ae=0;ae<X;++ae){if(z=parseInt(y["number-columns-repeated"]||"1",10),r.dense)for(g[E+ae]||(g[E+ae]=[]),g[E+ae][k]=ae==0?x:xt(x);--z>0;)g[E+ae][k+z]=xt(x);else for(g[je({r:E+ae,c:k})]=x;--z>0;)g[je({r:E+ae,c:k+z})]=xt(x);b.e.c<=k&&(b.e.c=k)}z=parseInt(y["number-columns-repeated"]||"1",10),k+=z-1,z=0,x={},w="",S=[]}F={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((a=s.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((a=s.pop())[0]!==m[3])throw"Bad state: "+a;j.t=w,S.length&&(j.R=S),j.a=H,Y.push(j)}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);H="",U=0,w="",v=0,S=[];break;case"creator":m[1]==="/"?H=n.slice(U,m.index):U=m.index+m[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((a=s.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&s.push([m[3],!1]);w="",v=0,S=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(A[o.name]=c,(a=s.pop())[0]!==m[3])throw"Bad state: "+a}else m[0].charAt(m[0].length-2)!=="/"&&(c="",o=Fe(m[0],!1),s.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Fe(m[0],!1),c+=My[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(s[s.length-1][0]){case"time-style":case"date-style":i=Fe(m[0],!1),c+=My[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(s[s.length-1][0]){case"number-style":case"date-style":case"time-style":c+=n.slice(u,m.index);break}else u=m.index+m[0].length;break;case"named-range":i=Fe(m[0],!1),ne=Xh(i["cell-range-address"]);var se={Name:i.name,Ref:ne[0]+"!"+ne[1]};J&&(se.Sheet=p.length),K.Names.push(se);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(s[s.length-1][0])>-1)break;if(m[1]==="/"&&(!y||!y["string-value"])){var de=PH(n.slice(v,m.index));w=(w.length>0?w+`
`:"")+de[0]}else Fe(m[0],!1),v=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ne=Xh(Fe(m[0])["target-range-address"]),h[ne[0]]["!autofilter"]={ref:ne[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(F=Fe(m[0],!1),!F.href)break;F.Target=Qe(F.href),delete F.href,F.Target.charAt(0)=="#"&&F.Target.indexOf(".")>-1?(ne=Xh(F.Target.slice(1)),F.Target="#"+ne[0]+"!"+ne[1]):F.Target.match(/^\.\.[\\\/]/)&&(F.Target=F.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(m)}}var I={Sheets:h,SheetNames:p,Workbook:K};return r.bookSheets&&delete I.Sheets,I}function By(e,t){t=t||{},_n(e,"META-INF/manifest.xml")&&sM(Ut(e,"META-INF/manifest.xml"),t);var r=sn(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=DN(ot(r),t);return _n(e,"meta.xml")&&(n.Props=TT(Ut(e,"meta.xml"))),n}function Uy(e,t){return DN(e,t)}var RH=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Hc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Mt+t}}(),$y=function(){var e=function(a){return st(a).replace(/  +/g,function(i){return'<text:s text:c="'+i.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,i,o){var c=[];c.push('      <table:table table:name="'+st(i.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,d=qr(a["!ref"]||"A1"),h=a["!merges"]||[],p=0,g=Array.isArray(a);if(a["!cols"])for(f=0;f<=d.e.c;++f)c.push("        <table:table-column"+(a["!cols"][f]?' table:style-name="co'+a["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",x=a["!rows"]||[];for(u=0;u<d.s.r;++u)m=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=d.e.r;++u){for(m=x[u]?' table:style-name="ro'+x[u].ods+'"':"",c.push("        <table:table-row"+m+`>
`),f=0;f<d.s.c;++f)c.push(t);for(;f<=d.e.c;++f){var y=!1,w={},v="";for(p=0;p!=h.length;++p)if(!(h[p].s.c>f)&&!(h[p].s.r>u)&&!(h[p].e.c<f)&&!(h[p].e.r<u)){(h[p].s.c!=f||h[p].s.r!=u)&&(y=!0),w["table:number-columns-spanned"]=h[p].e.c-h[p].s.c+1,w["table:number-rows-spanned"]=h[p].e.r-h[p].s.r+1;break}if(y){c.push(r);continue}var S=je({r:u,c:f}),E=g?(a[u]||[])[f]:a[S];if(E&&E.f&&(w["table:formula"]=st(Q$(E.f)),E.F&&E.F.slice(0,S.length)==S)){var k=qr(E.F);w["table:number-matrix-columns-spanned"]=k.e.c-k.s.c+1,w["table:number-matrix-rows-spanned"]=k.e.r-k.s.r+1}if(!E){c.push(t);continue}switch(E.t){case"b":v=E.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=E.v?"true":"false";break;case"n":v=E.w||String(E.v||0),w["office:value-type"]="float",w["office:value"]=E.v||0;break;case"s":case"str":v=E.v==null?"":E.v,w["office:value-type"]="string";break;case"d":v=E.w||mt(E.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=mt(E.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(t);continue}var b=e(v);if(E.l&&E.l.Target){var N=E.l.Target;N=N.charAt(0)=="#"?"#"+Z$(N.slice(1)):N,N.charAt(0)!="#"&&!N.match(/^\w+:/)&&(N="../"+N),b=ve("text:a",b,{"xlink:href":N.replace(/&/g,"&amp;")})}c.push("          "+ve("table:table-cell",ve("text:p",b,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},s=function(a,i){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;La(d),d.ods=o;var h=u["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+h+`"/>
`),a.push(`  </style:style>
`),++o}}});var c=0;i.SheetNames.map(function(u){return i.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=c;var d=u["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),a.push(`  </style:style>
`),++c}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(i,o){var c=[Mt],u=Hc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Hc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+f+`>
`),c.push(ET().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),s(c,i),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=i.SheetNames.length;++d)c.push(n(i.Sheets[i.SheetNames[d]],i,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function LN(e,t){if(t.bookType=="fods")return $y(e,t);var r=Cg(),n="",s=[],a=[];return n="mimetype",We(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",We(r,n,$y(e,t)),s.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",We(r,n,RH(e,t)),s.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",We(r,n,Mt+ET()),s.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",We(r,n,oM(a)),s.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",We(r,n,aM(s)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Di(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Bm(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):ot(Ka(e))}function FH(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):nn(vs(e))}function OH(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Ba(e){var t=e.reduce(function(s,a){return s+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(s){r.set(s,n),n+=s.length}),r}function zy(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function IH(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,s=t+13;s>=t;--s)n=n*256+e[s];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function DH(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,s=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;s>=1;++a,s/=256)e[t+a]=s&255;e[t+15]|=r>=0?0:128}function Zc(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function rt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function jt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function et(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],s=Zc(e,r),a=s&7;s=Math.floor(s/8);var i=0,o;if(s==0)break;switch(a){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Zc(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(s," at offset ").concat(n))}var u={data:o,type:a};t[s]==null?t[s]=[u]:t[s].push(u)}return t}function ar(e){var t=[];return e.forEach(function(r,n){r.forEach(function(s){s.data&&(t.push(rt(n*8+s.type)),s.type==2&&t.push(rt(s.data.length)),t.push(s.data))})}),Ba(t)}function tv(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function wn(e){for(var t,r=[],n=[0];n[0]<e.length;){var s=Zc(e,n),a=et(e.slice(n[0],n[0]+s));n[0]+=s;var i={id:jt(a[1][0].data),messages:[]};a[2].forEach(function(o){var c=et(o.data),u=jt(c[3][0].data);i.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(i.merge=jt(a[3][0].data)>>>0>0),r.push(i)}return r}function co(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:rt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:rt(+!!r.merge),type:0}]);var s=[];r.messages.forEach(function(i){s.push(i.data),i.meta[3]=[{type:0,data:rt(i.data.length)}],n[2].push({data:ar(i.meta),type:2})});var a=ar(n);t.push(rt(a.length)),t.push(a),s.forEach(function(i){return t.push(i)})}),Ba(t)}function LH(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Zc(t,r),s=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}s.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var c=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),s=[Ba(s)],c==0)throw new Error("Invalid offset 0");if(c>s[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(s.push(s[0].slice(-c)),u-=c;u>=s[s.length-1].length;)s.push(s[s.length-1]),u-=s[s.length-1].length;s.push(s[0].slice(-c,-c+u))}}var f=Ba(s);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function yn(e){for(var t=[],r=0;r<e.length;){var n=e[r++],s=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(LH(n,e.slice(r,r+s))),r+=s}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Ba(t)}function uo(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),s=new Uint8Array(4);t.push(s);var a=rt(n),i=a.length;t.push(a),n<=60?(i++,t.push(new Uint8Array([n-1<<2]))):n<=256?(i+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(i+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(i+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(i+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),i+=n,s[0]=0,s[1]=i&255,s[2]=i>>8&255,s[3]=i>>16&255,r+=n}return Ba(t)}function MH(e,t,r,n){var s=Di(e),a=s.getUint32(4,!0),i=(n>1?12:8)+zy(a&(n>1?3470:398))*4,o=-1,c=-1,u=NaN,f=new Date(2001,0,1);a&512&&(o=s.getUint32(i,!0),i+=4),i+=zy(a&(n>1?12288:4096))*4,a&16&&(c=s.getUint32(i,!0),i+=4),a&32&&(u=s.getFloat64(i,!0),i+=8),a&64&&(f.setTime(f.getTime()+s.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:u};break;case 3:d={t:"s",v:t[c]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(c>-1)d={t:"s",v:t[c]};else if(!isNaN(u))d={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function BH(e,t,r){var n=Di(e),s=n.getUint32(8,!0),a=12,i=-1,o=-1,c=NaN,u=NaN,f=new Date(2001,0,1);s&1&&(c=IH(e,a),a+=16),s&2&&(u=n.getFloat64(a,!0),a+=8),s&4&&(f.setTime(f.getTime()+n.getFloat64(a,!0)*1e3),a+=8),s&8&&(o=n.getUint32(a,!0),a+=4),s&16&&(i=n.getUint32(a,!0),a+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:u>0};break;case 7:d={t:"n",v:u/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(s&31," : ").concat(e.slice(0,4)))}return d}function Jh(e,t){var r=new Uint8Array(32),n=Di(r),s=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,DH(r,s,e.v),a|=1,s+=16;break;case"b":r[1]=6,n.setFloat64(s,e.v?1:0,!0),a|=2,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=8,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,s)}function Qh(e,t){var r=new Uint8Array(32),n=Di(r),s=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(s,e.v,!0),a|=32,s+=8;break;case"b":r[2]=6,n.setFloat64(s,e.v?1:0,!0),a|=32,s+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(s,t.indexOf(e.v),!0),a|=16,s+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,s)}function UH(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return MH(e,t,r,e[0]);case 5:return BH(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function vr(e){var t=et(e);return Zc(t[1][0].data)}function Wy(e,t){var r=et(t.data),n=jt(r[1][0].data),s=r[3],a=[];return(s||[]).forEach(function(i){var o=et(i.data),c=jt(o[1][0].data)>>>0;switch(n){case 1:a[c]=Bm(o[3][0].data);break;case 8:{var u=e[vr(o[9][0].data)][0],f=et(u.data),d=e[vr(f[1][0].data)][0],h=jt(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=et(d.data);a[c]=p[3].map(function(g){return Bm(g.data)}).join("")}break}}),a}function $H(e,t){var r,n,s,a,i,o,c,u,f,d,h,p,g,m,x=et(e),y=jt(x[1][0].data)>>>0,w=jt(x[2][0].data)>>>0,v=((n=(r=x[8])==null?void 0:r[0])==null?void 0:n.data)&&jt(x[8][0].data)>0||!1,S,E;if((a=(s=x[7])==null?void 0:s[0])!=null&&a.data&&t!=0)S=(o=(i=x[7])==null?void 0:i[0])==null?void 0:o.data,E=(u=(c=x[6])==null?void 0:c[0])==null?void 0:u.data;else if((d=(f=x[4])==null?void 0:f[0])!=null&&d.data&&t!=1)S=(p=(h=x[4])==null?void 0:h[0])==null?void 0:p.data,E=(m=(g=x[3])==null?void 0:g[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var k=v?4:1,b=Di(S),N=[],A=0;A<S.length/2;++A){var O=b.getUint16(A*2,!0);O<65535&&N.push([A,O])}if(N.length!=w)throw"Expected ".concat(w," cells, found ").concat(N.length);var V=[];for(A=0;A<N.length-1;++A)V[N[A][0]]=E.subarray(N[A][1]*k,N[A+1][1]*k);return N.length>=1&&(V[N[N.length-1][0]]=E.subarray(N[N.length-1][1]*k)),{R:y,cells:V}}function zH(e,t){var r,n=et(t.data),s=(r=n==null?void 0:n[7])!=null&&r[0]?jt(n[7][0].data)>>>0>0?1:0:-1,a=tv(n[5],function(i){return $H(i,s)});return{nrows:jt(n[4][0].data)>>>0,data:a.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(c,u){if(i[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));i[o.R][u]=c}),i},[])}}function WH(e,t,r){var n,s=et(t.data),a={s:{r:0,c:0},e:{r:0,c:0}};if(a.e.r=(jt(s[6][0].data)>>>0)-1,a.e.r<0)throw new Error("Invalid row varint ".concat(s[6][0].data));if(a.e.c=(jt(s[7][0].data)>>>0)-1,a.e.c<0)throw new Error("Invalid col varint ".concat(s[7][0].data));r["!ref"]=$e(a);var i=et(s[4][0].data),o=Wy(e,e[vr(i[4][0].data)][0]),c=(n=i[17])!=null&&n[0]?Wy(e,e[vr(i[17][0].data)][0]):[],u=et(i[3][0].data),f=0;u[1].forEach(function(d){var h=et(d.data),p=e[vr(h[2][0].data)][0],g=jt(p.meta[1][0].data);if(g!=6002)throw new Error("6001 unexpected reference to ".concat(g));var m=zH(e,p);m.data.forEach(function(x,y){x.forEach(function(w,v){var S=je({r:f+y,c:v}),E=UH(w,o,c);E&&(r[S]=E)})}),f+=m.nrows})}function VH(e,t){var r=et(t.data),n={"!ref":"A1"},s=e[vr(r[2][0].data)],a=jt(s[0].meta[1][0].data);if(a!=6001)throw new Error("6000 unexpected reference to ".concat(a));return WH(e,s[0],n),n}function HH(e,t){var r,n=et(t.data),s={name:(r=n[1])!=null&&r[0]?Bm(n[1][0].data):"",sheets:[]},a=tv(n[2],vr);return a.forEach(function(i){e[i].forEach(function(o){var c=jt(o.meta[1][0].data);c==6e3&&s.sheets.push(VH(e,o))})}),s}function GH(e,t){var r=iv(),n=et(t.data),s=tv(n[1],vr);if(s.forEach(function(a){e[a].forEach(function(i){var o=jt(i.meta[1][0].data);if(o==2){var c=HH(e,i);c.sheets.forEach(function(u,f){ov(r,u,f==0?c.name:c.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Zh(e){var t,r,n,s,a={},i=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var u;try{u=yn(c.content)}catch(d){return console.log("?? "+c.content.length+" "+(d.message||d))}var f;try{f=wn(u)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){a[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((s=(n=(r=(t=a==null?void 0:a[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:s[0].data)&&jt(a[1][0].meta[1][0].data)==1&&a[1][0];if(o||i.forEach(function(c){a[c].forEach(function(u){var f=jt(u.meta[1][0].data)>>>0;if(f==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return GH(a,o)}function qH(e,t,r){var n,s,a,i;if(!((n=e[6])!=null&&n[0])||!((s=e[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var o=((i=(a=e[8])==null?void 0:a[0])==null?void 0:i.data)&&jt(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=Di(e[7][0].data),f=0,d=[],h=Di(e[4][0].data),p=0,g=[],m=0;m<t.length;++m){if(t[m]==null){u.setUint16(m*2,65535,!0),h.setUint16(m*2,65535);continue}u.setUint16(m*2,f,!0),h.setUint16(m*2,p,!0);var x,y;switch(typeof t[m]){case"string":x=Jh({t:"s",v:t[m]},r),y=Qh({t:"s",v:t[m]},r);break;case"number":x=Jh({t:"n",v:t[m]},r),y=Qh({t:"n",v:t[m]},r);break;case"boolean":x=Jh({t:"b",v:t[m]},r),y=Qh({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}d.push(x),f+=x.length,g.push(y),p+=y.length,++c}for(e[2][0].data=rt(c);m<e[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),h.setUint16(m*2,65535,!0);return e[6][0].data=Ba(d),e[3][0].data=Ba(g),c}function KH(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=qr(r["!ref"]);n.s.r=n.s.c=0;var s=!1;n.e.c>9&&(s=!0,n.e.c=9),n.e.r>49&&(s=!0,n.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat($e(n)));var a=Md(r,{range:n,header:1}),i=["~Sh33tJ5~"];a.forEach(function(H){return H.forEach(function(U){typeof U=="string"&&i.push(U)})});var o={},c=[],u=Ee.read(t.numbers,{type:"base64"});u.FileIndex.map(function(H,U){return[H,u.FullPaths[U]]}).forEach(function(H){var U=H[0],W=H[1];if(U.type==2&&U.name.match(/\.iwa/)){var J=U.content,te=yn(J),oe=wn(te);oe.forEach(function(ae){c.push(ae.id),o[ae.id]={deps:[],location:W,type:jt(ae.messages[0].meta[1][0].data)}})}}),c.sort(function(H,U){return H-U});var f=c.filter(function(H){return H>1}).map(function(H){return[H,rt(H)]});u.FileIndex.map(function(H,U){return[H,u.FullPaths[U]]}).forEach(function(H){var U=H[0];if(H[1],!!U.name.match(/\.iwa/)){var W=wn(yn(U.content));W.forEach(function(J){J.messages.forEach(function(te){f.forEach(function(oe){J.messages.some(function(ae){return jt(ae.meta[1][0].data)!=11006&&OH(ae.data,oe[1])})&&o[oe[0]].deps.push(J.id)})})})}});for(var d=Ee.find(u,o[1].location),h=wn(yn(d.content)),p,g=0;g<h.length;++g){var m=h[g];m.id==1&&(p=m)}var x=vr(et(p.messages[0].data)[1][0].data);for(d=Ee.find(u,o[x].location),h=wn(yn(d.content)),g=0;g<h.length;++g)m=h[g],m.id==x&&(p=m);for(x=vr(et(p.messages[0].data)[2][0].data),d=Ee.find(u,o[x].location),h=wn(yn(d.content)),g=0;g<h.length;++g)m=h[g],m.id==x&&(p=m);for(x=vr(et(p.messages[0].data)[2][0].data),d=Ee.find(u,o[x].location),h=wn(yn(d.content)),g=0;g<h.length;++g)m=h[g],m.id==x&&(p=m);var y=et(p.messages[0].data);{y[6][0].data=rt(n.e.r+1),y[7][0].data=rt(n.e.c+1);var w=vr(y[46][0].data),v=Ee.find(u,o[w].location),S=wn(yn(v.content));{for(var E=0;E<S.length&&S[E].id!=w;++E);if(S[E].id!=w)throw"Bad ColumnRowUIDMapArchive";var k=et(S[E].messages[0].data);k[1]=[],k[2]=[],k[3]=[];for(var b=0;b<=n.e.c;++b){var N=[];N[1]=N[2]=[{type:0,data:rt(b+420690)}],k[1].push({type:2,data:ar(N)}),k[2].push({type:0,data:rt(b)}),k[3].push({type:0,data:rt(b)})}k[4]=[],k[5]=[],k[6]=[];for(var A=0;A<=n.e.r;++A)N=[],N[1]=N[2]=[{type:0,data:rt(A+726270)}],k[4].push({type:2,data:ar(N)}),k[5].push({type:0,data:rt(A)}),k[6].push({type:0,data:rt(A)});S[E].messages[0].data=ar(k)}v.content=uo(co(S)),v.size=v.content.length,delete y[46];var O=et(y[4][0].data);{O[7][0].data=rt(n.e.r+1);var V=et(O[1][0].data),C=vr(V[2][0].data);v=Ee.find(u,o[C].location),S=wn(yn(v.content));{if(S[0].id!=C)throw"Bad HeaderStorageBucket";var B=et(S[0].messages[0].data);for(A=0;A<a.length;++A){var G=et(B[2][0].data);G[1][0].data=rt(A),G[4][0].data=rt(a[A].length),B[2][A]={type:B[2][0].type,data:ar(G)}}S[0].messages[0].data=ar(B)}v.content=uo(co(S)),v.size=v.content.length;var X=vr(O[2][0].data);v=Ee.find(u,o[X].location),S=wn(yn(v.content));{if(S[0].id!=X)throw"Bad HeaderStorageBucket";for(B=et(S[0].messages[0].data),b=0;b<=n.e.c;++b)G=et(B[2][0].data),G[1][0].data=rt(b),G[4][0].data=rt(n.e.r+1),B[2][b]={type:B[2][0].type,data:ar(G)};S[0].messages[0].data=ar(B)}v.content=uo(co(S)),v.size=v.content.length;var z=vr(O[4][0].data);(function(){for(var H=Ee.find(u,o[z].location),U=wn(yn(H.content)),W,J=0;J<U.length;++J){var te=U[J];te.id==z&&(W=te)}var oe=et(W.messages[0].data);{oe[3]=[];var ae=[];i.forEach(function(I,Be){ae[1]=[{type:0,data:rt(Be)}],ae[2]=[{type:0,data:rt(1)}],ae[3]=[{type:2,data:FH(I)}],oe[3].push({type:2,data:ar(ae)})})}W.messages[0].data=ar(oe);var se=co(U),de=uo(se);H.content=de,H.size=H.content.length})();var q=et(O[3][0].data);{var K=q[1][0];delete q[2];var F=et(K.data);{var ne=vr(F[2][0].data);(function(){for(var H=Ee.find(u,o[ne].location),U=wn(yn(H.content)),W,J=0;J<U.length;++J){var te=U[J];te.id==ne&&(W=te)}var oe=et(W.messages[0].data);{delete oe[6],delete q[7];var ae=new Uint8Array(oe[5][0].data);oe[5]=[];for(var se=0,de=0;de<=n.e.r;++de){var I=et(ae);se+=qH(I,a[de],i),I[1][0].data=rt(de),oe[5].push({data:ar(I),type:2})}oe[1]=[{type:0,data:rt(n.e.c+1)}],oe[2]=[{type:0,data:rt(n.e.r+1)}],oe[3]=[{type:0,data:rt(se)}],oe[4]=[{type:0,data:rt(n.e.r+1)}]}W.messages[0].data=ar(oe);var Be=co(U),Re=uo(Be);H.content=Re,H.size=H.content.length})()}K.data=ar(F)}O[3][0].data=ar(q)}y[4][0].data=ar(O)}p.messages[0].data=ar(y);var Y=co(h),j=uo(Y);return d.content=j,d.size=d.content.length,u}function MN(e){return function(r){for(var n=0;n!=e.length;++n){var s=e[n];r[s[0]]===void 0&&(r[s[0]]=s[1]),s[2]==="n"&&(r[s[0]]=Number(r[s[0]]))}}}function rv(e){MN([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function nv(e){MN([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function XH(e){return qe.WS.indexOf(e)>-1?"sheet":e==qe.CS?"chart":e==qe.DS?"dialog":e==qe.MS?"macro":e&&e.length?e:"sheet"}function YH(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,XH(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function JH(e,t,r,n,s,a,i,o,c,u,f,d){try{a[n]=lc(sn(e,r,!0),t);var h=Ut(e,t),p;switch(o){case"sheet":p=wV(h,t,s,c,a[n],u,f,d);break;case"chart":if(p=yV(h,t,s,c,a[n],u,f,d),!p||!p["!drawel"])break;var g=Hl(p["!drawel"].Target,t),m=qc(g),x=iU(sn(e,g,!0),lc(sn(e,m,!0),g)),y=Hl(x,g),w=qc(y);p=qW(sn(e,y,!0),y,c,lc(sn(e,w,!0),y),u,p);break;case"macro":p=_V(h,t,s,c,a[n],u,f,d);break;case"dialog":p=bV(h,t,s,c,a[n],u,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var v=[];a&&a[n]&&Pt(a[n]).forEach(function(S){var E="";if(a[n][S].Type==qe.CMNT){E=Hl(a[n][S].Target,t);var k=TV(Ut(e,E,!0),E,c);if(!k||!k.length)return;Cy(p,k,!1)}a[n][S].Type==qe.TCMNT&&(E=Hl(a[n][S].Target,t),v=v.concat(lU(Ut(e,E,!0),c)))}),v&&v.length&&Cy(p,v,!0,c.people||[])}catch(S){if(c.WTF)throw S}}function gn(e){return e.charAt(0)=="/"?e.slice(1):e}function QH(e,t){if(xl(),t=t||{},rv(t),_n(e,"META-INF/manifest.xml")||_n(e,"objectdata.xml"))return By(e,t);if(_n(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Zh<"u"){if(e.FileIndex)return Zh(e);var r=Ee.utils.cfb_new();return Xw(e).forEach(function(G){We(r,G,cL(e,G))}),Zh(r)}throw new Error("Unsupported NUMBERS file")}if(!_n(e,"[Content_Types].xml"))throw _n(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):_n(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Xw(e),s=rM(sn(e,"[Content_Types].xml")),a=!1,i,o;if(s.workbooks.length===0&&(o="xl/workbook.xml",Ut(e,o,!0)&&s.workbooks.push(o)),s.workbooks.length===0){if(o="xl/workbook.bin",!Ut(e,o,!0))throw new Error("Could not find workbook");s.workbooks.push(o),a=!0}s.workbooks[0].slice(-3)=="bin"&&(a=!0);var c={},u={};if(!t.bookSheets&&!t.bookProps){if(cc=[],s.sst)try{cc=EV(Ut(e,gn(s.sst)),s.sst,t)}catch(G){if(t.WTF)throw G}t.cellStyles&&s.themes.length&&(c=kV(sn(e,s.themes[0].replace(/^\//,""),!0)||"",s.themes[0],t)),s.style&&(u=SV(Ut(e,gn(s.style)),s.style,c,t))}s.links.map(function(G){try{var X=lc(sn(e,qc(gn(G))),G);return CV(Ut(e,gn(G)),X,G,t)}catch{}});var f=vV(Ut(e,gn(s.workbooks[0])),s.workbooks[0],t),d={},h="";s.coreprops.length&&(h=Ut(e,gn(s.coreprops[0]),!0),h&&(d=TT(h)),s.extprops.length!==0&&(h=Ut(e,gn(s.extprops[0]),!0),h&&cM(h,d,t)));var p={};(!t.bookSheets||t.bookProps)&&s.custprops.length!==0&&(h=sn(e,gn(s.custprops[0]),!0),h&&(p=fM(h,t)));var g={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(X){return X.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(g.Props=d,g.Custprops=p),t.bookSheets&&typeof i<"u"&&(g.SheetNames=i),t.bookSheets?g.SheetNames:t.bookProps))return g;i={};var m={};t.bookDeps&&s.calcchain&&(m=NV(Ut(e,gn(s.calcchain)),s.calcchain));var x=0,y={},w,v;{var S=f.Sheets;d.Worksheets=S.length,d.SheetNames=[];for(var E=0;E!=S.length;++E)d.SheetNames[E]=S[E].name}var k=a?"bin":"xml",b=s.workbooks[0].lastIndexOf("/"),N=(s.workbooks[0].slice(0,b+1)+"_rels/"+s.workbooks[0].slice(b+1)+".rels").replace(/^\//,"");_n(e,N)||(N="xl/_rels/workbook."+k+".rels");var A=lc(sn(e,N,!0),N.replace(/_rels.*/,"s5s"));(s.metadata||[]).length>=1&&(t.xlmeta=AV(Ut(e,gn(s.metadata[0])),s.metadata[0],t)),(s.people||[]).length>=1&&(t.people=uU(Ut(e,gn(s.people[0])),t)),A&&(A=YH(A,f.Sheets));var O=Ut(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(x=0;x!=d.Worksheets;++x){var V="sheet";if(A&&A[x]?(w="xl/"+A[x][1].replace(/[\/]?xl\//,""),_n(e,w)||(w=A[x][1]),_n(e,w)||(w=N.replace(/_rels\/.*$/,"")+A[x][1]),V=A[x][2]):(w="xl/worksheets/sheet"+(x+1-O)+"."+k,w=w.replace(/sheet0\./,"sheet.")),v=w.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(x!=t.sheets)continue e;break;case"string":if(d.SheetNames[x].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var C=!1,B=0;B!=t.sheets.length;++B)typeof t.sheets[B]=="number"&&t.sheets[B]==x&&(C=1),typeof t.sheets[B]=="string"&&t.sheets[B].toLowerCase()==d.SheetNames[x].toLowerCase()&&(C=1);if(!C)continue e}}JH(e,w,v,d.SheetNames[x],x,y,i,V,t,f,c,u)}return g={Directory:s,Workbook:f,Props:d,Custprops:p,Deps:m,Sheets:i,SheetNames:d.SheetNames,Strings:cc,Styles:u,Themes:c,SSF:xt(Ae)},t&&t.bookFiles&&(e.files?(g.keys=n,g.files=e.files):(g.keys=[],g.files={},e.FullPaths.forEach(function(G,X){G=G.replace(/^Root Entry[\/]/,""),g.keys.push(G),g.files[G]=e.FileIndex[X]}))),t&&t.bookVBA&&(s.vba.length>0?g.vbaraw=Ut(e,gn(s.vba[0]),!0):s.defaults&&s.defaults.bin===vU&&(g.vbaraw=Ut(e,"xl/vbaProject.bin",!0))),g}function ZH(e,t){var r=t||{},n="Workbook",s=Ee.find(e,n);try{if(n="/!DataSpaces/Version",s=Ee.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(A7(s.content),n="/!DataSpaces/DataSpaceMap",s=Ee.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=P7(s.content);if(a.length!==1||a[0].comps.length!==1||a[0].comps[0].t!==0||a[0].name!=="StrongEncryptionDataSpace"||a[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",s=Ee.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=R7(s.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",s=Ee.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);O7(s.content)}catch{}if(n="/EncryptionInfo",s=Ee.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=I7(s.content);if(n="/EncryptedPackage",s=Ee.find(e,n),!s||!s.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],s.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],s.content,r.password||"",r);throw new Error("File is password-protected")}function eG(e,t){return t.bookType=="ods"?LN(e,t):t.bookType=="numbers"?KH(e,t):t.bookType=="xlsb"?tG(e,t):rG(e,t)}function tG(e,t){No=1024,e&&!e.SSF&&(e.SSF=xt(Ae)),e&&e.SSF&&(xl(),T0(e.SSF),t.revssf=C0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,uc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=fN.indexOf(t.bookType)>-1,s=zg();nv(t=t||{});var a=Cg(),i="",o=0;if(t.cellXfs=[],Ya(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",We(a,i,NT(e.Props,t)),s.coreprops.push(i),nt(t.rels,2,i,qe.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,We(a,i,jT(e.Props)),s.extprops.push(i),nt(t.rels,3,i,qe.EXT_PROPS),e.Custprops!==e.Props&&Pt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",We(a,i,PT(e.Custprops)),s.custprops.push(i),nt(t.rels,4,i,qe.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],h=(d||{})["!type"]||"sheet";switch(h){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,We(a,i,PV(o-1,i,t,e,f)),s.sheets.push(i),nt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,qe.WS[0])}if(d){var p=d["!comments"],g=!1,m="";p&&p.length>0&&(m="xl/comments"+o+"."+r,We(a,m,OV(p,m)),s.comments.push(m),nt(f,-1,"../comments"+o+"."+r,qe.CMNT),g=!0),d["!legacy"]&&g&&We(a,"xl/drawings/vmlDrawing"+o+".vml",cN(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&We(a,qc(i),Uo(f))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,We(a,i,FV(t.Strings,i,t)),s.strs.push(i),nt(t.wbrels,-1,"sharedStrings."+r,qe.SST)),i="xl/workbook."+r,We(a,i,jV(e,i)),s.workbooks.push(i),nt(t.rels,1,i,qe.WB),i="xl/theme/theme1.xml",We(a,i,Kg(e.Themes,t)),s.themes.push(i),nt(t.wbrels,-1,"theme/theme1.xml",qe.THEME),i="xl/styles."+r,We(a,i,RV(e,i,t)),s.styles.push(i),nt(t.wbrels,-1,"styles."+r,qe.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",We(a,i,e.vbaraw),s.vba.push(i),nt(t.wbrels,-1,"vbaProject.bin",qe.VBA)),i="xl/metadata."+r,We(a,i,IV(i)),s.metadata.push(i),nt(t.wbrels,-1,"metadata."+r,qe.XLMETA),We(a,"[Content_Types].xml",kT(s,t)),We(a,"_rels/.rels",Uo(t.rels)),We(a,"xl/_rels/workbook."+r+".rels",Uo(t.wbrels)),delete t.revssf,delete t.ssf,a}function rG(e,t){No=1024,e&&!e.SSF&&(e.SSF=xt(Ae)),e&&e.SSF&&(xl(),T0(e.SSF),t.revssf=C0(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,uc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=fN.indexOf(t.bookType)>-1,s=zg();nv(t=t||{});var a=Cg(),i="",o=0;if(t.cellXfs=[],Ya(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),i="docProps/core.xml",We(a,i,NT(e.Props,t)),s.coreprops.push(i),nt(t.rels,2,i,qe.CORE_PROPS),i="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,We(a,i,jT(e.Props)),s.extprops.push(i),nt(t.rels,3,i,qe.EXT_PROPS),e.Custprops!==e.Props&&Pt(e.Custprops||{}).length>0&&(i="docProps/custom.xml",We(a,i,PT(e.Custprops)),s.custprops.push(i),nt(t.rels,4,i,qe.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:i="xl/worksheets/sheet"+o+"."+r,We(a,i,bN(o-1,t,e,d)),s.sheets.push(i),nt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,qe.WS[0])}if(h){var g=h["!comments"],m=!1,x="";if(g&&g.length>0){var y=!1;g.forEach(function(w){w[1].forEach(function(v){v.T==!0&&(y=!0)})}),y&&(x="xl/threadedComments/threadedComment"+o+"."+r,We(a,x,cU(g,f,t)),s.threadedcomments.push(x),nt(d,-1,"../threadedComments/threadedComment"+o+"."+r,qe.TCMNT)),x="xl/comments"+o+"."+r,We(a,x,uN(g)),s.comments.push(x),nt(d,-1,"../comments"+o+"."+r,qe.CMNT),m=!0}h["!legacy"]&&m&&We(a,"xl/drawings/vmlDrawing"+o+".vml",cN(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&We(a,qc(i),Uo(d))}return t.Strings!=null&&t.Strings.length>0&&(i="xl/sharedStrings."+r,We(a,i,JT(t.Strings,t)),s.strs.push(i),nt(t.wbrels,-1,"sharedStrings."+r,qe.SST)),i="xl/workbook."+r,We(a,i,NN(e)),s.workbooks.push(i),nt(t.rels,1,i,qe.WB),i="xl/theme/theme1.xml",We(a,i,Kg(e.Themes,t)),s.themes.push(i),nt(t.wbrels,-1,"theme/theme1.xml",qe.THEME),i="xl/styles."+r,We(a,i,aN(e,t)),s.styles.push(i),nt(t.wbrels,-1,"styles."+r,qe.STY),e.vbaraw&&n&&(i="xl/vbaProject.bin",We(a,i,e.vbaraw),s.vba.push(i),nt(t.wbrels,-1,"vbaProject.bin",qe.VBA)),i="xl/metadata."+r,We(a,i,lN()),s.metadata.push(i),nt(t.wbrels,-1,"metadata."+r,qe.XLMETA),f.length>1&&(i="xl/persons/person.xml",We(a,i,fU(f)),s.people.push(i),nt(t.wbrels,-1,"persons/person.xml",qe.PEOPLE)),We(a,"[Content_Types].xml",kT(s,t)),We(a,"_rels/.rels",Uo(t.rels)),We(a,"xl/_rels/workbook."+r+".rels",Uo(t.wbrels)),delete t.revssf,delete t.ssf,a}function sv(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=dn(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function nG(e,t){return Ee.find(e,"EncryptedPackage")?ZH(e,t):PN(e,t)}function sG(e,t){var r,n=e,s=t||{};return s.type||(s.type=Ge&&Buffer.isBuffer(e)?"buffer":"base64"),r=ZE(n,s),QH(r,s)}function BN(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Lm(e.slice(r),t);default:break e}return tl.to_workbook(e,t)}function aG(e,t){var r="",n=sv(e,t);switch(t.type){case"base64":r=dn(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Ri(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=ot(r)),t.type="binary",BN(r,t)}function iG(e,t){var r=e;return t.type=="base64"&&(r=dn(r)),r=ma.utils.decode(1200,r.slice(2),"str"),t.type="binary",BN(r,t)}function oG(e){return e.match(/[^\x00-\x7F]/)?vs(e):e}function ep(e,t,r,n){return n?(r.type="string",tl.to_workbook(e,r)):tl.to_workbook(t,r)}function Um(e,t){Sg();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Um(new Uint8Array(e),(r=xt(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,s=[0,0,0,0],a=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),zo={},r.dateNF&&(zo.dateNF=r.dateNF),r.type||(r.type=Ge&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Ge?"buffer":"binary",n=tL(e),typeof Uint8Array<"u"&&!Ge&&(r.type="array")),r.type=="string"&&(a=!0,r.type="binary",r.codepage=65001,n=oG(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=xt(r),r.type="array",Um(kg(n),r)}switch((s=sv(n,r))[0]){case 208:if(s[1]===207&&s[2]===17&&s[3]===224&&s[4]===161&&s[5]===177&&s[6]===26&&s[7]===225)return nG(Ee.read(n,r),r);break;case 9:if(s[1]<=8)return PN(n,r);break;case 60:return Lm(n,r);case 73:if(s[1]===73&&s[2]===42&&s[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(s[1]===68)return d7(n,r);break;case 84:if(s[1]===65&&s[2]===66&&s[3]===76)return XT.to_workbook(n,r);break;case 80:return s[1]===75&&s[2]<9&&s[3]<9?sG(n,r):ep(e,n,r,a);case 239:return s[3]===60?Lm(n,r):ep(e,n,r,a);case 255:if(s[1]===254)return iG(n,r);if(s[1]===0&&s[2]===2&&s[3]===0)return wi.to_workbook(n,r);break;case 0:if(s[1]===0&&(s[2]>=2&&s[3]===0||s[2]===0&&(s[3]===8||s[3]===9)))return wi.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Dm.to_workbook(n,r);case 123:if(s[1]===92&&s[2]===114&&s[3]===116)return rN.to_workbook(n,r);break;case 10:case 13:case 32:return aG(n,r);case 137:if(s[1]===80&&s[2]===78&&s[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return f7.indexOf(s[0])>-1&&s[2]<=12&&s[3]<=31?Dm.to_workbook(n,r):ep(e,n,r,a)}function UN(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return gu(t.file,Ee.write(e,{type:Ge?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ee.write(e,t)}function lG(e,t){var r=xt(t||{}),n=eG(e,r);return cG(n,r)}function cG(e,t){var r={},n=Ge?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var s=e.FullPaths?Ee.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof s=="string"){if(t.type=="binary"||t.type=="base64")return s;s=new Uint8Array(E0(s))}return t.password&&typeof encrypt_agile<"u"?UN(encrypt_agile(s,t.password),t):t.type==="file"?gu(t.file,s):t.type=="string"?ot(s):s}function uG(e,t){var r=t||{},n=oH(e,r);return UN(n,r)}function us(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return zc(vs(n));case"binary":return vs(n);case"string":return e;case"file":return gu(t.file,n,"utf8");case"buffer":return Ge?Qs(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):us(n,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function fG(e,t){switch(t.type){case"base64":return zc(e);case"binary":return e;case"string":return e;case"file":return gu(t.file,e,"binary");case"buffer":return Ge?Qs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function xf(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?zc(r):t.type=="string"?ot(r):r;case"file":return gu(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function $N(e,t){Sg(),nV(e);var r=xt(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=$N(e,r);return r.type="array",E0(n)}var s=0;if(r.sheet&&(typeof r.sheet=="number"?s=r.sheet:s=e.SheetNames.indexOf(r.sheet),!e.SheetNames[s]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return us(eH(e,r),r);case"slk":case"sylk":return us(KT.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"htm":case"html":return us(FN(e.Sheets[e.SheetNames[s]],r),r);case"txt":return fG(zN(e.Sheets[e.SheetNames[s]],r),r);case"csv":return us(av(e.Sheets[e.SheetNames[s]],r),r,"\uFEFF");case"dif":return us(XT.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"dbf":return xf(Dm.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"prn":return us(tl.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"rtf":return us(rN.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"eth":return us(YT.from_sheet(e.Sheets[e.SheetNames[s]],r),r);case"fods":return us(LN(e,r),r);case"wk1":return xf(wi.sheet_to_wk1(e.Sheets[e.SheetNames[s]],r),r);case"wk3":return xf(wi.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),xf(RN(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),uG(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return lG(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function dG(e,t,r,n,s,a,i,o){var c=Dt(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var g=i?e[r][p]:e[n[p]+c];if(g===void 0||g.t===void 0){if(u===void 0)continue;a[p]!=null&&(h[a[p]]=u);continue}var m=g.v;switch(g.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+g.t)}if(a[p]!=null){if(m==null)if(g.t=="e"&&m===null)h[a[p]]=null;else if(u!==void 0)h[a[p]]=u;else if(f&&m===null)h[a[p]]=null;else continue;else h[a[p]]=f&&(g.t!=="n"||g.t==="n"&&o.rawNumbers!==!1)?m:Xs(g,m,o);m!=null&&(d=!1)}}return{row:h,isempty:d}}function Md(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,s=1,a=[],i=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":c=Ze(f);break;case"number":c=Ze(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(s=0);var d=Dt(c.s.r),h=[],p=[],g=0,m=0,x=Array.isArray(e),y=c.s.r,w=0,v={};x&&!e[y]&&(e[y]=[]);var S=u.skipHidden&&e["!cols"]||[],E=u.skipHidden&&e["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(S[w]||{}).hidden)switch(h[w]=bt(w),r=x?e[y][w]:e[h[w]+d],n){case 1:a[w]=w-c.s.c;break;case 2:a[w]=h[w];break;case 3:a[w]=u.header[w-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=Xs(r,null,u),m=v[i]||0,!m)v[i]=1;else{do o=i+"_"+m++;while(v[o]);v[i]=m,v[o]=1}a[w]=o}for(y=c.s.r+s;y<=c.e.r;++y)if(!(E[y]||{}).hidden){var k=dG(e,c,y,h,n,a,x,u);(k.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(p[g++]=k.row)}return p.length=g,p}var Vy=/"/g;function hG(e,t,r,n,s,a,i,o){for(var c=!0,u=[],f="",d=Dt(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=o.dense?(e[r]||[])[h]:e[n[h]+d];if(p==null)f="";else if(p.v!=null){c=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:Xs(p,null,o));for(var g=0,m=0;g!==f.length;++g)if((m=f.charCodeAt(g))===s||m===a||m===34||o.forceQuotes){f='"'+f.replace(Vy,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(c=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(Vy,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&c?null:u.join(i)}function av(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var s=Ze(e["!ref"]),a=n.FS!==void 0?n.FS:",",i=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],g=s.s.c;g<=s.e.c;++g)(h[g]||{}).hidden||(d[g]=bt(g));for(var m=0,x=s.s.r;x<=s.e.r;++x)(p[x]||{}).hidden||(f=hG(e,s,x,d,i,c,a,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function zN(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=av(e,t);return r}function pG(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var s=Ze(e["!ref"]),a="",i=[],o,c=[],u=Array.isArray(e);for(o=s.s.c;o<=s.e.c;++o)i[o]=bt(o);for(var f=s.s.r;f<=s.e.r;++f)for(a=Dt(f),o=s.s.c;o<=s.e.c;++o)if(t=i[o]+a,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function WN(e,t,r){var n=r||{},s=+!n.skipHeader,a=e||{},i=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var c=typeof n.origin=="string"?St(n.origin):n.origin;i=c.r,o=c.c}var u,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+s}};if(a["!ref"]){var d=Ze(a["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+s)}else i==-1&&(i=0,f.e.r=t.length-1+s);var h=n.header||[],p=0;t.forEach(function(m,x){Pt(m).forEach(function(y){(p=h.indexOf(y))==-1&&(h[p=h.length]=y);var w=m[y],v="z",S="",E=je({c:o+p,r:i+x+s});u=eu(a,E),w&&typeof w=="object"&&!(w instanceof Date)?a[E]=w:(typeof w=="number"?v="n":typeof w=="boolean"?v="b":typeof w=="string"?v="s":w instanceof Date?(v="d",n.cellDates||(v="n",w=Yt(w)),S=n.dateNF||Ae[14]):w===null&&n.nullError&&(v="e",w=0),u?(u.t=v,u.v=w,delete u.w,delete u.R,S&&(u.z=S)):a[E]=u={t:v,v:w},S&&(u.z=S))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var g=Dt(i);if(s)for(p=0;p<h.length;++p)a[bt(p+o)+g]={t:"s",v:h[p]};return a["!ref"]=$e(f),a}function mG(e,t){return WN(null,e,t)}function eu(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=St(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?eu(e,je(t)):eu(e,je({r:t,c:r||0}))}function xG(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function iv(){return{SheetNames:[],Sheets:{}}}function ov(e,t,r,n){var s=1;if(!r)for(;s<=65535&&e.SheetNames.indexOf(r="Sheet"+s)!=-1;++s,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);s=a&&+a[2]||0;var i=a&&a[1]||r;for(++s;s<=65535&&e.SheetNames.indexOf(r=i+s)!=-1;++s);}if(TN(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function gG(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=xG(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function vG(e,t){return e.z=t,e}function VN(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function wG(e,t,r){return VN(e,"#"+t,r)}function yG(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function _G(e,t,r,n){for(var s=typeof t!="string"?t:Ze(t),a=typeof t=="string"?t:$e(t),i=s.s.r;i<=s.e.r;++i)for(var o=s.s.c;o<=s.e.c;++o){var c=eu(e,i,o);c.t="n",c.F=a,delete c.v,i==s.s.r&&o==s.s.c&&(c.f=r,n&&(c.D=!0))}return e}var Bf={encode_col:bt,encode_row:Dt,encode_cell:je,encode_range:$e,decode_col:Dg,decode_row:Ig,split_cell:FL,decode_cell:St,decode_range:qr,format_cell:Xs,sheet_add_aoa:gT,sheet_add_json:WN,sheet_add_dom:ON,aoa_to_sheet:gl,json_to_sheet:mG,table_to_sheet:IN,table_to_book:AH,sheet_to_csv:av,sheet_to_txt:zN,sheet_to_json:Md,sheet_to_html:FN,sheet_to_formulae:pG,sheet_to_row_object_array:Md,sheet_get_cell:eu,book_new:iv,book_append_sheet:ov,book_set_sheet_visibility:gG,cell_set_number_format:vG,cell_set_hyperlink:VN,cell_set_internal_link:wG,cell_add_comment:yG,sheet_set_array_formula:_G,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const bG=e=>new Promise((t,r)=>{const n=new FileReader;n.onload=s=>{var a;try{const i=new Uint8Array((a=s.target)==null?void 0:a.result),o=Um(i,{type:"array"}),c=o.Sheets[o.SheetNames[0]],f=Bf.sheet_to_json(c).map(d=>{const h=d.full_name||d.FullName||d["Full Name"]||d.name||d.Name,p=d.email||d.Email,g=d.group_name||d.GroupName||d["Group Name"]||d.group||d.Group,m=d.phone||d.Phone,x=d.cssbattle_profile_link||d.CSSBattleProfileLink||d["CSS Battle Profile Link"]||d.css_link||d.CSSLink,y=d.verified_ofppt||d.VerifiedOfppt||d["Verified OFPPT"]||d.verified||d.Verified;if(!h||!p||!g)throw new Error("Missing required fields: full_name, email, and group_name are required");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(p.toString()))throw new Error(`Invalid email format: ${p}`);return{full_name:h.toString().trim(),email:p.toString().trim(),group_name:g.toString().trim(),phone:m?m.toString().trim():void 0,cssbattle_profile_link:x?x.toString().trim():void 0,verified_ofppt:y?y.toString().toLowerCase()==="true":!1}});t(f)}catch(i){r(new Error(`Failed to parse Excel file: ${i.message}`))}},n.onerror=()=>{r(new Error("Failed to read file"))},n.readAsArrayBuffer(e)}),SG=()=>{const e=[["full_name","email","group_name","phone","cssbattle_profile_link","verified_ofppt"],["John Doe","john.doe@example.com","DD101","123-456-7890","https://cssbattle.dev/player/johndoe","true"],["Jane Smith","jane.smith@example.com","DD102","098-765-4321","https://cssbattle.dev/player/janesmith","false"]],t=Bf.aoa_to_sheet(e),r=Bf.book_new();Bf.book_append_sheet(r,t,"Players");const n=$N(r,{bookType:"xlsx",type:"array"});return new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})},kG=()=>"players_template.xlsx",EG=({isOpen:e,onClose:t,onImportComplete:r})=>{const{toast:n}=Xr(),s=_.useRef(null),[a,i]=_.useState(null),[o,c]=_.useState(!1),[u,f]=_.useState(0),[d,h]=_.useState([]),[p,g]=_.useState([]);if(!e)return null;const m=()=>{const k=SG(),b=kG(),N=URL.createObjectURL(k),A=document.createElement("a");A.href=N,A.download=b,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(N)},x=k=>{var N;const b=(N=k.target.files)==null?void 0:N[0];b&&(i(b),h([]),g([]))},y=k=>{k.preventDefault()},w=k=>{var N;k.preventDefault();const b=(N=k.dataTransfer.files)==null?void 0:N[0];b&&(i(b),h([]),g([]))},v=async k=>{const b=[],N=ns.map(C=>C.value),A=new Set,O=k.map(C=>C.cssbattle_profile_link).filter(C=>C!=null&&C.trim()!=="");let V=[];if(O.length>0)try{const{data:C,error:B}=await ge.from("players").select("cssbattle_profile_link").in("cssbattle_profile_link",O);B?console.error("Error checking existing CSS Battle links:",B):C&&(V=C.map(G=>G.cssbattle_profile_link).filter(G=>G!==null))}catch(C){console.error("Error checking existing CSS Battle links:",C)}return k.forEach((C,B)=>{C.full_name||b.push({row:B+2,message:"Missing full name"}),C.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(C.email)||b.push({row:B+2,message:"Invalid email format"}):b.push({row:B+2,message:"Missing email"}),C.group_name?N.includes(C.group_name)||b.push({row:B+2,message:`Invalid group: ${C.group_name}`}):b.push({row:B+2,message:"Missing group"}),C.cssbattle_profile_link&&(A.has(C.cssbattle_profile_link)?b.push({row:B+2,message:`Duplicate CSS Battle profile link in import file: ${C.cssbattle_profile_link}`}):V.includes(C.cssbattle_profile_link)?b.push({row:B+2,message:`CSS Battle profile link already exists in database: ${C.cssbattle_profile_link}`}):A.add(C.cssbattle_profile_link))}),b},S=async()=>{if(!a){n({title:"Error",description:"Please select a file to import",variant:"destructive"});return}c(!0),h([]),g([]),f(0);try{const k=await bG(a),b=await v(k);if(b.length>0){g(b),n({title:"Validation Errors",description:`Found ${b.length} validation errors. Please check the details below.`,variant:"destructive"});return}let N=0;const A=[],O=10;for(let V=0;V<k.length;V+=O){const C=k.slice(V,V+O);await Promise.all(C.map(async B=>{try{const G=Math.random().toString(36).slice(-8),{data:X,error:z}=await ge.auth.signUp({email:B.email,password:G,options:{data:{full_name:B.full_name},emailRedirectTo:`${window.location.origin}/login`}});if(z){A.push(`Row ${k.indexOf(B)+2}: ${z.message}`);return}if(X.user){const{error:q}=await ge.from("players").insert([{id:X.user.id,full_name:B.full_name,email:B.email,group_name:B.group_name,phone:B.phone||null,cssbattle_profile_link:B.cssbattle_profile_link||null,verified_ofppt:B.verified_ofppt||!1,score:0}]);if(q){A.push(`Row ${k.indexOf(B)+2}: ${q.message}`);return}N++,f(N)}}catch(G){A.push(`Row ${k.indexOf(B)+2}: ${G.message}`)}}))}f(N),h(A),A.length===0?(n({title:"Success",description:`Successfully imported ${N} players!`}),r(),t()):n({title:"Partial Success",description:`Imported ${N} players with ${A.length} errors.`,variant:"destructive"})}catch(k){console.error("Import error:",k),n({title:"Error",description:`Failed to import players: ${k.message}`,variant:"destructive"})}finally{c(!1)}},E=()=>{i(null),h([]),g([]),s.current&&(s.current.value=""),t()};return l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:l.jsx(Pe,{className:"bg-card/90 backdrop-blur-sm border-battle-purple/30 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-xl font-bold text-foreground",children:"Import Players from Excel"}),l.jsx(fe,{variant:"ghost",size:"icon",onClick:E,className:"text-foreground hover:bg-battle-purple/10 hover:text-foreground",children:l.jsx(rn,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"p-4 bg-background/50 rounded-lg border border-battle-purple/30",children:[l.jsx("h4",{className:"font-semibold text-foreground mb-2",children:"Download Template"}),l.jsx("p",{className:"text-sm text-foreground/80 mb-3",children:"Download the Excel template to ensure your data is formatted correctly."}),l.jsxs(fe,{onClick:m,variant:"outline",className:"border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:[l.jsx(_P,{className:"w-4 h-4 mr-2"}),"Download Template"]})]}),l.jsxs("div",{className:"border-2 border-dashed border-battle-purple/50 rounded-lg p-8 text-center cursor-pointer hover:bg-battle-purple/5 transition-colors",onDragOver:y,onDrop:w,onClick:()=>{var k;return(k=s.current)==null?void 0:k.click()},children:[l.jsx(nm,{className:"w-12 h-12 mx-auto text-battle-purple/50 mb-3"}),l.jsx("p",{className:"font-medium text-foreground mb-1",children:a?a.name:"Click to upload or drag and drop"}),l.jsx("p",{className:"text-sm text-foreground/70",children:a?"File selected":"Excel files only (.xlsx, .xls)"}),l.jsx(tt,{ref:s,type:"file",accept:".xlsx,.xls",onChange:x,className:"hidden"})]}),p.length>0&&l.jsxs("div",{className:"p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx(dd,{className:"w-5 h-5 text-red-500 mr-2"}),l.jsx("h4",{className:"font-semibold text-red-500",children:"Validation Errors"})]}),l.jsx("div",{className:"max-h-40 overflow-y-auto",children:p.map((k,b)=>l.jsxs("p",{className:"text-sm text-foreground mb-1",children:["Row ",k.row,": ",k.message]},b))})]}),d.length>0&&l.jsxs("div",{className:"p-4 bg-red-500/10 border border-red-500/30 rounded-lg",children:[l.jsxs("div",{className:"flex items-center mb-2",children:[l.jsx(dd,{className:"w-5 h-5 text-red-500 mr-2"}),l.jsx("h4",{className:"font-semibold text-red-500",children:"Import Errors"})]}),l.jsx("div",{className:"max-h-40 overflow-y-auto",children:d.map((k,b)=>l.jsx("p",{className:"text-sm text-foreground mb-1",children:k},b))})]}),u>0&&d.length===0&&l.jsx("div",{className:"p-4 bg-green-500/10 border border-green-500/30 rounded-lg",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(Rc,{className:"w-5 h-5 text-green-500 mr-2"}),l.jsxs("h4",{className:"font-semibold text-green-500",children:["Successfully imported ",u," players!"]})]})}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(fe,{onClick:E,variant:"outline",className:"flex-1 border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",disabled:o,children:"Cancel"}),l.jsx(fe,{onClick:S,className:"flex-1 bg-gradient-primary hover:scale-105 transition-transform shadow-glow",disabled:!a||o,children:o?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processing..."]}):l.jsxs(l.Fragment,{children:[l.jsx(nm,{className:"w-4 h-4 mr-2"}),"Import Players"]})})]})]})]})})})},HN=({isOpen:e,onClose:t})=>{const r=dr(),{toast:n}=Xr(),{admin:s,isAdmin:a,loading:i,fetchUnreadMessageCount:o}=Kr(),[c,u]=_.useState([]),[f,d]=_.useState([]),[h,p]=_.useState(!0),[g,m]=_.useState("all"),[x,y]=_.useState(null),[w,v]=_.useState(""),[S,E]=_.useState([]),[k,b]=_.useState(window.innerWidth<768),[N,A]=_.useState(!1),[O,V]=_.useState(null),C=_.useRef(null),B=()=>{var Y;(Y=C.current)==null||Y.scrollIntoView({behavior:"smooth"})};_.useEffect(()=>{B()},[S]),_.useEffect(()=>{const Y=()=>{b(window.innerWidth<768)};return window.addEventListener("resize",Y),()=>window.removeEventListener("resize",Y)},[]),_.useEffect(()=>{const Y=()=>{if(window.visualViewport){const j=window.innerHeight-window.visualViewport.height>100;A(j)}};if(window.visualViewport)return window.visualViewport.addEventListener("resize",Y),()=>{window.visualViewport.removeEventListener("resize",Y)};{const j=()=>A(!0),H=()=>A(!1),U=document.querySelectorAll("input, textarea");return U.forEach(W=>{W.addEventListener("focusin",j),W.addEventListener("focusout",H)}),()=>{U.forEach(W=>{W.removeEventListener("focusin",j),W.removeEventListener("focusout",H)})}}},[]),_.useEffect(()=>{e&&(G(),X())},[e,a,s]);const G=async()=>{if(e)try{if(!(s!=null&&s.email)){console.warn("Admin email not available"),u([]),p(!1);return}const{data:Y,error:j}=await ge.from("contact_messages").select("*").eq("recipient_email",s.email).order("created_at",{ascending:!1});if(j)throw j;const H=(Y||[]).map(W=>({...W,status:W.status}));u(H),p(!1);const U=H.filter(W=>W.status==="unread");U.length>0&&(await Promise.all(U.map(async W=>{const{error:J}=await ge.from("contact_messages").update({status:"read",updated_at:new Date().toISOString()}).eq("id",W.id);J&&console.error("Failed to mark message as read:",J)})),setTimeout(()=>{G(),o()},100))}catch(Y){console.error("Failed to fetch messages:",Y),n({title:"Error",description:"Failed to fetch messages",variant:"destructive"}),p(!1)}},X=async()=>{try{const{data:Y,error:j}=await ge.from("players").select("id, full_name, email, group_name, score").order("full_name",{ascending:!0});if(j)throw j;d(Y||[])}catch(Y){console.error("Failed to fetch players:",Y),d([])}},z=async Y=>{if(!(s!=null&&s.id)||!(s!=null&&s.email)){n({title:"Error",description:"Admin not properly authenticated",variant:"destructive"}),p(!1);return}console.log("Admin object:",s),console.log("Admin ID:",s.id),console.log("Admin email:",s.email),console.log("Player object:",Y);try{if(p(!0),console.log("Fetching messages for player:",Y),!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(s.id)){console.error("Admin ID is not a valid UUID:",s.id),n({title:"Error",description:"Admin data is corrupted. Please log out and log back in.",variant:"destructive"}),p(!1);return}const H=s.id==="00000000-0000-0000-0000-000000000000";let U;H?U=`and(sender_email.eq.${Y.email},recipient_email.eq.${s.email}),and(sender_email.eq.${s.email},recipient_email.eq.${Y.email})`:U=`and(sender_email.eq.${Y.email},recipient_email.eq.${s.email}),and(sender_id.eq.${s.id},recipient_email.eq.${Y.email})`;const{data:W,error:J}=await ge.from("contact_messages").select("*").or(U).order("created_at",{ascending:!0});if(J)throw console.error("Error fetching player messages:",J),J;console.log("Fetched player messages:",W);const te=(W||[]).map(ae=>({...ae,status:ae.status}));E(te),y(Y);const oe=te.filter(ae=>ae.status==="unread"&&ae.recipient_email===s.email&&(ae.sender_email===Y.email||H&&ae.sender_email===Y.email));oe.length>0&&(console.log("Marking messages as read:",oe.length),await Promise.all(oe.map(async ae=>{const{error:se}=await ge.from("contact_messages").update({status:"read",updated_at:new Date().toISOString()}).eq("id",ae.id);se&&console.error("Failed to mark message as read:",se)})),G(),o())}catch(j){console.error("Failed to fetch player messages:",j);const H=j instanceof Error?j.message:String(j);n({title:"Error",description:"Failed to fetch conversation: "+H,variant:"destructive"})}finally{p(!1)}},q=Y=>{r(`/admin/player/${Y}`),t()},K=Y=>{console.log("Selecting player:",Y),z(Y)},F=async()=>{if(!x||!w.trim()||!(s!=null&&s.email)||!(s!=null&&s.id)){n({title:"Error",description:"Missing required information to send message",variant:"destructive"});return}try{const j=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(s.id),H=s.id==="00000000-0000-0000-0000-000000000000";if(!j){n({title:"Error",description:"Admin data is corrupted. Please log out and log back in.",variant:"destructive"});return}const U=O?`[Replying to: "${O.message.substring(0,50)}..."] ${w}`:w,W={sender_id:H?null:s.id,sender_name:"Admin",sender_email:s.email,recipient_email:x.email,subject:`Re: Message from ${x.full_name}`,message:U,status:"unread"},{error:J}=await ge.from("contact_messages").insert(W);if(J)if(console.error("Failed to send message:",J),J.message.includes("new row violates row-level security policy"))if(H)n({title:"Error",description:"Admin messaging is not available in this mode. Please contact system administrator.",variant:"destructive"});else throw J;else throw J;else v(""),V(null),n({title:"Success",description:"Message sent successfully!"}),await G(),x&&await z(x)}catch(Y){console.error("Failed to send message:",Y);const j=Y instanceof Error?Y.message:String(Y);n({title:"Error",description:"Failed to send message: "+j,variant:"destructive"})}};c.filter(Y=>g==="all"||Y.status===g);const ne=f.filter((Y,j,H)=>j===H.findIndex(U=>U.id===Y.id));return e?l.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden pointer-events-none",children:[l.jsx("div",{className:"fixed inset-0 bg-black/0 transition-opacity pointer-events-auto",onClick:t}),l.jsx("div",{className:"fixed inset-y-0 right-0 flex max-w-full pointer-events-auto",children:l.jsx("div",{className:"relative w-screen max-w-4xl h-full",children:l.jsxs("div",{className:"flex h-full bg-background border-l border-battle-purple/20 shadow-xl flex-col md:flex-row",children:[l.jsxs("div",{className:`border-r border-battle-purple/20 flex flex-col md:w-1/3 ${x&&k?"hidden":"flex"}`,children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-4 border-b border-battle-purple/20",children:[l.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Messages"}),l.jsx(fe,{variant:"ghost",size:"icon",onClick:t,className:"text-foreground hover:bg-battle-purple/10",children:l.jsx(rn,{className:"h-5 w-5"})})]}),l.jsx("div",{className:"px-4 py-3 border-b border-battle-purple/20",children:l.jsxs(xs,{value:g,onValueChange:m,children:[l.jsx(Hn,{className:"w-full bg-background border-primary/30",children:l.jsx(gs,{placeholder:"Filter by status"})}),l.jsxs(Gn,{children:[l.jsx(Ct,{value:"all",children:"All Messages"}),l.jsx(Ct,{value:"unread",children:"Unread"}),l.jsx(Ct,{value:"read",children:"Read"}),l.jsx(Ct,{value:"replied",children:"Replied"})]})]})}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:h?l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsx("div",{className:"animate-pulse text-foreground",children:"Loading contacts..."})}):ne.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:[l.jsx(cl,{className:"w-12 h-12 text-muted-foreground mb-4"}),l.jsx("p",{className:"text-muted-foreground",children:"No contacts found"})]}):l.jsx("div",{className:"divide-y divide-battle-purple/10",children:ne.map(Y=>{const j=c.filter(U=>U.sender_email===Y.email&&U.recipient_email===s.email||U.recipient_email===Y.email&&(U.sender_id===(s==null?void 0:s.id)||U.sender_email===(s==null?void 0:s.email))),H=j.filter(U=>U.status==="unread").length;return l.jsxs("div",{className:`p-4 cursor-pointer hover:bg-battle-purple/5 transition-colors ${(x==null?void 0:x.id)===Y.id?"bg-battle-purple/10":""}`,onClick:()=>K(Y),children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-primary flex items-center justify-center",children:l.jsx(Jn,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-foreground",children:Y.full_name}),l.jsx("p",{className:"text-xs text-muted-foreground truncate max-w-[150px]",children:Y.email})]})]}),H>0&&l.jsx(or,{variant:"default",className:"rounded-full",children:H})]}),j.length>0&&l.jsx("p",{className:"text-xs text-muted-foreground mt-2 truncate",children:j[j.length-1].message})]},Y.id)})})})]}),l.jsx("div",{className:`flex flex-col ${x&&k?"w-full":"md:w-2/3"} ${!x&&k?"hidden md:flex":"flex"}`,children:x?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-4 border-b border-battle-purple/20",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[k&&l.jsx(fe,{variant:"ghost",size:"icon",onClick:()=>y(null),className:"text-foreground hover:bg-battle-purple/10 md:hidden",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:l.jsx("path",{d:"m15 18-6-6 6-6"})})}),l.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-primary flex items-center justify-center",children:l.jsx(Jn,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-foreground",children:x.full_name}),l.jsx("p",{className:"text-xs text-muted-foreground truncate max-w-[150px]",children:x.email})]})]}),l.jsx(fe,{variant:"ghost",size:"icon",onClick:()=>q(x.id),className:"text-foreground hover:bg-battle-purple/10",children:l.jsx(Fb,{className:"h-5 w-5"})})]}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:h?l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsx("div",{className:"animate-pulse text-foreground",children:"Loading messages..."})}):S.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[l.jsx(hd,{className:"w-16 h-16 text-muted-foreground mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No messages yet"}),l.jsxs("p",{className:"text-muted-foreground max-w-xs",children:["Start a conversation with ",x.full_name]})]}):l.jsxs("div",{className:"space-y-4",children:[S.map(Y=>{const j=Y.message.match(/^\[Replying to: "(.*?)"\] (.*)$/),H=j?j[1]:null,U=j?j[2]:Y.message;return l.jsx("div",{className:`flex ${Y.sender_id===(s==null?void 0:s.id)||Y.sender_email===(s==null?void 0:s.email)?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`group max-w-xs lg:max-w-md px-4 py-2 rounded-lg relative ${Y.sender_id===(s==null?void 0:s.id)||Y.sender_email===(s==null?void 0:s.email)?"bg-battle-purple text-white rounded-br-none":"bg-muted text-foreground rounded-bl-none"}`,children:[H&&l.jsxs("div",{className:"text-xs opacity-70 mb-2 pb-2 border-b border-white/20",children:[l.jsx(Io,{className:"w-3 h-3 inline mr-1"}),H]}),l.jsx("p",{className:"text-sm",children:U}),l.jsxs("div",{className:`text-xs mt-1 flex items-center justify-between ${Y.sender_id===(s==null?void 0:s.id)||Y.sender_email===(s==null?void 0:s.email)?"text-battle-purple-foreground/80":"text-muted-foreground"}`,children:[l.jsxs("div",{className:"flex items-center",children:[Y.sender_id===(s==null?void 0:s.id)||Y.sender_email===(s==null?void 0:s.email)?Y.status==="read"?l.jsx(Rb,{className:"w-3 h-3 mr-1 text-blue-400"}):l.jsx(a0,{className:"w-3 h-3 mr-1 text-white/60"}):null,new Date(Y.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),l.jsx(fe,{size:"sm",variant:"ghost",className:"h-6 px-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>V(Y),children:l.jsx(Io,{className:"w-3 h-3"})})]})]})},Y.id)}),l.jsx("div",{ref:C})]})}),l.jsxs("div",{className:`border-t border-battle-purple/20 p-4 transition-all duration-300 ${k&&N?"fixed bottom-0 left-0 right-0 bg-background z-50":""}`,style:{left:k&&N?"auto":"",right:k&&N?"0":"",width:k&&N?"calc(100% - 2rem)":"",marginLeft:k&&N?"1rem":"",marginRight:k&&N?"1rem":""},children:[O&&l.jsxs("div",{className:"mb-2 p-2 bg-muted rounded-lg flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx(Io,{className:"w-4 h-4 text-primary"}),l.jsx("span",{className:"text-muted-foreground",children:"Replying to:"}),l.jsx("span",{className:"truncate max-w-[200px]",children:O.message})]}),l.jsx(fe,{size:"sm",variant:"ghost",onClick:()=>V(null),className:"h-6 w-6 p-0",children:l.jsx(rn,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(tt,{value:w,onChange:Y=>v(Y.target.value),placeholder:"Type a message...",className:"flex-1 bg-background/50 border-primary/30",onKeyDown:Y=>{Y.key==="Enter"&&!Y.shiftKey&&(Y.preventDefault(),F())},onFocus:()=>A(!0),onBlur:()=>A(!1)}),l.jsx(fe,{onClick:F,disabled:!w.trim(),className:"bg-gradient-primary hover:scale-105 transition-transform",children:l.jsx(Ib,{className:"w-4 h-4"})})]})]})]}):l.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[l.jsx(hd,{className:"w-16 h-16 text-muted-foreground mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Select a contact"}),l.jsx("p",{className:"text-muted-foreground max-w-xs",children:"Choose a player from the contacts list to start chatting"})]})})]})})})]}):null};function ja(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e==null||e(s),r===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}var TG="DismissableLayer",$m="dismissableLayer.update",NG="dismissableLayer.pointerDownOutside",CG="dismissableLayer.focusOutside",Hy,GN=_.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),qN=_.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:i,onDismiss:o,...c}=e,u=_.useContext(GN),[f,d]=_.useState(null),h=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=_.useState({}),g=Ye(t,b=>d(b)),m=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),y=m.indexOf(x),w=f?m.indexOf(f):-1,v=u.layersWithOutsidePointerEventsDisabled.size>0,S=w>=y,E=PG(b=>{const N=b.target,A=[...u.branches].some(O=>O.contains(N));!S||A||(s==null||s(b),i==null||i(b),b.defaultPrevented||o==null||o())},h),k=RG(b=>{const N=b.target;[...u.branches].some(O=>O.contains(N))||(a==null||a(b),i==null||i(b),b.defaultPrevented||o==null||o())},h);return Zx(b=>{w===u.layers.size-1&&(n==null||n(b),!b.defaultPrevented&&o&&(b.preventDefault(),o()))},h),_.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Hy=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),Gy(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=Hy)}},[f,h,r,u]),_.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),Gy())},[f,u]),_.useEffect(()=>{const b=()=>p({});return document.addEventListener($m,b),()=>document.removeEventListener($m,b)},[]),l.jsx(Le.div,{...c,ref:g,style:{pointerEvents:v?S?"auto":"none":void 0,...e.style},onFocusCapture:ja(e.onFocusCapture,k.onFocusCapture),onBlurCapture:ja(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:ja(e.onPointerDownCapture,E.onPointerDownCapture)})});qN.displayName=TG;var AG="DismissableLayerBranch",jG=_.forwardRef((e,t)=>{const r=_.useContext(GN),n=_.useRef(null),s=Ye(t,n);return _.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),l.jsx(Le.div,{...e,ref:s})});jG.displayName=AG;function PG(e,t=globalThis==null?void 0:globalThis.document){const r=nr(e),n=_.useRef(!1),s=_.useRef(()=>{});return _.useEffect(()=>{const a=o=>{if(o.target&&!n.current){let c=function(){KN(NG,r,u,{discrete:!0})};const u={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",a),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function RG(e,t=globalThis==null?void 0:globalThis.document){const r=nr(e),n=_.useRef(!1);return _.useEffect(()=>{const s=a=>{a.target&&!n.current&&KN(CG,r,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Gy(){const e=new CustomEvent($m);document.dispatchEvent(e)}function KN(e,t,r,{discrete:n}){const s=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?uu(s,a):s.dispatchEvent(a)}function FG(e,t){return _.useReducer((r,n)=>t[r][n]??r,e)}var O0=e=>{const{present:t,children:r}=e,n=OG(t),s=typeof r=="function"?r({present:n.isPresent}):_.Children.only(r),a=Ye(n.ref,IG(s));return typeof r=="function"||n.isPresent?_.cloneElement(s,{ref:a}):null};O0.displayName="Presence";function OG(e){const[t,r]=_.useState(),n=_.useRef(null),s=_.useRef(e),a=_.useRef("none"),i=e?"mounted":"unmounted",[o,c]=FG(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return _.useEffect(()=>{const u=gf(n.current);a.current=o==="mounted"?u:"none"},[o]),Lt(()=>{const u=n.current,f=s.current;if(f!==e){const h=a.current,p=gf(u);e?c("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(f&&h!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),Lt(()=>{if(t){let u;const f=t.ownerDocument.defaultView??window,d=p=>{const m=gf(n.current).includes(CSS.escape(p.animationName));if(p.target===t&&m&&(c("ANIMATION_END"),!s.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",u=f.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},h=p=>{p.target===t&&(a.current=gf(n.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{f.clearTimeout(u),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:_.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function gf(e){return(e==null?void 0:e.animationName)||"none"}function IG(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var tp=0;function DG(){_.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??qy()),document.body.insertAdjacentElement("beforeend",e[1]??qy()),tp++,()=>{tp===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),tp--}},[])}function qy(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var I0="Dialog",[XN,oK]=Ha(I0),[LG,ss]=XN(I0),YN=e=>{const{__scopeDialog:t,children:r,open:n,defaultOpen:s,onOpenChange:a,modal:i=!0}=e,o=_.useRef(null),c=_.useRef(null),[u,f]=Qo({prop:n,defaultProp:s??!1,onChange:a,caller:I0});return l.jsx(LG,{scope:t,triggerRef:o,contentRef:c,contentId:Bs(),titleId:Bs(),descriptionId:Bs(),open:u,onOpenChange:f,onOpenToggle:_.useCallback(()=>f(d=>!d),[f]),modal:i,children:r})};YN.displayName=I0;var JN="DialogTrigger",MG=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ss(JN,r),a=Ye(t,s.triggerRef);return l.jsx(Le.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":uv(s.open),...n,ref:a,onClick:ja(e.onClick,s.onOpenToggle)})});MG.displayName=JN;var lv="DialogPortal",[BG,QN]=XN(lv,{forceMount:void 0}),ZN=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:s}=e,a=ss(lv,t);return l.jsx(BG,{scope:t,forceMount:r,children:_.Children.map(n,i=>l.jsx(O0,{present:r||a.open,children:l.jsx(du,{asChild:!0,container:s,children:i})}))})};ZN.displayName=lv;var Bd="DialogOverlay",eC=_.forwardRef((e,t)=>{const r=QN(Bd,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,a=ss(Bd,e.__scopeDialog);return a.modal?l.jsx(O0,{present:n||a.open,children:l.jsx($G,{...s,ref:t})}):null});eC.displayName=Bd;var UG=Ti("DialogOverlay.RemoveScroll"),$G=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ss(Bd,r);return l.jsx(v0,{as:UG,allowPinchZoom:!0,shards:[s.contentRef],children:l.jsx(Le.div,{"data-state":uv(s.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Li="DialogContent",tC=_.forwardRef((e,t)=>{const r=QN(Li,e.__scopeDialog),{forceMount:n=r.forceMount,...s}=e,a=ss(Li,e.__scopeDialog);return l.jsx(O0,{present:n||a.open,children:a.modal?l.jsx(zG,{...s,ref:t}):l.jsx(WG,{...s,ref:t})})});tC.displayName=Li;var zG=_.forwardRef((e,t)=>{const r=ss(Li,e.__scopeDialog),n=_.useRef(null),s=Ye(t,r.contentRef,n);return _.useEffect(()=>{const a=n.current;if(a)return ug(a)},[]),l.jsx(rC,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ja(e.onCloseAutoFocus,a=>{var i;a.preventDefault(),(i=r.triggerRef.current)==null||i.focus()}),onPointerDownOutside:ja(e.onPointerDownOutside,a=>{const i=a.detail.originalEvent,o=i.button===0&&i.ctrlKey===!0;(i.button===2||o)&&a.preventDefault()}),onFocusOutside:ja(e.onFocusOutside,a=>a.preventDefault())})}),WG=_.forwardRef((e,t)=>{const r=ss(Li,e.__scopeDialog),n=_.useRef(!1),s=_.useRef(!1);return l.jsx(rC,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{var i,o;(i=e.onCloseAutoFocus)==null||i.call(e,a),a.defaultPrevented||(n.current||(o=r.triggerRef.current)==null||o.focus(),a.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:a=>{var c,u;(c=e.onInteractOutside)==null||c.call(e,a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const i=a.target;((u=r.triggerRef.current)==null?void 0:u.contains(i))&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}})}),rC=_.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:a,...i}=e,o=ss(Li,r),c=_.useRef(null),u=Ye(t,c);return DG(),l.jsxs(l.Fragment,{children:[l.jsx(d0,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:a,children:l.jsx(qN,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":uv(o.open),...i,ref:u,onDismiss:()=>o.onOpenChange(!1)})}),l.jsxs(l.Fragment,{children:[l.jsx(VG,{titleId:o.titleId}),l.jsx(GG,{contentRef:c,descriptionId:o.descriptionId})]})]})}),cv="DialogTitle",nC=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ss(cv,r);return l.jsx(Le.h2,{id:s.titleId,...n,ref:t})});nC.displayName=cv;var sC="DialogDescription",aC=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ss(sC,r);return l.jsx(Le.p,{id:s.descriptionId,...n,ref:t})});aC.displayName=sC;var iC="DialogClose",oC=_.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,s=ss(iC,r);return l.jsx(Le.button,{type:"button",...n,ref:t,onClick:ja(e.onClick,()=>s.onOpenChange(!1))})});oC.displayName=iC;function uv(e){return e?"open":"closed"}var lC="DialogTitleWarning",[lK,cC]=bO(lC,{contentName:Li,titleName:cv,docsSlug:"dialog"}),VG=({titleId:e})=>{const t=cC(lC),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return _.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},HG="DialogDescriptionWarning",GG=({contentRef:e,descriptionId:t})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${cC(HG).contentName}}.`;return _.useEffect(()=>{var a;const s=(a=e.current)==null?void 0:a.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(n))},[n,e,t]),null},qG=YN,KG=ZN,uC=eC,fC=tC,dC=nC,hC=aC,XG=oC;const YG=qG,JG=KG,pC=_.forwardRef(({className:e,...t},r)=>l.jsx(uC,{ref:r,className:Ke("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));pC.displayName=uC.displayName;const mC=_.forwardRef(({className:e,children:t,...r},n)=>l.jsxs(JG,{children:[l.jsx(pC,{}),l.jsxs(fC,{ref:n,className:Ke("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,l.jsxs(XG,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[l.jsx(rn,{className:"h-4 w-4"}),l.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));mC.displayName=fC.displayName;const xC=({className:e,...t})=>l.jsx("div",{className:Ke("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});xC.displayName="DialogHeader";const gC=_.forwardRef(({className:e,...t},r)=>l.jsx(dC,{ref:r,className:Ke("text-lg font-semibold leading-none tracking-tight",e),...t}));gC.displayName=dC.displayName;const QG=_.forwardRef(({className:e,...t},r)=>l.jsx(hC,{ref:r,className:Ke("text-sm text-muted-foreground",e),...t}));QG.displayName=hC.displayName;function ZG({isOpen:e,onClose:t,onSave:r,player:n,mode:s}){const[a,i]=_.useState({full_name:"",email:"",phone:"",css_link:"",group_name:"",score:0,password:""}),[o,c]=_.useState(!1);_.useEffect(()=>{i(n&&s==="edit"?{...n,password:""}:{full_name:"",email:"",phone:"",css_link:"",group_name:"",score:0,password:""})},[n,s,e]);const u=async f=>{f.preventDefault(),c(!0);try{await r(a),t()}catch(d){console.error("Error saving player:",d)}finally{c(!1)}};return l.jsx(YG,{open:e,onOpenChange:t,children:l.jsxs(mC,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[l.jsx(xC,{children:l.jsx(gC,{children:s==="create"?"Create New Player":"Edit Player"})}),l.jsxs("form",{onSubmit:u,className:"space-y-4",children:[l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"full_name",children:"Full Name *"}),l.jsx(tt,{id:"full_name",value:a.full_name,onChange:f=>i({...a,full_name:f.target.value}),required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"email",children:"Email *"}),l.jsx(tt,{id:"email",type:"email",value:a.email,onChange:f=>i({...a,email:f.target.value}),required:!0,disabled:s==="edit"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"phone",children:"Phone"}),l.jsx(tt,{id:"phone",value:a.phone,onChange:f=>i({...a,phone:f.target.value})})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"group_name",children:"Group *"}),l.jsxs(xs,{value:a.group_name,onValueChange:f=>i({...a,group_name:f}),children:[l.jsx(Hn,{children:l.jsx(gs,{placeholder:"Select group"})}),l.jsx(Gn,{children:u6.map(f=>l.jsx(Ct,{value:f,children:f},f))})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"css_link",children:"CSS Battle Profile Link"}),l.jsx(tt,{id:"css_link",value:a.css_link,onChange:f=>i({...a,css_link:f.target.value}),placeholder:"https://cssbattle.dev/player/..."})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"score",children:"Score"}),l.jsx(tt,{id:"score",type:"number",value:a.score,onChange:f=>i({...a,score:parseInt(f.target.value)||0})})]}),s==="create"&&l.jsxs("div",{className:"space-y-2 col-span-2",children:[l.jsx(He,{htmlFor:"password",children:"Password *"}),l.jsx(tt,{id:"password",type:"password",value:a.password,onChange:f=>i({...a,password:f.target.value}),required:s==="create",placeholder:"Enter password for player"})]}),s==="edit"&&l.jsxs("div",{className:"space-y-2 col-span-2",children:[l.jsx(He,{htmlFor:"password",children:"New Password (leave empty to keep current)"}),l.jsx(tt,{id:"password",type:"password",value:a.password,onChange:f=>i({...a,password:f.target.value}),placeholder:"Enter new password or leave empty"})]})]}),l.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[l.jsx(fe,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),l.jsx(fe,{type:"submit",disabled:o,children:o?"Saving...":s==="create"?"Create Player":"Update Player"})]})]})]})})}const eq=()=>{var ju,Za;const e=dr(),{logout:t,isAdmin:r,loading:n,admin:s}=Kr(),[a,i]=_.useState([]),[o,c]=_.useState(!0),[u,f]=_.useState(null),[d,h]=_.useState(null),[p,g]=_.useState(""),[m,x]=_.useState("all"),[y,w]=_.useState(""),[v,S]=_.useState(!1),[E,k]=_.useState(null),[b,N]=_.useState(new Set),[A,O]=_.useState(!1),[V,C]=_.useState(!1),[B,G]=_.useState(""),[X,z]=_.useState(""),[q,K]=_.useState(""),[F,ne]=_.useState(""),[Y,j]=_.useState("all"),[H,U]=_.useState("all"),[W,J]=_.useState({isOpen:!1,player:null}),[te,oe]=_.useState({isOpen:!1}),[ae,se]=_.useState(!1),[de,I]=_.useState({full_name:"",email:"",group_name:"",password:"",phone:"",cssbattle_profile_link:""}),[Be,Re]=_.useState(!1),[Ve,Oe]=_.useState({isOpen:!1,player:null,userId:null}),[xe,it]=_.useState(""),[Rt,Yr]=_.useState(!1),[On,ta]=_.useState(!1),[as,Nr]=_.useState(0),[In,is]=_.useState(0),[Ja,sr]=_.useState(!1);_.useEffect(()=>{if(!(typeof window>"u")&&!n){if(!r){e("/admin");return}w((s==null?void 0:s.email)||""),xn(),De()}},[r,n,s,e]);const xn=async()=>{try{const{data:ue,error:ke}=await ge.from("players").select("id").limit(1);console.log("AdminDashboard - Select test:",{data:ue,error:ke})}catch(ue){console.error("AdminDashboard - Permission test error:",ue)}},De=async()=>{var ue;try{const{data:ke,error:lt}=await ge.from("players").select("*").order("created_at",{ascending:!1});if(lt)throw lt;i(ke||[]),Nr((ke==null?void 0:ke.length)||0);const Dn=((ue=ke==null?void 0:ke.filter(hr=>hr.cssbattle_profile_link))==null?void 0:ue.length)||0;is(Dn)}catch(ke){f("Failed to fetch players"),console.error(ke)}finally{c(!1)}},vt=ue=>{k(ue),S(!0)},Lr=async ue=>{try{c(!0),f(null);const{error:ke}=await ge.auth.resetPasswordForEmail(ue.email,{redirectTo:`${window.location.origin}/reset-password`});if(ke)throw new Error(ke.message);h(`Password reset email sent to ${ue.email} successfully! The user can now reset their password.`),setTimeout(()=>h(null),5e3)}catch(ke){f("Failed to send password reset email: "+ke.message),console.error(ke)}finally{c(!1)}},Ft=async ue=>{try{if(!E)return;const ke={full_name:ue.full_name,email:ue.email,cssbattle_profile_link:ue.css_link||null,phone:ue.phone||null,group_name:ue.group_name||null,score:ue.score};ue.password&&await ge.auth.resetPasswordForEmail(ue.email,{redirectTo:`${window.location.origin}/reset-password`});const{error:lt}=await ge.from("players").update(ke).eq("id",E.id);if(lt)throw lt;h("Player updated successfully!"),De()}catch(ke){throw console.error("Failed to update player:",ke),ke}},Cs=async()=>{if(!de.full_name||!de.email||!de.group_name||!de.password){f("Please fill in all required fields");return}Re(!0),f(null);try{const{data:ue,error:ke}=await ge.auth.signUp({email:de.email,password:de.password,options:{data:{full_name:de.full_name},emailRedirectTo:`${window.location.origin}/login`}});if(ke)throw new Error(ke.message);if(ue.user){if(de.cssbattle_profile_link){const{data:Dn,error:hr}=await ge.from("players").select("id, full_name").eq("cssbattle_profile_link",de.cssbattle_profile_link);if(hr)throw new Error(`Database error: ${hr.message}`);if(Dn&&Dn.length>0)throw new Error("CSS Battle link is already in use by another player")}const{error:lt}=await ge.from("players").insert([{id:ue.user.id,full_name:de.full_name,email:de.email,cssbattle_profile_link:de.cssbattle_profile_link||null,group_name:de.group_name,phone:de.phone||null,score:0}]);if(lt)throw new Error(lt.message);h("Player account created successfully!"),se(!1),I({full_name:"",email:"",group_name:"",password:"",phone:"",cssbattle_profile_link:""}),De(),setTimeout(()=>h(null),3e3)}}catch(ue){f("Failed to create player account: "+ue.message),console.error(ue)}finally{Re(!1)}},Tu=async ue=>{console.log("=== DELETE OPERATION START ==="),console.log("Attempting to delete player with ID:",ue);try{c(!0),f(null),console.log("Attempting to delete player from players table...");const{data:ke,error:lt}=await ge.from("players").delete().eq("id",ue).select();if(console.log("Delete operation result:",{data:ke,error:lt}),lt)throw console.error("Database delete error:",lt),lt.code==="42501"?new Error("Permission denied. You may not have the required permissions to delete this record."):new Error(`Failed to delete player from database: ${lt.message}`);ke&&Array.isArray(ke)&&ke.length>0?(console.log("Player deleted successfully:",ke[0]),h("Player deleted successfully!")):(console.warn("No rows were deleted - player may not exist or was already deleted"),h("Player may have already been deleted.")),J({isOpen:!1,player:null}),De(),console.log("=== DELETE OPERATION END ===")}catch(ke){console.error("=== DELETE OPERATION ERROR ==="),console.error("Error details:",ke);const lt=ke.message||"Unknown error occurred";f("Delete failed: "+lt),J({isOpen:!1,player:null})}finally{c(!1)}},L0=async()=>{if(!xe||xe.length<6){f("Password must be at least 6 characters");return}if(!Ve.userId){f("User ID not found");return}Yr(!0),f(null);try{const{data:{session:ue}}=await ge.auth.getSession();if(!ue){f("You must be logged in to perform this action");return}const{data:ke,error:lt}=await ge.functions.invoke("admin-manage-password",{body:{action:"update_password",userId:Ve.userId,newPassword:xe}});if(lt)throw lt;h("Password updated successfully!"),Oe({isOpen:!1,player:null,userId:null}),it(""),setTimeout(()=>h(null),3e3)}catch(ue){console.error("Password update error:",ue),f(`Failed to update password: ${ue.message}`)}finally{Yr(!1)}},M0=ue=>{const ke=new Set(b);ke.has(ue)?ke.delete(ue):ke.add(ue),N(ke)},Nu=()=>{b.size===Qa.length?N(new Set):N(new Set(Qa.map(ue=>ue.id)))},Cu=async()=>{var ue;if(b.size===0){f("No players selected for deletion");return}O(!0),f(null),h(null);try{const ke=Array.from(b),lt=ke.map(Cr=>ge.from("players").delete().eq("id",Cr)),hr=(await Promise.all(lt)).filter(Cr=>Cr.error);if(hr.length>0)throw new Error(`Failed to delete ${hr.length} players: ${(ue=hr[0].error)==null?void 0:ue.message}`);h(`Successfully deleted ${ke.length} players`),N(new Set),De()}catch(ke){console.error("Bulk delete error:",ke),f(`Failed to delete players: ${ke.message}`)}finally{O(!1),oe({isOpen:!1})}},Au=async()=>{var ue;if(b.size===0){f("No players selected for password reset");return}O(!0),f(null),h(null);try{const ke=Qa.filter(Cr=>b.has(Cr.id)).map(Cr=>Cr.email),lt=ke.map(Cr=>ge.auth.resetPasswordForEmail(Cr,{redirectTo:`${window.location.origin}/reset-password`})),hr=(await Promise.all(lt)).filter(Cr=>Cr.error);if(hr.length>0)throw new Error(`Failed to send password reset to ${hr.length} players: ${(ue=hr[0].error)==null?void 0:ue.message}`);h(`Successfully sent password reset emails to ${ke.length} players`),N(new Set)}catch(ke){console.error("Bulk password reset error:",ke),f(`Failed to reset passwords: ${ke.message}`)}finally{O(!1)}},Qa=a.filter(ue=>{const ke=ue.full_name.toLowerCase().includes(p.toLowerCase())||ue.email.toLowerCase().includes(p.toLowerCase()),lt=m==="all"||ue.group_name===m,Dn=ue.score||0,hr=B===""||Dn>=parseInt(B),Cr=X===""||Dn<=parseInt(X),Pu=new Date(ue.created_at),B0=q===""||Pu>=new Date(q),wl=F===""||Pu<=new Date(F),Ji=ue.group_name||"",U0=Ji.startsWith("DD")||Ji.startsWith("DEVOWS"),$0=Ji.startsWith("ID")||Ji.startsWith("IDOSR"),T=Y==="all"||Y==="DEV"&&U0||Y==="ID"&&$0,D=ue.verified_ofppt||!1;return ke&&lt&&hr&&Cr&&B0&&wl&&T&&(H==="all"||H==="verified"&&D||H==="unverified"&&!D)});return o?l.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-battle-purple mx-auto mb-4"}),l.jsx("p",{className:"text-foreground/80",children:"Loading players..."})]})}):l.jsxs("div",{className:"min-h-screen bg-background py-12 px-4 sm:px-6 mt-16 overflow-hidden relative",children:[l.jsx(Tt,{}),l.jsx(HN,{isOpen:Ja,onClose:()=>sr(!1)}),l.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[l.jsxs("div",{className:"hidden sm:block",children:[l.jsx(Ie,{color:"purple",size:200,top:"5%",left:"85%",delay:0}),l.jsx(Ie,{color:"pink",size:150,top:"70%",left:"5%",delay:1,rotation:!0}),l.jsx(Ie,{color:"yellow",size:100,top:"40%",left:"80%",delay:.5}),l.jsx(Ie,{color:"purple",size:120,top:"85%",left:"15%",delay:1.5})]}),l.jsxs("div",{className:"sm:hidden",children:[l.jsx(Ie,{color:"purple",size:120,top:"10%",left:"80%",delay:0}),l.jsx(Ie,{color:"pink",size:90,top:"75%",left:"15%",delay:1,rotation:!0})]})]}),l.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[l.jsxs("div",{className:"flex items-center justify-between mb-8",children:[l.jsx("div",{})," ",l.jsxs("div",{className:"text-center flex-1",children:[l.jsxs("h1",{className:"text-3xl font-bold text-foreground",children:["CSS"," ",l.jsx("span",{className:"bg-gradient-primary bg-clip-text text-transparent",children:"BATTLE"})," ","Admin Dashboard"]}),y&&l.jsxs("p",{className:"text-sm text-foreground/70 mt-1 flex items-center justify-center",children:[l.jsx(pd,{className:"w-4 h-4 mr-1 text-battle-accent inline-flex"}),"Logged in as:"," ",l.jsx("span",{className:"text-battle-purple font-medium ml-1",children:y})]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[l.jsx(Pe,{className:"bg-purple-500/20 dark:bg-purple-600/30 backdrop-blur-sm border-battle-purple/30 p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(cl,{className:"w-8 h-8 text-battle-purple mr-4"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-foreground/80",children:"Total Players"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:as})]})]})}),l.jsx(Pe,{className:"bg-blue-500/20 dark:bg-yellow-500/20 backdrop-blur-sm border-blue-500/30 dark:border-yellow-500/30 p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(Oc,{className:"w-8 h-8 text-blue-500 dark:text-yellow-500 mr-4"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-foreground/80",children:"CSS Battle Links"}),l.jsx("p",{className:"text-2xl font-bold text-foreground",children:In})]})]})})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4 mb-4",children:[l.jsxs("div",{className:"relative flex-1 max-w-2xl",children:[l.jsx(jP,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-5 h-5"}),l.jsx(tt,{placeholder:"Search players by name or email...",value:p,onChange:ue=>g(ue.target.value),className:"pl-10 bg-background/50 border-battle-purple/30 h-12"})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full lg:w-auto",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(SP,{className:"w-5 h-5 text-muted-foreground hidden sm:block"}),l.jsxs(xs,{value:m,onValueChange:x,children:[l.jsx(Hn,{className:"w-full sm:w-48 bg-background/50 border-battle-purple/30 h-12",children:l.jsx(gs,{placeholder:"Filter by group"})}),l.jsxs(Gn,{children:[l.jsx(Ct,{value:"all",children:"All Groups"}),ns.map(ue=>l.jsx(Ct,{value:ue.value,children:ue.label},ue.value))]})]})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsxs(fe,{onClick:()=>ta(!0),variant:"outline",className:"border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground h-12 whitespace-nowrap",disabled:o,children:[l.jsx(nm,{className:"w-4 h-4 mr-2"}),l.jsx("span",{className:"hidden sm:inline",children:"Import Players"}),l.jsx("span",{className:"sm:hidden",children:"Import"})]}),l.jsxs(fe,{onClick:()=>se(!0),className:"bg-gradient-primary hover:scale-105 transition-transform shadow-glow h-12 whitespace-nowrap",disabled:o,children:[l.jsx(NP,{className:"w-4 h-4 mr-2"}),l.jsx("span",{className:"hidden sm:inline",children:"Create Player"}),l.jsx("span",{className:"sm:hidden",children:"Create"})]})]})]})]}),l.jsxs("div",{className:"mb-4",children:[l.jsxs(fe,{variant:"outline",onClick:()=>C(!V),className:"border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:[l.jsx(RP,{className:"w-4 h-4 mr-2"}),"Advanced Filters",l.jsx(Hx,{className:`w-4 h-4 ml-2 transition-transform ${V?"rotate-180":""}`})]}),V&&l.jsx("div",{className:"mt-4 p-4 bg-card/50 backdrop-blur-sm border border-battle-purple/30 rounded-lg",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"scoreMin",className:"text-foreground",children:"Min Score"}),l.jsx(tt,{id:"scoreMin",type:"number",value:B,onChange:ue=>G(ue.target.value),placeholder:"0",className:"bg-background/50 border-battle-purple/30"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"scoreMax",className:"text-foreground",children:"Max Score"}),l.jsx(tt,{id:"scoreMax",type:"number",value:X,onChange:ue=>z(ue.target.value),placeholder:"10000",className:"bg-background/50 border-battle-purple/30"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"dateFrom",className:"text-foreground",children:"From Date"}),l.jsx(tt,{id:"dateFrom",type:"date",value:q,onChange:ue=>K(ue.target.value),className:"bg-background/50 border-battle-purple/30"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"dateTo",className:"text-foreground",children:"To Date"}),l.jsx(tt,{id:"dateTo",type:"date",value:F,onChange:ue=>ne(ue.target.value),className:"bg-background/50 border-battle-purple/30"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{className:"text-foreground",children:"Group Category"}),l.jsxs(xs,{value:Y,onValueChange:j,children:[l.jsx(Hn,{className:"bg-background/50 border-battle-purple/30",children:l.jsx(gs,{placeholder:"Category"})}),l.jsxs(Gn,{children:[l.jsx(Ct,{value:"all",children:"All Categories"}),l.jsx(Ct,{value:"DEV",children:"DEV Groups"}),l.jsx(Ct,{value:"ID",children:"ID Groups"})]})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{className:"text-foreground",children:"Verification Status"}),l.jsxs(xs,{value:H,onValueChange:U,children:[l.jsx(Hn,{className:"bg-background/50 border-battle-purple/30",children:l.jsx(gs,{placeholder:"Status"})}),l.jsxs(Gn,{children:[l.jsx(Ct,{value:"all",children:"All Statuses"}),l.jsx(Ct,{value:"verified",children:"Verified"}),l.jsx(Ct,{value:"unverified",children:"Unverified"})]})]})]}),l.jsx("div",{className:"flex items-end",children:l.jsxs(fe,{variant:"outline",onClick:()=>{G(""),z(""),K(""),ne(""),j("all"),U("all")},className:"border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground w-full",children:[l.jsx(rn,{className:"w-4 h-4 mr-2"}),"Reset Filters"]})})]})})]}),u&&l.jsxs("div",{className:"mb-4 p-4 bg-red-500/20 border border-red-500/50 rounded-lg text-foreground",children:["Error: ",u]}),d&&l.jsx("div",{className:"mb-4 p-4 bg-green-500/20 border border-green-500/50 rounded-lg text-foreground",children:d})]}),l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30",children:[l.jsx("div",{className:"p-6 border-b border-battle-purple/30",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-foreground",children:"Registered Players"}),l.jsx("p",{className:"text-foreground/70",children:"Manage all registered players"})]}),b.size>0&&l.jsxs("div",{className:"flex gap-2",children:[l.jsxs(fe,{onClick:()=>oe({isOpen:!0}),variant:"outline",className:"border-red-500/50 hover:bg-red-500/10 hover:text-foreground",disabled:A,children:[l.jsx(Xu,{className:"w-4 h-4 mr-2"}),"Delete (",b.size,")"]}),l.jsxs(fe,{onClick:Au,variant:"outline",className:"border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",disabled:A,children:[l.jsx(D1,{className:"w-4 h-4 mr-2"}),"Reset Password (",b.size,")"]})]})]})}),l.jsx("div",{className:"overflow-x-auto",children:l.jsxs("table",{className:"w-full border-collapse",children:[l.jsx("thead",{children:l.jsxs("tr",{className:"bg-battle-purple/5",children:[l.jsx("th",{className:"px-4 py-2",children:l.jsx("input",{type:"checkbox",checked:b.size>0&&b.size===Qa.length,onChange:Nu,className:"rounded border-battle-purple/30 bg-background/50 text-battle-purple focus:ring-battle-purple",title:"Select all players"})}),l.jsx("th",{className:"px-4 py-2",children:"Name"}),l.jsx("th",{className:"px-4 py-2",children:"Email"}),l.jsx("th",{className:"px-4 py-2",children:"Group"}),l.jsx("th",{className:"px-4 py-2",children:"Score"}),l.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),l.jsx("tbody",{children:Qa.map(ue=>l.jsxs("tr",{children:[l.jsx("td",{className:"px-4 py-2",children:l.jsx("input",{type:"checkbox",checked:b.has(ue.id),onChange:()=>M0(ue.id),className:"rounded border-battle-purple/30 bg-background/50 text-battle-purple focus:ring-battle-purple",title:`Select player ${ue.full_name}`})}),l.jsx("td",{className:"px-4 py-2",children:ue.full_name||"N/A"}),l.jsx("td",{className:"px-4 py-2",children:ue.email||"N/A"}),l.jsx("td",{className:"px-4 py-2",children:ue.group_name?l.jsx(or,{variant:"secondary",children:ue.group_name}):"N/A"}),l.jsx("td",{className:"px-4 py-2",children:ue.score||0}),l.jsx("td",{className:"px-4 py-2",children:l.jsxs("div",{className:"flex gap-2",children:[l.jsxs(fe,{onClick:()=>vt(ue),variant:"outline",className:"border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:[l.jsx(FP,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),l.jsxs(fe,{onClick:()=>Lr(ue),variant:"outline",className:"border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:[l.jsx(D1,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Reset Password"})]}),l.jsxs(fe,{onClick:()=>{J({isOpen:!0,player:ue})},variant:"outline",className:"border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:[l.jsx(Xu,{className:"w-4 h-4"}),l.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})]})})]},ue.id))})]})})]}),te.isOpen&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:l.jsx(Pe,{className:"bg-card/90 backdrop-blur-sm border-battle-purple/30 w-full max-w-md",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-xl font-bold text-foreground",children:"Confirm Bulk Deletion"}),l.jsx(fe,{variant:"ghost",size:"icon",onClick:()=>oe({isOpen:!1}),className:"text-foreground hover:bg-battle-purple/10 hover:text-foreground",children:l.jsx(rn,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("p",{className:"text-foreground/80 mb-4",children:["Are you sure you want to delete"," ",l.jsxs("span",{className:"font-bold text-foreground",children:[b.size," players"]}),"? This action cannot be undone."]}),l.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:l.jsxs("p",{className:"text-foreground text-sm",children:[l.jsx("strong",{children:"Warning:"})," This will permanently remove the selected players' accounts and all associated data."]})})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(fe,{onClick:()=>oe({isOpen:!1}),variant:"outline",className:"flex-1 border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",disabled:A,children:"Cancel"}),l.jsx(fe,{onClick:Cu,className:"flex-1 bg-red-600 hover:bg-red-700",disabled:A,children:A?l.jsxs(l.Fragment,{children:[l.jsx("span",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Deleting..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Xu,{className:"w-4 h-4 mr-2"}),"Delete Players"]})})]})]})})}),W.isOpen&&W.player&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:l.jsx(Pe,{className:"bg-card/90 backdrop-blur-sm border-battle-purple/30 w-full max-w-md",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-xl font-bold text-foreground",children:"Confirm Deletion"}),l.jsx(fe,{variant:"ghost",size:"icon",onClick:()=>J({isOpen:!1,player:null}),className:"text-foreground hover:bg-battle-purple/10 hover:text-foreground",children:l.jsx(rn,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("p",{className:"text-foreground/80 mb-4",children:["Are you sure you want to delete the player"," ",l.jsx("span",{className:"font-bold text-foreground",children:W.player.full_name}),"? This action cannot be undone."]}),l.jsx("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-4",children:l.jsxs("p",{className:"text-foreground text-sm",children:[l.jsx("strong",{children:"Warning:"})," This will permanently remove the player's account and all associated data."]})})]}),l.jsxs("div",{className:"flex gap-3",children:[l.jsx(fe,{onClick:()=>J({isOpen:!1,player:null}),variant:"outline",className:"flex-1 border-battle-purple/50 hover:bg-battle-purple/10 hover:text-foreground",children:"Cancel"}),l.jsxs(fe,{onClick:()=>{console.log("Delete button clicked, player ID:",W.player.id),Tu(W.player.id)},className:"flex-1 bg-red-600 hover:bg-red-700",disabled:o,children:[l.jsx(Xu,{className:"w-4 h-4 mr-2"}),"Delete Player"]})]})]})})}),ae&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:l.jsx(Pe,{className:"bg-card/90 backdrop-blur-sm border-battle-purple/30 w-full max-w-lg max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-xl font-bold text-foreground",children:"Create Player"}),l.jsx(fe,{variant:"ghost",size:"icon",onClick:()=>se(!1),className:"text-foreground hover:bg-battle-purple/10 hover:text-foreground",children:l.jsx(rn,{className:"w-4 h-4"})})]}),u&&!d&&l.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg text-foreground text-sm",children:u}),l.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"full_name",className:"text-foreground",children:"Full Name *"}),l.jsx(tt,{id:"full_name",value:de.full_name,onChange:ue=>I({...de,full_name:ue.target.value}),className:"bg-background/50 border-battle-purple/30",required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"email",className:"text-foreground",children:"Email *"}),l.jsx(tt,{id:"email",type:"email",value:de.email,onChange:ue=>I({...de,email:ue.target.value}),className:"bg-background/50 border-battle-purple/30",required:!0})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"group_name",className:"text-foreground",children:"Group *"}),l.jsxs(xs,{value:de.group_name,onValueChange:ue=>I({...de,group_name:ue}),children:[l.jsx(Hn,{className:"bg-background/50 border-battle-purple/30",children:l.jsx(gs,{placeholder:"Select group"})}),l.jsx(Gn,{children:ns.map(ue=>l.jsx(Ct,{value:ue.value,children:ue.label},ue.value))})]})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"phone",className:"text-foreground",children:"Phone"}),l.jsx(tt,{id:"phone",value:de.phone,onChange:ue=>I({...de,phone:ue.target.value}),className:"bg-background/50 border-battle-purple/30"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"cssbattle_profile_link",className:"text-foreground",children:"CSSBattle Profile Link"}),l.jsx(tt,{id:"cssbattle_profile_link",value:de.cssbattle_profile_link,onChange:ue=>I({...de,cssbattle_profile_link:ue.target.value}),placeholder:"https://cssbattle.dev/player/...",className:"bg-background/50 border-battle-purple/30"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"password",className:"text-foreground",children:"Password *"}),l.jsx(tt,{id:"password",type:"password",value:de.password,onChange:ue=>I({...de,password:ue.target.value}),className:"bg-background/50 border-battle-purple/30",required:!0})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6",children:[l.jsx(fe,{onClick:()=>se(!1),variant:"outline",className:"w-full sm:w-1/2 border-battle-purple/50 hover:bg-battle-purple/10",disabled:Be,children:"Cancel"}),l.jsx(fe,{onClick:Cs,className:"w-full sm:w-1/2 bg-gradient-primary hover:scale-105 transition-transform shadow-glow",disabled:Be,children:Be?"Creating...":"Create Player"})]})]})})}),Ve.isOpen&&l.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:l.jsx(Pe,{className:"bg-card/90 backdrop-blur-sm border-battle-purple/30 w-full max-w-md",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-xl font-bold text-foreground",children:"Change Password"}),l.jsx(fe,{variant:"ghost",size:"icon",onClick:()=>{Oe({isOpen:!1,player:null,userId:null}),it("")},className:"text-foreground hover:bg-battle-purple/10",children:l.jsx(rn,{className:"w-4 h-4"})})]}),u&&!d&&l.jsx("div",{className:"mb-4 p-3 bg-red-500/20 border border-red-500/50 rounded-lg text-foreground text-sm",children:u}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"p-4 bg-background/50 rounded-lg border border-battle-purple/30",children:[l.jsx("p",{className:"text-sm text-foreground/70 mb-1",children:"Player"}),l.jsx("p",{className:"font-semibold text-foreground",children:(ju=Ve.player)==null?void 0:ju.full_name}),l.jsx("p",{className:"text-sm text-foreground/70",children:(Za=Ve.player)==null?void 0:Za.email})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"new_password",className:"text-foreground",children:"New Password *"}),l.jsx(tt,{id:"new_password",type:"text",value:xe,onChange:ue=>it(ue.target.value),placeholder:"Enter new password (min 6 characters)",className:"bg-background/50 border-battle-purple/30"})]}),l.jsxs("div",{className:"flex gap-3 pt-4",children:[l.jsx(fe,{onClick:()=>{Oe({isOpen:!1,player:null,userId:null}),it("")},variant:"outline",className:"flex-1 border-battle-purple/50 hover:bg-battle-purple/10",disabled:Rt,children:"Cancel"}),l.jsx(fe,{onClick:L0,className:"flex-1 bg-gradient-primary hover:scale-105 transition-transform shadow-glow",disabled:Rt,children:Rt?"Updating...":"Update Password"})]})]})]})})}),l.jsx(EG,{isOpen:On,onClose:()=>ta(!1),onImportComplete:De}),l.jsx(ZG,{isOpen:v,onClose:()=>{S(!1),k(null)},onSave:Ft,player:E?{id:E.id,full_name:E.full_name,email:E.email,phone:E.phone||"",css_link:E.cssbattle_profile_link||"",group_name:E.group_name||"",score:E.score||0}:null,mode:"edit"})]})]})},tq=()=>{var p;const{playerId:e}=Yj(),t=dr(),{toast:r}=Xr(),{isAdmin:n,loading:s}=Kr(),[a,i]=_.useState(null),[o,c]=_.useState(!0),[u,f]=_.useState(null);_.useEffect(()=>{if(!s){if(!n){t("/admin");return}if(!e){t("/admin/dashboard");return}d()}},[n,s,e,t]);const d=async()=>{try{c(!0);const{data:g,error:m}=await ge.from("players").select("*").eq("id",e).single();if(m)throw m;i(g)}catch(g){console.error("Error fetching player details:",g),f("Failed to fetch player details"),r({title:"Error",description:"Failed to fetch player details",variant:"destructive"})}finally{c(!1)}};if(o)return l.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:l.jsx("div",{className:"animate-pulse text-foreground",children:"Loading player details..."})});if(u||!a)return l.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:l.jsxs(Pe,{className:"p-8 max-w-md w-full text-center",children:[l.jsx("h2",{className:"text-2xl font-bold text-foreground mb-4",children:"Player Not Found"}),l.jsx("p",{className:"text-foreground/80 mb-6",children:"Unable to load player details."}),l.jsx(fe,{onClick:()=>t("/admin/dashboard"),className:"bg-gradient-primary hover:scale-105 transition-transform",children:"Back to Dashboard"})]})});const h=a.group_name?((p=ns.find(g=>g.value===a.group_name))==null?void 0:p.label)||a.group_name:"No group assigned";return l.jsx("div",{className:"min-h-screen bg-background py-12 px-4 sm:px-6 mt-16",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"flex items-center justify-between mb-8",children:[l.jsxs(fe,{onClick:()=>t("/admin/dashboard"),variant:"outline",className:"border-primary/50",children:[l.jsx(Yo,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),l.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Player Details"}),l.jsx("div",{})," "]}),l.jsx(Pe,{className:"bg-card/50 backdrop-blur-sm border-primary/30 p-6",children:l.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("div",{className:"w-32 h-32 rounded-full bg-gradient-primary flex items-center justify-center mx-auto",children:l.jsx(Jn,{className:"w-16 h-16 text-foreground"})})}),l.jsxs("div",{className:"flex-1",children:[l.jsxs("div",{className:"mb-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-foreground mb-2",children:a.full_name}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsxs(or,{variant:"secondary",className:"text-sm",children:["Player ID: ",a.id.substring(0,8),"..."]}),l.jsxs(or,{variant:"default",className:"text-sm",children:["Score: ",a.score]})]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-start",children:[l.jsx(Ni,{className:"w-5 h-5 text-muted-foreground mt-0.5 mr-3 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Email"}),l.jsx("p",{className:"text-foreground",children:a.email})]})]}),l.jsxs("div",{className:"flex items-start",children:[l.jsx(cl,{className:"w-5 h-5 text-muted-foreground mt-0.5 mr-3 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Group"}),l.jsx("p",{className:"text-foreground",children:h})]})]}),l.jsxs("div",{className:"flex items-start",children:[l.jsx(Vx,{className:"w-5 h-5 text-muted-foreground mt-0.5 mr-3 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Member Since"}),l.jsx("p",{className:"text-foreground",children:new Date(a.created_at).toLocaleDateString()})]})]})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-start",children:[l.jsx(rm,{className:"w-5 h-5 text-muted-foreground mt-0.5 mr-3 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Phone"}),l.jsx("p",{className:"text-foreground",children:a.phone||"Not provided"})]})]}),l.jsxs("div",{className:"flex items-start",children:[l.jsx(Oc,{className:"w-5 h-5 text-muted-foreground mt-0.5 mr-3 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"CSS Battle Profile"}),a.cssbattle_profile_link?l.jsx("a",{href:a.cssbattle_profile_link,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline break-all",children:"View Profile"}):l.jsx("p",{className:"text-foreground",children:"Not linked"})]})]}),l.jsxs("div",{className:"flex items-start",children:[l.jsx(Fa,{className:"w-5 h-5 text-muted-foreground mt-0.5 mr-3 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Current Score"}),l.jsxs("p",{className:"text-foreground font-bold text-xl",children:[a.score," points"]})]})]}),l.jsxs("div",{className:"flex items-start",children:[l.jsx(Ob,{className:"w-5 h-5 text-muted-foreground mt-0.5 mr-3 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-muted-foreground",children:"Video Completed"}),l.jsx("p",{className:"text-foreground font-bold",children:a.video_completed?l.jsx("span",{className:"text-green-500",children:"Yes"}):l.jsx("span",{className:"text-red-500",children:"No"})})]})]})]})]}),l.jsx("div",{className:"mt-8 pt-6 border-t border-primary/20",children:l.jsx(fe,{onClick:()=>t("/admin/dashboard"),variant:"outline",className:"border-primary/50",children:"Back to Dashboard"})})]})]})})]})})},rq=()=>{const e=dr();S3();const[t,r]=_.useState(!1),[n,s]=_.useState(null),[a,i]=_.useState(null),[o,c]=_.useState({password:"",confirmPassword:""}),[u,f]=_.useState(null);_.useEffect(()=>{(async()=>{try{console.log("Checking for reset session...");const{data:{session:p},error:g}=await ge.auth.getSession();if(g){console.error("Session error:",g),f(!1);return}if(console.log("Session data:",p),p){const{data:{user:m},error:x}=await ge.auth.getUser();if(x||!m){console.error("User error:",x),f(!1);return}console.log("User data:",m),f(!0)}else f(!1)}catch(p){console.error("Session validation error:",p),f(!1)}})()},[]);const d=async h=>{if(h.preventDefault(),!o.password){s("Please enter a new password");return}if(o.password.length<6){s("Password must be at least 6 characters long");return}if(o.password!==o.confirmPassword){s("Passwords do not match");return}r(!0),s(null);try{const{error:p}=await ge.auth.updateUser({password:o.password});if(p)throw new Error(p.message);i("Password updated successfully! Redirecting to login..."),setTimeout(()=>{e("/login")},3e3)}catch(p){s(p.message||"Failed to update password"),console.error(p)}finally{r(!1)}};return u===null?l.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-battle-purple mx-auto mb-4"}),l.jsx("p",{className:"text-foreground/80",children:"Loading password reset..."})]})}):u===!1?l.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:l.jsx(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 w-full max-w-md p-8",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mx-auto mb-6",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),l.jsx("h2",{className:"text-2xl font-bold text-foreground mb-4",children:"Invalid Reset Link"}),l.jsx("p",{className:"text-foreground/80 mb-6",children:"This password reset link is invalid or has expired. Please request a new password reset from the admin dashboard."}),l.jsx(fe,{onClick:()=>e("/login"),className:"bg-gradient-primary hover:scale-105 transition-transform shadow-glow",children:"Back to Login"})]})})}):l.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center p-4",children:l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 w-full max-w-md p-8",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsxs("h1",{className:"text-3xl font-bold text-foreground mb-2",children:["CSS ",l.jsx("span",{className:"bg-gradient-primary bg-clip-text text-transparent",children:"BATTLE"})]}),l.jsx("h2",{className:"text-xl font-bold text-foreground",children:"Reset Password"}),l.jsx("p",{className:"text-foreground/70 mt-2",children:"Enter your new password below"})]}),n&&l.jsx("div",{className:"mb-6 p-4 bg-red-500/20 border border-red-500/50 rounded-lg text-foreground text-sm",children:n}),a&&l.jsx("div",{className:"mb-6 p-4 bg-green-500/20 border border-green-500/50 rounded-lg text-foreground text-sm",children:a}),l.jsxs("form",{onSubmit:d,className:"space-y-6",children:[l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"password",className:"text-foreground",children:"New Password"}),l.jsx($c,{id:"password",value:o.password,onChange:h=>c({...o,password:h.target.value}),placeholder:"Enter new password",className:"bg-background/50 border-battle-purple/30",disabled:t}),l.jsx("p",{className:"text-sm text-foreground/70",children:"Password must be at least 6 characters long"})]}),l.jsxs("div",{className:"space-y-2",children:[l.jsx(He,{htmlFor:"confirmPassword",className:"text-foreground",children:"Confirm Password"}),l.jsx($c,{id:"confirmPassword",value:o.confirmPassword,onChange:h=>c({...o,confirmPassword:h.target.value}),placeholder:"Confirm new password",className:"bg-background/50 border-battle-purple/30",disabled:t})]}),l.jsx(fe,{type:"submit",className:"w-full bg-gradient-primary hover:scale-105 transition-transform shadow-glow",disabled:t,children:t?"Updating Password...":"Update Password"})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsx(fe,{variant:"ghost",onClick:()=>e("/login"),className:"text-battle-purple hover:text-battle-purple/80",children:"Back to Login"})})]})})},nq=()=>{const[e,t]=_.useState(null),[r,n]=_.useState(!1),s=async()=>{n(!0);const a={};try{const{data:{user:i}}=await ge.auth.getUser();a.currentUser=i;const{data:o,error:c}=await ge.from("players").select("*");if(a.players=o,a.playersError=c,i){const{data:u,error:f}=await ge.from("players").select("*").eq("email",i.email);if(a.userInPlayers=u,a.userInPlayersError=f,u&&u.length>0){const d=u[0].id,{data:h,error:p}=await ge.from("players").update({updated_at:new Date().toISOString()}).eq("id",d).select();a.updateTest=h,a.updateError=p}}}catch(i){a.error=i}finally{n(!1),t(a)}};return l.jsx("div",{className:"min-h-screen bg-background py-12 px-4 sm:px-6",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsx("h1",{className:"text-3xl font-bold text-foreground mb-8",children:"Database Test"}),l.jsx(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-6 mb-6",children:l.jsx(fe,{onClick:s,disabled:r,className:"bg-gradient-primary hover:scale-105 transition-transform shadow-glow",children:r?"Running Tests...":"Run Database Tests"})}),e&&l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-6",children:[l.jsx("h2",{className:"text-xl font-bold text-foreground mb-4",children:"Test Results"}),l.jsx("pre",{className:"bg-background/50 p-4 rounded-lg overflow-auto max-h-96",children:JSON.stringify(e,null,2)})]})]})})},sq=()=>{const e=dr(),[t,r]=_.useState(null),[n,s]=_.useState(!1),a=async()=>{s(!0);const i={};try{i.selectTest=await ge.from("players").select("id, full_name").limit(2),i.insertTest=await ge.from("players").insert([{id:"00000000-0000-0000-0000-000000000001",full_name:"Test User",email:"test@example.com",group_name:"DD101",score:0}]),i.updateTest=await ge.from("players").update({updated_at:new Date().toISOString()}).limit(1),i.deleteNonExistentTest=await ge.from("players").delete().eq("id","00000000-0000-0000-0000-000000000000").select();const{data:o,error:c}=await ge.from("players").insert([{id:"00000000-0000-0000-0000-000000000002",full_name:"Delete Test User",email:"delete-test@example.com",group_name:"DD101",score:0}]).select();if(c)i.deleteInsertError=c;else if(i.deleteInsertTest=o,o&&Array.isArray(o)&&o.length>0){const u=o[0].id,{data:f,error:d}=await ge.from("players").delete().eq("id",u).select();i.deleteTest={data:f,error:d}}}catch(o){i.error=o}finally{s(!1),r(i)}};return l.jsx("div",{className:"min-h-screen bg-background py-12 px-4 sm:px-6",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"flex items-center justify-between mb-8",children:[l.jsx(fe,{onClick:()=>e("/admin/dashboard"),variant:"outline",className:"border-battle-purple/50 hover:bg-battle-purple/10",children:"Back to Admin Dashboard"}),l.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Database Permissions Test"}),l.jsx("div",{})]}),l.jsx(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-6 mb-6",children:l.jsx(fe,{onClick:a,disabled:n,className:"bg-gradient-primary hover:scale-105 transition-transform shadow-glow",children:n?"Running Tests...":"Run Database Permission Tests"})}),t&&l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-6",children:[l.jsx("h2",{className:"text-xl font-bold text-foreground mb-4",children:"Test Results"}),l.jsx("pre",{className:"bg-background/50 p-4 rounded-lg overflow-auto max-h-96 text-sm",children:JSON.stringify(t,null,2)})]})]})})},aq=()=>{const[e,t]=_.useState([]),[r,n]=_.useState(!1),[s,a]=_.useState(null),[i,o]=_.useState(null),[c,u]=_.useState(""),f=async()=>{n(!0),a(null);try{const{data:{user:h}}=await ge.auth.getUser();o(h),console.log("Current user:",h);const{data:p,error:g}=await ge.from("players").select("*").limit(10);console.log("Players fetch result:",{data:p,error:g}),g?a(g.message):t(p||[])}catch(h){console.error("Test error:",h),a(h.message)}finally{n(!1)}},d=async()=>{n(!0);try{a("execute_sql function is not available"),u("Test migrations disabled - execute_sql function not found")}catch(h){a(h.message)}finally{n(!1)}};return l.jsx("div",{className:"min-h-screen bg-background py-12 px-4 sm:px-6",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsx("h1",{className:"text-3xl font-bold text-foreground mb-8",children:"Player Fetch Test"}),l.jsx(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-6 mb-6",children:l.jsxs("div",{className:"flex gap-4",children:[l.jsx(fe,{onClick:f,disabled:r,className:"bg-gradient-primary hover:scale-105 transition-transform shadow-glow",children:r?"Testing...":"Test Player Fetch"}),l.jsx(fe,{onClick:d,disabled:r,variant:"outline",className:"border-battle-purple/50 hover:bg-battle-purple/10",children:r?"Applying Migrations...":"Apply Migrations"})]})}),c&&l.jsxs(Pe,{className:"bg-green-900/50 backdrop-blur-sm border-green-500/30 p-6 mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-green-200 mb-4",children:"Migration Status"}),l.jsx("p",{className:"text-green-100",children:c})]}),s&&l.jsxs(Pe,{className:"bg-red-900/50 backdrop-blur-sm border-red-500/30 p-6 mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-red-200 mb-4",children:"Error"}),l.jsx("p",{className:"text-red-100",children:s})]}),i&&l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-6 mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-foreground mb-4",children:"Current User"}),l.jsx("pre",{className:"bg-background/50 p-4 rounded-lg overflow-auto",children:JSON.stringify(i,null,2)})]}),l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30 p-6",children:[l.jsxs("h2",{className:"text-xl font-bold text-foreground mb-4",children:["Players (",e.length,")"]}),e.length>0?l.jsx("div",{className:"space-y-4",children:e.map(h=>l.jsx(Pe,{className:"bg-background/50 p-4",children:l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-bold",children:h.full_name}),l.jsx("p",{className:"text-foreground/70",children:h.email})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"font-mono",children:["Score: ",h.score||0]}),l.jsx("p",{className:"text-sm text-foreground/70",children:h.group_name||"No group"})]})]})},h.id))}):l.jsx("p",{className:"text-foreground/70",children:"No players found"})]})]})})},iq=()=>{const{toast:e}=Xr(),[t,r]=_.useState(null),[n,s]=_.useState(!1),[a,i]=_.useState(null),o=async()=>{s(!0);try{const{data:f,error:d}=await ge.storage.getBucket("learning");if(d){console.error("Bucket error:",d),r({error:d.message}),e({title:"Error",description:`Bucket error: ${d.message}`,variant:"destructive"});return}r(f),console.log("Bucket info:",f),e({title:"Success",description:"Bucket exists and is accessible"})}catch(f){console.error("Unexpected error:",f),r({error:f.message}),e({title:"Error",description:`Unexpected error: ${f.message}`,variant:"destructive"})}finally{s(!1)}},c=async()=>{s(!0);try{const{data:f,error:d}=await ge.storage.createBucket("learning",{public:!0});if(d){console.error("Create bucket error:",d),e({title:"Error",description:`Failed to create bucket: ${d.message}`,variant:"destructive"});return}console.log("Bucket created:",f),r(f),e({title:"Success",description:"Bucket created successfully"}),setTimeout(o,1e3)}catch(f){console.error("Unexpected error creating bucket:",f),e({title:"Error",description:`Unexpected error: ${f.message}`,variant:"destructive"})}finally{s(!1)}},u=async()=>{s(!0);try{const f="This is a test file for storage testing",d=new Blob([f],{type:"text/plain"}),h=new File([d],"test-file.txt",{type:"text/plain"}),p=`test/${Date.now()}_test-file.txt`,{data:g,error:m}=await ge.storage.from("learning").upload(p,h,{cacheControl:"3600",upsert:!1});if(m){console.error("Upload error:",m),i({error:m.message}),e({title:"Error",description:`Upload failed: ${m.message}`,variant:"destructive"});return}console.log("Upload successful:",g),i(g);const{data:{publicUrl:x}}=ge.storage.from("learning").getPublicUrl(p);console.log("Public URL:",x),e({title:"Success",description:"File uploaded successfully"})}catch(f){console.error("Unexpected upload error:",f),i({error:f.message}),e({title:"Error",description:`Unexpected error: ${f.message}`,variant:"destructive"})}finally{s(!1)}};return _.useEffect(()=>{o()},[]),l.jsx("div",{className:"min-h-screen bg-background py-12 px-4 sm:px-6 mt-16",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("h1",{className:"text-3xl font-bold text-foreground mb-2",children:"Storage Bucket Test"}),l.jsx("p",{className:"text-foreground/80",children:"Diagnose and test the learning storage bucket"})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30",children:[l.jsx(_s,{children:l.jsx(bs,{children:"Bucket Information"})}),l.jsxs(ln,{children:[n&&!t?l.jsx("div",{className:"flex justify-center items-center h-24",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-battle-purple"})}):t?l.jsx("div",{className:"space-y-2",children:t.error?l.jsxs("div",{className:"text-red-500",children:[l.jsx("strong",{children:"Error:"})," ",t.error]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("strong",{children:"ID:"})," ",t.id]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Name:"})," ",t.name]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Public:"})," ",t.public?"Yes":"No"]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Created:"})," ",new Date(t.created_at).toLocaleString()]})]})}):l.jsx("div",{className:"text-foreground/50",children:"No bucket information"}),l.jsxs("div",{className:"flex gap-2 mt-4",children:[l.jsx(fe,{onClick:o,disabled:n,variant:"outline",children:"Check Bucket"}),l.jsx(fe,{onClick:c,disabled:n,children:"Create Bucket"})]})]})]}),l.jsxs(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30",children:[l.jsx(_s,{children:l.jsx(bs,{children:"Upload Test"})}),l.jsxs(ln,{children:[a?l.jsx("div",{className:"space-y-2",children:a.error?l.jsxs("div",{className:"text-red-500",children:[l.jsx("strong",{children:"Error:"})," ",a.error]}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{children:[l.jsx("strong",{children:"Path:"})," ",a.path]}),l.jsxs("div",{children:[l.jsx("strong",{children:"ID:"})," ",a.id]}),l.jsxs("div",{children:[l.jsx("strong",{children:"Created:"})," ",new Date(a.created_at).toLocaleString()]})]})}):l.jsx("div",{className:"text-foreground/50",children:"No upload test performed"}),l.jsx(fe,{onClick:u,disabled:n,className:"mt-4",children:"Test Upload"})]})]})]})]})})},oq=()=>{const[e,t]=_.useState([]),[r,n]=_.useState(!0),[s,a]=_.useState("all"),{t:i,language:o}=Js(),c=async()=>{n(!0);try{let p=ge.from("monthly_winners").select("*").order("winning_month",{ascending:!1}).order("position",{ascending:!0});s!=="all"&&(p=p.eq("winning_month",s));const{data:g,error:m}=await p;if(m)throw m;t(g||[])}catch(p){console.error("Error fetching monthly winners:",p)}finally{n(!1)}};_.useEffect(()=>{c()},[s]);const u=Array.from(new Set(e.map(p=>p.winning_month))).sort((p,g)=>g.localeCompare(p)),f=e.reduce((p,g)=>{const m=g.winning_month;return p[m]||(p[m]=[]),p[m].push(g),p},{}),d=p=>p===1?l.jsx(Fc,{className:"w-5 h-5 text-yellow-500"}):p===2?l.jsx(Fa,{className:"w-5 h-5 text-gray-400"}):p===3?l.jsx(Gx,{className:"w-5 h-5 text-amber-700"}):null,h=p=>{if(!p)return"bg-muted";const g=p.charAt(0).toLowerCase();return g>="a"&&g<="m"?"bg-purple-500/20 text-purple-500 border-purple-500/30":"bg-blue-500/20 text-blue-500 border-blue-500/30"};return l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-primary/5 overflow-hidden relative",children:[l.jsx(Tt,{}),l.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[l.jsxs("div",{className:"hidden sm:block",children:[l.jsx(Ie,{color:"purple",size:180,top:"5%",left:"80%",delay:0}),l.jsx(Ie,{color:"pink",size:120,top:"65%",left:"5%",delay:1,rotation:!0}),l.jsx(Ie,{color:"yellow",size:80,top:"35%",left:"85%",delay:.5})]}),l.jsxs("div",{className:"sm:hidden",children:[l.jsx(Ie,{color:"purple",size:100,top:"10%",left:"80%",delay:0}),l.jsx(Ie,{color:"pink",size:70,top:"75%",left:"15%",delay:1,rotation:!0})]})]}),l.jsx("main",{className:"relative z-10 container mx-auto px-4 py-8 mt-20",children:l.jsxs("div",{className:"max-w-4xl mx-auto",children:[l.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-8 gap-4",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent",children:o==="en"?"Monthly Winners":"Gagnants du Mois"}),l.jsx("p",{className:"text-muted-foreground mt-1",children:o==="en"?"Celebrating our top performers each month":"Célébrons nos meilleurs performers chaque mois"})]})}),l.jsx("div",{className:"mb-6 w-48",children:l.jsxs(xs,{value:s,onValueChange:a,children:[l.jsx(Hn,{className:"border-battle-purple/50 hover:bg-battle-purple/10",children:l.jsx(gs,{placeholder:o==="en"?"Select Month":"Sélectionner un Mois"})}),l.jsxs(Gn,{children:[l.jsx(Ct,{value:"all",children:o==="en"?"All Months":"Tous les Mois"}),u.map(p=>l.jsx(Ct,{value:p,children:new Date(p).toLocaleDateString(o==="en"?"en-US":"fr-FR",{year:"numeric",month:"long"})},p))]})]})}),r?l.jsx("div",{className:"flex justify-center items-center h-48",children:l.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-battle-purple"})}):Object.keys(f).length>0?l.jsx("div",{className:"space-y-8",children:Object.entries(f).map(([p,g])=>l.jsxs("div",{children:[l.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:new Date(p).toLocaleDateString(o==="en"?"en-US":"fr-FR",{year:"numeric",month:"long"})}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:g.map(m=>{var x;return l.jsxs(Pe,{className:`bg-card/50 backdrop-blur-sm border ${m.position===1?"border-yellow-500/50 shadow-lg shadow-yellow-500/20":m.position===2?"border-gray-400/30":"border-amber-700/30"}`,children:[l.jsx(_s,{children:l.jsx(bs,{className:"flex items-center justify-between",children:l.jsxs("div",{className:"flex items-center gap-2",children:[d(m.position),l.jsx("span",{className:m.position===1?"text-yellow-500":"",children:o==="en"?`#${m.position} Place`:`Place #${m.position}`})]})})}),l.jsx(ln,{children:l.jsxs("div",{className:"text-center",children:[l.jsx("h3",{className:`font-bold text-lg mb-2 ${m.position===1?"text-yellow-500":m.position===2?"text-gray-400":"text-amber-700"}`,children:m.full_name}),l.jsx(or,{className:`${h(m.group_name)} py-1 px-2 mb-3`,children:m.group_name||"N/A"}),l.jsx("div",{className:"text-2xl font-bold",children:((x=m.score)==null?void 0:x.toLocaleString())||"0"}),l.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:"Points"})]})})]},m.id)})})]},p))}):l.jsx(Pe,{className:"bg-card/50 backdrop-blur-sm border-battle-purple/30",children:l.jsxs(ln,{className:"py-12 text-center",children:[l.jsx(Fa,{className:"w-16 h-16 text-muted-foreground mx-auto mb-4"}),l.jsx("h3",{className:"text-xl font-semibold mb-2",children:o==="en"?"No Winners Found":"Aucun Gagnant Trouvé"}),l.jsx("p",{className:"text-muted-foreground",children:o==="en"?"No monthly winners have been recorded yet.":"Aucun gagnant mensuel n'a encore été enregistré."})]})})]})})]})},lq=()=>{const{toast:e}=Xr(),[t,r]=_.useState([]),[n,s]=_.useState(!0),[a,i]=_.useState(null);return _.useEffect(()=>{(async()=>{try{s(!0),console.log("Attempting to fetch learning resources...");const{data:c,error:u}=await ge.from("learning_resources").select("*").order("created_at",{ascending:!1});if(u){console.error("Supabase error:",u),i(u.message),e({title:"Error",description:`Failed to load learning resources: ${u.message}`,variant:"destructive"});return}console.log("Fetched resources:",c),r(c),i(null)}catch(c){console.error("Unexpected error:",c),i(c instanceof Error?c.message:"Unknown error"),e({title:"Error",description:"Failed to load learning resources",variant:"destructive"})}finally{s(!1)}})()},[e]),l.jsxs("div",{className:"container mx-auto p-4",children:[l.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Test Resource Fetch"}),n&&l.jsx("p",{children:"Loading resources..."}),a&&l.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:l.jsxs("p",{children:["Error: ",a]})}),!n&&!a&&l.jsxs("div",{children:[l.jsxs("p",{children:["Found ",t.length," resources"]}),t.map(o=>l.jsxs("div",{className:"border p-4 mb-2 rounded",children:[l.jsx("h2",{className:"font-bold",children:o.title}),l.jsx("p",{children:o.description}),l.jsxs("p",{children:["Type: ",o.type]}),l.jsxs("p",{children:["Created: ",o.created_at]})]},o.id))]})]})},vC=({className:e,size:t="md",message:r})=>{const n={sm:"h-6 w-6",md:"h-12 w-12",lg:"h-16 w-16"};return l.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:Ke("animate-spin rounded-full border-b-2 border-primary mx-auto",n[t],e)}),r&&l.jsx("p",{className:"mt-4 text-foreground",children:r})]})})},vf=({children:e})=>{const{isAdmin:t,loading:r}=Kr(),n=dr();return _.useEffect(()=>{!r&&!t&&n("/admin")},[t,r,n]),r?l.jsx(vC,{message:"Loading..."}):t?l.jsx(l.Fragment,{children:e}):null},Ky=({children:e})=>{const{user:t}=mn(),{isAdmin:r,loading:n}=Kr(),s=dr();return _.useEffect(()=>{!n&&(!t||r)&&s("/")},[t,r,n,s]),n?l.jsx(vC,{message:"Loading..."}):!t||r?null:l.jsx(l.Fragment,{children:e})},cq=({playerEmail:e,isOpen:t,onClose:r})=>{const{toast:n}=Xr();console.log("PlayerMessagesPanel rendered with props:",{playerEmail:e,isOpen:t});const[s,a]=_.useState([]),[i,o]=_.useState(!1),[c,u]=_.useState(""),[f,d]=_.useState([]),[h,p]=_.useState(null),[g,m]=_.useState([]),[x,y]=_.useState(window.innerWidth<768),[w,v]=_.useState(!1),[S,E]=_.useState(null),k=_.useRef(null),b=()=>{var B;(B=k.current)==null||B.scrollIntoView({behavior:"smooth"})};_.useEffect(()=>{b()},[g]),_.useEffect(()=>{const B=()=>{y(window.innerWidth<768)};return window.addEventListener("resize",B),()=>window.removeEventListener("resize",B)},[]),_.useEffect(()=>{const B=()=>{if(window.visualViewport){const G=window.innerHeight-window.visualViewport.height>100;v(G)}};if(window.visualViewport)return window.visualViewport.addEventListener("resize",B),()=>{window.visualViewport.removeEventListener("resize",B)};{const G=()=>v(!0),X=()=>v(!1),z=document.querySelectorAll("input, textarea");return z.forEach(q=>{q.addEventListener("focusin",G),q.addEventListener("focusout",X)}),()=>{z.forEach(q=>{q.removeEventListener("focusin",G),q.removeEventListener("focusout",X)})}}},[]),_.useEffect(()=>{console.log("PlayerMessagesPanel useEffect triggered",{isOpen:t,playerEmail:e}),t?(N(),O()):(d([]),p(null),m([]),u(""))},[t,e]),_.useEffect(()=>{h&&A(h)},[h]);const N=async()=>{try{o(!0),console.log("Using hardcoded admin contacts...");const B=[{name:"Ibrahim Challal",email:"ibrahimchallal@admincss.com"},{name:"Youness Hlibi",email:"younesshlibi@admincss.com"},{name:"Mazgour Abdalmonim",email:"mazgouraabdalmonim@admincss.com"}];d(B),console.log("Using hardcoded admins:",B)}catch(B){console.error("Failed to set hardcoded admins:",B),n({title:"Error",description:"Failed to load admin contacts",variant:"destructive"}),d([])}finally{o(!1)}},A=async B=>{if(e)try{o(!0);const{data:G,error:X}=await ge.from("contact_messages").select("*").or(`and(sender_email.eq.${e},recipient_email.eq.${B.email}),and(sender_email.eq.${B.email},recipient_email.eq.${e})`).order("created_at",{ascending:!0});if(X)throw X;const z=(G||[]).map(K=>({...K,status:K.status}));m(z);const q=z.filter(K=>K.status==="unread"&&K.recipient_email===e);console.log("Found unread messages with admin:",q.length),q.length>0&&(await Promise.all(q.map(async K=>{const{error:F}=await ge.from("contact_messages").update({status:"read",updated_at:new Date().toISOString()}).eq("id",K.id);F&&console.error("Failed to mark message as read:",F)})),console.log("Dispatching playerMessagesRead event"),window.dispatchEvent(new CustomEvent("playerMessagesRead")))}catch(G){console.error("Failed to fetch messages:",G),n({title:"Error",description:"Failed to fetch messages",variant:"destructive"})}finally{o(!1)}},O=async()=>{if(e)try{const{data:B,error:G}=await ge.from("contact_messages").select("*").or(`sender_email.eq.${e},recipient_email.eq.${e}`).order("created_at",{ascending:!0});if(G)throw G;const X=(B||[]).map(q=>({...q,status:q.status}));a(X),o(!1);const z=X.filter(q=>q.status==="unread"&&q.recipient_email===e);console.log("Found unread messages for player:",z.length),z.length>0&&(await Promise.all(z.map(async q=>{const{error:K}=await ge.from("contact_messages").update({status:"read",updated_at:new Date().toISOString()}).eq("id",q.id);K&&console.error("Failed to mark message as read:",K)})),console.log("Dispatching playerMessagesRead event"),window.dispatchEvent(new CustomEvent("playerMessagesRead")))}catch(B){console.error("Failed to fetch messages:",B),n({title:"Error",description:"Failed to fetch messages",variant:"destructive"}),o(!1)}},V=B=>{m([]),setTimeout(()=>{p(B)},50)},C=async()=>{if(!c.trim()||!e||!h){n({title:"Error",description:"Please select an admin and enter a message",variant:"destructive"});return}try{const B=S?`[Replying to: "${S.message.substring(0,50)}..."] ${c}`:c,{error:G}=await ge.from("contact_messages").insert({sender_email:e,sender_name:"Player",recipient_email:h.email,subject:"Message from Player",message:B,status:"unread"});if(G)throw G;u(""),E(null),n({title:"Success",description:"Message sent successfully!"}),A(h)}catch(B){console.error("Failed to send message:",B),n({title:"Error",description:`Failed to send message: ${B.message||B}`,variant:"destructive"})}};return t?l.jsxs("div",{className:"fixed inset-0 z-50 overflow-hidden pointer-events-none",children:[l.jsx("div",{className:"fixed inset-0 bg-black/0 transition-opacity pointer-events-auto",onClick:r}),l.jsx("div",{className:"fixed inset-y-0 right-0 flex max-w-full pointer-events-auto",children:l.jsx("div",{className:"relative w-screen max-w-4xl h-full",children:l.jsxs("div",{className:"flex h-full bg-background border-l border-battle-purple/20 shadow-xl flex-col md:flex-row",children:[l.jsxs("div",{className:`border-r border-battle-purple/20 flex flex-col md:w-1/3 ${h&&x?"hidden":"flex"}`,children:[l.jsxs("div",{className:"flex items-center justify-between px-4 py-4 border-b border-battle-purple/20",children:[l.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Contact Admins"}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsx(fe,{variant:"ghost",size:"icon",onClick:N,className:"text-foreground hover:bg-battle-purple/10",title:"Refresh admin list",children:l.jsx(qx,{className:"h-5 w-5"})}),l.jsx(fe,{variant:"ghost",size:"icon",onClick:r,className:"text-foreground hover:bg-battle-purple/10",children:l.jsx(rn,{className:"h-5 w-5"})})]})]}),l.jsx("div",{className:"flex-1 overflow-y-auto",children:i?l.jsx("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:l.jsx("div",{className:"animate-pulse text-foreground mb-4",children:"Loading admins..."})}):f.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center h-full p-4 text-center",children:[l.jsx(Jn,{className:"w-12 h-12 text-muted-foreground mb-4"}),l.jsx("p",{className:"text-muted-foreground",children:"No admins available"})]}):l.jsx("div",{className:"divide-y divide-battle-purple/10",children:f.map(B=>{const G=s.filter(q=>q.sender_email===B.email&&q.recipient_email===e||q.sender_email===e&&q.recipient_email===B.email),X=G.filter(q=>q.status==="unread"&&q.recipient_email===e).length,z=G.length>0?G[G.length-1]:null;return l.jsxs("div",{className:`p-4 cursor-pointer hover:bg-battle-purple/5 transition-colors ${(h==null?void 0:h.email)===B.email?"bg-battle-purple/10":""}`,onClick:()=>V(B),children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-3",children:[l.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-primary flex items-center justify-center",children:l.jsx(Jn,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-foreground",children:B.name}),l.jsx("p",{className:"text-xs text-muted-foreground truncate max-w-[150px]",children:B.email})]})]}),X>0&&l.jsx(or,{variant:"default",className:"rounded-full",children:X})]}),z&&l.jsx("p",{className:"text-xs text-muted-foreground mt-2 truncate",children:z.message})]},B.email)})})})]}),l.jsx("div",{className:`flex flex-col ${h&&x?"w-full":"md:w-2/3"} ${!h&&x?"hidden md:flex":"flex"}`,children:h?l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"flex items-center justify-between px-4 py-4 border-b border-battle-purple/20",children:l.jsxs("div",{className:"flex items-center gap-3",children:[x&&l.jsx(fe,{variant:"ghost",size:"icon",onClick:()=>p(null),className:"text-foreground hover:bg-battle-purple/10 md:hidden",children:l.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:l.jsx("path",{d:"m15 18-6-6 6-6"})})}),l.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-primary flex items-center justify-center",children:l.jsx(Jn,{className:"w-5 h-5 text-white"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-foreground",children:h.name}),l.jsx("p",{className:"text-xs text-muted-foreground truncate max-w-[150px]",children:h.email})]})]})}),l.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:i?l.jsx("div",{className:"flex items-center justify-center h-full",children:l.jsx("div",{className:"animate-pulse text-foreground",children:"Loading messages..."})}):g.length===0?l.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center",children:[l.jsx(hd,{className:"w-16 h-16 text-muted-foreground mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"No messages yet"}),l.jsxs("p",{className:"text-muted-foreground max-w-xs",children:["Send a message to ",h.name]})]}):l.jsxs("div",{className:"space-y-4",children:[g.map(B=>{const G=B.message.match(/^\[Replying to: "(.*?)"\] (.*)$/),X=G?G[1]:null,z=G?G[2]:B.message;return l.jsx("div",{className:`flex ${B.sender_email===e?"justify-end":"justify-start"}`,children:l.jsxs("div",{className:`group max-w-xs lg:max-w-md px-4 py-2 rounded-lg relative ${B.sender_email===e?"bg-battle-purple text-white rounded-br-none":"bg-muted text-foreground rounded-bl-none"}`,children:[X&&l.jsxs("div",{className:"text-xs opacity-70 mb-2 pb-2 border-b border-white/20",children:[l.jsx(Io,{className:"w-3 h-3 inline mr-1"}),X]}),l.jsx("p",{className:"text-sm",children:z}),l.jsxs("div",{className:`text-xs mt-1 flex items-center justify-between ${B.sender_email===e?"text-battle-purple-foreground/80":"text-muted-foreground"}`,children:[l.jsxs("div",{className:"flex items-center",children:[B.sender_email===e?B.status==="read"?l.jsx(Rb,{className:"w-3 h-3 mr-1 text-blue-400"}):l.jsx(a0,{className:"w-3 h-3 mr-1 text-white/60"}):null,new Date(B.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),l.jsx(fe,{size:"sm",variant:"ghost",className:"h-6 px-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>E(B),children:l.jsx(Io,{className:"w-3 h-3"})})]})]})},`${B.id}-${B.created_at}`)}),l.jsx("div",{ref:k})]})}),l.jsxs("div",{className:`border-t border-battle-purple/20 p-4 transition-all duration-300 ${x&&w?"fixed bottom-0 left-0 right-0 bg-background z-50":""}`,style:{left:x&&w?"auto":"",right:x&&w?"0":"",width:x&&w?"calc(100% - 2rem)":"",marginLeft:x&&w?"1rem":"",marginRight:x&&w?"1rem":""},children:[S&&l.jsxs("div",{className:"mb-2 p-2 bg-muted rounded-lg flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[l.jsx(Io,{className:"w-4 h-4 text-primary"}),l.jsx("span",{className:"text-muted-foreground",children:"Replying to:"}),l.jsx("span",{className:"truncate max-w-[200px]",children:S.message})]}),l.jsx(fe,{size:"sm",variant:"ghost",onClick:()=>E(null),className:"h-6 w-6 p-0",children:l.jsx(rn,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"flex gap-2",children:[l.jsx(tt,{value:c,onChange:B=>u(B.target.value),placeholder:"Type a message...",className:"flex-1 bg-background/50 border-primary/30",onKeyDown:B=>{B.key==="Enter"&&!B.shiftKey&&(B.preventDefault(),C())},onFocus:()=>v(!0),onBlur:()=>v(!1)}),l.jsx(fe,{onClick:C,disabled:!c.trim(),className:"bg-gradient-primary hover:scale-105 transition-transform",children:l.jsx(Ib,{className:"w-4 h-4"})})]})]})]}):l.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8",children:[l.jsx(hd,{className:"w-16 h-16 text-muted-foreground mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Select an Admin"}),l.jsx("p",{className:"text-muted-foreground max-w-xs",children:"Choose an admin from the contacts list to start chatting"})]})})]})})})]}):null},uq=()=>{const[e,t]=_.useState(!1),[r,n]=_.useState(!1);return _.useEffect(()=>{const i=()=>{console.log("Opening player messages panel"),t(!0)},o=()=>{console.log("Opening admin messages panel"),n(!0)};return window.addEventListener("openPlayerMessagesPanel",i),window.addEventListener("openMessagesPanel",o),()=>{window.removeEventListener("openPlayerMessagesPanel",i),window.removeEventListener("openMessagesPanel",o)}},[]),{isPlayerMessagesOpen:e,isAdminMessagesOpen:r,closePlayerMessages:()=>{t(!1)},closeAdminMessages:()=>{n(!1)}}},fq=()=>{const{user:e}=mn(),{admin:t,isAdmin:r}=Kr(),{isPlayerMessagesOpen:n,isAdminMessagesOpen:s,closePlayerMessages:a,closeAdminMessages:i}=uq();return l.jsxs(l.Fragment,{children:[l.jsxs(f3,{children:[l.jsx(Jt,{path:"/",element:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(j8,{})]})}),l.jsx(Jt,{path:"/register",element:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(h6,{})]})}),l.jsx(Jt,{path:"/login",element:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(m6,{})]})}),l.jsx(Jt,{path:"/reset-password",element:l.jsx(rq,{})}),l.jsx(Jt,{path:"/profile",element:l.jsx(Ky,{children:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(g6,{})]})})}),l.jsx(Jt,{path:"/leaderboard",element:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(w6,{})]})}),l.jsx(Jt,{path:"/monthly-winners",element:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(oq,{})]})}),l.jsx(Jt,{path:"/learning",element:l.jsx(Ky,{children:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(_6,{})]})})}),l.jsx(Jt,{path:"/quiz-scores",element:l.jsx(vf,{children:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(b6,{})]})})}),l.jsx(Jt,{path:"/admin",element:l.jsx(x6,{})}),l.jsx(Jt,{path:"/admin/dashboard",element:l.jsx(vf,{children:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(eq,{})]})})}),l.jsx(Jt,{path:"/admin/player/:playerId",element:l.jsx(vf,{children:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(tq,{})]})})}),l.jsx(Jt,{path:"/database-test",element:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(nq,{})]})}),l.jsx(Jt,{path:"/database-permissions-test",element:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(sq,{})]})}),l.jsx(Jt,{path:"/test-player-fetch",element:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(aq,{})]})}),l.jsx(Jt,{path:"/test-resource-fetch",element:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(lq,{})]})}),l.jsx(Jt,{path:"/test-storage",element:l.jsx(vf,{children:l.jsxs(l.Fragment,{children:[l.jsx(Tt,{}),l.jsx(iq,{})]})})})]}),e&&l.jsx(cq,{playerEmail:(e==null?void 0:e.email)||"",isOpen:n,onClose:a}),r&&l.jsx(HN,{isOpen:s,onClose:i})]})},dq=()=>l.jsx(gO,{children:l.jsx(vO,{children:l.jsx(wO,{children:l.jsx(w3,{children:l.jsx(fq,{})})})})});function an(e,t,{checkForDefaultPrevented:r=!0}={}){return function(s){if(e==null||e(s),r===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}var hq="DismissableLayer",zm="dismissableLayer.update",pq="dismissableLayer.pointerDownOutside",mq="dismissableLayer.focusOutside",Xy,wC=_.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),yC=_.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:s,onFocusOutside:a,onInteractOutside:i,onDismiss:o,...c}=e,u=_.useContext(wC),[f,d]=_.useState(null),h=(f==null?void 0:f.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,p]=_.useState({}),g=Ye(t,b=>d(b)),m=Array.from(u.layers),[x]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),y=m.indexOf(x),w=f?m.indexOf(f):-1,v=u.layersWithOutsidePointerEventsDisabled.size>0,S=w>=y,E=gq(b=>{const N=b.target,A=[...u.branches].some(O=>O.contains(N));!S||A||(s==null||s(b),i==null||i(b),b.defaultPrevented||o==null||o())},h),k=vq(b=>{const N=b.target;[...u.branches].some(O=>O.contains(N))||(a==null||a(b),i==null||i(b),b.defaultPrevented||o==null||o())},h);return Zx(b=>{w===u.layers.size-1&&(n==null||n(b),!b.defaultPrevented&&o&&(b.preventDefault(),o()))},h),_.useEffect(()=>{if(f)return r&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(Xy=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(f)),u.layers.add(f),Yy(),()=>{r&&u.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=Xy)}},[f,h,r,u]),_.useEffect(()=>()=>{f&&(u.layers.delete(f),u.layersWithOutsidePointerEventsDisabled.delete(f),Yy())},[f,u]),_.useEffect(()=>{const b=()=>p({});return document.addEventListener(zm,b),()=>document.removeEventListener(zm,b)},[]),l.jsx(Le.div,{...c,ref:g,style:{pointerEvents:v?S?"auto":"none":void 0,...e.style},onFocusCapture:an(e.onFocusCapture,k.onFocusCapture),onBlurCapture:an(e.onBlurCapture,k.onBlurCapture),onPointerDownCapture:an(e.onPointerDownCapture,E.onPointerDownCapture)})});yC.displayName=hq;var xq="DismissableLayerBranch",_C=_.forwardRef((e,t)=>{const r=_.useContext(wC),n=_.useRef(null),s=Ye(t,n);return _.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),l.jsx(Le.div,{...e,ref:s})});_C.displayName=xq;function gq(e,t=globalThis==null?void 0:globalThis.document){const r=nr(e),n=_.useRef(!1),s=_.useRef(()=>{});return _.useEffect(()=>{const a=o=>{if(o.target&&!n.current){let c=function(){bC(pq,r,u,{discrete:!0})};const u={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);n.current=!1},i=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(i),t.removeEventListener("pointerdown",a),t.removeEventListener("click",s.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function vq(e,t=globalThis==null?void 0:globalThis.document){const r=nr(e),n=_.useRef(!1);return _.useEffect(()=>{const s=a=>{a.target&&!n.current&&bC(mq,r,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function Yy(){const e=new CustomEvent(zm);document.dispatchEvent(e)}function bC(e,t,r,{discrete:n}){const s=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?uu(s,a):s.dispatchEvent(a)}var wq=yC,yq=_C;function _q(e,t){return _.useReducer((r,n)=>t[r][n]??r,e)}var SC=e=>{const{present:t,children:r}=e,n=bq(t),s=typeof r=="function"?r({present:n.isPresent}):_.Children.only(r),a=Ye(n.ref,Sq(s));return typeof r=="function"||n.isPresent?_.cloneElement(s,{ref:a}):null};SC.displayName="Presence";function bq(e){const[t,r]=_.useState(),n=_.useRef(null),s=_.useRef(e),a=_.useRef("none"),i=e?"mounted":"unmounted",[o,c]=_q(i,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return _.useEffect(()=>{const u=wf(n.current);a.current=o==="mounted"?u:"none"},[o]),Lt(()=>{const u=n.current,f=s.current;if(f!==e){const h=a.current,p=wf(u);e?c("MOUNT"):p==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(f&&h!==p?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),Lt(()=>{if(t){let u;const f=t.ownerDocument.defaultView??window,d=p=>{const m=wf(n.current).includes(CSS.escape(p.animationName));if(p.target===t&&m&&(c("ANIMATION_END"),!s.current)){const x=t.style.animationFillMode;t.style.animationFillMode="forwards",u=f.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=x)})}},h=p=>{p.target===t&&(a.current=wf(n.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{f.clearTimeout(u),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:_.useCallback(u=>{n.current=u?getComputedStyle(u):null,r(u)},[])}}function wf(e){return(e==null?void 0:e.animationName)||"none"}function Sq(e){var n,s;let t=(n=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:n.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var fv="ToastProvider",[dv,kq,Eq]=f0("Toast"),[kC,cK]=Ha("Toast",[Eq]),[Tq,D0]=kC(fv),EC=e=>{const{__scopeToast:t,label:r="Notification",duration:n=5e3,swipeDirection:s="right",swipeThreshold:a=50,children:i}=e,[o,c]=_.useState(null),[u,f]=_.useState(0),d=_.useRef(!1),h=_.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${fv}\`. Expected non-empty \`string\`.`),l.jsx(dv.Provider,{scope:t,children:l.jsx(Tq,{scope:t,label:r,duration:n,swipeDirection:s,swipeThreshold:a,toastCount:u,viewport:o,onViewportChange:c,onToastAdd:_.useCallback(()=>f(p=>p+1),[]),onToastRemove:_.useCallback(()=>f(p=>p-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:i})})};EC.displayName=fv;var TC="ToastViewport",Nq=["F8"],Wm="toast.viewportPause",Vm="toast.viewportResume",NC=_.forwardRef((e,t)=>{const{__scopeToast:r,hotkey:n=Nq,label:s="Notifications ({hotkey})",...a}=e,i=D0(TC,r),o=kq(r),c=_.useRef(null),u=_.useRef(null),f=_.useRef(null),d=_.useRef(null),h=Ye(t,d,i.onViewportChange),p=n.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=i.toastCount>0;_.useEffect(()=>{const x=y=>{var v;n.length!==0&&n.every(S=>y[S]||y.code===S)&&((v=d.current)==null||v.focus())};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[n]),_.useEffect(()=>{const x=c.current,y=d.current;if(g&&x&&y){const w=()=>{if(!i.isClosePausedRef.current){const k=new CustomEvent(Wm);y.dispatchEvent(k),i.isClosePausedRef.current=!0}},v=()=>{if(i.isClosePausedRef.current){const k=new CustomEvent(Vm);y.dispatchEvent(k),i.isClosePausedRef.current=!1}},S=k=>{!x.contains(k.relatedTarget)&&v()},E=()=>{x.contains(document.activeElement)||v()};return x.addEventListener("focusin",w),x.addEventListener("focusout",S),x.addEventListener("pointermove",w),x.addEventListener("pointerleave",E),window.addEventListener("blur",w),window.addEventListener("focus",v),()=>{x.removeEventListener("focusin",w),x.removeEventListener("focusout",S),x.removeEventListener("pointermove",w),x.removeEventListener("pointerleave",E),window.removeEventListener("blur",w),window.removeEventListener("focus",v)}}},[g,i.isClosePausedRef]);const m=_.useCallback(({tabbingDirection:x})=>{const w=o().map(v=>{const S=v.ref.current,E=[S,...Uq(S)];return x==="forwards"?E:E.reverse()});return(x==="forwards"?w.reverse():w).flat()},[o]);return _.useEffect(()=>{const x=d.current;if(x){const y=w=>{var E,k,b;const v=w.altKey||w.ctrlKey||w.metaKey;if(w.key==="Tab"&&!v){const N=document.activeElement,A=w.shiftKey;if(w.target===x&&A){(E=u.current)==null||E.focus();return}const C=m({tabbingDirection:A?"backwards":"forwards"}),B=C.findIndex(G=>G===N);rp(C.slice(B+1))?w.preventDefault():A?(k=u.current)==null||k.focus():(b=f.current)==null||b.focus()}};return x.addEventListener("keydown",y),()=>x.removeEventListener("keydown",y)}},[o,m]),l.jsxs(yq,{ref:c,role:"region","aria-label":s.replace("{hotkey}",p),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&l.jsx(Hm,{ref:u,onFocusFromOutsideViewport:()=>{const x=m({tabbingDirection:"forwards"});rp(x)}}),l.jsx(dv.Slot,{scope:r,children:l.jsx(Le.ol,{tabIndex:-1,...a,ref:h})}),g&&l.jsx(Hm,{ref:f,onFocusFromOutsideViewport:()=>{const x=m({tabbingDirection:"backwards"});rp(x)}})]})});NC.displayName=TC;var CC="ToastFocusProxy",Hm=_.forwardRef((e,t)=>{const{__scopeToast:r,onFocusFromOutsideViewport:n,...s}=e,a=D0(CC,r);return l.jsx(vg,{tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:i=>{var u;const o=i.relatedTarget;!((u=a.viewport)!=null&&u.contains(o))&&n()}})});Hm.displayName=CC;var Eu="Toast",Cq="toast.swipeStart",Aq="toast.swipeMove",jq="toast.swipeCancel",Pq="toast.swipeEnd",AC=_.forwardRef((e,t)=>{const{forceMount:r,open:n,defaultOpen:s,onOpenChange:a,...i}=e,[o,c]=Qo({prop:n,defaultProp:s??!0,onChange:a,caller:Eu});return l.jsx(SC,{present:r||o,children:l.jsx(Oq,{open:o,...i,ref:t,onClose:()=>c(!1),onPause:nr(e.onPause),onResume:nr(e.onResume),onSwipeStart:an(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:an(e.onSwipeMove,u=>{const{x:f,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:an(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:an(e.onSwipeEnd,u=>{const{x:f,y:d}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${f}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),c(!1)})})})});AC.displayName=Eu;var[Rq,Fq]=kC(Eu,{onClose(){}}),Oq=_.forwardRef((e,t)=>{const{__scopeToast:r,type:n="foreground",duration:s,open:a,onClose:i,onEscapeKeyDown:o,onPause:c,onResume:u,onSwipeStart:f,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:p,...g}=e,m=D0(Eu,r),[x,y]=_.useState(null),w=Ye(t,G=>y(G)),v=_.useRef(null),S=_.useRef(null),E=s||m.duration,k=_.useRef(0),b=_.useRef(E),N=_.useRef(0),{onToastAdd:A,onToastRemove:O}=m,V=nr(()=>{var X;(x==null?void 0:x.contains(document.activeElement))&&((X=m.viewport)==null||X.focus()),i()}),C=_.useCallback(G=>{!G||G===1/0||(window.clearTimeout(N.current),k.current=new Date().getTime(),N.current=window.setTimeout(V,G))},[V]);_.useEffect(()=>{const G=m.viewport;if(G){const X=()=>{C(b.current),u==null||u()},z=()=>{const q=new Date().getTime()-k.current;b.current=b.current-q,window.clearTimeout(N.current),c==null||c()};return G.addEventListener(Wm,z),G.addEventListener(Vm,X),()=>{G.removeEventListener(Wm,z),G.removeEventListener(Vm,X)}}},[m.viewport,E,c,u,C]),_.useEffect(()=>{a&&!m.isClosePausedRef.current&&C(E)},[a,E,m.isClosePausedRef,C]),_.useEffect(()=>(A(),()=>O()),[A,O]);const B=_.useMemo(()=>x?DC(x):null,[x]);return m.viewport?l.jsxs(l.Fragment,{children:[B&&l.jsx(Iq,{__scopeToast:r,role:"status","aria-live":n==="foreground"?"assertive":"polite",children:B}),l.jsx(Rq,{scope:r,onClose:V,children:Ui.createPortal(l.jsx(dv.ItemSlot,{scope:r,children:l.jsx(wq,{asChild:!0,onEscapeKeyDown:an(o,()=>{m.isFocusedToastEscapeKeyDownRef.current||V(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:l.jsx(Le.li,{tabIndex:0,"data-state":a?"open":"closed","data-swipe-direction":m.swipeDirection,...g,ref:w,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:an(e.onKeyDown,G=>{G.key==="Escape"&&(o==null||o(G.nativeEvent),G.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,V()))}),onPointerDown:an(e.onPointerDown,G=>{G.button===0&&(v.current={x:G.clientX,y:G.clientY})}),onPointerMove:an(e.onPointerMove,G=>{if(!v.current)return;const X=G.clientX-v.current.x,z=G.clientY-v.current.y,q=!!S.current,K=["left","right"].includes(m.swipeDirection),F=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,ne=K?F(0,X):0,Y=K?0:F(0,z),j=G.pointerType==="touch"?10:2,H={x:ne,y:Y},U={originalEvent:G,delta:H};q?(S.current=H,yf(Aq,d,U,{discrete:!1})):Jy(H,m.swipeDirection,j)?(S.current=H,yf(Cq,f,U,{discrete:!1}),G.target.setPointerCapture(G.pointerId)):(Math.abs(X)>j||Math.abs(z)>j)&&(v.current=null)}),onPointerUp:an(e.onPointerUp,G=>{const X=S.current,z=G.target;if(z.hasPointerCapture(G.pointerId)&&z.releasePointerCapture(G.pointerId),S.current=null,v.current=null,X){const q=G.currentTarget,K={originalEvent:G,delta:X};Jy(X,m.swipeDirection,m.swipeThreshold)?yf(Pq,p,K,{discrete:!0}):yf(jq,h,K,{discrete:!0}),q.addEventListener("click",F=>F.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),Iq=e=>{const{__scopeToast:t,children:r,...n}=e,s=D0(Eu,t),[a,i]=_.useState(!1),[o,c]=_.useState(!1);return Mq(()=>i(!0)),_.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),o?null:l.jsx(du,{asChild:!0,children:l.jsx(vg,{...n,children:a&&l.jsxs(l.Fragment,{children:[s.label," ",r]})})})},Dq="ToastTitle",jC=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return l.jsx(Le.div,{...n,ref:t})});jC.displayName=Dq;var Lq="ToastDescription",PC=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e;return l.jsx(Le.div,{...n,ref:t})});PC.displayName=Lq;var RC="ToastAction",FC=_.forwardRef((e,t)=>{const{altText:r,...n}=e;return r.trim()?l.jsx(IC,{altText:r,asChild:!0,children:l.jsx(hv,{...n,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${RC}\`. Expected non-empty \`string\`.`),null)});FC.displayName=RC;var OC="ToastClose",hv=_.forwardRef((e,t)=>{const{__scopeToast:r,...n}=e,s=Fq(OC,r);return l.jsx(IC,{asChild:!0,children:l.jsx(Le.button,{type:"button",...n,ref:t,onClick:an(e.onClick,s.onClose)})})});hv.displayName=OC;var IC=_.forwardRef((e,t)=>{const{__scopeToast:r,altText:n,...s}=e;return l.jsx(Le.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":n||void 0,...s,ref:t})});function DC(e){const t=[];return Array.from(e.childNodes).forEach(n=>{if(n.nodeType===n.TEXT_NODE&&n.textContent&&t.push(n.textContent),Bq(n)){const s=n.ariaHidden||n.hidden||n.style.display==="none",a=n.dataset.radixToastAnnounceExclude==="";if(!s)if(a){const i=n.dataset.radixToastAnnounceAlt;i&&t.push(i)}else t.push(...DC(n))}}),t}function yf(e,t,r,{discrete:n}){const s=r.originalEvent.currentTarget,a=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:r});t&&s.addEventListener(e,t,{once:!0}),n?uu(s,a):s.dispatchEvent(a)}var Jy=(e,t,r=0)=>{const n=Math.abs(e.x),s=Math.abs(e.y),a=n>s;return t==="left"||t==="right"?a&&n>r:!a&&s>r};function Mq(e=()=>{}){const t=nr(e);Lt(()=>{let r=0,n=0;return r=window.requestAnimationFrame(()=>n=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(n)}},[t])}function Bq(e){return e.nodeType===e.ELEMENT_NODE}function Uq(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const s=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||s?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function rp(e){const t=document.activeElement;return e.some(r=>r===t?!0:(r.focus(),document.activeElement!==t))}var $q=EC,LC=NC,MC=AC,BC=jC,UC=PC,$C=FC,zC=hv;const zq=$q,WC=_.forwardRef(({className:e,...t},r)=>l.jsx(LC,{ref:r,className:Ke("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));WC.displayName=LC.displayName;const Wq=s0("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),VC=_.forwardRef(({className:e,variant:t,...r},n)=>l.jsx(MC,{ref:n,className:Ke(Wq({variant:t}),e),...r}));VC.displayName=MC.displayName;const Vq=_.forwardRef(({className:e,...t},r)=>l.jsx($C,{ref:r,className:Ke("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));Vq.displayName=$C.displayName;const HC=_.forwardRef(({className:e,...t},r)=>l.jsx(zC,{ref:r,className:Ke("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:l.jsx(rn,{className:"h-4 w-4"})}));HC.displayName=zC.displayName;const GC=_.forwardRef(({className:e,...t},r)=>l.jsx(BC,{ref:r,className:Ke("text-sm font-semibold",e),...t}));GC.displayName=BC.displayName;const qC=_.forwardRef(({className:e,...t},r)=>l.jsx(UC,{ref:r,className:Ke("text-sm opacity-90",e),...t}));qC.displayName=UC.displayName;function Hq(){const{toasts:e}=Xr();return l.jsxs(zq,{children:[e.map(function({id:t,title:r,description:n,action:s,...a}){return l.jsxs(VC,{...a,children:[l.jsxs("div",{className:"grid gap-1",children:[r&&l.jsx(GC,{children:r}),n&&l.jsx(qC,{children:n})]}),s,l.jsx(HC,{})]},t)}),l.jsx(WC,{})]})}const Gq=()=>{const e=new Date().getHours();return e>=6&&e<18?"light":"dark"},Qy=localStorage.getItem("theme-preference")||"auto",qq=Qy==="auto"?Gq():Qy;qq==="light"?(document.documentElement.classList.remove("dark"),document.documentElement.classList.add("light")):(document.documentElement.classList.add("dark"),document.documentElement.classList.remove("light"));db(document.getElementById("root")).render(l.jsxs(l.Fragment,{children:[l.jsx(dq,{}),l.jsx(Hq,{})]}));
